[2024-02-26 19:31:51,197 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-02-26 19:31:51,197 INFO] Parsed 2 corpora from -data.
[2024-02-26 19:31:51,197 INFO] Loading checkpoint from tg-pretrain/models/both/tg-pretrain_03_step_8800.pt
[2024-02-26 19:31:51,320 INFO] Building model...
[2024-02-26 19:31:51,377 INFO] Switching model to float32 for amp/apex_amp
[2024-02-26 19:31:51,377 INFO] Non quantized layer compute is fp32
[2024-02-26 19:31:53,288 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(32768, 320, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(320, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(25208, 320, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(820, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=25208, bias=True)
)
[2024-02-26 19:31:53,288 INFO] encoder: 14133760
[2024-02-26 19:31:53,288 INFO] decoder: 26093768
[2024-02-26 19:31:53,288 INFO] * number of parameters: 40227528
[2024-02-26 19:31:53,288 INFO] Trainable parameters = {'torch.float32': 40227528, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-02-26 19:31:53,288 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-02-26 19:31:53,288 INFO]  * src vocab size = 32768
[2024-02-26 19:31:53,288 INFO]  * tgt vocab size = 25208
[2024-02-26 19:31:53,290 INFO] Starting training on GPU: [0]
[2024-02-26 19:31:53,290 INFO] Start training loop and validate every 200 steps...
[2024-02-26 19:31:53,290 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-02-26 19:32:08,668 INFO] Step 8850/13800; acc: 23.8; ppl: 1661.7; xent: 7.4; lr: 1.00000; sents:    3200; bsz:  292/ 218/64; 949/708 tok/s;     15 sec;
[2024-02-26 19:32:09,257 INFO] Step 8900/13800; acc: 27.1; ppl: 386.5; xent: 6.0; lr: 1.00000; sents:    3200; bsz:  345/ 222/64; 29293/18841 tok/s;     16 sec;
[2024-02-26 19:32:09,801 INFO] Step 8950/13800; acc: 29.0; ppl: 170.0; xent: 5.1; lr: 1.00000; sents:    3200; bsz:  303/ 224/64; 27905/20605 tok/s;     17 sec;
[2024-02-26 19:32:10,318 INFO] Step 9000/13800; acc: 35.2; ppl:  85.7; xent: 4.5; lr: 1.00000; sents:    3200; bsz:  253/ 199/64; 24485/19190 tok/s;     17 sec;
[2024-02-26 19:32:14,071 INFO] valid stats calculation
                           took: 3.7521727085113525 s.
[2024-02-26 19:32:14,071 INFO] Train perplexity: 318.928
[2024-02-26 19:32:14,071 INFO] Train accuracy: 28.6311
[2024-02-26 19:32:14,071 INFO] Sentences processed: 12800
[2024-02-26 19:32:14,071 INFO] Average bsz:  298/ 216/64
[2024-02-26 19:32:14,071 INFO] Validation perplexity: 581.181
[2024-02-26 19:32:14,071 INFO] Validation accuracy: 15.5188
[2024-02-26 19:32:14,074 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_9000.pt
[2024-02-26 19:32:14,838 INFO] Step 9050/13800; acc: 34.0; ppl:  79.7; xent: 4.4; lr: 1.00000; sents:    3200; bsz:  310/ 222/64; 3427/2460 tok/s;     22 sec;
[2024-02-26 19:32:15,415 INFO] Step 9100/13800; acc: 29.4; ppl: 110.1; xent: 4.7; lr: 1.00000; sents:    3200; bsz:  320/ 237/64; 27745/20575 tok/s;     22 sec;
[2024-02-26 19:32:15,907 INFO] Step 9150/13800; acc: 43.1; ppl:  30.3; xent: 3.4; lr: 1.00000; sents:    3200; bsz:  279/ 179/64; 28351/18165 tok/s;     23 sec;
[2024-02-26 19:32:16,439 INFO] Step 9200/13800; acc: 38.9; ppl:  35.4; xent: 3.6; lr: 1.00000; sents:    3200; bsz:  292/ 210/64; 27441/19772 tok/s;     23 sec;
[2024-02-26 19:32:20,221 INFO] valid stats calculation
                           took: 3.7818973064422607 s.
[2024-02-26 19:32:20,221 INFO] Train perplexity: 137.147
[2024-02-26 19:32:20,221 INFO] Train accuracy: 32.2208
[2024-02-26 19:32:20,221 INFO] Sentences processed: 25600
[2024-02-26 19:32:20,221 INFO] Average bsz:  299/ 214/64
[2024-02-26 19:32:20,221 INFO] Validation perplexity: 919.904
[2024-02-26 19:32:20,222 INFO] Validation accuracy: 16.5066
[2024-02-26 19:32:20,224 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_9200.pt
[2024-02-26 19:32:21,067 INFO] Step 9250/13800; acc: 34.1; ppl:  76.0; xent: 4.3; lr: 1.00000; sents:    3200; bsz:  362/ 238/64; 3907/2566 tok/s;     28 sec;
[2024-02-26 19:32:21,565 INFO] Step 9300/13800; acc: 51.4; ppl:  13.1; xent: 2.6; lr: 1.00000; sents:    3200; bsz:  269/ 176/64; 26995/17649 tok/s;     28 sec;
[2024-02-26 19:32:22,156 INFO] Step 9350/13800; acc: 44.1; ppl:  27.8; xent: 3.3; lr: 1.00000; sents:    3200; bsz:  297/ 210/64; 25133/17758 tok/s;     29 sec;
[2024-02-26 19:32:22,679 INFO] Step 9400/13800; acc: 49.4; ppl:  12.2; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  270/ 200/64; 25852/19114 tok/s;     29 sec;
[2024-02-26 19:32:26,436 INFO] valid stats calculation
                           took: 3.757641553878784 s.
[2024-02-26 19:32:26,437 INFO] Train perplexity: 79.8081
[2024-02-26 19:32:26,437 INFO] Train accuracy: 36.0658
[2024-02-26 19:32:26,437 INFO] Sentences processed: 38400
[2024-02-26 19:32:26,437 INFO] Average bsz:  299/ 211/64
[2024-02-26 19:32:26,437 INFO] Validation perplexity: 529.602
[2024-02-26 19:32:26,437 INFO] Validation accuracy: 18.8885
[2024-02-26 19:32:26,439 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_9400.pt
[2024-02-26 19:32:27,215 INFO] Step 9450/13800; acc: 44.5; ppl:  17.9; xent: 2.9; lr: 1.00000; sents:    3200; bsz:  307/ 240/64; 3386/2641 tok/s;     34 sec;
[2024-02-26 19:32:27,753 INFO] Step 9500/13800; acc: 48.8; ppl:  12.0; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  306/ 212/64; 28438/19713 tok/s;     34 sec;
[2024-02-26 19:32:28,372 INFO] Step 9550/13800; acc: 44.3; ppl:  23.0; xent: 3.1; lr: 1.00000; sents:    3200; bsz:  317/ 241/64; 25576/19461 tok/s;     35 sec;
[2024-02-26 19:32:28,923 INFO] Step 9600/13800; acc: 51.6; ppl:   9.5; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  311/ 222/64; 28252/20210 tok/s;     36 sec;
[2024-02-26 19:32:32,672 INFO] valid stats calculation
                           took: 3.7496469020843506 s.
[2024-02-26 19:32:32,673 INFO] Train perplexity: 51.1672
[2024-02-26 19:32:32,673 INFO] Train accuracy: 39.0143
[2024-02-26 19:32:32,673 INFO] Sentences processed: 51200
[2024-02-26 19:32:32,673 INFO] Average bsz:  302/ 216/64
[2024-02-26 19:32:32,673 INFO] Validation perplexity: 403.282
[2024-02-26 19:32:32,673 INFO] Validation accuracy: 19.3685
[2024-02-26 19:32:32,675 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_9600.pt
[2024-02-26 19:32:33,432 INFO] Step 9650/13800; acc: 57.2; ppl:   7.0; xent: 1.9; lr: 1.00000; sents:    3200; bsz:  276/ 210/64; 3065/2329 tok/s;     40 sec;
[2024-02-26 19:32:33,956 INFO] Step 9700/13800; acc: 60.1; ppl:   6.1; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  280/ 201/64; 26785/19181 tok/s;     41 sec;
[2024-02-26 19:32:34,485 INFO] Step 9750/13800; acc: 59.1; ppl:   5.7; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  289/ 210/64; 27328/19831 tok/s;     41 sec;
[2024-02-26 19:32:35,070 INFO] Step 9800/13800; acc: 54.4; ppl:  10.7; xent: 2.4; lr: 1.00000; sents:    3200; bsz:  325/ 226/64; 27772/19341 tok/s;     42 sec;
[2024-02-26 19:32:38,802 INFO] valid stats calculation
                           took: 3.731421947479248 s.
[2024-02-26 19:32:38,802 INFO] Train perplexity: 34.7738
[2024-02-26 19:32:38,802 INFO] Train accuracy: 42.6756
[2024-02-26 19:32:38,802 INFO] Sentences processed: 64000
[2024-02-26 19:32:38,802 INFO] Average bsz:  300/ 215/64
[2024-02-26 19:32:38,802 INFO] Validation perplexity: 341.39
[2024-02-26 19:32:38,802 INFO] Validation accuracy: 18.7685
[2024-02-26 19:32:38,805 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_9800.pt
[2024-02-26 19:32:39,553 INFO] Step 9850/13800; acc: 57.2; ppl:   7.4; xent: 2.0; lr: 1.00000; sents:    3200; bsz:  305/ 220/64; 3398/2450 tok/s;     46 sec;
[2024-02-26 19:32:40,117 INFO] Step 9900/13800; acc: 61.1; ppl:   4.9; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  333/ 234/64; 29518/20723 tok/s;     47 sec;
[2024-02-26 19:32:40,624 INFO] Step 9950/13800; acc: 69.2; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  291/ 192/64; 28629/18918 tok/s;     47 sec;
[2024-02-26 19:32:41,148 INFO] Step 10000/13800; acc: 68.3; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  261/ 203/64; 24936/19359 tok/s;     48 sec;
[2024-02-26 19:32:44,926 INFO] valid stats calculation
                           took: 3.7779970169067383 s.
[2024-02-26 19:32:44,927 INFO] Train perplexity: 24.9187
[2024-02-26 19:32:44,927 INFO] Train accuracy: 46.1349
[2024-02-26 19:32:44,927 INFO] Sentences processed: 76800
[2024-02-26 19:32:44,927 INFO] Average bsz:  300/ 214/64
[2024-02-26 19:32:44,927 INFO] Validation perplexity: 602.127
[2024-02-26 19:32:44,927 INFO] Validation accuracy: 19.1008
[2024-02-26 19:32:44,929 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_10000.pt
[2024-02-26 19:32:45,756 INFO] Step 10050/13800; acc: 58.3; ppl:   8.8; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  313/ 243/64; 3396/2633 tok/s;     52 sec;
[2024-02-26 19:32:46,283 INFO] Step 10100/13800; acc: 68.1; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  268/ 200/64; 25366/18947 tok/s;     53 sec;
[2024-02-26 19:32:46,916 INFO] Step 10150/13800; acc: 55.5; ppl:  13.8; xent: 2.6; lr: 1.00000; sents:    3200; bsz:  336/ 236/64; 26609/18676 tok/s;     54 sec;
[2024-02-26 19:32:47,499 INFO] Step 10200/13800; acc: 61.1; ppl:   7.6; xent: 2.0; lr: 1.00000; sents:    3200; bsz:  331/ 220/64; 28372/18836 tok/s;     54 sec;
[2024-02-26 19:32:51,244 INFO] valid stats calculation
                           took: 3.744588851928711 s.
[2024-02-26 19:32:51,245 INFO] Train perplexity: 21.0809
[2024-02-26 19:32:51,245 INFO] Train accuracy: 48.2617
[2024-02-26 19:32:51,245 INFO] Sentences processed: 89600
[2024-02-26 19:32:51,245 INFO] Average bsz:  301/ 216/64
[2024-02-26 19:32:51,245 INFO] Validation perplexity: 333.631
[2024-02-26 19:32:51,245 INFO] Validation accuracy: 18.9623
[2024-02-26 19:32:51,247 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_10200.pt
[2024-02-26 19:32:51,992 INFO] Step 10250/13800; acc: 69.4; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  302/ 210/64; 3362/2338 tok/s;     59 sec;
[2024-02-26 19:32:52,579 INFO] Step 10300/13800; acc: 70.5; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  292/ 209/64; 24838/17756 tok/s;     59 sec;
[2024-02-26 19:32:53,212 INFO] Step 10350/13800; acc: 67.9; ppl:   4.7; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  370/ 252/64; 29278/19920 tok/s;     60 sec;
[2024-02-26 19:32:54,013 INFO] Step 10400/13800; acc: 51.5; ppl:  21.5; xent: 3.1; lr: 1.00000; sents:    3195; bsz:  413/ 282/64; 25805/17601 tok/s;     61 sec;
[2024-02-26 19:32:57,817 INFO] valid stats calculation
                           took: 3.8043363094329834 s.
[2024-02-26 19:32:57,818 INFO] Train perplexity: 18.0407
[2024-02-26 19:32:57,818 INFO] Train accuracy: 50.3993
[2024-02-26 19:32:57,818 INFO] Sentences processed: 102395
[2024-02-26 19:32:57,818 INFO] Average bsz:  307/ 219/64
[2024-02-26 19:32:57,818 INFO] Validation perplexity: 483.409
[2024-02-26 19:32:57,818 INFO] Validation accuracy: 18.87
[2024-02-26 19:32:57,820 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_10400.pt
[2024-02-26 19:32:58,541 INFO] Step 10450/13800; acc: 77.4; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  291/ 190/64; 3208/2099 tok/s;     65 sec;
[2024-02-26 19:32:59,102 INFO] Step 10500/13800; acc: 70.7; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  303/ 225/64; 27023/20077 tok/s;     66 sec;
[2024-02-26 19:32:59,660 INFO] Step 10550/13800; acc: 78.2; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  310/ 213/64; 27815/19081 tok/s;     66 sec;
[2024-02-26 19:33:00,182 INFO] Step 10600/13800; acc: 80.5; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  276/ 196/64; 26551/18807 tok/s;     67 sec;
[2024-02-26 19:33:03,949 INFO] valid stats calculation
                           took: 3.7667200565338135 s.
[2024-02-26 19:33:03,950 INFO] Train perplexity: 14.7675
[2024-02-26 19:33:03,950 INFO] Train accuracy: 53.1547
[2024-02-26 19:33:03,950 INFO] Sentences processed: 115195
[2024-02-26 19:33:03,950 INFO] Average bsz:  306/ 217/64
[2024-02-26 19:33:03,950 INFO] Validation perplexity: 662.443
[2024-02-26 19:33:03,950 INFO] Validation accuracy: 19.2024
[2024-02-26 19:33:03,952 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_10600.pt
[2024-02-26 19:33:04,716 INFO] Step 10650/13800; acc: 80.2; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  280/ 215/64; 3091/2371 tok/s;     71 sec;
[2024-02-26 19:33:05,359 INFO] Step 10700/13800; acc: 64.3; ppl:   8.3; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  339/ 260/64; 26402/20202 tok/s;     72 sec;
[2024-02-26 19:33:05,878 INFO] Step 10750/13800; acc: 77.7; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  275/ 192/64; 26521/18538 tok/s;     73 sec;
[2024-02-26 19:33:06,403 INFO] Step 10800/13800; acc: 75.6; ppl:   3.5; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  260/ 188/64; 24737/17918 tok/s;     73 sec;
[2024-02-26 19:33:10,157 INFO] valid stats calculation
                           took: 3.753560781478882 s.
[2024-02-26 19:33:10,158 INFO] Train perplexity: 12.8666
[2024-02-26 19:33:10,158 INFO] Train accuracy: 55.1869
[2024-02-26 19:33:10,158 INFO] Sentences processed: 127995
[2024-02-26 19:33:10,158 INFO] Average bsz:  304/ 217/64
[2024-02-26 19:33:10,158 INFO] Validation perplexity: 392.997
[2024-02-26 19:33:10,158 INFO] Validation accuracy: 18.6023
[2024-02-26 19:33:10,161 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_10800.pt
[2024-02-26 19:33:10,998 INFO] Step 10850/13800; acc: 64.3; ppl:   7.9; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  358/ 249/64; 3892/2712 tok/s;     78 sec;
[2024-02-26 19:33:11,538 INFO] Step 10900/13800; acc: 83.5; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  298/ 219/64; 27584/20220 tok/s;     78 sec;
[2024-02-26 19:33:12,232 INFO] Step 10950/13800; acc: 64.4; ppl:   9.6; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  405/ 271/64; 29160/19550 tok/s;     79 sec;
[2024-02-26 19:33:12,846 INFO] Step 11000/13800; acc: 69.7; ppl:   5.8; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  315/ 237/64; 25690/19300 tok/s;     80 sec;
[2024-02-26 19:33:16,581 INFO] valid stats calculation
                           took: 3.734248638153076 s.
[2024-02-26 19:33:16,581 INFO] Train perplexity: 11.8167
[2024-02-26 19:33:16,581 INFO] Train accuracy: 56.6796
[2024-02-26 19:33:16,582 INFO] Sentences processed: 140795
[2024-02-26 19:33:16,582 INFO] Average bsz:  307/ 219/64
[2024-02-26 19:33:16,582 INFO] Validation perplexity: 374.546
[2024-02-26 19:33:16,582 INFO] Validation accuracy: 15.565
[2024-02-26 19:33:16,584 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_11000.pt
[2024-02-26 19:33:17,400 INFO] Step 11050/13800; acc: 77.2; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    3155; bsz:  322/ 223/63; 3530/2448 tok/s;     84 sec;
[2024-02-26 19:33:17,932 INFO] Step 11100/13800; acc: 78.8; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  272/ 200/64; 25567/18847 tok/s;     85 sec;
[2024-02-26 19:33:18,446 INFO] Step 11150/13800; acc: 88.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  287/ 196/64; 27884/19046 tok/s;     85 sec;
[2024-02-26 19:33:18,969 INFO] Step 11200/13800; acc: 87.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  294/ 204/64; 28140/19467 tok/s;     86 sec;
[2024-02-26 19:33:22,698 INFO] valid stats calculation
                           took: 3.7287983894348145 s.
[2024-02-26 19:33:22,699 INFO] Train perplexity: 10.3531
[2024-02-26 19:33:22,699 INFO] Train accuracy: 58.7388
[2024-02-26 19:33:22,699 INFO] Sentences processed: 153550
[2024-02-26 19:33:22,699 INFO] Average bsz:  306/ 218/64
[2024-02-26 19:33:22,699 INFO] Validation perplexity: 562.288
[2024-02-26 19:33:22,699 INFO] Validation accuracy: 18.8977
[2024-02-26 19:33:22,701 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_11200.pt
[2024-02-26 19:33:23,505 INFO] Step 11250/13800; acc: 79.4; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  336/ 235/64; 3707/2592 tok/s;     90 sec;
[2024-02-26 19:33:24,033 INFO] Step 11300/13800; acc: 77.5; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  307/ 200/64; 29112/18955 tok/s;     91 sec;
[2024-02-26 19:33:24,598 INFO] Step 11350/13800; acc: 75.9; ppl:   4.2; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  333/ 212/64; 29504/18816 tok/s;     91 sec;
[2024-02-26 19:33:25,144 INFO] Step 11400/13800; acc: 77.7; ppl:   3.5; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  306/ 209/64; 28035/19159 tok/s;     92 sec;
[2024-02-26 19:33:28,902 INFO] valid stats calculation
                           took: 3.757455587387085 s.
[2024-02-26 19:33:28,902 INFO] Train perplexity: 9.53892
[2024-02-26 19:33:28,902 INFO] Train accuracy: 60.1711
[2024-02-26 19:33:28,902 INFO] Sentences processed: 166350
[2024-02-26 19:33:28,902 INFO] Average bsz:  307/ 218/64
[2024-02-26 19:33:28,902 INFO] Validation perplexity: 389.534
[2024-02-26 19:33:28,902 INFO] Validation accuracy: 18.3069
[2024-02-26 19:33:28,905 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_11400.pt
[2024-02-26 19:33:29,641 INFO] Step 11450/13800; acc: 81.5; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  312/ 222/64; 3472/2467 tok/s;     96 sec;
[2024-02-26 19:33:30,174 INFO] Step 11500/13800; acc: 89.4; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  271/ 212/64; 25484/19955 tok/s;     97 sec;
[2024-02-26 19:33:30,715 INFO] Step 11550/13800; acc: 84.4; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  308/ 216/64; 28528/19937 tok/s;     97 sec;
[2024-02-26 19:33:31,318 INFO] Step 11600/13800; acc: 78.9; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  312/ 230/64; 25880/19078 tok/s;     98 sec;
[2024-02-26 19:33:35,057 INFO] valid stats calculation
                           took: 3.739096164703369 s.
[2024-02-26 19:33:35,058 INFO] Train perplexity: 8.60485
[2024-02-26 19:33:35,058 INFO] Train accuracy: 61.8483
[2024-02-26 19:33:35,058 INFO] Sentences processed: 179150
[2024-02-26 19:33:35,058 INFO] Average bsz:  307/ 218/64
[2024-02-26 19:33:35,058 INFO] Validation perplexity: 461.389
[2024-02-26 19:33:35,058 INFO] Validation accuracy: 16.9129
[2024-02-26 19:33:35,060 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_11600.pt
[2024-02-26 19:33:35,795 INFO] Step 11650/13800; acc: 75.6; ppl:   4.2; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  303/ 213/64; 3389/2383 tok/s;    103 sec;
[2024-02-26 19:33:36,362 INFO] Step 11700/13800; acc: 86.3; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  299/ 224/64; 26394/19716 tok/s;    103 sec;
[2024-02-26 19:33:36,943 INFO] Step 11750/13800; acc: 82.1; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  288/ 222/64; 24832/19151 tok/s;    104 sec;
[2024-02-26 19:33:37,485 INFO] Step 11800/13800; acc: 85.9; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  296/ 209/64; 27328/19271 tok/s;    104 sec;
[2024-02-26 19:33:41,214 INFO] valid stats calculation
                           took: 3.7288265228271484 s.
[2024-02-26 19:33:41,214 INFO] Train perplexity: 7.93258
[2024-02-26 19:33:41,214 INFO] Train accuracy: 63.2184
[2024-02-26 19:33:41,214 INFO] Sentences processed: 191950
[2024-02-26 19:33:41,214 INFO] Average bsz:  306/ 218/64
[2024-02-26 19:33:41,214 INFO] Validation perplexity: 408.38
[2024-02-26 19:33:41,214 INFO] Validation accuracy: 17.4945
[2024-02-26 19:33:41,217 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_11800.pt
[2024-02-26 19:33:41,998 INFO] Step 11850/13800; acc: 80.8; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  315/ 233/64; 3491/2579 tok/s;    109 sec;
[2024-02-26 19:33:42,684 INFO] Step 11900/13800; acc: 72.0; ppl:   7.8; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  394/ 282/64; 28716/20541 tok/s;    109 sec;
[2024-02-26 19:33:43,218 INFO] Step 11950/13800; acc: 86.7; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  330/ 232/64; 30933/21727 tok/s;    110 sec;
[2024-02-26 19:33:43,740 INFO] Step 12000/13800; acc: 86.7; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  320/ 219/64; 30650/20966 tok/s;    110 sec;
[2024-02-26 19:33:47,719 INFO] valid stats calculation
                           took: 3.9780991077423096 s.
[2024-02-26 19:33:47,719 INFO] Train perplexity: 7.46507
[2024-02-26 19:33:47,719 INFO] Train accuracy: 64.4392
[2024-02-26 19:33:47,719 INFO] Sentences processed: 204750
[2024-02-26 19:33:47,719 INFO] Average bsz:  308/ 219/64
[2024-02-26 19:33:47,719 INFO] Validation perplexity: 408.78
[2024-02-26 19:33:47,719 INFO] Validation accuracy: 19.0639
[2024-02-26 19:33:47,722 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_12000.pt
[2024-02-26 19:33:48,415 INFO] Step 12050/13800; acc: 84.1; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  288/ 200/64; 3081/2139 tok/s;    115 sec;
[2024-02-26 19:33:48,939 INFO] Step 12100/13800; acc: 84.2; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  324/ 224/64; 30933/21442 tok/s;    116 sec;
[2024-02-26 19:33:49,481 INFO] Step 12150/13800; acc: 83.5; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  327/ 218/64; 30193/20110 tok/s;    116 sec;
[2024-02-26 19:33:50,019 INFO] Step 12200/13800; acc: 82.9; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  308/ 216/64; 28647/20108 tok/s;    117 sec;
[2024-02-26 19:33:53,983 INFO] valid stats calculation
                           took: 3.9638888835906982 s.
[2024-02-26 19:33:53,984 INFO] Train perplexity: 7.01517
[2024-02-26 19:33:53,984 INFO] Train accuracy: 65.5476
[2024-02-26 19:33:53,984 INFO] Sentences processed: 217550
[2024-02-26 19:33:53,984 INFO] Average bsz:  309/ 219/64
[2024-02-26 19:33:53,984 INFO] Validation perplexity: 448.054
[2024-02-26 19:33:53,984 INFO] Validation accuracy: 18.3623
[2024-02-26 19:33:53,986 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_12200.pt
[2024-02-26 19:33:54,720 INFO] Step 12250/13800; acc: 88.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  303/ 202/64; 3222/2152 tok/s;    121 sec;
[2024-02-26 19:33:58,834 INFO] Step 12300/13800; acc: 94.1; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  301/ 198/64; 3656/2402 tok/s;    126 sec;
[2024-02-26 19:33:59,437 INFO] Step 12350/13800; acc: 91.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  296/ 198/64; 24501/16400 tok/s;    126 sec;
[2024-02-26 19:34:00,064 INFO] Step 12400/13800; acc: 80.6; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  317/ 241/64; 25302/19212 tok/s;    127 sec;
[2024-02-26 19:34:03,820 INFO] valid stats calculation
                           took: 3.755375623703003 s.
[2024-02-26 19:34:03,820 INFO] Train perplexity: 6.53227
[2024-02-26 19:34:03,820 INFO] Train accuracy: 66.7533
[2024-02-26 19:34:03,820 INFO] Sentences processed: 230350
[2024-02-26 19:34:03,820 INFO] Average bsz:  308/ 219/64
[2024-02-26 19:34:03,820 INFO] Validation perplexity: 593.195
[2024-02-26 19:34:03,821 INFO] Validation accuracy: 19.11
[2024-02-26 19:34:03,823 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_12400.pt
[2024-02-26 19:34:04,617 INFO] Step 12450/13800; acc: 89.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  279/ 216/64; 3064/2367 tok/s;    131 sec;
[2024-02-26 19:34:05,201 INFO] Step 12500/13800; acc: 95.0; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  319/ 220/64; 27322/18873 tok/s;    132 sec;
[2024-02-26 19:34:05,782 INFO] Step 12550/13800; acc: 85.6; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  312/ 211/64; 26885/18173 tok/s;    132 sec;
[2024-02-26 19:34:06,325 INFO] Step 12600/13800; acc: 92.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  259/ 191/64; 23811/17578 tok/s;    133 sec;
[2024-02-26 19:34:10,049 INFO] valid stats calculation
                           took: 3.723311424255371 s.
[2024-02-26 19:34:10,049 INFO] Train perplexity: 6.07896
[2024-02-26 19:34:10,049 INFO] Train accuracy: 67.9551
[2024-02-26 19:34:10,049 INFO] Sentences processed: 243150
[2024-02-26 19:34:10,049 INFO] Average bsz:  307/ 218/64
[2024-02-26 19:34:10,049 INFO] Validation perplexity: 436.089
[2024-02-26 19:34:10,049 INFO] Validation accuracy: 17.2821
[2024-02-26 19:34:10,052 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_12600.pt
[2024-02-26 19:34:10,793 INFO] Step 12650/13800; acc: 87.9; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  274/ 210/64; 3071/2354 tok/s;    138 sec;
[2024-02-26 19:34:11,319 INFO] Step 12700/13800; acc: 92.1; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  291/ 208/64; 27603/19749 tok/s;    138 sec;
[2024-02-26 19:34:11,869 INFO] Step 12750/13800; acc: 90.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  302/ 218/64; 27527/19839 tok/s;    139 sec;
[2024-02-26 19:34:12,393 INFO] Step 12800/13800; acc: 92.4; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  292/ 207/64; 27855/19719 tok/s;    139 sec;
[2024-02-26 19:34:16,139 INFO] valid stats calculation
                           took: 3.746347188949585 s.
[2024-02-26 19:34:16,140 INFO] Train perplexity: 5.70921
[2024-02-26 19:34:16,140 INFO] Train accuracy: 69.0572
[2024-02-26 19:34:16,140 INFO] Sentences processed: 255950
[2024-02-26 19:34:16,140 INFO] Average bsz:  307/ 218/64
[2024-02-26 19:34:16,140 INFO] Validation perplexity: 449.924
[2024-02-26 19:34:16,140 INFO] Validation accuracy: 18.0484
[2024-02-26 19:34:16,142 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_12800.pt
[2024-02-26 19:34:16,889 INFO] Step 12850/13800; acc: 90.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  297/ 211/64; 3302/2351 tok/s;    144 sec;
[2024-02-26 19:34:17,429 INFO] Step 12900/13800; acc: 95.2; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  312/ 219/64; 28961/20328 tok/s;    144 sec;
[2024-02-26 19:34:18,033 INFO] Step 12950/13800; acc: 80.5; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  322/ 246/64; 26628/20348 tok/s;    145 sec;
[2024-02-26 19:34:18,525 INFO] Step 13000/13800; acc: 94.3; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  276/ 182/64; 28084/18463 tok/s;    145 sec;
[2024-02-26 19:34:22,319 INFO] valid stats calculation
                           took: 3.793670654296875 s.
[2024-02-26 19:34:22,320 INFO] Train perplexity: 5.40018
[2024-02-26 19:34:22,320 INFO] Train accuracy: 70.0273
[2024-02-26 19:34:22,320 INFO] Sentences processed: 268750
[2024-02-26 19:34:22,320 INFO] Average bsz:  306/ 218/64
[2024-02-26 19:34:22,320 INFO] Validation perplexity: 432.698
[2024-02-26 19:34:22,320 INFO] Validation accuracy: 18.39
[2024-02-26 19:34:22,323 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_13000.pt
[2024-02-26 19:34:23,080 INFO] Step 13050/13800; acc: 91.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  330/ 224/64; 3626/2460 tok/s;    150 sec;
[2024-02-26 19:34:23,721 INFO] Step 13100/13800; acc: 74.2; ppl:   5.2; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  330/ 249/64; 25736/19426 tok/s;    150 sec;
[2024-02-26 19:34:24,349 INFO] Step 13150/13800; acc: 79.9; ppl:   3.5; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  356/ 245/64; 28355/19499 tok/s;    151 sec;
[2024-02-26 19:34:25,098 INFO] Step 13200/13800; acc: 67.6; ppl:   8.6; xent: 2.1; lr: 1.00000; sents:    3195; bsz:  397/ 281/64; 26457/18747 tok/s;    152 sec;
[2024-02-26 19:34:28,864 INFO] valid stats calculation
                           took: 3.7652225494384766 s.
[2024-02-26 19:34:28,864 INFO] Train perplexity: 5.32539
[2024-02-26 19:34:28,864 INFO] Train accuracy: 70.4226
[2024-02-26 19:34:28,864 INFO] Sentences processed: 281545
[2024-02-26 19:34:28,864 INFO] Average bsz:  309/ 219/64
[2024-02-26 19:34:28,864 INFO] Validation perplexity: 664.085
[2024-02-26 19:34:28,864 INFO] Validation accuracy: 17.5591
[2024-02-26 19:34:28,867 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_13200.pt
[2024-02-26 19:34:29,583 INFO] Step 13250/13800; acc: 95.1; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  312/ 198/64; 3482/2212 tok/s;    156 sec;
[2024-02-26 19:34:30,117 INFO] Step 13300/13800; acc: 95.1; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  307/ 204/64; 28754/19050 tok/s;    157 sec;
[2024-02-26 19:34:30,732 INFO] Step 13350/13800; acc: 77.9; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  334/ 222/64; 27134/18032 tok/s;    157 sec;
[2024-02-26 19:34:31,324 INFO] Step 13400/13800; acc: 81.2; ppl:   3.5; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  312/ 206/64; 26392/17402 tok/s;    158 sec;
[2024-02-26 19:34:35,071 INFO] valid stats calculation
                           took: 3.74654221534729 s.
[2024-02-26 19:34:35,072 INFO] Train perplexity: 5.13082
[2024-02-26 19:34:35,072 INFO] Train accuracy: 71.1094
[2024-02-26 19:34:35,072 INFO] Sentences processed: 294345
[2024-02-26 19:34:35,072 INFO] Average bsz:  309/ 219/64
[2024-02-26 19:34:35,072 INFO] Validation perplexity: 469.761
[2024-02-26 19:34:35,072 INFO] Validation accuracy: 17.6422
[2024-02-26 19:34:35,074 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_13400.pt
[2024-02-26 19:34:35,852 INFO] Step 13450/13800; acc: 76.1; ppl:   4.5; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  332/ 230/64; 3663/2543 tok/s;    163 sec;
[2024-02-26 19:34:36,440 INFO] Step 13500/13800; acc: 87.7; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  348/ 242/64; 29569/20572 tok/s;    163 sec;
[2024-02-26 19:34:37,042 INFO] Step 13550/13800; acc: 79.8; ppl:   3.5; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  329/ 236/64; 27336/19627 tok/s;    164 sec;
[2024-02-26 19:34:37,576 INFO] Step 13600/13800; acc: 93.2; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  283/ 218/64; 26498/20387 tok/s;    164 sec;
[2024-02-26 19:34:41,329 INFO] valid stats calculation
                           took: 3.753601312637329 s.
[2024-02-26 19:34:41,330 INFO] Train perplexity: 4.97893
[2024-02-26 19:34:41,330 INFO] Train accuracy: 71.6806
[2024-02-26 19:34:41,330 INFO] Sentences processed: 307145
[2024-02-26 19:34:41,330 INFO] Average bsz:  309/ 219/64
[2024-02-26 19:34:41,330 INFO] Validation perplexity: 484.32
[2024-02-26 19:34:41,330 INFO] Validation accuracy: 18.3807
[2024-02-26 19:34:41,332 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_13600.pt
[2024-02-26 19:34:42,052 INFO] Step 13650/13800; acc: 88.4; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  297/ 215/64; 3317/2400 tok/s;    169 sec;
[2024-02-26 19:34:42,631 INFO] Step 13700/13800; acc: 79.0; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  313/ 232/64; 27016/20086 tok/s;    169 sec;
[2024-02-26 19:34:43,186 INFO] Step 13750/13800; acc: 90.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  306/ 225/64; 27581/20320 tok/s;    170 sec;
[2024-02-26 19:34:43,705 INFO] Step 13800/13800; acc: 95.3; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  273/ 206/64; 26257/19847 tok/s;    170 sec;
[2024-02-26 19:34:47,466 INFO] valid stats calculation
                           took: 3.760352373123169 s.
[2024-02-26 19:34:47,466 INFO] Train perplexity: 4.79923
[2024-02-26 19:34:47,466 INFO] Train accuracy: 72.3426
[2024-02-26 19:34:47,466 INFO] Sentences processed: 319945
[2024-02-26 19:34:47,466 INFO] Average bsz:  309/ 219/64
[2024-02-26 19:34:47,466 INFO] Validation perplexity: 394.008
[2024-02-26 19:34:47,466 INFO] Validation accuracy: 18.2607
[2024-02-26 19:34:47,469 INFO] Saving checkpoint tg-ft-both/tg-finetune_8800_01_step_13800.pt
