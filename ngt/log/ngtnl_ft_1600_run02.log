[2024-03-01 23:21:33,777 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-01 23:21:33,777 INFO] Parsed 2 corpora from -data.
[2024-03-01 23:21:33,778 INFO] Loading checkpoint from gt-pretrain/models/gt-pretrain_02_step_1600.pt
[2024-03-01 23:21:33,922 INFO] Building model...
[2024-03-01 23:21:33,983 INFO] Switching model to float32 for amp/apex_amp
[2024-03-01 23:21:33,983 INFO] Non quantized layer compute is fp32
[2024-03-01 23:21:35,799 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(25208, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(500, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(32768, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(1000, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=32768, bias=True)
)
[2024-03-01 23:21:35,799 INFO] encoder: 16612000
[2024-03-01 23:21:35,799 INFO] decoder: 38558768
[2024-03-01 23:21:35,799 INFO] * number of parameters: 55170768
[2024-03-01 23:21:35,799 INFO] Trainable parameters = {'torch.float32': 55170768, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-01 23:21:35,799 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-01 23:21:35,799 INFO]  * src vocab size = 25208
[2024-03-01 23:21:35,799 INFO]  * tgt vocab size = 32768
[2024-03-01 23:21:35,801 INFO] Starting training on GPU: [0]
[2024-03-01 23:21:35,801 INFO] Start training loop and validate every 200 steps...
[2024-03-01 23:21:35,801 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-01 23:21:50,500 INFO] Step 1650/ 6600; acc: 24.1; ppl: 372.1; xent: 5.9; lr: 1.00000; sents:    3200; bsz:  134/ 355/64; 457/1209 tok/s;     15 sec;
[2024-03-01 23:21:51,337 INFO] Step 1700/ 6600; acc: 25.9; ppl: 249.7; xent: 5.5; lr: 1.00000; sents:    3200; bsz:  191/ 366/64; 11400/21871 tok/s;     16 sec;
[2024-03-01 23:21:52,156 INFO] Step 1750/ 6600; acc: 27.1; ppl: 155.9; xent: 5.0; lr: 1.00000; sents:    3200; bsz:  169/ 396/64; 10314/24169 tok/s;     16 sec;
[2024-03-01 23:21:52,912 INFO] Step 1800/ 6600; acc: 30.7; ppl:  97.0; xent: 4.6; lr: 1.00000; sents:    3200; bsz:  131/ 356/64; 8633/23568 tok/s;     17 sec;
[2024-03-01 23:21:56,828 INFO] valid stats calculation
                           took: 3.9158706665039062 s.
[2024-03-01 23:21:56,829 INFO] Train perplexity: 192.705
[2024-03-01 23:21:56,829 INFO] Train accuracy: 26.9571
[2024-03-01 23:21:56,829 INFO] Sentences processed: 12800
[2024-03-01 23:21:56,829 INFO] Average bsz:  156/ 368/64
[2024-03-01 23:21:56,829 INFO] Validation perplexity: 356.149
[2024-03-01 23:21:56,829 INFO] Validation accuracy: 15.6038
[2024-03-01 23:21:56,832 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_1800.pt
[2024-03-01 23:21:57,948 INFO] Step 1850/ 6600; acc: 28.8; ppl: 108.1; xent: 4.7; lr: 1.00000; sents:    3200; bsz:  183/ 388/64; 1817/3849 tok/s;     22 sec;
[2024-03-01 23:21:58,739 INFO] Step 1900/ 6600; acc: 31.2; ppl:  75.9; xent: 4.3; lr: 1.00000; sents:    3200; bsz:  154/ 373/64; 9711/23557 tok/s;     23 sec;
[2024-03-01 23:21:59,510 INFO] Step 1950/ 6600; acc: 34.6; ppl:  49.9; xent: 3.9; lr: 1.00000; sents:    3200; bsz:  146/ 360/64; 9467/23336 tok/s;     24 sec;
[2024-03-01 23:22:00,314 INFO] Step 2000/ 6600; acc: 33.0; ppl:  60.6; xent: 4.1; lr: 1.00000; sents:    3200; bsz:  157/ 373/64; 9793/23223 tok/s;     25 sec;
[2024-03-01 23:22:04,212 INFO] valid stats calculation
                           took: 3.8977062702178955 s.
[2024-03-01 23:22:04,212 INFO] Train perplexity: 116.641
[2024-03-01 23:22:04,212 INFO] Train accuracy: 29.4185
[2024-03-01 23:22:04,212 INFO] Sentences processed: 25600
[2024-03-01 23:22:04,212 INFO] Average bsz:  158/ 371/64
[2024-03-01 23:22:04,213 INFO] Validation perplexity: 307.016
[2024-03-01 23:22:04,213 INFO] Validation accuracy: 17.832
[2024-03-01 23:22:04,215 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_2000.pt
[2024-03-01 23:22:05,388 INFO] Step 2050/ 6600; acc: 31.9; ppl:  69.2; xent: 4.2; lr: 1.00000; sents:    3200; bsz:  169/ 397/64; 1667/3908 tok/s;     30 sec;
[2024-03-01 23:22:06,200 INFO] Step 2100/ 6600; acc: 35.4; ppl:  47.8; xent: 3.9; lr: 1.00000; sents:    3200; bsz:  169/ 366/64; 10409/22519 tok/s;     30 sec;
[2024-03-01 23:22:07,015 INFO] Step 2150/ 6600; acc: 36.9; ppl:  38.6; xent: 3.7; lr: 1.00000; sents:    3200; bsz:  157/ 362/64; 9669/22248 tok/s;     31 sec;
[2024-03-01 23:22:07,963 INFO] Step 2200/ 6600; acc: 32.0; ppl:  58.7; xent: 4.1; lr: 1.00000; sents:    3200; bsz:  187/ 434/64; 9836/22888 tok/s;     32 sec;
[2024-03-01 23:22:11,837 INFO] valid stats calculation
                           took: 3.8736376762390137 s.
[2024-03-01 23:22:11,837 INFO] Train perplexity: 88.8348
[2024-03-01 23:22:11,837 INFO] Train accuracy: 30.9612
[2024-03-01 23:22:11,837 INFO] Sentences processed: 38400
[2024-03-01 23:22:11,837 INFO] Average bsz:  162/ 377/64
[2024-03-01 23:22:11,838 INFO] Validation perplexity: 255.034
[2024-03-01 23:22:11,838 INFO] Validation accuracy: 18.3404
[2024-03-01 23:22:11,840 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_2200.pt
[2024-03-01 23:22:12,987 INFO] Step 2250/ 6600; acc: 36.5; ppl:  38.3; xent: 3.6; lr: 1.00000; sents:    3200; bsz:  186/ 407/64; 1847/4050 tok/s;     37 sec;
[2024-03-01 23:22:13,867 INFO] Step 2300/ 6600; acc: 39.4; ppl:  26.7; xent: 3.3; lr: 1.00000; sents:    3200; bsz:  134/ 371/64; 7608/21072 tok/s;     38 sec;
[2024-03-01 23:22:14,670 INFO] Step 2350/ 6600; acc: 42.2; ppl:  18.1; xent: 2.9; lr: 1.00000; sents:    3200; bsz:  160/ 384/64; 9956/23911 tok/s;     39 sec;
[2024-03-01 23:22:15,448 INFO] Step 2400/ 6600; acc: 42.9; ppl:  17.4; xent: 2.9; lr: 1.00000; sents:    3200; bsz:  150/ 366/64; 9630/23531 tok/s;     40 sec;
[2024-03-01 23:22:19,332 INFO] valid stats calculation
                           took: 3.883145332336426 s.
[2024-03-01 23:22:19,332 INFO] Train perplexity: 63.8839
[2024-03-01 23:22:19,332 INFO] Train accuracy: 33.2844
[2024-03-01 23:22:19,332 INFO] Sentences processed: 51200
[2024-03-01 23:22:19,332 INFO] Average bsz:  161/ 378/64
[2024-03-01 23:22:19,332 INFO] Validation perplexity: 282.388
[2024-03-01 23:22:19,332 INFO] Validation accuracy: 18.6982
[2024-03-01 23:22:19,335 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_2400.pt
[2024-03-01 23:22:20,495 INFO] Step 2450/ 6600; acc: 41.0; ppl:  22.9; xent: 3.1; lr: 1.00000; sents:    3200; bsz:  172/ 387/64; 1703/3838 tok/s;     45 sec;
[2024-03-01 23:22:21,362 INFO] Step 2500/ 6600; acc: 43.3; ppl:  18.7; xent: 2.9; lr: 1.00000; sents:    3200; bsz:  166/ 399/64; 9551/23028 tok/s;     46 sec;
[2024-03-01 23:22:22,290 INFO] Step 2550/ 6600; acc: 43.0; ppl:  20.0; xent: 3.0; lr: 1.00000; sents:    3200; bsz:  187/ 410/64; 10058/22085 tok/s;     46 sec;
[2024-03-01 23:22:23,074 INFO] Step 2600/ 6600; acc: 49.4; ppl:  11.2; xent: 2.4; lr: 1.00000; sents:    3200; bsz:  148/ 368/64; 9470/23493 tok/s;     47 sec;
[2024-03-01 23:22:26,982 INFO] valid stats calculation
                           took: 3.9068362712860107 s.
[2024-03-01 23:22:26,982 INFO] Train perplexity: 49.0985
[2024-03-01 23:22:26,982 INFO] Train accuracy: 35.5033
[2024-03-01 23:22:26,982 INFO] Sentences processed: 64000
[2024-03-01 23:22:26,982 INFO] Average bsz:  162/ 381/64
[2024-03-01 23:22:26,982 INFO] Validation perplexity: 320.895
[2024-03-01 23:22:26,982 INFO] Validation accuracy: 19.0936
[2024-03-01 23:22:26,985 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_2600.pt
[2024-03-01 23:22:28,062 INFO] Step 2650/ 6600; acc: 47.8; ppl:  11.9; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  155/ 372/64; 1553/3726 tok/s;     52 sec;
[2024-03-01 23:22:28,843 INFO] Step 2700/ 6600; acc: 52.8; ppl:   8.2; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  157/ 368/64; 10087/23556 tok/s;     53 sec;
[2024-03-01 23:22:29,631 INFO] Step 2750/ 6600; acc: 50.5; ppl:  10.1; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  148/ 372/64; 9426/23610 tok/s;     54 sec;
[2024-03-01 23:22:30,485 INFO] Step 2800/ 6600; acc: 51.9; ppl:   9.9; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  172/ 378/64; 10068/22134 tok/s;     55 sec;
[2024-03-01 23:22:34,381 INFO] valid stats calculation
                           took: 3.8948843479156494 s.
[2024-03-01 23:22:34,381 INFO] Train perplexity: 37.8165
[2024-03-01 23:22:34,381 INFO] Train accuracy: 37.9993
[2024-03-01 23:22:34,381 INFO] Sentences processed: 76800
[2024-03-01 23:22:34,381 INFO] Average bsz:  162/ 379/64
[2024-03-01 23:22:34,381 INFO] Validation perplexity: 323.585
[2024-03-01 23:22:34,381 INFO] Validation accuracy: 18.7986
[2024-03-01 23:22:34,384 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_2800.pt
[2024-03-01 23:22:35,530 INFO] Step 2850/ 6600; acc: 52.1; ppl:   9.9; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  180/ 395/64; 1785/3911 tok/s;     60 sec;
[2024-03-01 23:22:36,562 INFO] Step 2900/ 6600; acc: 49.0; ppl:  16.0; xent: 2.8; lr: 1.00000; sents:    3200; bsz:  217/ 450/64; 10534/21816 tok/s;     61 sec;
[2024-03-01 23:22:37,388 INFO] Step 2950/ 6600; acc: 51.5; ppl:  12.0; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  160/ 388/64; 9684/23465 tok/s;     62 sec;
[2024-03-01 23:22:38,244 INFO] Step 3000/ 6600; acc: 58.2; ppl:   7.2; xent: 2.0; lr: 1.00000; sents:    3200; bsz:  169/ 401/64; 9909/23475 tok/s;     62 sec;
[2024-03-01 23:22:42,167 INFO] valid stats calculation
                           took: 3.9228458404541016 s.
[2024-03-01 23:22:42,167 INFO] Train perplexity: 31.3085
[2024-03-01 23:22:42,167 INFO] Train accuracy: 40.2228
[2024-03-01 23:22:42,167 INFO] Sentences processed: 89600
[2024-03-01 23:22:42,167 INFO] Average bsz:  165/ 384/64
[2024-03-01 23:22:42,167 INFO] Validation perplexity: 306.554
[2024-03-01 23:22:42,167 INFO] Validation accuracy: 18.9681
[2024-03-01 23:22:42,170 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_3000.pt
[2024-03-01 23:22:43,200 INFO] Step 3050/ 6600; acc: 62.6; ppl:   4.5; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  131/ 334/64; 1317/3373 tok/s;     67 sec;
[2024-03-01 23:22:43,999 INFO] Step 3100/ 6600; acc: 59.9; ppl:   6.3; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  149/ 348/64; 9342/21756 tok/s;     68 sec;
[2024-03-01 23:22:44,772 INFO] Step 3150/ 6600; acc: 65.0; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  150/ 358/64; 9692/23195 tok/s;     69 sec;
[2024-03-01 23:22:45,530 INFO] Step 3200/ 6600; acc: 65.7; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  154/ 347/64; 10129/22874 tok/s;     70 sec;
[2024-03-01 23:22:49,388 INFO] valid stats calculation
                           took: 3.8573055267333984 s.
[2024-03-01 23:22:49,388 INFO] Train perplexity: 25.1151
[2024-03-01 23:22:49,388 INFO] Train accuracy: 42.867
[2024-03-01 23:22:49,388 INFO] Sentences processed: 102400
[2024-03-01 23:22:49,388 INFO] Average bsz:  162/ 379/64
[2024-03-01 23:22:49,388 INFO] Validation perplexity: 452.151
[2024-03-01 23:22:49,388 INFO] Validation accuracy: 19.2255
[2024-03-01 23:22:49,391 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_3200.pt
[2024-03-01 23:22:50,533 INFO] Step 3250/ 6600; acc: 64.2; ppl:   5.1; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  194/ 404/64; 1940/4043 tok/s;     75 sec;
[2024-03-01 23:22:51,489 INFO] Step 3300/ 6600; acc: 60.6; ppl:   7.7; xent: 2.0; lr: 1.00000; sents:    3092; bsz:  172/ 378/62; 8974/19768 tok/s;     76 sec;
[2024-03-01 23:22:52,258 INFO] Step 3350/ 6600; acc: 69.1; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  148/ 362/64; 9662/23527 tok/s;     76 sec;
[2024-03-01 23:22:53,097 INFO] Step 3400/ 6600; acc: 60.8; ppl:   7.1; xent: 2.0; lr: 1.00000; sents:    3200; bsz:  144/ 383/64; 8587/22798 tok/s;     77 sec;
[2024-03-01 23:22:56,976 INFO] valid stats calculation
                           took: 3.8782413005828857 s.
[2024-03-01 23:22:56,976 INFO] Train perplexity: 21.204
[2024-03-01 23:22:56,976 INFO] Train accuracy: 45.1864
[2024-03-01 23:22:56,976 INFO] Sentences processed: 115092
[2024-03-01 23:22:56,976 INFO] Average bsz:  162/ 379/64
[2024-03-01 23:22:56,976 INFO] Validation perplexity: 371.694
[2024-03-01 23:22:56,976 INFO] Validation accuracy: 18.6731
[2024-03-01 23:22:56,978 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_3400.pt
[2024-03-01 23:22:58,363 INFO] Step 3450/ 6600; acc: 53.8; ppl:  14.6; xent: 2.7; lr: 1.00000; sents:    3200; bsz:  223/ 446/64; 2115/4236 tok/s;     83 sec;
[2024-03-01 23:22:59,126 INFO] Step 3500/ 6600; acc: 70.5; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  151/ 351/64; 9889/22982 tok/s;     83 sec;
[2024-03-01 23:22:59,962 INFO] Step 3550/ 6600; acc: 63.6; ppl:   6.4; xent: 1.9; lr: 1.00000; sents:    3200; bsz:  175/ 388/64; 10500/23250 tok/s;     84 sec;
[2024-03-01 23:23:00,897 INFO] Step 3600/ 6600; acc: 67.5; ppl:   4.8; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  159/ 399/64; 8525/21347 tok/s;     85 sec;
[2024-03-01 23:23:04,769 INFO] valid stats calculation
                           took: 3.872011184692383 s.
[2024-03-01 23:23:04,770 INFO] Train perplexity: 18.7804
[2024-03-01 23:23:04,770 INFO] Train accuracy: 47.0738
[2024-03-01 23:23:04,770 INFO] Sentences processed: 127892
[2024-03-01 23:23:04,770 INFO] Average bsz:  164/ 381/64
[2024-03-01 23:23:04,770 INFO] Validation perplexity: 425.099
[2024-03-01 23:23:04,770 INFO] Validation accuracy: 16.2503
[2024-03-01 23:23:04,772 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_3600.pt
[2024-03-01 23:23:05,982 INFO] Step 3650/ 6600; acc: 68.7; ppl:   5.0; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  192/ 410/64; 1886/4034 tok/s;     90 sec;
[2024-03-01 23:23:06,745 INFO] Step 3700/ 6600; acc: 76.3; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  170/ 348/64; 11160/22816 tok/s;     91 sec;
[2024-03-01 23:23:07,582 INFO] Step 3750/ 6600; acc: 75.6; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  187/ 399/64; 11170/23823 tok/s;     92 sec;
[2024-03-01 23:23:08,348 INFO] Step 3800/ 6600; acc: 79.2; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  159/ 351/64; 10357/22909 tok/s;     93 sec;
[2024-03-01 23:23:12,261 INFO] valid stats calculation
                           took: 3.9130027294158936 s.
[2024-03-01 23:23:12,262 INFO] Train perplexity: 16.0484
[2024-03-01 23:23:12,262 INFO] Train accuracy: 49.5628
[2024-03-01 23:23:12,262 INFO] Sentences processed: 140692
[2024-03-01 23:23:12,262 INFO] Average bsz:  165/ 381/64
[2024-03-01 23:23:12,262 INFO] Validation perplexity: 461.629
[2024-03-01 23:23:12,262 INFO] Validation accuracy: 19.2317
[2024-03-01 23:23:12,264 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_3800.pt
[2024-03-01 23:23:13,317 INFO] Step 3850/ 6600; acc: 77.3; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  141/ 353/64; 1417/3555 tok/s;     98 sec;
[2024-03-01 23:23:14,123 INFO] Step 3900/ 6600; acc: 77.1; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  161/ 384/64; 10003/23835 tok/s;     98 sec;
[2024-03-01 23:23:14,889 INFO] Step 3950/ 6600; acc: 80.3; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  146/ 356/64; 9529/23238 tok/s;     99 sec;
[2024-03-01 23:23:15,630 INFO] Step 4000/ 6600; acc: 78.4; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  138/ 333/64; 9336/22469 tok/s;    100 sec;
[2024-03-01 23:23:19,512 INFO] valid stats calculation
                           took: 3.8816702365875244 s.
[2024-03-01 23:23:19,512 INFO] Train perplexity: 13.8162
[2024-03-01 23:23:19,512 INFO] Train accuracy: 51.8142
[2024-03-01 23:23:19,512 INFO] Sentences processed: 153492
[2024-03-01 23:23:19,512 INFO] Average bsz:  164/ 379/64
[2024-03-01 23:23:19,512 INFO] Validation perplexity: 476.544
[2024-03-01 23:23:19,512 INFO] Validation accuracy: 18.4785
[2024-03-01 23:23:19,515 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_4000.pt
[2024-03-01 23:23:20,582 INFO] Step 4050/ 6600; acc: 78.3; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  150/ 368/64; 1512/3713 tok/s;    105 sec;
[2024-03-01 23:23:21,409 INFO] Step 4100/ 6600; acc: 72.2; ppl:   4.9; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  167/ 374/64; 10114/22642 tok/s;    106 sec;
[2024-03-01 23:23:22,205 INFO] Step 4150/ 6600; acc: 80.6; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  165/ 378/64; 10374/23732 tok/s;    106 sec;
[2024-03-01 23:23:23,078 INFO] Step 4200/ 6600; acc: 70.0; ppl:   5.5; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  183/ 406/64; 10492/23246 tok/s;    107 sec;
[2024-03-01 23:23:26,939 INFO] valid stats calculation
                           took: 3.86157488822937 s.
[2024-03-01 23:23:26,940 INFO] Train perplexity: 12.4711
[2024-03-01 23:23:26,940 INFO] Train accuracy: 53.6224
[2024-03-01 23:23:26,940 INFO] Sentences processed: 166292
[2024-03-01 23:23:26,940 INFO] Average bsz:  164/ 379/64
[2024-03-01 23:23:26,940 INFO] Validation perplexity: 493.739
[2024-03-01 23:23:26,940 INFO] Validation accuracy: 18.7045
[2024-03-01 23:23:26,942 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_4200.pt
[2024-03-01 23:23:28,402 INFO] Step 4250/ 6600; acc: 58.1; ppl:  12.8; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  232/ 455/64; 2179/4272 tok/s;    113 sec;
[2024-03-01 23:23:29,194 INFO] Step 4300/ 6600; acc: 80.7; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  156/ 384/64; 9867/24260 tok/s;    113 sec;
[2024-03-01 23:23:30,036 INFO] Step 4350/ 6600; acc: 76.9; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  150/ 375/64; 8919/22241 tok/s;    114 sec;
[2024-03-01 23:23:30,812 INFO] Step 4400/ 6600; acc: 81.3; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  161/ 379/64; 10403/24455 tok/s;    115 sec;
[2024-03-01 23:23:34,932 INFO] valid stats calculation
                           took: 4.120192050933838 s.
[2024-03-01 23:23:34,932 INFO] Train perplexity: 11.4698
[2024-03-01 23:23:34,933 INFO] Train accuracy: 55.1068
[2024-03-01 23:23:34,933 INFO] Sentences processed: 179092
[2024-03-01 23:23:34,933 INFO] Average bsz:  165/ 380/64
[2024-03-01 23:23:34,933 INFO] Validation perplexity: 461.494
[2024-03-01 23:23:34,933 INFO] Validation accuracy: 19.0183
[2024-03-01 23:23:34,935 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_4400.pt
[2024-03-01 23:23:36,063 INFO] Step 4450/ 6600; acc: 76.2; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  188/ 406/64; 1792/3862 tok/s;    120 sec;
[2024-03-01 23:23:36,801 INFO] Step 4500/ 6600; acc: 81.6; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  136/ 353/64; 9203/23928 tok/s;    121 sec;
[2024-03-01 23:23:37,714 INFO] Step 4550/ 6600; acc: 65.7; ppl:   7.4; xent: 2.0; lr: 1.00000; sents:    3200; bsz:  199/ 416/64; 10913/22750 tok/s;    122 sec;
[2024-03-01 23:23:38,474 INFO] Step 4600/ 6600; acc: 83.2; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  148/ 369/64; 9770/24306 tok/s;    123 sec;
[2024-03-01 23:23:42,590 INFO] valid stats calculation
                           took: 4.1154210567474365 s.
[2024-03-01 23:23:42,591 INFO] Train perplexity: 10.6016
[2024-03-01 23:23:42,591 INFO] Train accuracy: 56.5385
[2024-03-01 23:23:42,591 INFO] Sentences processed: 191892
[2024-03-01 23:23:42,591 INFO] Average bsz:  165/ 381/64
[2024-03-01 23:23:42,591 INFO] Validation perplexity: 453.443
[2024-03-01 23:23:42,591 INFO] Validation accuracy: 18.9242
[2024-03-01 23:23:42,593 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_4600.pt
[2024-03-01 23:23:43,667 INFO] Step 4650/ 6600; acc: 78.3; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  161/ 379/64; 1553/3653 tok/s;    128 sec;
[2024-03-01 23:23:44,548 INFO] Step 4700/ 6600; acc: 82.4; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  166/ 389/64; 9444/22085 tok/s;    129 sec;
[2024-03-01 23:23:45,372 INFO] Step 4750/ 6600; acc: 81.6; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  163/ 377/64; 9915/22888 tok/s;    130 sec;
[2024-03-01 23:23:46,288 INFO] Step 4800/ 6600; acc: 77.1; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  160/ 373/64; 8709/20385 tok/s;    130 sec;
[2024-03-01 23:23:50,169 INFO] valid stats calculation
                           took: 3.8805527687072754 s.
[2024-03-01 23:23:50,169 INFO] Train perplexity: 9.76123
[2024-03-01 23:23:50,169 INFO] Train accuracy: 57.9944
[2024-03-01 23:23:50,170 INFO] Sentences processed: 204692
[2024-03-01 23:23:50,170 INFO] Average bsz:  165/ 381/64
[2024-03-01 23:23:50,170 INFO] Validation perplexity: 394.545
[2024-03-01 23:23:50,170 INFO] Validation accuracy: 18.8614
[2024-03-01 23:23:50,172 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_4800.pt
[2024-03-01 23:23:51,235 INFO] Step 4850/ 6600; acc: 88.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  163/ 362/64; 1643/3661 tok/s;    135 sec;
[2024-03-01 23:23:52,021 INFO] Step 4900/ 6600; acc: 76.7; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  161/ 370/64; 10273/23580 tok/s;    136 sec;
[2024-03-01 23:23:52,782 INFO] Step 4950/ 6600; acc: 81.3; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  131/ 352/64; 8578/23102 tok/s;    137 sec;
[2024-03-01 23:23:53,510 INFO] Step 5000/ 6600; acc: 88.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  156/ 328/64; 10719/22509 tok/s;    138 sec;
[2024-03-01 23:23:57,389 INFO] valid stats calculation
                           took: 3.878307819366455 s.
[2024-03-01 23:23:57,390 INFO] Train perplexity: 9.01157
[2024-03-01 23:23:57,390 INFO] Train accuracy: 59.3878
[2024-03-01 23:23:57,390 INFO] Sentences processed: 217492
[2024-03-01 23:23:57,390 INFO] Average bsz:  164/ 379/64
[2024-03-01 23:23:57,390 INFO] Validation perplexity: 482.035
[2024-03-01 23:23:57,390 INFO] Validation accuracy: 19.6585
[2024-03-01 23:23:57,392 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_5000.pt
[2024-03-01 23:23:58,417 INFO] Step 5050/ 6600; acc: 87.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  123/ 339/64; 1252/3456 tok/s;    143 sec;
[2024-03-01 23:23:59,270 INFO] Step 5100/ 6600; acc: 81.2; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  159/ 383/64; 9320/22488 tok/s;    143 sec;
[2024-03-01 23:24:00,101 INFO] Step 5150/ 6600; acc: 81.1; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  173/ 402/64; 10403/24187 tok/s;    144 sec;
[2024-03-01 23:24:00,906 INFO] Step 5200/ 6600; acc: 86.8; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  152/ 387/64; 9467/24050 tok/s;    145 sec;
[2024-03-01 23:24:04,792 INFO] valid stats calculation
                           took: 3.8866212368011475 s.
[2024-03-01 23:24:04,793 INFO] Train perplexity: 8.35029
[2024-03-01 23:24:04,793 INFO] Train accuracy: 60.751
[2024-03-01 23:24:04,793 INFO] Sentences processed: 230292
[2024-03-01 23:24:04,793 INFO] Average bsz:  163/ 379/64
[2024-03-01 23:24:04,793 INFO] Validation perplexity: 460.222
[2024-03-01 23:24:04,793 INFO] Validation accuracy: 18.6857
[2024-03-01 23:24:04,795 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_5200.pt
[2024-03-01 23:24:06,067 INFO] Step 5250/ 6600; acc: 79.6; ppl:   3.5; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  174/ 419/64; 1685/4055 tok/s;    150 sec;
[2024-03-01 23:24:06,956 INFO] Step 5300/ 6600; acc: 76.4; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  175/ 399/64; 9840/22432 tok/s;    151 sec;
[2024-03-01 23:24:07,791 INFO] Step 5350/ 6600; acc: 86.2; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3140; bsz:  155/ 353/63; 9276/21136 tok/s;    152 sec;
[2024-03-01 23:24:08,618 INFO] Step 5400/ 6600; acc: 82.1; ppl:   3.2; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  162/ 369/64; 9791/22305 tok/s;    153 sec;
[2024-03-01 23:24:12,485 INFO] valid stats calculation
                           took: 3.8671481609344482 s.
[2024-03-01 23:24:12,486 INFO] Train perplexity: 7.91505
[2024-03-01 23:24:12,486 INFO] Train accuracy: 61.8259
[2024-03-01 23:24:12,486 INFO] Sentences processed: 243032
[2024-03-01 23:24:12,486 INFO] Average bsz:  163/ 379/64
[2024-03-01 23:24:12,486 INFO] Validation perplexity: 480.821
[2024-03-01 23:24:12,486 INFO] Validation accuracy: 18.7422
[2024-03-01 23:24:12,488 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_5400.pt
[2024-03-01 23:24:13,649 INFO] Step 5450/ 6600; acc: 82.5; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  142/ 389/64; 1408/3863 tok/s;    158 sec;
[2024-03-01 23:24:14,473 INFO] Step 5500/ 6600; acc: 89.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  141/ 364/64; 8548/22074 tok/s;    159 sec;
[2024-03-01 23:24:15,235 INFO] Step 5550/ 6600; acc: 84.7; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  138/ 350/64; 9072/22975 tok/s;    159 sec;
[2024-03-01 23:24:16,166 INFO] Step 5600/ 6600; acc: 75.3; ppl:   4.6; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  204/ 416/64; 10936/22369 tok/s;    160 sec;
[2024-03-01 23:24:20,040 INFO] valid stats calculation
                           took: 3.8738863468170166 s.
[2024-03-01 23:24:20,040 INFO] Train perplexity: 7.49746
[2024-03-01 23:24:20,040 INFO] Train accuracy: 62.8714
[2024-03-01 23:24:20,040 INFO] Sentences processed: 255832
[2024-03-01 23:24:20,040 INFO] Average bsz:  163/ 379/64
[2024-03-01 23:24:20,041 INFO] Validation perplexity: 472.917
[2024-03-01 23:24:20,041 INFO] Validation accuracy: 17.7881
[2024-03-01 23:24:20,043 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_5600.pt
[2024-03-01 23:24:21,213 INFO] Step 5650/ 6600; acc: 79.1; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  210/ 405/64; 2080/4009 tok/s;    165 sec;
[2024-03-01 23:24:22,034 INFO] Step 5700/ 6600; acc: 82.0; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  154/ 375/64; 9407/22860 tok/s;    166 sec;
[2024-03-01 23:24:23,028 INFO] Step 5750/ 6600; acc: 70.9; ppl:   5.8; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  178/ 415/64; 8935/20874 tok/s;    167 sec;
[2024-03-01 23:24:23,794 INFO] Step 5800/ 6600; acc: 85.4; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  148/ 356/64; 9699/23283 tok/s;    168 sec;
[2024-03-01 23:24:27,679 INFO] valid stats calculation
                           took: 3.885251045227051 s.
[2024-03-01 23:24:27,680 INFO] Train perplexity: 7.21078
[2024-03-01 23:24:27,680 INFO] Train accuracy: 63.66
[2024-03-01 23:24:27,680 INFO] Sentences processed: 268632
[2024-03-01 23:24:27,680 INFO] Average bsz:  164/ 380/64
[2024-03-01 23:24:27,680 INFO] Validation perplexity: 442.691
[2024-03-01 23:24:27,680 INFO] Validation accuracy: 19.1564
[2024-03-01 23:24:27,682 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_5800.pt
[2024-03-01 23:24:28,861 INFO] Step 5850/ 6600; acc: 75.5; ppl:   4.2; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  172/ 403/64; 1699/3980 tok/s;    173 sec;
[2024-03-01 23:24:29,690 INFO] Step 5900/ 6600; acc: 86.7; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  150/ 379/64; 9058/22858 tok/s;    174 sec;
[2024-03-01 23:24:30,505 INFO] Step 5950/ 6600; acc: 88.1; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  150/ 359/64; 9190/22046 tok/s;    175 sec;
[2024-03-01 23:24:31,493 INFO] Step 6000/ 6600; acc: 74.8; ppl:   4.7; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  221/ 439/64; 11207/22252 tok/s;    176 sec;
[2024-03-01 23:24:35,389 INFO] valid stats calculation
                           took: 3.8957979679107666 s.
[2024-03-01 23:24:35,389 INFO] Train perplexity: 6.91181
[2024-03-01 23:24:35,389 INFO] Train accuracy: 64.4716
[2024-03-01 23:24:35,389 INFO] Sentences processed: 281432
[2024-03-01 23:24:35,389 INFO] Average bsz:  164/ 380/64
[2024-03-01 23:24:35,389 INFO] Validation perplexity: 478.23
[2024-03-01 23:24:35,390 INFO] Validation accuracy: 18.9995
[2024-03-01 23:24:35,392 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_6000.pt
[2024-03-01 23:24:36,604 INFO] Step 6050/ 6600; acc: 75.1; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  168/ 388/64; 1641/3791 tok/s;    181 sec;
[2024-03-01 23:24:37,429 INFO] Step 6100/ 6600; acc: 77.9; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  175/ 374/64; 10628/22686 tok/s;    182 sec;
[2024-03-01 23:24:38,362 INFO] Step 6150/ 6600; acc: 78.6; ppl:   3.5; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  207/ 410/64; 11117/21961 tok/s;    183 sec;
[2024-03-01 23:24:39,150 INFO] Step 6200/ 6600; acc: 89.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  168/ 372/64; 10642/23612 tok/s;    183 sec;
[2024-03-01 23:24:43,029 INFO] valid stats calculation
                           took: 3.8788070678710938 s.
[2024-03-01 23:24:43,030 INFO] Train perplexity: 6.66453
[2024-03-01 23:24:43,030 INFO] Train accuracy: 65.1663
[2024-03-01 23:24:43,030 INFO] Sentences processed: 294232
[2024-03-01 23:24:43,030 INFO] Average bsz:  165/ 381/64
[2024-03-01 23:24:43,030 INFO] Validation perplexity: 457.832
[2024-03-01 23:24:43,030 INFO] Validation accuracy: 19.9347
[2024-03-01 23:24:43,032 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_6200.pt
[2024-03-01 23:24:44,051 INFO] Step 6250/ 6600; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  133/ 333/64; 1358/3395 tok/s;    188 sec;
[2024-03-01 23:24:44,945 INFO] Step 6300/ 6600; acc: 77.0; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  209/ 416/64; 11695/23246 tok/s;    189 sec;
[2024-03-01 23:24:45,744 INFO] Step 6350/ 6600; acc: 87.9; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  140/ 381/64; 8732/23817 tok/s;    190 sec;
[2024-03-01 23:24:46,611 INFO] Step 6400/ 6600; acc: 86.0; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  171/ 392/64; 9879/22615 tok/s;    191 sec;
[2024-03-01 23:24:50,463 INFO] valid stats calculation
                           took: 3.8517355918884277 s.
[2024-03-01 23:24:50,464 INFO] Train perplexity: 6.37084
[2024-03-01 23:24:50,464 INFO] Train accuracy: 65.9961
[2024-03-01 23:24:50,464 INFO] Sentences processed: 307032
[2024-03-01 23:24:50,464 INFO] Average bsz:  165/ 381/64
[2024-03-01 23:24:50,464 INFO] Validation perplexity: 460.012
[2024-03-01 23:24:50,464 INFO] Validation accuracy: 18.2024
[2024-03-01 23:24:50,466 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_6400.pt
[2024-03-01 23:24:51,665 INFO] Step 6450/ 6600; acc: 81.8; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  177/ 385/64; 1747/3805 tok/s;    196 sec;
[2024-03-01 23:24:52,549 INFO] Step 6500/ 6600; acc: 85.1; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  166/ 379/64; 9387/21444 tok/s;    197 sec;
[2024-03-01 23:24:53,410 INFO] Step 6550/ 6600; acc: 84.1; ppl:   2.3; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  178/ 382/64; 10323/22178 tok/s;    198 sec;
[2024-03-01 23:24:54,164 INFO] Step 6600/ 6600; acc: 90.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  143/ 348/64; 9506/23090 tok/s;    198 sec;
[2024-03-01 23:24:58,080 INFO] valid stats calculation
                           took: 3.9152395725250244 s.
[2024-03-01 23:24:58,080 INFO] Train perplexity: 6.11065
[2024-03-01 23:24:58,080 INFO] Train accuracy: 66.7467
[2024-03-01 23:24:58,080 INFO] Sentences processed: 319832
[2024-03-01 23:24:58,080 INFO] Average bsz:  165/ 380/64
[2024-03-01 23:24:58,080 INFO] Validation perplexity: 419.635
[2024-03-01 23:24:58,080 INFO] Validation accuracy: 19.5518
[2024-03-01 23:24:58,083 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_02_step_6600.pt
