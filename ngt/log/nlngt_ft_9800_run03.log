[2024-02-24 13:42:45,916 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-02-24 13:42:45,916 INFO] Parsed 2 corpora from -data.
[2024-02-24 13:42:45,916 INFO] Loading checkpoint from tg-pretrain/models/tg-pretrain_01_step_9800.pt
[2024-02-24 13:42:46,050 INFO] Building model...
[2024-02-24 13:42:46,110 INFO] Switching model to float32 for amp/apex_amp
[2024-02-24 13:42:46,110 INFO] Non quantized layer compute is fp32
[2024-02-24 13:42:47,943 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(32768, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(500, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(25208, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(1000, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=25208, bias=True)
)
[2024-02-24 13:42:47,944 INFO] encoder: 20392000
[2024-02-24 13:42:47,945 INFO] decoder: 30991208
[2024-02-24 13:42:47,945 INFO] * number of parameters: 51383208
[2024-02-24 13:42:47,946 INFO] Trainable parameters = {'torch.float32': 51383208, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-02-24 13:42:47,946 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-02-24 13:42:47,946 INFO]  * src vocab size = 32768
[2024-02-24 13:42:47,946 INFO]  * tgt vocab size = 25208
[2024-02-24 13:42:47,948 INFO] Starting training on GPU: [0]
[2024-02-24 13:42:47,948 INFO] Start training loop and validate every 200 steps...
[2024-02-24 13:42:47,948 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-02-24 13:43:03,179 INFO] Step 9850/14800; acc: 28.4; ppl: 1036.9; xent: 6.9; lr: 1.00000; sents:    3200; bsz:  293/ 197/64; 962/647 tok/s;     15 sec;
[2024-02-24 13:43:03,703 INFO] Step 9900/14800; acc: 37.2; ppl: 161.4; xent: 5.1; lr: 1.00000; sents:    3200; bsz:  255/ 176/64; 24321/16833 tok/s;     16 sec;
[2024-02-24 13:43:04,297 INFO] Step 9950/14800; acc: 27.8; ppl: 236.5; xent: 5.5; lr: 1.00000; sents:    3200; bsz:  323/ 222/64; 27199/18683 tok/s;     16 sec;
[2024-02-24 13:43:04,833 INFO] Step 10000/14800; acc: 37.4; ppl:  82.0; xent: 4.4; lr: 1.00000; sents:    3200; bsz:  246/ 188/64; 22927/17554 tok/s;     17 sec;
[2024-02-24 13:43:08,597 INFO] valid stats calculation
                           took: 3.763671636581421 s.
[2024-02-24 13:43:08,598 INFO] Train perplexity: 244.04
[2024-02-24 13:43:08,598 INFO] Train accuracy: 32.3942
[2024-02-24 13:43:08,598 INFO] Sentences processed: 12800
[2024-02-24 13:43:08,598 INFO] Average bsz:  279/ 196/64
[2024-02-24 13:43:08,598 INFO] Validation perplexity: 3275.29
[2024-02-24 13:43:08,598 INFO] Validation accuracy: 16.5251
[2024-02-24 13:43:08,601 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_10000.pt
[2024-02-24 13:43:09,442 INFO] Step 10050/14800; acc: 37.4; ppl:  68.8; xent: 4.2; lr: 1.00000; sents:    3200; bsz:  240/ 197/64; 2602/2132 tok/s;     21 sec;
[2024-02-24 13:43:10,140 INFO] Step 10100/14800; acc: 27.8; ppl: 147.4; xent: 5.0; lr: 1.00000; sents:    3200; bsz:  341/ 256/64; 24447/18354 tok/s;     22 sec;
[2024-02-24 13:43:10,732 INFO] Step 10150/14800; acc: 34.3; ppl:  57.2; xent: 4.0; lr: 1.00000; sents:    3200; bsz:  298/ 219/64; 25207/18483 tok/s;     23 sec;
[2024-02-24 13:43:11,461 INFO] Step 10200/14800; acc: 31.5; ppl:  82.3; xent: 4.4; lr: 1.00000; sents:    3200; bsz:  336/ 254/64; 23044/17428 tok/s;     24 sec;
[2024-02-24 13:43:15,199 INFO] valid stats calculation
                           took: 3.7377712726593018 s.
[2024-02-24 13:43:15,200 INFO] Train perplexity: 138.25
[2024-02-24 13:43:15,200 INFO] Train accuracy: 32.3963
[2024-02-24 13:43:15,200 INFO] Sentences processed: 25600
[2024-02-24 13:43:15,200 INFO] Average bsz:  292/ 214/64
[2024-02-24 13:43:15,200 INFO] Validation perplexity: 493.867
[2024-02-24 13:43:15,200 INFO] Validation accuracy: 15.6665
[2024-02-24 13:43:15,202 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_10200.pt
[2024-02-24 13:43:16,124 INFO] Step 10250/14800; acc: 32.6; ppl:  68.1; xent: 4.2; lr: 1.00000; sents:    3200; bsz:  320/ 250/64; 3432/2676 tok/s;     28 sec;
[2024-02-24 13:43:16,732 INFO] Step 10300/14800; acc: 35.9; ppl:  41.3; xent: 3.7; lr: 1.00000; sents:    3200; bsz:  302/ 233/64; 24830/19170 tok/s;     29 sec;
[2024-02-24 13:43:17,321 INFO] Step 10350/14800; acc: 38.9; ppl:  30.3; xent: 3.4; lr: 1.00000; sents:    3200; bsz:  277/ 214/64; 23498/18198 tok/s;     29 sec;
[2024-02-24 13:43:17,962 INFO] Step 10400/14800; acc: 43.5; ppl:  21.7; xent: 3.1; lr: 1.00000; sents:    3200; bsz:  297/ 221/64; 23153/17243 tok/s;     30 sec;
[2024-02-24 13:43:21,700 INFO] valid stats calculation
                           took: 3.7379589080810547 s.
[2024-02-24 13:43:21,700 INFO] Train perplexity: 87.7897
[2024-02-24 13:43:21,700 INFO] Train accuracy: 34.1873
[2024-02-24 13:43:21,700 INFO] Sentences processed: 38400
[2024-02-24 13:43:21,700 INFO] Average bsz:  294/ 219/64
[2024-02-24 13:43:21,701 INFO] Validation perplexity: 890.811
[2024-02-24 13:43:21,701 INFO] Validation accuracy: 17.6699
[2024-02-24 13:43:21,703 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_10400.pt
[2024-02-24 13:43:22,515 INFO] Step 10450/14800; acc: 50.8; ppl:  13.7; xent: 2.6; lr: 1.00000; sents:    3200; bsz:  266/ 186/64; 2924/2038 tok/s;     35 sec;
[2024-02-24 13:43:23,063 INFO] Step 10500/14800; acc: 51.7; ppl:  10.2; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  276/ 194/64; 25236/17671 tok/s;     35 sec;
[2024-02-24 13:43:23,634 INFO] Step 10550/14800; acc: 49.1; ppl:  12.2; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  290/ 206/64; 25387/18060 tok/s;     36 sec;
[2024-02-24 13:43:24,219 INFO] Step 10600/14800; acc: 48.1; ppl:  13.9; xent: 2.6; lr: 1.00000; sents:    3200; bsz:  328/ 221/64; 28008/18888 tok/s;     36 sec;
[2024-02-24 13:43:27,932 INFO] valid stats calculation
                           took: 3.7120635509490967 s.
[2024-02-24 13:43:27,932 INFO] Train perplexity: 55.4653
[2024-02-24 13:43:27,932 INFO] Train accuracy: 37.8631
[2024-02-24 13:43:27,932 INFO] Sentences processed: 51200
[2024-02-24 13:43:27,932 INFO] Average bsz:  293/ 215/64
[2024-02-24 13:43:27,932 INFO] Validation perplexity: 369.523
[2024-02-24 13:43:27,932 INFO] Validation accuracy: 18.5284
[2024-02-24 13:43:27,935 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_10600.pt
[2024-02-24 13:43:28,773 INFO] Step 10650/14800; acc: 53.2; ppl:  10.6; xent: 2.4; lr: 1.00000; sents:    3200; bsz:  264/ 212/64; 2895/2324 tok/s;     41 sec;
[2024-02-24 13:43:29,332 INFO] Step 10700/14800; acc: 57.5; ppl:   6.7; xent: 1.9; lr: 1.00000; sents:    3200; bsz:  270/ 204/64; 24148/18210 tok/s;     41 sec;
[2024-02-24 13:43:30,047 INFO] Step 10750/14800; acc: 48.5; ppl:  15.9; xent: 2.8; lr: 1.00000; sents:    3150; bsz:  373/ 236/63; 26090/16528 tok/s;     42 sec;
[2024-02-24 13:43:30,693 INFO] Step 10800/14800; acc: 47.9; ppl:  17.0; xent: 2.8; lr: 1.00000; sents:    3200; bsz:  340/ 225/64; 26308/17439 tok/s;     43 sec;
[2024-02-24 13:43:34,452 INFO] valid stats calculation
                           took: 3.758481025695801 s.
[2024-02-24 13:43:34,453 INFO] Train perplexity: 40.6139
[2024-02-24 13:43:34,453 INFO] Train accuracy: 40.6513
[2024-02-24 13:43:34,453 INFO] Sentences processed: 63950
[2024-02-24 13:43:34,453 INFO] Average bsz:  297/ 216/64
[2024-02-24 13:43:34,453 INFO] Validation perplexity: 307.028
[2024-02-24 13:43:34,453 INFO] Validation accuracy: 18.0668
[2024-02-24 13:43:34,455 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_10800.pt
[2024-02-24 13:43:35,303 INFO] Step 10850/14800; acc: 59.6; ppl:   6.0; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  283/ 199/64; 3068/2157 tok/s;     47 sec;
[2024-02-24 13:43:35,922 INFO] Step 10900/14800; acc: 56.0; ppl:   8.6; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  314/ 214/64; 25336/17248 tok/s;     48 sec;
[2024-02-24 13:43:36,488 INFO] Step 10950/14800; acc: 63.8; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  268/ 207/64; 23643/18326 tok/s;     49 sec;
[2024-02-24 13:43:37,098 INFO] Step 11000/14800; acc: 54.7; ppl:  10.3; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  324/ 224/64; 26556/18328 tok/s;     49 sec;
[2024-02-24 13:43:40,851 INFO] valid stats calculation
                           took: 3.752431869506836 s.
[2024-02-24 13:43:40,851 INFO] Train perplexity: 30.4091
[2024-02-24 13:43:40,851 INFO] Train accuracy: 43.5586
[2024-02-24 13:43:40,852 INFO] Sentences processed: 76750
[2024-02-24 13:43:40,852 INFO] Average bsz:  297/ 215/64
[2024-02-24 13:43:40,852 INFO] Validation perplexity: 345.847
[2024-02-24 13:43:40,852 INFO] Validation accuracy: 18.7223
[2024-02-24 13:43:40,854 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_11000.pt
[2024-02-24 13:43:41,686 INFO] Step 11050/14800; acc: 64.4; ppl:   5.4; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  311/ 196/64; 3390/2131 tok/s;     54 sec;
[2024-02-24 13:43:42,263 INFO] Step 11100/14800; acc: 70.0; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  293/ 215/64; 25399/18625 tok/s;     54 sec;
[2024-02-24 13:43:42,855 INFO] Step 11150/14800; acc: 63.0; ppl:   5.9; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  329/ 226/64; 27794/19127 tok/s;     55 sec;
[2024-02-24 13:43:43,433 INFO] Step 11200/14800; acc: 66.1; ppl:   4.4; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  294/ 217/64; 25470/18800 tok/s;     55 sec;
[2024-02-24 13:43:47,193 INFO] valid stats calculation
                           took: 3.75950026512146 s.
[2024-02-24 13:43:47,194 INFO] Train perplexity: 23.2006
[2024-02-24 13:43:47,194 INFO] Train accuracy: 46.7328
[2024-02-24 13:43:47,194 INFO] Sentences processed: 89550
[2024-02-24 13:43:47,194 INFO] Average bsz:  298/ 215/64
[2024-02-24 13:43:47,194 INFO] Validation perplexity: 374.974
[2024-02-24 13:43:47,194 INFO] Validation accuracy: 18.3715
[2024-02-24 13:43:47,196 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_11200.pt
[2024-02-24 13:43:48,054 INFO] Step 11250/14800; acc: 69.0; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  307/ 214/64; 3325/2317 tok/s;     60 sec;
[2024-02-24 13:43:48,698 INFO] Step 11300/14800; acc: 64.2; ppl:   5.7; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  303/ 243/64; 23496/18852 tok/s;     61 sec;
[2024-02-24 13:43:49,384 INFO] Step 11350/14800; acc: 58.4; ppl:  11.6; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  352/ 242/64; 25666/17630 tok/s;     61 sec;
[2024-02-24 13:43:49,959 INFO] Step 11400/14800; acc: 69.0; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  296/ 205/64; 25747/17822 tok/s;     62 sec;
[2024-02-24 13:43:53,700 INFO] valid stats calculation
                           took: 3.741065502166748 s.
[2024-02-24 13:43:53,700 INFO] Train perplexity: 19.2187
[2024-02-24 13:43:53,700 INFO] Train accuracy: 49.1055
[2024-02-24 13:43:53,701 INFO] Sentences processed: 102350
[2024-02-24 13:43:53,701 INFO] Average bsz:  300/ 216/64
[2024-02-24 13:43:53,701 INFO] Validation perplexity: 492.904
[2024-02-24 13:43:53,701 INFO] Validation accuracy: 19.3408
[2024-02-24 13:43:53,703 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_11400.pt
[2024-02-24 13:43:54,554 INFO] Step 11450/14800; acc: 76.4; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  324/ 204/64; 3524/2216 tok/s;     67 sec;
[2024-02-24 13:43:55,122 INFO] Step 11500/14800; acc: 74.0; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  276/ 205/64; 24335/18059 tok/s;     67 sec;
[2024-02-24 13:43:55,758 INFO] Step 11550/14800; acc: 72.7; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  307/ 223/64; 24156/17521 tok/s;     68 sec;
[2024-02-24 13:43:56,325 INFO] Step 11600/14800; acc: 77.6; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  296/ 200/64; 26092/17624 tok/s;     68 sec;
[2024-02-24 13:44:00,058 INFO] valid stats calculation
                           took: 3.733243227005005 s.
[2024-02-24 13:44:00,059 INFO] Train perplexity: 15.7613
[2024-02-24 13:44:00,059 INFO] Train accuracy: 51.8972
[2024-02-24 13:44:00,059 INFO] Sentences processed: 115150
[2024-02-24 13:44:00,059 INFO] Average bsz:  300/ 215/64
[2024-02-24 13:44:00,059 INFO] Validation perplexity: 347.98
[2024-02-24 13:44:00,059 INFO] Validation accuracy: 19.0177
[2024-02-24 13:44:00,061 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_11600.pt
[2024-02-24 13:44:00,901 INFO] Step 11650/14800; acc: 79.3; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  296/ 211/64; 3231/2308 tok/s;     73 sec;
[2024-02-24 13:44:01,484 INFO] Step 11700/14800; acc: 82.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  337/ 219/64; 28908/18835 tok/s;     74 sec;
[2024-02-24 13:44:02,144 INFO] Step 11750/14800; acc: 68.0; ppl:   6.3; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  336/ 246/64; 25464/18665 tok/s;     74 sec;
[2024-02-24 13:44:02,735 INFO] Step 11800/14800; acc: 77.2; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  306/ 217/64; 25915/18353 tok/s;     75 sec;
[2024-02-24 13:44:06,447 INFO] valid stats calculation
                           took: 3.7125301361083984 s.
[2024-02-24 13:44:06,448 INFO] Train perplexity: 13.282
[2024-02-24 13:44:06,448 INFO] Train accuracy: 54.4423
[2024-02-24 13:44:06,448 INFO] Sentences processed: 127950
[2024-02-24 13:44:06,448 INFO] Average bsz:  302/ 216/64
[2024-02-24 13:44:06,448 INFO] Validation perplexity: 401.668
[2024-02-24 13:44:06,448 INFO] Validation accuracy: 18.75
[2024-02-24 13:44:06,450 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_11800.pt
[2024-02-24 13:44:07,302 INFO] Step 11850/14800; acc: 72.2; ppl:   4.8; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  296/ 201/64; 3244/2203 tok/s;     79 sec;
[2024-02-24 13:44:07,894 INFO] Step 11900/14800; acc: 79.2; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  302/ 227/64; 25539/19167 tok/s;     80 sec;
[2024-02-24 13:44:08,450 INFO] Step 11950/14800; acc: 83.6; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  305/ 201/64; 27397/18075 tok/s;     81 sec;
[2024-02-24 13:44:09,002 INFO] Step 12000/14800; acc: 85.8; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  273/ 201/64; 24673/18148 tok/s;     81 sec;
[2024-02-24 13:44:12,755 INFO] valid stats calculation
                           took: 3.7521073818206787 s.
[2024-02-24 13:44:12,755 INFO] Train perplexity: 11.4773
[2024-02-24 13:44:12,755 INFO] Train accuracy: 56.6977
[2024-02-24 13:44:12,755 INFO] Sentences processed: 140750
[2024-02-24 13:44:12,755 INFO] Average bsz:  301/ 215/64
[2024-02-24 13:44:12,755 INFO] Validation perplexity: 458.902
[2024-02-24 13:44:12,755 INFO] Validation accuracy: 19.3685
[2024-02-24 13:44:12,758 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_12000.pt
[2024-02-24 13:44:13,648 INFO] Step 12050/14800; acc: 78.6; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  334/ 221/64; 3600/2379 tok/s;     86 sec;
[2024-02-24 13:44:14,229 INFO] Step 12100/14800; acc: 83.3; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  294/ 220/64; 25354/18961 tok/s;     86 sec;
[2024-02-24 13:44:14,853 INFO] Step 12150/14800; acc: 74.9; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  338/ 248/64; 27066/19870 tok/s;     87 sec;
[2024-02-24 13:44:15,493 INFO] Step 12200/14800; acc: 72.9; ppl:   4.5; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  330/ 249/64; 25830/19446 tok/s;     88 sec;
[2024-02-24 13:44:19,247 INFO] valid stats calculation
                           took: 3.7536137104034424 s.
[2024-02-24 13:44:19,248 INFO] Train perplexity: 10.2002
[2024-02-24 13:44:19,248 INFO] Train accuracy: 58.5472
[2024-02-24 13:44:19,248 INFO] Sentences processed: 153550
[2024-02-24 13:44:19,248 INFO] Average bsz:  303/ 217/64
[2024-02-24 13:44:19,248 INFO] Validation perplexity: 1175.23
[2024-02-24 13:44:19,248 INFO] Validation accuracy: 15.9989
[2024-02-24 13:44:19,250 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_12200.pt
[2024-02-24 13:44:20,202 INFO] Step 12250/14800; acc: 69.9; ppl:   6.1; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  343/ 241/64; 3646/2557 tok/s;     92 sec;
[2024-02-24 13:44:20,885 INFO] Step 12300/14800; acc: 71.5; ppl:   6.0; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  350/ 235/64; 25577/17186 tok/s;     93 sec;
[2024-02-24 13:44:21,487 INFO] Step 12350/14800; acc: 77.3; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  320/ 203/64; 26594/16860 tok/s;     94 sec;
[2024-02-24 13:44:22,072 INFO] Step 12400/14800; acc: 86.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  297/ 214/64; 25361/18286 tok/s;     94 sec;
[2024-02-24 13:44:25,862 INFO] valid stats calculation
                           took: 3.7893543243408203 s.
[2024-02-24 13:44:25,862 INFO] Train perplexity: 9.45908
[2024-02-24 13:44:25,862 INFO] Train accuracy: 59.9257
[2024-02-24 13:44:25,863 INFO] Sentences processed: 166350
[2024-02-24 13:44:25,863 INFO] Average bsz:  305/ 217/64
[2024-02-24 13:44:25,863 INFO] Validation perplexity: 449.975
[2024-02-24 13:44:25,863 INFO] Validation accuracy: 17.9376
[2024-02-24 13:44:25,865 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_12400.pt
[2024-02-24 13:44:26,726 INFO] Step 12450/14800; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  321/ 212/64; 3452/2283 tok/s;     99 sec;
[2024-02-24 13:44:27,286 INFO] Step 12500/14800; acc: 89.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  291/ 194/64; 25929/17302 tok/s;     99 sec;
[2024-02-24 13:44:27,930 INFO] Step 12550/14800; acc: 76.8; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  347/ 237/64; 26970/18406 tok/s;    100 sec;
[2024-02-24 13:44:28,564 INFO] Step 12600/14800; acc: 81.8; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  318/ 235/64; 25073/18481 tok/s;    101 sec;
[2024-02-24 13:44:32,276 INFO] valid stats calculation
                           took: 3.711132764816284 s.
[2024-02-24 13:44:32,276 INFO] Train perplexity: 8.49692
[2024-02-24 13:44:32,276 INFO] Train accuracy: 61.693
[2024-02-24 13:44:32,276 INFO] Sentences processed: 179150
[2024-02-24 13:44:32,276 INFO] Average bsz:  306/ 217/64
[2024-02-24 13:44:32,276 INFO] Validation perplexity: 755.194
[2024-02-24 13:44:32,276 INFO] Validation accuracy: 19.6178
[2024-02-24 13:44:32,279 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_12600.pt
[2024-02-24 13:44:33,110 INFO] Step 12650/14800; acc: 87.5; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  280/ 202/64; 3083/2222 tok/s;    105 sec;
[2024-02-24 13:44:33,865 INFO] Step 12700/14800; acc: 63.3; ppl:  12.4; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  382/ 272/64; 25286/18021 tok/s;    106 sec;
[2024-02-24 13:44:34,502 INFO] Step 12750/14800; acc: 78.9; ppl:   3.5; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  334/ 237/64; 26289/18635 tok/s;    107 sec;
[2024-02-24 13:44:35,062 INFO] Step 12800/14800; acc: 90.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  274/ 206/64; 24448/18406 tok/s;    107 sec;
[2024-02-24 13:44:38,770 INFO] valid stats calculation
                           took: 3.7081544399261475 s.
[2024-02-24 13:44:38,771 INFO] Train perplexity: 7.99646
[2024-02-24 13:44:38,771 INFO] Train accuracy: 62.8922
[2024-02-24 13:44:38,771 INFO] Sentences processed: 191950
[2024-02-24 13:44:38,771 INFO] Average bsz:  307/ 218/64
[2024-02-24 13:44:38,771 INFO] Validation perplexity: 511.41
[2024-02-24 13:44:38,771 INFO] Validation accuracy: 20.0055
[2024-02-24 13:44:38,773 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_12800.pt
[2024-02-24 13:44:39,638 INFO] Step 12850/14800; acc: 85.2; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  291/ 214/64; 3178/2343 tok/s;    112 sec;
[2024-02-24 13:44:40,175 INFO] Step 12900/14800; acc: 88.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  300/ 198/64; 27890/18415 tok/s;    112 sec;
[2024-02-24 13:44:40,692 INFO] Step 12950/14800; acc: 87.6; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  291/ 189/64; 28132/18284 tok/s;    113 sec;
[2024-02-24 13:44:41,218 INFO] Step 13000/14800; acc: 92.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  298/ 202/64; 28392/19253 tok/s;    113 sec;
[2024-02-24 13:44:45,198 INFO] valid stats calculation
                           took: 3.9793965816497803 s.
[2024-02-24 13:44:45,198 INFO] Train perplexity: 7.3569
[2024-02-24 13:44:45,198 INFO] Train accuracy: 64.367
[2024-02-24 13:44:45,198 INFO] Sentences processed: 204750
[2024-02-24 13:44:45,198 INFO] Average bsz:  306/ 217/64
[2024-02-24 13:44:45,198 INFO] Validation perplexity: 429.651
[2024-02-24 13:44:45,198 INFO] Validation accuracy: 19.0916
[2024-02-24 13:44:45,200 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_13000.pt
[2024-02-24 13:44:46,002 INFO] Step 13050/14800; acc: 92.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  291/ 207/64; 3037/2168 tok/s;    118 sec;
[2024-02-24 13:44:46,607 INFO] Step 13100/14800; acc: 75.2; ppl:   5.0; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  351/ 244/64; 28999/20139 tok/s;    119 sec;
[2024-02-24 13:44:47,279 INFO] Step 13150/14800; acc: 73.9; ppl:   5.2; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  360/ 252/64; 26838/18750 tok/s;    119 sec;
[2024-02-24 13:44:47,827 INFO] Step 13200/14800; acc: 84.5; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  273/ 214/64; 24878/19520 tok/s;    120 sec;
[2024-02-24 13:44:51,828 INFO] valid stats calculation
                           took: 4.000535249710083 s.
[2024-02-24 13:44:51,828 INFO] Train perplexity: 6.97319
[2024-02-24 13:44:51,829 INFO] Train accuracy: 65.3909
[2024-02-24 13:44:51,829 INFO] Sentences processed: 217550
[2024-02-24 13:44:51,829 INFO] Average bsz:  307/ 218/64
[2024-02-24 13:44:51,829 INFO] Validation perplexity: 378.003
[2024-02-24 13:44:51,829 INFO] Validation accuracy: 18.0761
[2024-02-24 13:44:51,831 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_13200.pt
[2024-02-24 13:44:52,787 INFO] Step 13250/14800; acc: 70.2; ppl:   8.2; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  378/ 249/64; 3806/2506 tok/s;    125 sec;
[2024-02-24 13:44:56,365 INFO] Step 13300/14800; acc: 81.6; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  327/ 238/64; 4565/3329 tok/s;    128 sec;
[2024-02-24 13:44:57,180 INFO] Step 13350/14800; acc: 70.3; ppl:   6.8; xent: 1.9; lr: 1.00000; sents:    3200; bsz:  374/ 264/64; 22931/16229 tok/s;    129 sec;
[2024-02-24 13:44:57,750 INFO] Step 13400/14800; acc: 93.7; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  288/ 212/64; 25277/18649 tok/s;    130 sec;
[2024-02-24 13:45:01,552 INFO] valid stats calculation
                           took: 3.8021111488342285 s.
[2024-02-24 13:45:01,553 INFO] Train perplexity: 6.74157
[2024-02-24 13:45:01,553 INFO] Train accuracy: 66.1742
[2024-02-24 13:45:01,553 INFO] Sentences processed: 230350
[2024-02-24 13:45:01,553 INFO] Average bsz:  309/ 219/64
[2024-02-24 13:45:01,553 INFO] Validation perplexity: 429.713
[2024-02-24 13:45:01,553 INFO] Validation accuracy: 19.8855
[2024-02-24 13:45:01,555 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_13400.pt
[2024-02-24 13:45:02,401 INFO] Step 13450/14800; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  279/ 209/64; 3000/2243 tok/s;    134 sec;
[2024-02-24 13:45:02,948 INFO] Step 13500/14800; acc: 93.7; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  276/ 193/64; 25255/17655 tok/s;    135 sec;
[2024-02-24 13:45:03,568 INFO] Step 13550/14800; acc: 92.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  334/ 240/64; 26919/19369 tok/s;    136 sec;
[2024-02-24 13:45:04,157 INFO] Step 13600/14800; acc: 95.2; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  326/ 227/64; 27708/19233 tok/s;    136 sec;
[2024-02-24 13:45:07,928 INFO] valid stats calculation
                           took: 3.7708070278167725 s.
[2024-02-24 13:45:07,929 INFO] Train perplexity: 6.18799
[2024-02-24 13:45:07,929 INFO] Train accuracy: 67.6081
[2024-02-24 13:45:07,929 INFO] Sentences processed: 243150
[2024-02-24 13:45:07,929 INFO] Average bsz:  309/ 219/64
[2024-02-24 13:45:07,929 INFO] Validation perplexity: 431.502
[2024-02-24 13:45:07,929 INFO] Validation accuracy: 19.0916
[2024-02-24 13:45:07,931 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_13600.pt
[2024-02-24 13:45:08,775 INFO] Step 13650/14800; acc: 90.6; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  292/ 215/64; 3160/2324 tok/s;    141 sec;
[2024-02-24 13:45:09,471 INFO] Step 13700/14800; acc: 73.7; ppl:   5.4; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  345/ 250/64; 24808/17923 tok/s;    142 sec;
[2024-02-24 13:45:10,047 INFO] Step 13750/14800; acc: 90.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  303/ 212/64; 26375/18468 tok/s;    142 sec;
[2024-02-24 13:45:10,681 INFO] Step 13800/14800; acc: 74.2; ppl:   4.8; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  291/ 210/64; 22988/16555 tok/s;    143 sec;
[2024-02-24 13:45:14,421 INFO] valid stats calculation
                           took: 3.7401835918426514 s.
[2024-02-24 13:45:14,421 INFO] Train perplexity: 5.95714
[2024-02-24 13:45:14,421 INFO] Train accuracy: 68.3288
[2024-02-24 13:45:14,422 INFO] Sentences processed: 255950
[2024-02-24 13:45:14,422 INFO] Average bsz:  309/ 219/64
[2024-02-24 13:45:14,422 INFO] Validation perplexity: 557.784
[2024-02-24 13:45:14,422 INFO] Validation accuracy: 19.7563
[2024-02-24 13:45:14,424 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_13800.pt
[2024-02-24 13:45:15,359 INFO] Step 13850/14800; acc: 81.5; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  346/ 246/64; 3698/2634 tok/s;    147 sec;
[2024-02-24 13:45:15,918 INFO] Step 13900/14800; acc: 91.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  276/ 198/64; 24763/17741 tok/s;    148 sec;
[2024-02-24 13:45:16,581 INFO] Step 13950/14800; acc: 77.4; ppl:   4.2; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  333/ 227/64; 25085/17126 tok/s;    149 sec;
[2024-02-24 13:45:17,250 INFO] Step 14000/14800; acc: 78.0; ppl:   4.2; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  324/ 246/64; 24242/18403 tok/s;    149 sec;
[2024-02-24 13:45:20,983 INFO] valid stats calculation
                           took: 3.7326242923736572 s.
[2024-02-24 13:45:20,984 INFO] Train perplexity: 5.76666
[2024-02-24 13:45:20,984 INFO] Train accuracy: 68.9885
[2024-02-24 13:45:20,984 INFO] Sentences processed: 268750
[2024-02-24 13:45:20,984 INFO] Average bsz:  309/ 220/64
[2024-02-24 13:45:20,984 INFO] Validation perplexity: 490.057
[2024-02-24 13:45:20,984 INFO] Validation accuracy: 16.9313
[2024-02-24 13:45:20,986 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_14000.pt
[2024-02-24 13:45:21,894 INFO] Step 14050/14800; acc: 82.4; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  337/ 236/64; 3633/2536 tok/s;    154 sec;
[2024-02-24 13:45:22,475 INFO] Step 14100/14800; acc: 92.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  316/ 203/64; 27185/17516 tok/s;    155 sec;
[2024-02-24 13:45:23,058 INFO] Step 14150/14800; acc: 93.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  314/ 222/64; 26863/19012 tok/s;    155 sec;
[2024-02-24 13:45:23,625 INFO] Step 14200/14800; acc: 93.3; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  311/ 208/64; 27483/18341 tok/s;    156 sec;
[2024-02-24 13:45:27,377 INFO] valid stats calculation
                           took: 3.7519733905792236 s.
[2024-02-24 13:45:27,377 INFO] Train perplexity: 5.46529
[2024-02-24 13:45:27,377 INFO] Train accuracy: 69.943
[2024-02-24 13:45:27,377 INFO] Sentences processed: 281550
[2024-02-24 13:45:27,377 INFO] Average bsz:  310/ 220/64
[2024-02-24 13:45:27,377 INFO] Validation perplexity: 395.258
[2024-02-24 13:45:27,377 INFO] Validation accuracy: 20.0517
[2024-02-24 13:45:27,380 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_14200.pt
[2024-02-24 13:45:28,239 INFO] Step 14250/14800; acc: 88.7; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  301/ 218/64; 3259/2361 tok/s;    160 sec;
[2024-02-24 13:45:28,829 INFO] Step 14300/14800; acc: 89.2; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  294/ 220/64; 24957/18636 tok/s;    161 sec;
[2024-02-24 13:45:29,431 INFO] Step 14350/14800; acc: 88.0; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  298/ 221/64; 24745/18384 tok/s;    161 sec;
[2024-02-24 13:45:30,054 INFO] Step 14400/14800; acc: 81.3; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  307/ 214/64; 24672/17224 tok/s;    162 sec;
[2024-02-24 13:45:33,840 INFO] valid stats calculation
                           took: 3.7863848209381104 s.
[2024-02-24 13:45:33,841 INFO] Train perplexity: 5.25147
[2024-02-24 13:45:33,841 INFO] Train accuracy: 70.6731
[2024-02-24 13:45:33,841 INFO] Sentences processed: 294350
[2024-02-24 13:45:33,841 INFO] Average bsz:  309/ 219/64
[2024-02-24 13:45:33,841 INFO] Validation perplexity: 680.364
[2024-02-24 13:45:33,841 INFO] Validation accuracy: 17.2267
[2024-02-24 13:45:33,843 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_14400.pt
[2024-02-24 13:45:34,800 INFO] Step 14450/14800; acc: 80.6; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    3195; bsz:  359/ 252/64; 3779/2653 tok/s;    167 sec;
[2024-02-24 13:45:35,384 INFO] Step 14500/14800; acc: 89.3; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  294/ 220/64; 25235/18834 tok/s;    167 sec;
[2024-02-24 13:45:35,957 INFO] Step 14550/14800; acc: 96.0; ppl:   1.2; xent: 0.1; lr: 1.00000; sents:    3200; bsz:  311/ 212/64; 27118/18525 tok/s;    168 sec;
[2024-02-24 13:45:36,576 INFO] Step 14600/14800; acc: 80.5; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  322/ 225/64; 26075/18208 tok/s;    169 sec;
[2024-02-24 13:45:40,311 INFO] valid stats calculation
                           took: 3.7353551387786865 s.
[2024-02-24 13:45:40,312 INFO] Train perplexity: 5.06736
[2024-02-24 13:45:40,312 INFO] Train accuracy: 71.3457
[2024-02-24 13:45:40,312 INFO] Sentences processed: 307145
[2024-02-24 13:45:40,312 INFO] Average bsz:  310/ 220/64
[2024-02-24 13:45:40,312 INFO] Validation perplexity: 748.053
[2024-02-24 13:45:40,312 INFO] Validation accuracy: 17.079
[2024-02-24 13:45:40,314 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_14600.pt
[2024-02-24 13:45:41,157 INFO] Step 14650/14800; acc: 92.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  280/ 191/64; 3059/2083 tok/s;    173 sec;
[2024-02-24 13:45:41,849 INFO] Step 14700/14800; acc: 75.7; ppl:   4.8; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  301/ 224/64; 21734/16220 tok/s;    174 sec;
[2024-02-24 13:45:42,411 INFO] Step 14750/14800; acc: 90.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  294/ 200/64; 26206/17794 tok/s;    174 sec;
[2024-02-24 13:45:43,031 INFO] Step 14800/14800; acc: 76.7; ppl:   4.3; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  319/ 230/64; 25708/18591 tok/s;    175 sec;
[2024-02-24 13:45:46,773 INFO] valid stats calculation
                           took: 3.741826057434082 s.
[2024-02-24 13:45:46,774 INFO] Train perplexity: 4.94996
[2024-02-24 13:45:46,774 INFO] Train accuracy: 71.806
[2024-02-24 13:45:46,774 INFO] Sentences processed: 319945
[2024-02-24 13:45:46,774 INFO] Average bsz:  309/ 219/64
[2024-02-24 13:45:46,774 INFO] Validation perplexity: 461.782
[2024-02-24 13:45:46,774 INFO] Validation accuracy: 20.024
[2024-02-24 13:45:46,776 INFO] Saving checkpoint tg-finetune/tg-finetune_9800_03_step_14800.pt
