[2024-02-26 19:15:13,806 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-02-26 19:15:13,806 INFO] Parsed 2 corpora from -data.
[2024-02-26 19:15:13,806 INFO] Loading checkpoint from tg-pretrain/models/both/tg-pretrain_02_step_6800.pt
[2024-02-26 19:15:13,922 INFO] Building model...
[2024-02-26 19:15:13,979 INFO] Switching model to float32 for amp/apex_amp
[2024-02-26 19:15:13,979 INFO] Non quantized layer compute is fp32
[2024-02-26 19:15:15,840 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(32768, 320, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(320, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(25208, 320, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(820, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=25208, bias=True)
)
[2024-02-26 19:15:15,841 INFO] encoder: 14133760
[2024-02-26 19:15:15,841 INFO] decoder: 26093768
[2024-02-26 19:15:15,841 INFO] * number of parameters: 40227528
[2024-02-26 19:15:15,841 INFO] Trainable parameters = {'torch.float32': 40227528, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-02-26 19:15:15,841 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-02-26 19:15:15,841 INFO]  * src vocab size = 32768
[2024-02-26 19:15:15,841 INFO]  * tgt vocab size = 25208
[2024-02-26 19:15:15,843 INFO] Starting training on GPU: [0]
[2024-02-26 19:15:15,843 INFO] Start training loop and validate every 200 steps...
[2024-02-26 19:15:15,843 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-02-26 19:15:31,129 INFO] Step 6850/11800; acc: 28.7; ppl: 1322.6; xent: 7.2; lr: 1.00000; sents:    3200; bsz:  279/ 193/64; 913/631 tok/s;     15 sec;
[2024-02-26 19:15:31,758 INFO] Step 6900/11800; acc: 28.7; ppl: 357.5; xent: 5.9; lr: 1.00000; sents:    3200; bsz:  321/ 219/64; 25519/17377 tok/s;     16 sec;
[2024-02-26 19:15:32,375 INFO] Step 6950/11800; acc: 26.9; ppl: 306.2; xent: 5.7; lr: 1.00000; sents:    3200; bsz:  370/ 234/64; 30007/18987 tok/s;     17 sec;
[2024-02-26 19:15:33,096 INFO] Step 7000/11800; acc: 24.4; ppl: 269.7; xent: 5.6; lr: 1.00000; sents:    3200; bsz:  385/ 276/64; 26708/19115 tok/s;     17 sec;
[2024-02-26 19:15:36,843 INFO] valid stats calculation
                           took: 3.7462453842163086 s.
[2024-02-26 19:15:36,843 INFO] Train perplexity: 415.51
[2024-02-26 19:15:36,843 INFO] Train accuracy: 26.9586
[2024-02-26 19:15:36,843 INFO] Sentences processed: 12800
[2024-02-26 19:15:36,843 INFO] Average bsz:  339/ 230/64
[2024-02-26 19:15:36,843 INFO] Validation perplexity: 485.881
[2024-02-26 19:15:36,843 INFO] Validation accuracy: 18.1222
[2024-02-26 19:15:36,846 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_7000.pt
[2024-02-26 19:15:37,777 INFO] Step 7050/11800; acc: 26.9; ppl: 148.1; xent: 5.0; lr: 1.00000; sents:    3150; bsz:  365/ 259/63; 3903/2772 tok/s;     22 sec;
[2024-02-26 19:15:38,279 INFO] Step 7100/11800; acc: 40.1; ppl:  49.4; xent: 3.9; lr: 1.00000; sents:    3200; bsz:  273/ 186/64; 27134/18547 tok/s;     22 sec;
[2024-02-26 19:15:38,804 INFO] Step 7150/11800; acc: 38.2; ppl:  46.2; xent: 3.8; lr: 1.00000; sents:    3200; bsz:  305/ 201/64; 29010/19168 tok/s;     23 sec;
[2024-02-26 19:15:39,305 INFO] Step 7200/11800; acc: 42.3; ppl:  29.2; xent: 3.4; lr: 1.00000; sents:    3200; bsz:  288/ 184/64; 28795/18429 tok/s;     23 sec;
[2024-02-26 19:15:43,074 INFO] valid stats calculation
                           took: 3.76908016204834 s.
[2024-02-26 19:15:43,074 INFO] Train perplexity: 167.142
[2024-02-26 19:15:43,074 INFO] Train accuracy: 31.2534
[2024-02-26 19:15:43,074 INFO] Sentences processed: 25550
[2024-02-26 19:15:43,074 INFO] Average bsz:  323/ 219/64
[2024-02-26 19:15:43,074 INFO] Validation perplexity: 423.406
[2024-02-26 19:15:43,074 INFO] Validation accuracy: 13.5894
[2024-02-26 19:15:43,077 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_7200.pt
[2024-02-26 19:15:43,840 INFO] Step 7250/11800; acc: 38.4; ppl:  37.1; xent: 3.6; lr: 1.00000; sents:    3200; bsz:  305/ 227/64; 3358/2500 tok/s;     28 sec;
[2024-02-26 19:15:44,400 INFO] Step 7300/11800; acc: 38.8; ppl:  34.4; xent: 3.5; lr: 1.00000; sents:    3200; bsz:  325/ 227/64; 29080/20300 tok/s;     29 sec;
[2024-02-26 19:15:44,898 INFO] Step 7350/11800; acc: 50.7; ppl:  13.4; xent: 2.6; lr: 1.00000; sents:    3200; bsz:  260/ 183/64; 26053/18353 tok/s;     29 sec;
[2024-02-26 19:15:45,418 INFO] Step 7400/11800; acc: 47.5; ppl:  14.7; xent: 2.7; lr: 1.00000; sents:    3200; bsz:  270/ 199/64; 26008/19137 tok/s;     30 sec;
[2024-02-26 19:15:49,210 INFO] valid stats calculation
                           took: 3.7923178672790527 s.
[2024-02-26 19:15:49,211 INFO] Train perplexity: 88.5231
[2024-02-26 19:15:49,211 INFO] Train accuracy: 35.1594
[2024-02-26 19:15:49,211 INFO] Sentences processed: 38350
[2024-02-26 19:15:49,211 INFO] Average bsz:  312/ 216/64
[2024-02-26 19:15:49,211 INFO] Validation perplexity: 360.291
[2024-02-26 19:15:49,211 INFO] Validation accuracy: 19.1193
[2024-02-26 19:15:49,213 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_7400.pt
[2024-02-26 19:15:49,944 INFO] Step 7450/11800; acc: 45.6; ppl:  16.2; xent: 2.8; lr: 1.00000; sents:    3200; bsz:  297/ 214/64; 3280/2361 tok/s;     34 sec;
[2024-02-26 19:15:50,544 INFO] Step 7500/11800; acc: 41.4; ppl:  25.2; xent: 3.2; lr: 1.00000; sents:    3200; bsz:  316/ 246/64; 26362/20472 tok/s;     35 sec;
[2024-02-26 19:15:51,088 INFO] Step 7550/11800; acc: 51.4; ppl:   9.3; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  271/ 211/64; 24963/19449 tok/s;     35 sec;
[2024-02-26 19:15:51,661 INFO] Step 7600/11800; acc: 50.8; ppl:  11.7; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  292/ 224/64; 25459/19567 tok/s;     36 sec;
[2024-02-26 19:15:55,433 INFO] valid stats calculation
                           took: 3.771555185317993 s.
[2024-02-26 19:15:55,434 INFO] Train perplexity: 55.8971
[2024-02-26 19:15:55,434 INFO] Train accuracy: 38.2385
[2024-02-26 19:15:55,434 INFO] Sentences processed: 51150
[2024-02-26 19:15:55,434 INFO] Average bsz:  308/ 218/64
[2024-02-26 19:15:55,434 INFO] Validation perplexity: 520.642
[2024-02-26 19:15:55,434 INFO] Validation accuracy: 18.2699
[2024-02-26 19:15:55,436 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_7600.pt
[2024-02-26 19:15:56,251 INFO] Step 7650/11800; acc: 46.0; ppl:  21.7; xent: 3.1; lr: 1.00000; sents:    3200; bsz:  326/ 224/64; 3557/2442 tok/s;     40 sec;
[2024-02-26 19:15:56,785 INFO] Step 7700/11800; acc: 57.5; ppl:   6.4; xent: 1.9; lr: 1.00000; sents:    3200; bsz:  284/ 203/64; 26608/18982 tok/s;     41 sec;
[2024-02-26 19:15:57,358 INFO] Step 7750/11800; acc: 54.1; ppl:   9.9; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  321/ 222/64; 28055/19365 tok/s;     42 sec;
[2024-02-26 19:15:57,962 INFO] Step 7800/11800; acc: 51.6; ppl:  13.7; xent: 2.6; lr: 1.00000; sents:    3200; bsz:  311/ 217/64; 25731/17937 tok/s;     42 sec;
[2024-02-26 19:16:01,731 INFO] valid stats calculation
                           took: 3.768343448638916 s.
[2024-02-26 19:16:01,731 INFO] Train perplexity: 41.0767
[2024-02-26 19:16:01,731 INFO] Train accuracy: 41.0152
[2024-02-26 19:16:01,731 INFO] Sentences processed: 63950
[2024-02-26 19:16:01,731 INFO] Average bsz:  308/ 217/64
[2024-02-26 19:16:01,731 INFO] Validation perplexity: 321.343
[2024-02-26 19:16:01,731 INFO] Validation accuracy: 18.9716
[2024-02-26 19:16:01,733 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_7800.pt
[2024-02-26 19:16:02,456 INFO] Step 7850/11800; acc: 61.7; ppl:   5.3; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  271/ 197/64; 3019/2197 tok/s;     47 sec;
[2024-02-26 19:16:03,087 INFO] Step 7900/11800; acc: 49.9; ppl:  16.8; xent: 2.8; lr: 1.00000; sents:    3200; bsz:  324/ 223/64; 25655/17707 tok/s;     47 sec;
[2024-02-26 19:16:03,651 INFO] Step 7950/11800; acc: 56.1; ppl:  10.1; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  314/ 209/64; 27917/18538 tok/s;     48 sec;
[2024-02-26 19:16:04,187 INFO] Step 8000/11800; acc: 60.0; ppl:   5.9; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  289/ 203/64; 26973/18928 tok/s;     48 sec;
[2024-02-26 19:16:07,940 INFO] valid stats calculation
                           took: 3.753129005432129 s.
[2024-02-26 19:16:07,941 INFO] Train perplexity: 32.0237
[2024-02-26 19:16:07,941 INFO] Train accuracy: 43.5379
[2024-02-26 19:16:07,941 INFO] Sentences processed: 76750
[2024-02-26 19:16:07,941 INFO] Average bsz:  307/ 216/64
[2024-02-26 19:16:07,941 INFO] Validation perplexity: 305.606
[2024-02-26 19:16:07,941 INFO] Validation accuracy: 18.1315
[2024-02-26 19:16:07,943 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_8000.pt
[2024-02-26 19:16:08,737 INFO] Step 8050/11800; acc: 65.1; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  303/ 228/64; 3334/2502 tok/s;     53 sec;
[2024-02-26 19:16:09,357 INFO] Step 8100/11800; acc: 55.6; ppl:   9.4; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  334/ 244/64; 26960/19716 tok/s;     54 sec;
[2024-02-26 19:16:09,931 INFO] Step 8150/11800; acc: 62.9; ppl:   5.6; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  299/ 216/64; 26093/18832 tok/s;     54 sec;
[2024-02-26 19:16:10,514 INFO] Step 8200/11800; acc: 59.5; ppl:   7.6; xent: 2.0; lr: 1.00000; sents:    3200; bsz:  316/ 222/64; 27105/19070 tok/s;     55 sec;
[2024-02-26 19:16:14,278 INFO] valid stats calculation
                           took: 3.7632851600646973 s.
[2024-02-26 19:16:14,278 INFO] Train perplexity: 25.0752
[2024-02-26 19:16:14,278 INFO] Train accuracy: 46.098
[2024-02-26 19:16:14,278 INFO] Sentences processed: 89550
[2024-02-26 19:16:14,278 INFO] Average bsz:  308/ 218/64
[2024-02-26 19:16:14,278 INFO] Validation perplexity: 362.722
[2024-02-26 19:16:14,278 INFO] Validation accuracy: 18.4084
[2024-02-26 19:16:14,281 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_8200.pt
[2024-02-26 19:16:15,001 INFO] Step 8250/11800; acc: 70.7; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  294/ 198/64; 3281/2211 tok/s;     59 sec;
[2024-02-26 19:16:15,553 INFO] Step 8300/11800; acc: 67.5; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  294/ 221/64; 26679/20055 tok/s;     60 sec;
[2024-02-26 19:16:16,068 INFO] Step 8350/11800; acc: 71.1; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  266/ 195/64; 25864/18929 tok/s;     60 sec;
[2024-02-26 19:16:16,643 INFO] Step 8400/11800; acc: 64.7; ppl:   6.9; xent: 1.9; lr: 1.00000; sents:    3200; bsz:  318/ 225/64; 27606/19569 tok/s;     61 sec;
[2024-02-26 19:16:20,387 INFO] valid stats calculation
                           took: 3.743408679962158 s.
[2024-02-26 19:16:20,387 INFO] Train perplexity: 20.1691
[2024-02-26 19:16:20,388 INFO] Train accuracy: 48.7901
[2024-02-26 19:16:20,388 INFO] Sentences processed: 102350
[2024-02-26 19:16:20,388 INFO] Average bsz:  306/ 217/64
[2024-02-26 19:16:20,388 INFO] Validation perplexity: 416.489
[2024-02-26 19:16:20,388 INFO] Validation accuracy: 17.5406
[2024-02-26 19:16:20,390 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_8400.pt
[2024-02-26 19:16:21,219 INFO] Step 8450/11800; acc: 66.1; ppl:   5.8; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  320/ 224/64; 3503/2447 tok/s;     65 sec;
[2024-02-26 19:16:21,725 INFO] Step 8500/11800; acc: 75.4; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  255/ 189/64; 25150/18705 tok/s;     66 sec;
[2024-02-26 19:16:22,282 INFO] Step 8550/11800; acc: 70.9; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  286/ 212/64; 25703/19015 tok/s;     66 sec;
[2024-02-26 19:16:22,934 INFO] Step 8600/11800; acc: 60.5; ppl:   8.7; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  373/ 254/64; 28647/19479 tok/s;     67 sec;
[2024-02-26 19:16:26,714 INFO] valid stats calculation
                           took: 3.7797555923461914 s.
[2024-02-26 19:16:26,714 INFO] Train perplexity: 17.1715
[2024-02-26 19:16:26,714 INFO] Train accuracy: 50.9088
[2024-02-26 19:16:26,714 INFO] Sentences processed: 115150
[2024-02-26 19:16:26,714 INFO] Average bsz:  306/ 217/64
[2024-02-26 19:16:26,714 INFO] Validation perplexity: 629.554
[2024-02-26 19:16:26,714 INFO] Validation accuracy: 16.9682
[2024-02-26 19:16:26,717 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_8600.pt
[2024-02-26 19:16:27,537 INFO] Step 8650/11800; acc: 60.5; ppl:   8.3; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  304/ 233/64; 3302/2531 tok/s;     72 sec;
[2024-02-26 19:16:28,092 INFO] Step 8700/11800; acc: 72.5; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  317/ 213/64; 28621/19221 tok/s;     72 sec;
[2024-02-26 19:16:28,683 INFO] Step 8750/11800; acc: 63.4; ppl:   7.7; xent: 2.0; lr: 1.00000; sents:    3200; bsz:  302/ 232/64; 25580/19627 tok/s;     73 sec;
[2024-02-26 19:16:29,223 INFO] Step 8800/11800; acc: 79.0; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  300/ 205/64; 27762/18962 tok/s;     73 sec;
[2024-02-26 19:16:32,958 INFO] valid stats calculation
                           took: 3.7346620559692383 s.
[2024-02-26 19:16:32,958 INFO] Train perplexity: 15.1027
[2024-02-26 19:16:32,958 INFO] Train accuracy: 52.6909
[2024-02-26 19:16:32,958 INFO] Sentences processed: 127950
[2024-02-26 19:16:32,958 INFO] Average bsz:  306/ 217/64
[2024-02-26 19:16:32,958 INFO] Validation perplexity: 370.854
[2024-02-26 19:16:32,958 INFO] Validation accuracy: 18.8054
[2024-02-26 19:16:32,960 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_8800.pt
[2024-02-26 19:16:33,730 INFO] Step 8850/11800; acc: 69.9; ppl:   4.3; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  282/ 214/64; 3130/2369 tok/s;     78 sec;
[2024-02-26 19:16:34,263 INFO] Step 8900/11800; acc: 81.3; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  273/ 204/64; 25569/19152 tok/s;     78 sec;
[2024-02-26 19:16:34,773 INFO] Step 8950/11800; acc: 83.1; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  283/ 184/64; 27762/18089 tok/s;     79 sec;
[2024-02-26 19:16:35,317 INFO] Step 9000/11800; acc: 77.6; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  292/ 212/64; 26804/19445 tok/s;     79 sec;
[2024-02-26 19:16:39,084 INFO] valid stats calculation
                           took: 3.766461133956909 s.
[2024-02-26 19:16:39,084 INFO] Train perplexity: 12.9855
[2024-02-26 19:16:39,084 INFO] Train accuracy: 54.8354
[2024-02-26 19:16:39,084 INFO] Sentences processed: 140750
[2024-02-26 19:16:39,084 INFO] Average bsz:  304/ 216/64
[2024-02-26 19:16:39,085 INFO] Validation perplexity: 429.879
[2024-02-26 19:16:39,085 INFO] Validation accuracy: 18.8054
[2024-02-26 19:16:39,087 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_9000.pt
[2024-02-26 19:16:39,934 INFO] Step 9050/11800; acc: 73.5; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  355/ 247/64; 3850/2672 tok/s;     84 sec;
[2024-02-26 19:16:40,505 INFO] Step 9100/11800; acc: 77.6; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  315/ 227/64; 27579/19875 tok/s;     85 sec;
[2024-02-26 19:16:41,105 INFO] Step 9150/11800; acc: 71.9; ppl:   4.4; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  304/ 226/64; 25385/18850 tok/s;     85 sec;
[2024-02-26 19:16:41,677 INFO] Step 9200/11800; acc: 75.7; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  321/ 218/64; 28100/19087 tok/s;     86 sec;
[2024-02-26 19:16:45,419 INFO] valid stats calculation
                           took: 3.7422945499420166 s.
[2024-02-26 19:16:45,420 INFO] Train perplexity: 11.6082
[2024-02-26 19:16:45,420 INFO] Train accuracy: 56.5792
[2024-02-26 19:16:45,420 INFO] Sentences processed: 153550
[2024-02-26 19:16:45,420 INFO] Average bsz:  306/ 217/64
[2024-02-26 19:16:45,420 INFO] Validation perplexity: 1361.29
[2024-02-26 19:16:45,420 INFO] Validation accuracy: 18.5838
[2024-02-26 19:16:45,422 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_9200.pt
[2024-02-26 19:16:46,174 INFO] Step 9250/11800; acc: 81.9; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  284/ 208/64; 3153/2308 tok/s;     90 sec;
[2024-02-26 19:16:46,726 INFO] Step 9300/11800; acc: 86.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  314/ 212/64; 28442/19271 tok/s;     91 sec;
[2024-02-26 19:16:47,321 INFO] Step 9350/11800; acc: 82.9; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  304/ 212/64; 25571/17803 tok/s;     91 sec;
[2024-02-26 19:16:47,921 INFO] Step 9400/11800; acc: 79.6; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  325/ 242/64; 27107/20219 tok/s;     92 sec;
[2024-02-26 19:16:51,760 INFO] valid stats calculation
                           took: 3.838776111602783 s.
[2024-02-26 19:16:51,760 INFO] Train perplexity: 10.2078
[2024-02-26 19:16:51,760 INFO] Train accuracy: 58.586
[2024-02-26 19:16:51,760 INFO] Sentences processed: 166350
[2024-02-26 19:16:51,760 INFO] Average bsz:  306/ 217/64
[2024-02-26 19:16:51,760 INFO] Validation perplexity: 498.482
[2024-02-26 19:16:51,760 INFO] Validation accuracy: 18.2053
[2024-02-26 19:16:51,763 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_9400.pt
[2024-02-26 19:16:52,527 INFO] Step 9450/11800; acc: 83.6; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  306/ 192/64; 3320/2084 tok/s;     97 sec;
[2024-02-26 19:16:53,048 INFO] Step 9500/11800; acc: 88.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  288/ 191/64; 27661/18318 tok/s;     97 sec;
[2024-02-26 19:16:53,699 INFO] Step 9550/11800; acc: 64.7; ppl:  10.4; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  376/ 257/64; 28951/19788 tok/s;     98 sec;
[2024-02-26 19:16:54,353 INFO] Step 9600/11800; acc: 77.8; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  346/ 251/64; 26414/19171 tok/s;     99 sec;
[2024-02-26 19:16:58,085 INFO] valid stats calculation
                           took: 3.7310118675231934 s.
[2024-02-26 19:16:58,085 INFO] Train perplexity: 9.44894
[2024-02-26 19:16:58,085 INFO] Train accuracy: 59.9696
[2024-02-26 19:16:58,085 INFO] Sentences processed: 179150
[2024-02-26 19:16:58,085 INFO] Average bsz:  307/ 218/64
[2024-02-26 19:16:58,085 INFO] Validation perplexity: 708.06
[2024-02-26 19:16:58,085 INFO] Validation accuracy: 18.9346
[2024-02-26 19:16:58,088 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_9600.pt
[2024-02-26 19:16:58,983 INFO] Step 9650/11800; acc: 68.1; ppl:   8.4; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  374/ 269/64; 4038/2904 tok/s;    103 sec;
[2024-02-26 19:16:59,531 INFO] Step 9700/11800; acc: 83.6; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  283/ 190/64; 25875/17380 tok/s;    104 sec;
[2024-02-26 19:17:00,102 INFO] Step 9750/11800; acc: 78.4; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  307/ 215/64; 26907/18841 tok/s;    104 sec;
[2024-02-26 19:17:00,661 INFO] Step 9800/11800; acc: 89.0; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  314/ 212/64; 28079/18924 tok/s;    105 sec;
[2024-02-26 19:17:04,401 INFO] valid stats calculation
                           took: 3.7397992610931396 s.
[2024-02-26 19:17:04,402 INFO] Train perplexity: 8.85397
[2024-02-26 19:17:04,402 INFO] Train accuracy: 61.2521
[2024-02-26 19:17:04,402 INFO] Sentences processed: 191950
[2024-02-26 19:17:04,402 INFO] Average bsz:  308/ 218/64
[2024-02-26 19:17:04,402 INFO] Validation perplexity: 372.575
[2024-02-26 19:17:04,402 INFO] Validation accuracy: 19.1654
[2024-02-26 19:17:04,405 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_9800.pt
[2024-02-26 19:17:05,186 INFO] Step 9850/11800; acc: 86.3; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  305/ 214/64; 3367/2368 tok/s;    109 sec;
[2024-02-26 19:17:05,760 INFO] Step 9900/11800; acc: 85.9; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  306/ 210/64; 26700/18305 tok/s;    110 sec;
[2024-02-26 19:17:06,342 INFO] Step 9950/11800; acc: 79.6; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  321/ 222/64; 27576/19064 tok/s;    110 sec;
[2024-02-26 19:17:06,854 INFO] Step 10000/11800; acc: 84.2; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  288/ 211/64; 28141/20613 tok/s;    111 sec;
[2024-02-26 19:17:10,846 INFO] valid stats calculation
                           took: 3.9915950298309326 s.
[2024-02-26 19:17:10,846 INFO] Train perplexity: 8.16555
[2024-02-26 19:17:10,846 INFO] Train accuracy: 62.6474
[2024-02-26 19:17:10,846 INFO] Sentences processed: 204750
[2024-02-26 19:17:10,846 INFO] Average bsz:  308/ 218/64
[2024-02-26 19:17:10,847 INFO] Validation perplexity: 415.235
[2024-02-26 19:17:10,847 INFO] Validation accuracy: 16.322
[2024-02-26 19:17:10,849 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_10000.pt
[2024-02-26 19:17:11,569 INFO] Step 10050/11800; acc: 91.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  294/ 218/64; 3122/2308 tok/s;    116 sec;
[2024-02-26 19:17:12,116 INFO] Step 10100/11800; acc: 84.8; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  296/ 225/64; 27107/20612 tok/s;    116 sec;
[2024-02-26 19:17:12,774 INFO] Step 10150/11800; acc: 76.3; ppl:   4.6; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  382/ 275/64; 28984/20908 tok/s;    117 sec;
[2024-02-26 19:17:13,309 INFO] Step 10200/11800; acc: 86.7; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  294/ 226/64; 27482/21157 tok/s;    117 sec;
[2024-02-26 19:17:17,305 INFO] valid stats calculation
                           took: 3.9963538646698 s.
[2024-02-26 19:17:17,306 INFO] Train perplexity: 7.5584
[2024-02-26 19:17:17,306 INFO] Train accuracy: 64.0252
[2024-02-26 19:17:17,306 INFO] Sentences processed: 217550
[2024-02-26 19:17:17,306 INFO] Average bsz:  309/ 219/64
[2024-02-26 19:17:17,306 INFO] Validation perplexity: 510.18
[2024-02-26 19:17:17,306 INFO] Validation accuracy: 19.4239
[2024-02-26 19:17:17,308 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_10200.pt
[2024-02-26 19:17:18,034 INFO] Step 10250/11800; acc: 88.4; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  301/ 216/64; 3183/2282 tok/s;    122 sec;
[2024-02-26 19:17:21,970 INFO] Step 10300/11800; acc: 90.8; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  308/ 220/64; 3919/2801 tok/s;    126 sec;
[2024-02-26 19:17:22,673 INFO] Step 10350/11800; acc: 88.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3155; bsz:  287/ 197/63; 20404/14029 tok/s;    127 sec;
[2024-02-26 19:17:23,377 INFO] Step 10400/11800; acc: 58.3; ppl:  16.4; xent: 2.8; lr: 1.00000; sents:    3200; bsz:  380/ 258/64; 26967/18340 tok/s;    128 sec;
[2024-02-26 19:17:27,132 INFO] valid stats calculation
                           took: 3.7550830841064453 s.
[2024-02-26 19:17:27,133 INFO] Train perplexity: 7.2203
[2024-02-26 19:17:27,133 INFO] Train accuracy: 64.9379
[2024-02-26 19:17:27,133 INFO] Sentences processed: 230305
[2024-02-26 19:17:27,133 INFO] Average bsz:  309/ 219/64
[2024-02-26 19:17:27,133 INFO] Validation perplexity: 357.892
[2024-02-26 19:17:27,133 INFO] Validation accuracy: 18.9162
[2024-02-26 19:17:27,135 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_10400.pt
[2024-02-26 19:17:27,907 INFO] Step 10450/11800; acc: 77.2; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  282/ 195/64; 3111/2153 tok/s;    132 sec;
[2024-02-26 19:17:28,447 INFO] Step 10500/11800; acc: 93.7; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  311/ 215/64; 28819/19922 tok/s;    133 sec;
[2024-02-26 19:17:28,972 INFO] Step 10550/11800; acc: 91.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  319/ 203/64; 30351/19320 tok/s;    133 sec;
[2024-02-26 19:17:29,670 INFO] Step 10600/11800; acc: 66.1; ppl:   9.4; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  398/ 252/64; 28558/18060 tok/s;    134 sec;
[2024-02-26 19:17:33,399 INFO] valid stats calculation
                           took: 3.729583501815796 s.
[2024-02-26 19:17:33,400 INFO] Train perplexity: 6.902
[2024-02-26 19:17:33,400 INFO] Train accuracy: 65.7961
[2024-02-26 19:17:33,400 INFO] Sentences processed: 243105
[2024-02-26 19:17:33,400 INFO] Average bsz:  310/ 219/64
[2024-02-26 19:17:33,400 INFO] Validation perplexity: 471.597
[2024-02-26 19:17:33,400 INFO] Validation accuracy: 14.6049
[2024-02-26 19:17:33,402 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_10600.pt
[2024-02-26 19:17:34,148 INFO] Step 10650/11800; acc: 87.1; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  287/ 208/64; 3201/2320 tok/s;    138 sec;
[2024-02-26 19:17:34,775 INFO] Step 10700/11800; acc: 75.0; ppl:   4.7; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  358/ 243/64; 28537/19366 tok/s;    139 sec;
[2024-02-26 19:17:35,324 INFO] Step 10750/11800; acc: 87.7; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  323/ 221/64; 29400/20143 tok/s;    139 sec;
[2024-02-26 19:17:35,944 INFO] Step 10800/11800; acc: 74.6; ppl:   5.1; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  343/ 246/64; 27674/19833 tok/s;    140 sec;
[2024-02-26 19:17:39,711 INFO] valid stats calculation
                           took: 3.767030715942383 s.
[2024-02-26 19:17:39,711 INFO] Train perplexity: 6.62867
[2024-02-26 19:17:39,711 INFO] Train accuracy: 66.5746
[2024-02-26 19:17:39,711 INFO] Sentences processed: 255905
[2024-02-26 19:17:39,711 INFO] Average bsz:  311/ 219/64
[2024-02-26 19:17:39,711 INFO] Validation perplexity: 492.537
[2024-02-26 19:17:39,711 INFO] Validation accuracy: 16.7928
[2024-02-26 19:17:39,714 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_10800.pt
[2024-02-26 19:17:40,566 INFO] Step 10850/11800; acc: 72.6; ppl:   5.7; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  365/ 259/64; 3944/2797 tok/s;    145 sec;
[2024-02-26 19:17:41,158 INFO] Step 10900/11800; acc: 89.2; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  335/ 252/64; 28291/21293 tok/s;    145 sec;
[2024-02-26 19:17:41,711 INFO] Step 10950/11800; acc: 89.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  332/ 225/64; 29996/20362 tok/s;    146 sec;
[2024-02-26 19:17:42,341 INFO] Step 11000/11800; acc: 84.9; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  340/ 246/64; 26960/19547 tok/s;    146 sec;
[2024-02-26 19:17:46,099 INFO] valid stats calculation
                           took: 3.7572720050811768 s.
[2024-02-26 19:17:46,099 INFO] Train perplexity: 6.31182
[2024-02-26 19:17:46,100 INFO] Train accuracy: 67.4933
[2024-02-26 19:17:46,100 INFO] Sentences processed: 268705
[2024-02-26 19:17:46,100 INFO] Average bsz:  312/ 221/64
[2024-02-26 19:17:46,100 INFO] Validation perplexity: 335.284
[2024-02-26 19:17:46,100 INFO] Validation accuracy: 18.8331
[2024-02-26 19:17:46,102 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_11000.pt
[2024-02-26 19:17:46,906 INFO] Step 11050/11800; acc: 84.6; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  311/ 240/64; 3409/2633 tok/s;    151 sec;
[2024-02-26 19:17:47,491 INFO] Step 11100/11800; acc: 86.6; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  317/ 228/64; 27091/19465 tok/s;    152 sec;
[2024-02-26 19:17:48,006 INFO] Step 11150/11800; acc: 93.5; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  283/ 188/64; 27535/18272 tok/s;    152 sec;
[2024-02-26 19:17:48,555 INFO] Step 11200/11800; acc: 95.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  310/ 221/64; 28213/20169 tok/s;    153 sec;
[2024-02-26 19:17:52,296 INFO] valid stats calculation
                           took: 3.7411274909973145 s.
[2024-02-26 19:17:52,297 INFO] Train perplexity: 5.96072
[2024-02-26 19:17:52,297 INFO] Train accuracy: 68.5042
[2024-02-26 19:17:52,297 INFO] Sentences processed: 281505
[2024-02-26 19:17:52,297 INFO] Average bsz:  312/ 221/64
[2024-02-26 19:17:52,297 INFO] Validation perplexity: 402.339
[2024-02-26 19:17:52,297 INFO] Validation accuracy: 19.2208
[2024-02-26 19:17:52,299 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_11200.pt
[2024-02-26 19:17:53,099 INFO] Step 11250/11800; acc: 82.4; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  323/ 220/64; 3550/2422 tok/s;    157 sec;
[2024-02-26 19:17:53,674 INFO] Step 11300/11800; acc: 86.8; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  291/ 222/64; 25277/19288 tok/s;    158 sec;
[2024-02-26 19:17:54,205 INFO] Step 11350/11800; acc: 95.3; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  283/ 195/64; 26641/18376 tok/s;    158 sec;
[2024-02-26 19:17:54,806 INFO] Step 11400/11800; acc: 85.3; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  360/ 244/64; 29941/20275 tok/s;    159 sec;
[2024-02-26 19:17:58,575 INFO] valid stats calculation
                           took: 3.7682275772094727 s.
[2024-02-26 19:17:58,575 INFO] Train perplexity: 5.70048
[2024-02-26 19:17:58,575 INFO] Train accuracy: 69.3148
[2024-02-26 19:17:58,575 INFO] Sentences processed: 294305
[2024-02-26 19:17:58,575 INFO] Average bsz:  312/ 221/64
[2024-02-26 19:17:58,575 INFO] Validation perplexity: 764.828
[2024-02-26 19:17:58,575 INFO] Validation accuracy: 16.322
[2024-02-26 19:17:58,578 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_11400.pt
[2024-02-26 19:17:59,349 INFO] Step 11450/11800; acc: 85.8; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  329/ 235/64; 3621/2589 tok/s;    164 sec;
[2024-02-26 19:17:59,888 INFO] Step 11500/11800; acc: 92.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  298/ 216/64; 27663/20074 tok/s;    164 sec;
[2024-02-26 19:18:00,379 INFO] Step 11550/11800; acc: 94.0; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  243/ 177/64; 24786/18031 tok/s;    165 sec;
[2024-02-26 19:18:01,000 INFO] Step 11600/11800; acc: 81.9; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  316/ 245/64; 25445/19727 tok/s;    165 sec;
[2024-02-26 19:18:04,737 INFO] valid stats calculation
                           took: 3.736806631088257 s.
[2024-02-26 19:18:04,737 INFO] Train perplexity: 5.45437
[2024-02-26 19:18:04,737 INFO] Train accuracy: 70.0822
[2024-02-26 19:18:04,738 INFO] Sentences processed: 307105
[2024-02-26 19:18:04,738 INFO] Average bsz:  312/ 220/64
[2024-02-26 19:18:04,738 INFO] Validation perplexity: 517.908
[2024-02-26 19:18:04,738 INFO] Validation accuracy: 17.3191
[2024-02-26 19:18:04,740 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_11600.pt
[2024-02-26 19:18:05,524 INFO] Step 11650/11800; acc: 87.1; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  300/ 223/64; 3314/2466 tok/s;    170 sec;
[2024-02-26 19:18:06,040 INFO] Step 11700/11800; acc: 90.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  261/ 198/64; 25320/19168 tok/s;    170 sec;
[2024-02-26 19:18:06,579 INFO] Step 11750/11800; acc: 95.5; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  291/ 216/64; 26985/20073 tok/s;    171 sec;
[2024-02-26 19:18:07,102 INFO] Step 11800/11800; acc: 92.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  287/ 195/64; 27416/18676 tok/s;    171 sec;
[2024-02-26 19:18:10,853 INFO] valid stats calculation
                           took: 3.7512667179107666 s.
[2024-02-26 19:18:10,854 INFO] Train perplexity: 5.21366
[2024-02-26 19:18:10,854 INFO] Train accuracy: 70.8841
[2024-02-26 19:18:10,854 INFO] Sentences processed: 319905
[2024-02-26 19:18:10,854 INFO] Average bsz:  310/ 220/64
[2024-02-26 19:18:10,854 INFO] Validation perplexity: 339.514
[2024-02-26 19:18:10,854 INFO] Validation accuracy: 18.2422
[2024-02-26 19:18:10,856 INFO] Saving checkpoint tg-ft-both/tg-finetune_6800_03_step_11800.pt
