[2024-02-28 11:14:17,169 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-02-28 11:14:17,169 INFO] Parsed 2 corpora from -data.
[2024-02-28 11:14:17,169 INFO] Loading checkpoint from tg-pretrain/models/enc/tg-pretrain_03_step_9800.pt
[2024-02-28 11:14:17,284 INFO] Building model...
[2024-02-28 11:14:17,341 INFO] Switching model to float32 for amp/apex_amp
[2024-02-28 11:14:17,341 INFO] Non quantized layer compute is fp32
[2024-02-28 11:14:19,184 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(32768, 320, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(320, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(25208, 320, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(820, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=25208, bias=True)
)
[2024-02-28 11:14:19,184 INFO] encoder: 14133760
[2024-02-28 11:14:19,184 INFO] decoder: 26093768
[2024-02-28 11:14:19,184 INFO] * number of parameters: 40227528
[2024-02-28 11:14:19,184 INFO] Trainable parameters = {'torch.float32': 40227528, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-02-28 11:14:19,184 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-02-28 11:14:19,184 INFO]  * src vocab size = 32768
[2024-02-28 11:14:19,184 INFO]  * tgt vocab size = 25208
[2024-02-28 11:14:19,186 INFO] Starting training on GPU: [0]
[2024-02-28 11:14:19,186 INFO] Start training loop and validate every 200 steps...
[2024-02-28 11:14:19,186 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-02-28 11:14:34,379 INFO] Step 9850/14800; acc: 26.7; ppl: 1798.3; xent: 7.5; lr: 1.00000; sents:    3200; bsz:  282/ 203/64; 926/670 tok/s;     15 sec;
[2024-02-28 11:14:34,923 INFO] Step 9900/14800; acc: 26.5; ppl: 389.2; xent: 6.0; lr: 1.00000; sents:    3200; bsz:  343/ 223/64; 31543/20505 tok/s;     16 sec;
[2024-02-28 11:14:35,426 INFO] Step 9950/14800; acc: 34.5; ppl: 131.3; xent: 4.9; lr: 1.00000; sents:    3200; bsz:  292/ 192/64; 29013/19088 tok/s;     16 sec;
[2024-02-28 11:14:35,953 INFO] Step 10000/14800; acc: 32.9; ppl: 121.9; xent: 4.8; lr: 1.00000; sents:    3200; bsz:  287/ 210/64; 27224/19913 tok/s;     17 sec;
[2024-02-28 11:14:39,658 INFO] valid stats calculation
                           took: 3.705188035964966 s.
[2024-02-28 11:14:39,659 INFO] Train perplexity: 328.439
[2024-02-28 11:14:39,659 INFO] Train accuracy: 30.0273
[2024-02-28 11:14:39,659 INFO] Sentences processed: 12800
[2024-02-28 11:14:39,659 INFO] Average bsz:  301/ 207/64
[2024-02-28 11:14:39,659 INFO] Validation perplexity: 695.37
[2024-02-28 11:14:39,659 INFO] Validation accuracy: 17.2544
[2024-02-28 11:14:39,662 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_10000.pt
[2024-02-28 11:14:40,414 INFO] Step 10050/14800; acc: 34.3; ppl:  85.7; xent: 4.5; lr: 1.00000; sents:    3200; bsz:  301/ 204/64; 3377/2286 tok/s;     21 sec;
[2024-02-28 11:14:41,066 INFO] Step 10100/14800; acc: 27.3; ppl: 159.6; xent: 5.1; lr: 1.00000; sents:    3200; bsz:  372/ 257/64; 28554/19730 tok/s;     22 sec;
[2024-02-28 11:14:41,793 INFO] Step 10150/14800; acc: 28.5; ppl: 119.4; xent: 4.8; lr: 1.00000; sents:    3150; bsz:  379/ 264/63; 26103/18181 tok/s;     23 sec;
[2024-02-28 11:14:42,516 INFO] Step 10200/14800; acc: 28.8; ppl: 133.0; xent: 4.9; lr: 1.00000; sents:    3200; bsz:  392/ 265/64; 27069/18339 tok/s;     23 sec;
[2024-02-28 11:14:46,229 INFO] valid stats calculation
                           took: 3.712280750274658 s.
[2024-02-28 11:14:46,229 INFO] Train perplexity: 193.027
[2024-02-28 11:14:46,229 INFO] Train accuracy: 29.7175
[2024-02-28 11:14:46,229 INFO] Sentences processed: 25550
[2024-02-28 11:14:46,229 INFO] Average bsz:  331/ 227/64
[2024-02-28 11:14:46,229 INFO] Validation perplexity: 330.977
[2024-02-28 11:14:46,229 INFO] Validation accuracy: 17.6052
[2024-02-28 11:14:46,231 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_10200.pt
[2024-02-28 11:14:47,052 INFO] Step 10250/14800; acc: 33.3; ppl:  55.2; xent: 4.0; lr: 1.00000; sents:    3200; bsz:  345/ 262/64; 3803/2882 tok/s;     28 sec;
[2024-02-28 11:14:47,640 INFO] Step 10300/14800; acc: 36.1; ppl:  42.4; xent: 3.7; lr: 1.00000; sents:    3200; bsz:  295/ 233/64; 25062/19833 tok/s;     28 sec;
[2024-02-28 11:14:48,179 INFO] Step 10350/14800; acc: 42.9; ppl:  20.1; xent: 3.0; lr: 1.00000; sents:    3200; bsz:  326/ 213/64; 30278/19759 tok/s;     29 sec;
[2024-02-28 11:14:48,739 INFO] Step 10400/14800; acc: 43.4; ppl:  26.0; xent: 3.3; lr: 1.00000; sents:    3200; bsz:  332/ 209/64; 29608/18666 tok/s;     30 sec;
[2024-02-28 11:14:52,447 INFO] valid stats calculation
                           took: 3.7075092792510986 s.
[2024-02-28 11:14:52,448 INFO] Train perplexity: 108.297
[2024-02-28 11:14:52,448 INFO] Train accuracy: 32.6663
[2024-02-28 11:14:52,448 INFO] Sentences processed: 38350
[2024-02-28 11:14:52,448 INFO] Average bsz:  329/ 228/64
[2024-02-28 11:14:52,448 INFO] Validation perplexity: 383.68
[2024-02-28 11:14:52,448 INFO] Validation accuracy: 17.6699
[2024-02-28 11:14:52,450 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_10400.pt
[2024-02-28 11:14:53,218 INFO] Step 10450/14800; acc: 41.2; ppl:  29.9; xent: 3.4; lr: 1.00000; sents:    3200; bsz:  311/ 216/64; 3478/2412 tok/s;     34 sec;
[2024-02-28 11:14:53,745 INFO] Step 10500/14800; acc: 48.9; ppl:  12.7; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  282/ 203/64; 26699/19283 tok/s;     35 sec;
[2024-02-28 11:14:54,248 INFO] Step 10550/14800; acc: 50.4; ppl:  11.9; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  255/ 191/64; 25344/19006 tok/s;     35 sec;
[2024-02-28 11:14:54,787 INFO] Step 10600/14800; acc: 50.1; ppl:  10.3; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  310/ 220/64; 28760/20441 tok/s;     36 sec;
[2024-02-28 11:14:58,512 INFO] valid stats calculation
                           took: 3.7255351543426514 s.
[2024-02-28 11:14:58,513 INFO] Train perplexity: 68.1321
[2024-02-28 11:14:58,513 INFO] Train accuracy: 36.1339
[2024-02-28 11:14:58,513 INFO] Sentences processed: 51150
[2024-02-28 11:14:58,513 INFO] Average bsz:  319/ 223/64
[2024-02-28 11:14:58,513 INFO] Validation perplexity: 349.684
[2024-02-28 11:14:58,513 INFO] Validation accuracy: 18.8977
[2024-02-28 11:14:58,515 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_10600.pt
[2024-02-28 11:14:59,293 INFO] Step 10650/14800; acc: 49.3; ppl:  14.4; xent: 2.7; lr: 1.00000; sents:    3200; bsz:  318/ 220/64; 3523/2437 tok/s;     40 sec;
[2024-02-28 11:14:59,884 INFO] Step 10700/14800; acc: 51.2; ppl:  11.3; xent: 2.4; lr: 1.00000; sents:    3200; bsz:  340/ 236/64; 28810/19940 tok/s;     41 sec;
[2024-02-28 11:15:00,411 INFO] Step 10750/14800; acc: 59.8; ppl:   5.4; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  285/ 210/64; 27102/19932 tok/s;     41 sec;
[2024-02-28 11:15:00,984 INFO] Step 10800/14800; acc: 53.2; ppl:  11.0; xent: 2.4; lr: 1.00000; sents:    3200; bsz:  287/ 205/64; 25007/17874 tok/s;     42 sec;
[2024-02-28 11:15:04,703 INFO] valid stats calculation
                           took: 3.7185120582580566 s.
[2024-02-28 11:15:04,704 INFO] Train perplexity: 46.7619
[2024-02-28 11:15:04,704 INFO] Train accuracy: 39.4948
[2024-02-28 11:15:04,704 INFO] Sentences processed: 63950
[2024-02-28 11:15:04,704 INFO] Average bsz:  317/ 222/64
[2024-02-28 11:15:04,704 INFO] Validation perplexity: 300.005
[2024-02-28 11:15:04,704 INFO] Validation accuracy: 18.9808
[2024-02-28 11:15:04,706 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_10800.pt
[2024-02-28 11:15:05,431 INFO] Step 10850/14800; acc: 57.0; ppl:   8.5; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  287/ 200/64; 3224/2251 tok/s;     46 sec;
[2024-02-28 11:15:05,953 INFO] Step 10900/14800; acc: 61.9; ppl:   4.6; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  278/ 198/64; 26602/19002 tok/s;     47 sec;
[2024-02-28 11:15:06,575 INFO] Step 10950/14800; acc: 55.5; ppl:   9.0; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  317/ 242/64; 25509/19451 tok/s;     47 sec;
[2024-02-28 11:15:07,321 INFO] Step 11000/14800; acc: 47.6; ppl:  22.0; xent: 3.1; lr: 1.00000; sents:    3200; bsz:  372/ 279/64; 24959/18714 tok/s;     48 sec;
[2024-02-28 11:15:11,068 INFO] valid stats calculation
                           took: 3.7468149662017822 s.
[2024-02-28 11:15:11,068 INFO] Train perplexity: 35.9455
[2024-02-28 11:15:11,069 INFO] Train accuracy: 42.1257
[2024-02-28 11:15:11,069 INFO] Sentences processed: 76750
[2024-02-28 11:15:11,069 INFO] Average bsz:  316/ 223/64
[2024-02-28 11:15:11,069 INFO] Validation perplexity: 354.449
[2024-02-28 11:15:11,069 INFO] Validation accuracy: 19.3224
[2024-02-28 11:15:11,071 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_11000.pt
[2024-02-28 11:15:11,845 INFO] Step 11050/14800; acc: 62.4; ppl:   4.7; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  324/ 228/64; 3579/2517 tok/s;     53 sec;
[2024-02-28 11:15:12,388 INFO] Step 11100/14800; acc: 67.1; ppl:   3.5; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  316/ 219/64; 29098/20113 tok/s;     53 sec;
[2024-02-28 11:15:12,943 INFO] Step 11150/14800; acc: 62.5; ppl:   6.6; xent: 1.9; lr: 1.00000; sents:    3200; bsz:  305/ 206/64; 27511/18607 tok/s;     54 sec;
[2024-02-28 11:15:13,515 INFO] Step 11200/14800; acc: 57.6; ppl:   9.4; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  316/ 216/64; 27635/18874 tok/s;     54 sec;
[2024-02-28 11:15:17,248 INFO] valid stats calculation
                           took: 3.732529401779175 s.
[2024-02-28 11:15:17,248 INFO] Train perplexity: 27.7511
[2024-02-28 11:15:17,248 INFO] Train accuracy: 44.9558
[2024-02-28 11:15:17,248 INFO] Sentences processed: 89550
[2024-02-28 11:15:17,248 INFO] Average bsz:  316/ 222/64
[2024-02-28 11:15:17,248 INFO] Validation perplexity: 620.423
[2024-02-28 11:15:17,248 INFO] Validation accuracy: 17.5775
[2024-02-28 11:15:17,251 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_11200.pt
[2024-02-28 11:15:18,033 INFO] Step 11250/14800; acc: 59.2; ppl:   8.6; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  319/ 227/64; 3525/2517 tok/s;     59 sec;
[2024-02-28 11:15:18,567 INFO] Step 11300/14800; acc: 72.1; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  284/ 215/64; 26648/20166 tok/s;     59 sec;
[2024-02-28 11:15:19,079 INFO] Step 11350/14800; acc: 72.6; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  273/ 197/64; 26613/19241 tok/s;     60 sec;
[2024-02-28 11:15:19,619 INFO] Step 11400/14800; acc: 74.8; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  296/ 220/64; 27398/20400 tok/s;     60 sec;
[2024-02-28 11:15:23,372 INFO] valid stats calculation
                           took: 3.7529137134552 s.
[2024-02-28 11:15:23,372 INFO] Train perplexity: 21.6709
[2024-02-28 11:15:23,372 INFO] Train accuracy: 47.9356
[2024-02-28 11:15:23,372 INFO] Sentences processed: 102350
[2024-02-28 11:15:23,372 INFO] Average bsz:  313/ 221/64
[2024-02-28 11:15:23,373 INFO] Validation perplexity: 399.488
[2024-02-28 11:15:23,373 INFO] Validation accuracy: 18.6761
[2024-02-28 11:15:23,375 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_11400.pt
[2024-02-28 11:15:24,129 INFO] Step 11450/14800; acc: 70.9; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  302/ 203/64; 3349/2246 tok/s;     65 sec;
[2024-02-28 11:15:24,676 INFO] Step 11500/14800; acc: 74.0; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  306/ 222/64; 28009/20362 tok/s;     65 sec;
[2024-02-28 11:15:25,237 INFO] Step 11550/14800; acc: 67.1; ppl:   6.1; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  284/ 196/64; 25357/17515 tok/s;     66 sec;
[2024-02-28 11:15:25,860 INFO] Step 11600/14800; acc: 62.0; ppl:   9.3; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  326/ 241/64; 26150/19362 tok/s;     67 sec;
[2024-02-28 11:15:29,645 INFO] valid stats calculation
                           took: 3.7848265171051025 s.
[2024-02-28 11:15:29,646 INFO] Train perplexity: 18.4994
[2024-02-28 11:15:29,646 INFO] Train accuracy: 50.1514
[2024-02-28 11:15:29,646 INFO] Sentences processed: 115150
[2024-02-28 11:15:29,646 INFO] Average bsz:  312/ 221/64
[2024-02-28 11:15:29,646 INFO] Validation perplexity: 385.616
[2024-02-28 11:15:29,646 INFO] Validation accuracy: 20.0055
[2024-02-28 11:15:29,648 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_11600.pt
[2024-02-28 11:15:30,392 INFO] Step 11650/14800; acc: 79.6; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  306/ 221/64; 3376/2444 tok/s;     71 sec;
[2024-02-28 11:15:31,059 INFO] Step 11700/14800; acc: 62.6; ppl:   8.9; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  376/ 254/64; 28192/18998 tok/s;     72 sec;
[2024-02-28 11:15:31,629 INFO] Step 11750/14800; acc: 68.0; ppl:   5.2; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  299/ 225/64; 26197/19749 tok/s;     72 sec;
[2024-02-28 11:15:32,169 INFO] Step 11800/14800; acc: 80.3; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  301/ 213/64; 27896/19746 tok/s;     73 sec;
[2024-02-28 11:15:35,897 INFO] valid stats calculation
                           took: 3.728567600250244 s.
[2024-02-28 11:15:35,898 INFO] Train perplexity: 15.7215
[2024-02-28 11:15:35,898 INFO] Train accuracy: 52.4227
[2024-02-28 11:15:35,898 INFO] Sentences processed: 127950
[2024-02-28 11:15:35,898 INFO] Average bsz:  313/ 221/64
[2024-02-28 11:15:35,898 INFO] Validation perplexity: 416.643
[2024-02-28 11:15:35,898 INFO] Validation accuracy: 19.5439
[2024-02-28 11:15:35,900 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_11800.pt
[2024-02-28 11:15:36,659 INFO] Step 11850/14800; acc: 78.7; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  289/ 214/64; 3221/2380 tok/s;     77 sec;
[2024-02-28 11:15:37,244 INFO] Step 11900/14800; acc: 73.1; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  321/ 239/64; 27416/20439 tok/s;     78 sec;
[2024-02-28 11:15:37,783 INFO] Step 11950/14800; acc: 79.7; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  275/ 183/64; 25477/16985 tok/s;     79 sec;
[2024-02-28 11:15:38,300 INFO] Step 12000/14800; acc: 80.2; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  292/ 199/64; 28271/19282 tok/s;     79 sec;
[2024-02-28 11:15:41,995 INFO] valid stats calculation
                           took: 3.6951346397399902 s.
[2024-02-28 11:15:41,996 INFO] Train perplexity: 13.5286
[2024-02-28 11:15:41,996 INFO] Train accuracy: 54.5969
[2024-02-28 11:15:41,996 INFO] Sentences processed: 140750
[2024-02-28 11:15:41,996 INFO] Average bsz:  311/ 220/64
[2024-02-28 11:15:41,996 INFO] Validation perplexity: 398.703
[2024-02-28 11:15:41,996 INFO] Validation accuracy: 19.5255
[2024-02-28 11:15:41,998 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_12000.pt
[2024-02-28 11:15:42,737 INFO] Step 12050/14800; acc: 81.0; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  293/ 220/64; 3303/2477 tok/s;     84 sec;
[2024-02-28 11:15:43,270 INFO] Step 12100/14800; acc: 85.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  316/ 214/64; 29684/20070 tok/s;     84 sec;
[2024-02-28 11:15:43,797 INFO] Step 12150/14800; acc: 85.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  297/ 209/64; 28181/19866 tok/s;     85 sec;
[2024-02-28 11:15:44,341 INFO] Step 12200/14800; acc: 79.6; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  309/ 214/64; 28398/19693 tok/s;     85 sec;
[2024-02-28 11:15:48,118 INFO] valid stats calculation
                           took: 3.7760021686553955 s.
[2024-02-28 11:15:48,118 INFO] Train perplexity: 11.5936
[2024-02-28 11:15:48,118 INFO] Train accuracy: 56.9082
[2024-02-28 11:15:48,118 INFO] Sentences processed: 153550
[2024-02-28 11:15:48,118 INFO] Average bsz:  311/ 220/64
[2024-02-28 11:15:48,118 INFO] Validation perplexity: 368.374
[2024-02-28 11:15:48,118 INFO] Validation accuracy: 17.5129
[2024-02-28 11:15:48,120 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_12200.pt
[2024-02-28 11:15:48,873 INFO] Step 12250/14800; acc: 80.1; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  279/ 197/64; 3082/2169 tok/s;     90 sec;
[2024-02-28 11:15:49,439 INFO] Step 12300/14800; acc: 72.9; ppl:   5.0; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  314/ 218/64; 27789/19243 tok/s;     90 sec;
[2024-02-28 11:15:50,012 INFO] Step 12350/14800; acc: 79.2; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  295/ 212/64; 25751/18517 tok/s;     91 sec;
[2024-02-28 11:15:50,524 INFO] Step 12400/14800; acc: 88.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  280/ 197/64; 27412/19276 tok/s;     91 sec;
[2024-02-28 11:15:54,238 INFO] valid stats calculation
                           took: 3.7136600017547607 s.
[2024-02-28 11:15:54,238 INFO] Train perplexity: 10.4587
[2024-02-28 11:15:54,238 INFO] Train accuracy: 58.5732
[2024-02-28 11:15:54,238 INFO] Sentences processed: 166350
[2024-02-28 11:15:54,238 INFO] Average bsz:  309/ 219/64
[2024-02-28 11:15:54,238 INFO] Validation perplexity: 479.483
[2024-02-28 11:15:54,238 INFO] Validation accuracy: 17.8545
[2024-02-28 11:15:54,241 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_12400.pt
[2024-02-28 11:15:54,986 INFO] Step 12450/14800; acc: 78.8; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  294/ 221/64; 3299/2472 tok/s;     96 sec;
[2024-02-28 11:15:55,559 INFO] Step 12500/14800; acc: 78.9; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  305/ 237/64; 26610/20695 tok/s;     96 sec;
[2024-02-28 11:15:56,073 INFO] Step 12550/14800; acc: 84.1; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  252/ 199/64; 24516/19342 tok/s;     97 sec;
[2024-02-28 11:15:56,637 INFO] Step 12600/14800; acc: 83.8; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  291/ 228/64; 25804/20263 tok/s;     97 sec;
[2024-02-28 11:16:00,363 INFO] valid stats calculation
                           took: 3.726290702819824 s.
[2024-02-28 11:16:00,364 INFO] Train perplexity: 9.44319
[2024-02-28 11:16:00,364 INFO] Train accuracy: 60.2131
[2024-02-28 11:16:00,364 INFO] Sentences processed: 179150
[2024-02-28 11:16:00,364 INFO] Average bsz:  308/ 219/64
[2024-02-28 11:16:00,364 INFO] Validation perplexity: 417.808
[2024-02-28 11:16:00,364 INFO] Validation accuracy: 19.5532
[2024-02-28 11:16:00,366 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_12600.pt
[2024-02-28 11:16:01,194 INFO] Step 12650/14800; acc: 77.8; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  330/ 225/64; 3625/2470 tok/s;    102 sec;
[2024-02-28 11:16:01,750 INFO] Step 12700/14800; acc: 89.5; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  319/ 230/64; 28690/20740 tok/s;    103 sec;
[2024-02-28 11:16:02,292 INFO] Step 12750/14800; acc: 80.9; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  305/ 211/64; 28116/19494 tok/s;    103 sec;
[2024-02-28 11:16:02,841 INFO] Step 12800/14800; acc: 90.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  319/ 225/64; 29046/20531 tok/s;    104 sec;
[2024-02-28 11:16:06,665 INFO] valid stats calculation
                           took: 3.8238351345062256 s.
[2024-02-28 11:16:06,665 INFO] Train perplexity: 8.52298
[2024-02-28 11:16:06,665 INFO] Train accuracy: 61.8726
[2024-02-28 11:16:06,665 INFO] Sentences processed: 191950
[2024-02-28 11:16:06,665 INFO] Average bsz:  308/ 219/64
[2024-02-28 11:16:06,665 INFO] Validation perplexity: 505.563
[2024-02-28 11:16:06,665 INFO] Validation accuracy: 17.0975
[2024-02-28 11:16:06,668 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_12800.pt
[2024-02-28 11:16:07,441 INFO] Step 12850/14800; acc: 75.9; ppl:   4.4; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  330/ 226/64; 3592/2459 tok/s;    108 sec;
[2024-02-28 11:16:07,947 INFO] Step 12900/14800; acc: 88.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  308/ 202/64; 30463/19942 tok/s;    109 sec;
[2024-02-28 11:16:08,481 INFO] Step 12950/14800; acc: 85.4; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  326/ 234/64; 30566/21890 tok/s;    109 sec;
[2024-02-28 11:16:08,990 INFO] Step 13000/14800; acc: 87.4; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  305/ 206/64; 29941/20262 tok/s;    110 sec;
[2024-02-28 11:16:12,954 INFO] valid stats calculation
                           took: 3.9634878635406494 s.
[2024-02-28 11:16:12,955 INFO] Train perplexity: 7.87158
[2024-02-28 11:16:12,955 INFO] Train accuracy: 63.2551
[2024-02-28 11:16:12,955 INFO] Sentences processed: 204750
[2024-02-28 11:16:12,955 INFO] Average bsz:  309/ 219/64
[2024-02-28 11:16:12,955 INFO] Validation perplexity: 420.332
[2024-02-28 11:16:12,955 INFO] Validation accuracy: 18.0484
[2024-02-28 11:16:12,957 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_13000.pt
[2024-02-28 11:16:13,639 INFO] Step 13050/14800; acc: 92.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  293/ 205/64; 3153/2203 tok/s;    114 sec;
[2024-02-28 11:16:14,249 INFO] Step 13100/14800; acc: 76.6; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  325/ 224/64; 26651/18362 tok/s;    115 sec;
[2024-02-28 11:16:14,784 INFO] Step 13150/14800; acc: 87.2; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  298/ 228/64; 27893/21337 tok/s;    116 sec;
[2024-02-28 11:16:15,320 INFO] Step 13200/14800; acc: 81.9; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  292/ 214/64; 27280/20006 tok/s;    116 sec;
[2024-02-28 11:16:19,294 INFO] valid stats calculation
                           took: 3.9741287231445312 s.
[2024-02-28 11:16:19,295 INFO] Train perplexity: 7.3271
[2024-02-28 11:16:19,295 INFO] Train accuracy: 64.4914
[2024-02-28 11:16:19,295 INFO] Sentences processed: 217550
[2024-02-28 11:16:19,295 INFO] Average bsz:  308/ 219/64
[2024-02-28 11:16:19,295 INFO] Validation perplexity: 3410.89
[2024-02-28 11:16:19,295 INFO] Validation accuracy: 17.4852
[2024-02-28 11:16:19,297 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_13200.pt
[2024-02-28 11:16:19,996 INFO] Step 13250/14800; acc: 83.9; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  302/ 211/64; 3230/2254 tok/s;    121 sec;
[2024-02-28 11:16:23,966 INFO] Step 13300/14800; acc: 84.4; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  301/ 208/64; 3796/2624 tok/s;    125 sec;
[2024-02-28 11:16:24,739 INFO] Step 13350/14800; acc: 73.2; ppl:   5.0; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  369/ 264/64; 23860/17103 tok/s;    126 sec;
[2024-02-28 11:16:25,262 INFO] Step 13400/14800; acc: 93.9; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  305/ 202/64; 29139/19281 tok/s;    126 sec;
[2024-02-28 11:16:29,040 INFO] valid stats calculation
                           took: 3.7776360511779785 s.
[2024-02-28 11:16:29,040 INFO] Train perplexity: 6.92172
[2024-02-28 11:16:29,040 INFO] Train accuracy: 65.5355
[2024-02-28 11:16:29,040 INFO] Sentences processed: 230350
[2024-02-28 11:16:29,040 INFO] Average bsz:  309/ 219/64
[2024-02-28 11:16:29,040 INFO] Validation perplexity: 545.887
[2024-02-28 11:16:29,040 INFO] Validation accuracy: 19.9963
[2024-02-28 11:16:29,043 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_13400.pt
[2024-02-28 11:16:29,799 INFO] Step 13450/14800; acc: 76.6; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  297/ 206/64; 3268/2273 tok/s;    131 sec;
[2024-02-28 11:16:30,349 INFO] Step 13500/14800; acc: 93.2; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  308/ 228/64; 28069/20732 tok/s;    131 sec;
[2024-02-28 11:16:30,892 INFO] Step 13550/14800; acc: 92.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  294/ 218/64; 27131/20098 tok/s;    132 sec;
[2024-02-28 11:16:31,621 INFO] Step 13600/14800; acc: 64.1; ppl:  10.4; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  409/ 291/64; 28019/19955 tok/s;    132 sec;
[2024-02-28 11:16:35,357 INFO] valid stats calculation
                           took: 3.7353944778442383 s.
[2024-02-28 11:16:35,357 INFO] Train perplexity: 6.62546
[2024-02-28 11:16:35,357 INFO] Train accuracy: 66.3718
[2024-02-28 11:16:35,357 INFO] Sentences processed: 243150
[2024-02-28 11:16:35,358 INFO] Average bsz:  310/ 220/64
[2024-02-28 11:16:35,358 INFO] Validation perplexity: 965.904
[2024-02-28 11:16:35,358 INFO] Validation accuracy: 18.7408
[2024-02-28 11:16:35,360 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_13600.pt
[2024-02-28 11:16:36,196 INFO] Step 13650/14800; acc: 78.4; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    3195; bsz:  374/ 245/64; 4089/2682 tok/s;    137 sec;
[2024-02-28 11:16:36,787 INFO] Step 13700/14800; acc: 81.6; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  309/ 238/64; 26114/20162 tok/s;    138 sec;
[2024-02-28 11:16:37,320 INFO] Step 13750/14800; acc: 94.0; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  308/ 209/64; 28969/19593 tok/s;    138 sec;
[2024-02-28 11:16:37,840 INFO] Step 13800/14800; acc: 93.3; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  287/ 200/64; 27548/19185 tok/s;    139 sec;
[2024-02-28 11:16:41,556 INFO] valid stats calculation
                           took: 3.715287208557129 s.
[2024-02-28 11:16:41,556 INFO] Train perplexity: 6.25422
[2024-02-28 11:16:41,556 INFO] Train accuracy: 67.3775
[2024-02-28 11:16:41,556 INFO] Sentences processed: 255945
[2024-02-28 11:16:41,556 INFO] Average bsz:  310/ 220/64
[2024-02-28 11:16:41,556 INFO] Validation perplexity: 584.137
[2024-02-28 11:16:41,557 INFO] Validation accuracy: 20.1532
[2024-02-28 11:16:41,559 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_13800.pt
[2024-02-28 11:16:42,337 INFO] Step 13850/14800; acc: 78.7; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  331/ 246/64; 3681/2733 tok/s;    143 sec;
[2024-02-28 11:16:42,838 INFO] Step 13900/14800; acc: 90.7; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  270/ 185/64; 27006/18469 tok/s;    144 sec;
[2024-02-28 11:16:43,380 INFO] Step 13950/14800; acc: 88.8; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  303/ 202/64; 27955/18634 tok/s;    144 sec;
[2024-02-28 11:16:43,969 INFO] Step 14000/14800; acc: 80.0; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  334/ 236/64; 28361/20072 tok/s;    145 sec;
[2024-02-28 11:16:47,741 INFO] valid stats calculation
                           took: 3.771631956100464 s.
[2024-02-28 11:16:47,741 INFO] Train perplexity: 5.99059
[2024-02-28 11:16:47,741 INFO] Train accuracy: 68.1563
[2024-02-28 11:16:47,741 INFO] Sentences processed: 268745
[2024-02-28 11:16:47,741 INFO] Average bsz:  310/ 220/64
[2024-02-28 11:16:47,741 INFO] Validation perplexity: 441.748
[2024-02-28 11:16:47,741 INFO] Validation accuracy: 19.5901
[2024-02-28 11:16:47,744 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_14000.pt
[2024-02-28 11:16:48,458 INFO] Step 14050/14800; acc: 94.1; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  308/ 201/64; 3436/2238 tok/s;    149 sec;
[2024-02-28 11:16:49,044 INFO] Step 14100/14800; acc: 90.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3155; bsz:  306/ 206/63; 26117/17595 tok/s;    150 sec;
[2024-02-28 11:16:49,582 INFO] Step 14150/14800; acc: 90.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  307/ 205/64; 28541/19052 tok/s;    150 sec;
[2024-02-28 11:16:50,162 INFO] Step 14200/14800; acc: 87.4; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  338/ 225/64; 29134/19405 tok/s;    151 sec;
[2024-02-28 11:16:53,924 INFO] valid stats calculation
                           took: 3.7619144916534424 s.
[2024-02-28 11:16:53,925 INFO] Train perplexity: 5.66903
[2024-02-28 11:16:53,925 INFO] Train accuracy: 69.1274
[2024-02-28 11:16:53,925 INFO] Sentences processed: 281500
[2024-02-28 11:16:53,925 INFO] Average bsz:  311/ 220/64
[2024-02-28 11:16:53,925 INFO] Validation perplexity: 375.044
[2024-02-28 11:16:53,925 INFO] Validation accuracy: 19.507
[2024-02-28 11:16:53,927 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_14200.pt
[2024-02-28 11:16:54,644 INFO] Step 14250/14800; acc: 94.6; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  296/ 202/64; 3299/2256 tok/s;    155 sec;
[2024-02-28 11:16:55,154 INFO] Step 14300/14800; acc: 95.3; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  283/ 184/64; 27723/18064 tok/s;    156 sec;
[2024-02-28 11:16:55,707 INFO] Step 14350/14800; acc: 89.3; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  273/ 211/64; 24690/19126 tok/s;    157 sec;
[2024-02-28 11:16:56,269 INFO] Step 14400/14800; acc: 92.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  296/ 221/64; 26353/19649 tok/s;    157 sec;
[2024-02-28 11:17:00,023 INFO] valid stats calculation
                           took: 3.7536778450012207 s.
[2024-02-28 11:17:00,023 INFO] Train perplexity: 5.36024
[2024-02-28 11:17:00,023 INFO] Train accuracy: 70.0897
[2024-02-28 11:17:00,023 INFO] Sentences processed: 294300
[2024-02-28 11:17:00,023 INFO] Average bsz:  310/ 219/64
[2024-02-28 11:17:00,023 INFO] Validation perplexity: 373.953
[2024-02-28 11:17:00,024 INFO] Validation accuracy: 18.7777
[2024-02-28 11:17:00,026 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_14400.pt
[2024-02-28 11:17:00,744 INFO] Step 14450/14800; acc: 93.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  303/ 197/64; 3390/2200 tok/s;    162 sec;
[2024-02-28 11:17:01,326 INFO] Step 14500/14800; acc: 82.9; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  301/ 216/64; 25892/18551 tok/s;    162 sec;
[2024-02-28 11:17:01,859 INFO] Step 14550/14800; acc: 94.2; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  283/ 199/64; 26525/18628 tok/s;    163 sec;
[2024-02-28 11:17:02,440 INFO] Step 14600/14800; acc: 81.3; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  305/ 218/64; 26263/18779 tok/s;    163 sec;
[2024-02-28 11:17:06,141 INFO] valid stats calculation
                           took: 3.7004032135009766 s.
[2024-02-28 11:17:06,141 INFO] Train perplexity: 5.15734
[2024-02-28 11:17:06,141 INFO] Train accuracy: 70.7828
[2024-02-28 11:17:06,141 INFO] Sentences processed: 307100
[2024-02-28 11:17:06,141 INFO] Average bsz:  309/ 218/64
[2024-02-28 11:17:06,141 INFO] Validation perplexity: 471.819
[2024-02-28 11:17:06,141 INFO] Validation accuracy: 16.8575
[2024-02-28 11:17:06,144 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_14600.pt
[2024-02-28 11:17:06,834 INFO] Step 14650/14800; acc: 95.4; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  294/ 191/64; 3350/2170 tok/s;    168 sec;
[2024-02-28 11:17:07,541 INFO] Step 14700/14800; acc: 69.0; ppl:   8.0; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  362/ 258/64; 25621/18214 tok/s;    168 sec;
[2024-02-28 11:17:08,088 INFO] Step 14750/14800; acc: 85.3; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  289/ 216/64; 26457/19712 tok/s;    169 sec;
[2024-02-28 11:17:08,625 INFO] Step 14800/14800; acc: 94.6; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  265/ 215/64; 24685/20049 tok/s;    169 sec;
[2024-02-28 11:17:12,344 INFO] valid stats calculation
                           took: 3.7190680503845215 s.
[2024-02-28 11:17:12,345 INFO] Train perplexity: 5.00579
[2024-02-28 11:17:12,345 INFO] Train accuracy: 71.3551
[2024-02-28 11:17:12,345 INFO] Sentences processed: 319900
[2024-02-28 11:17:12,345 INFO] Average bsz:  309/ 218/64
[2024-02-28 11:17:12,345 INFO] Validation perplexity: 389.998
[2024-02-28 11:17:12,345 INFO] Validation accuracy: 18.4546
[2024-02-28 11:17:12,347 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_14800.pt
[2024-02-28 13:44:25,783 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-02-28 13:44:25,783 INFO] Parsed 2 corpora from -data.
[2024-02-28 13:44:25,783 INFO] Loading checkpoint from tg-pretrain/models/enc/tg-pretrain_03_step_9800.pt
[2024-02-28 13:44:25,899 INFO] Building model...
[2024-02-28 13:44:25,956 INFO] Switching model to float32 for amp/apex_amp
[2024-02-28 13:44:25,956 INFO] Non quantized layer compute is fp32
[2024-02-28 13:44:27,791 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(32768, 320, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(320, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(25208, 320, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(820, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=25208, bias=True)
)
[2024-02-28 13:44:27,792 INFO] encoder: 14133760
[2024-02-28 13:44:27,792 INFO] decoder: 26093768
[2024-02-28 13:44:27,792 INFO] * number of parameters: 40227528
[2024-02-28 13:44:27,792 INFO] Trainable parameters = {'torch.float32': 40227528, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-02-28 13:44:27,792 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-02-28 13:44:27,792 INFO]  * src vocab size = 32768
[2024-02-28 13:44:27,792 INFO]  * tgt vocab size = 25208
[2024-02-28 13:44:27,794 INFO] Starting training on GPU: [0]
[2024-02-28 13:44:27,794 INFO] Start training loop and validate every 200 steps...
[2024-02-28 13:44:27,794 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-02-28 13:44:42,972 INFO] Step 9850/14800; acc: 26.5; ppl: 1408.3; xent: 7.3; lr: 1.00000; sents:    3200; bsz:  282/ 200/64; 928/659 tok/s;     15 sec;
[2024-02-28 13:44:43,501 INFO] Step 9900/14800; acc: 31.8; ppl: 271.1; xent: 5.6; lr: 1.00000; sents:    3200; bsz:  292/ 202/64; 27624/19139 tok/s;     16 sec;
[2024-02-28 13:44:44,148 INFO] Step 9950/14800; acc: 27.3; ppl: 314.3; xent: 5.8; lr: 1.00000; sents:    3200; bsz:  334/ 228/64; 25809/17613 tok/s;     16 sec;
[2024-02-28 13:44:44,670 INFO] Step 10000/14800; acc: 35.4; ppl: 105.4; xent: 4.7; lr: 1.00000; sents:    3200; bsz:  303/ 204/64; 29051/19572 tok/s;     17 sec;
[2024-02-28 13:44:48,421 INFO] valid stats calculation
                           took: 3.7503108978271484 s.
[2024-02-28 13:44:48,421 INFO] Train perplexity: 332.454
[2024-02-28 13:44:48,421 INFO] Train accuracy: 30.1895
[2024-02-28 13:44:48,421 INFO] Sentences processed: 12800
[2024-02-28 13:44:48,421 INFO] Average bsz:  303/ 209/64
[2024-02-28 13:44:48,421 INFO] Validation perplexity: 865.439
[2024-02-28 13:44:48,421 INFO] Validation accuracy: 18.2422
[2024-02-28 13:44:48,424 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_10000.pt
[2024-02-28 13:44:49,431 INFO] Step 10050/14800; acc: 31.6; ppl: 120.7; xent: 4.8; lr: 1.00000; sents:    3200; bsz:  330/ 247/64; 3469/2595 tok/s;     22 sec;
[2024-02-28 13:44:49,974 INFO] Step 10100/14800; acc: 38.8; ppl:  51.0; xent: 3.9; lr: 1.00000; sents:    3200; bsz:  267/ 202/64; 24642/18591 tok/s;     22 sec;
[2024-02-28 13:44:50,506 INFO] Step 10150/14800; acc: 38.0; ppl:  42.4; xent: 3.7; lr: 1.00000; sents:    3200; bsz:  271/ 204/64; 25483/19112 tok/s;     23 sec;
[2024-02-28 13:44:51,068 INFO] Step 10200/14800; acc: 40.2; ppl:  32.2; xent: 3.5; lr: 1.00000; sents:    3200; bsz:  284/ 210/64; 25294/18662 tok/s;     23 sec;
[2024-02-28 13:44:54,797 INFO] valid stats calculation
                           took: 3.72878360748291 s.
[2024-02-28 13:44:54,798 INFO] Train perplexity: 134.407
[2024-02-28 13:44:54,798 INFO] Train accuracy: 33.584
[2024-02-28 13:44:54,798 INFO] Sentences processed: 25600
[2024-02-28 13:44:54,798 INFO] Average bsz:  296/ 212/64
[2024-02-28 13:44:54,798 INFO] Validation perplexity: 675.164
[2024-02-28 13:44:54,798 INFO] Validation accuracy: 16.1281
[2024-02-28 13:44:54,800 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_10200.pt
[2024-02-28 13:44:55,821 INFO] Step 10250/14800; acc: 37.8; ppl:  50.5; xent: 3.9; lr: 1.00000; sents:    3200; bsz:  325/ 230/64; 3415/2422 tok/s;     28 sec;
[2024-02-28 13:44:56,359 INFO] Step 10300/14800; acc: 43.8; ppl:  22.6; xent: 3.1; lr: 1.00000; sents:    3200; bsz:  289/ 206/64; 26866/19139 tok/s;     29 sec;
[2024-02-28 13:44:56,906 INFO] Step 10350/14800; acc: 44.4; ppl:  18.9; xent: 2.9; lr: 1.00000; sents:    3200; bsz:  301/ 212/64; 27494/19421 tok/s;     29 sec;
[2024-02-28 13:44:57,487 INFO] Step 10400/14800; acc: 44.2; ppl:  23.2; xent: 3.1; lr: 1.00000; sents:    3200; bsz:  331/ 213/64; 28505/18353 tok/s;     30 sec;
[2024-02-28 13:45:01,252 INFO] valid stats calculation
                           took: 3.764744997024536 s.
[2024-02-28 13:45:01,253 INFO] Train perplexity: 78.2605
[2024-02-28 13:45:01,253 INFO] Train accuracy: 36.566
[2024-02-28 13:45:01,253 INFO] Sentences processed: 38400
[2024-02-28 13:45:01,253 INFO] Average bsz:  301/ 213/64
[2024-02-28 13:45:01,253 INFO] Validation perplexity: 382.335
[2024-02-28 13:45:01,253 INFO] Validation accuracy: 16.0727
[2024-02-28 13:45:01,255 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_10400.pt
[2024-02-28 13:45:02,163 INFO] Step 10450/14800; acc: 48.1; ppl:  14.0; xent: 2.6; lr: 1.00000; sents:    3200; bsz:  283/ 214/64; 3025/2289 tok/s;     34 sec;
[2024-02-28 13:45:02,832 INFO] Step 10500/14800; acc: 38.7; ppl:  31.6; xent: 3.5; lr: 1.00000; sents:    3200; bsz:  328/ 260/64; 24465/19386 tok/s;     35 sec;
[2024-02-28 13:45:03,385 INFO] Step 10550/14800; acc: 49.3; ppl:  12.2; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  306/ 212/64; 27687/19159 tok/s;     36 sec;
[2024-02-28 13:45:03,964 INFO] Step 10600/14800; acc: 52.2; ppl:  12.5; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  331/ 202/64; 28638/17464 tok/s;     36 sec;
[2024-02-28 13:45:07,717 INFO] valid stats calculation
                           took: 3.753237724304199 s.
[2024-02-28 13:45:07,718 INFO] Train perplexity: 52.618
[2024-02-28 13:45:07,718 INFO] Train accuracy: 39.1414
[2024-02-28 13:45:07,718 INFO] Sentences processed: 51200
[2024-02-28 13:45:07,718 INFO] Average bsz:  304/ 215/64
[2024-02-28 13:45:07,718 INFO] Validation perplexity: 374.365
[2024-02-28 13:45:07,718 INFO] Validation accuracy: 18.4453
[2024-02-28 13:45:07,720 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_10600.pt
[2024-02-28 13:45:08,606 INFO] Step 10650/14800; acc: 58.6; ppl:   6.0; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  275/ 195/64; 2964/2100 tok/s;     41 sec;
[2024-02-28 13:45:09,156 INFO] Step 10700/14800; acc: 58.3; ppl:   7.4; xent: 2.0; lr: 1.00000; sents:    3200; bsz:  306/ 211/64; 27843/19223 tok/s;     41 sec;
[2024-02-28 13:45:09,787 INFO] Step 10750/14800; acc: 51.9; ppl:  17.5; xent: 2.9; lr: 1.00000; sents:    3200; bsz:  351/ 223/64; 27805/17705 tok/s;     42 sec;
[2024-02-28 13:45:10,314 INFO] Step 10800/14800; acc: 59.4; ppl:   7.1; xent: 2.0; lr: 1.00000; sents:    3200; bsz:  292/ 198/64; 27685/18781 tok/s;     43 sec;
[2024-02-28 13:45:14,041 INFO] valid stats calculation
                           took: 3.7264459133148193 s.
[2024-02-28 13:45:14,042 INFO] Train perplexity: 37.2072
[2024-02-28 13:45:14,042 INFO] Train accuracy: 42.5797
[2024-02-28 13:45:14,042 INFO] Sentences processed: 64000
[2024-02-28 13:45:14,042 INFO] Average bsz:  304/ 214/64
[2024-02-28 13:45:14,042 INFO] Validation perplexity: 519.209
[2024-02-28 13:45:14,042 INFO] Validation accuracy: 15.325
[2024-02-28 13:45:14,044 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_10800.pt
[2024-02-28 13:45:14,966 INFO] Step 10850/14800; acc: 58.4; ppl:   6.7; xent: 1.9; lr: 1.00000; sents:    3200; bsz:  301/ 213/64; 3233/2289 tok/s;     47 sec;
[2024-02-28 13:45:15,726 INFO] Step 10900/14800; acc: 41.3; ppl:  37.4; xent: 3.6; lr: 1.00000; sents:    3200; bsz:  407/ 287/64; 26798/18913 tok/s;     48 sec;
[2024-02-28 13:45:16,266 INFO] Step 10950/14800; acc: 62.6; ppl:   4.6; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  317/ 215/64; 29413/19925 tok/s;     48 sec;
[2024-02-28 13:45:16,805 INFO] Step 11000/14800; acc: 65.6; ppl:   4.2; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  265/ 209/64; 24607/19401 tok/s;     49 sec;
[2024-02-28 13:45:20,525 INFO] valid stats calculation
                           took: 3.7195005416870117 s.
[2024-02-28 13:45:20,525 INFO] Train perplexity: 29.1462
[2024-02-28 13:45:20,526 INFO] Train accuracy: 44.9073
[2024-02-28 13:45:20,526 INFO] Sentences processed: 76800
[2024-02-28 13:45:20,526 INFO] Average bsz:  307/ 217/64
[2024-02-28 13:45:20,526 INFO] Validation perplexity: 360.699
[2024-02-28 13:45:20,526 INFO] Validation accuracy: 18.9808
[2024-02-28 13:45:20,528 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_11000.pt
[2024-02-28 13:45:21,488 INFO] Step 11050/14800; acc: 62.2; ppl:   6.1; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  300/ 217/64; 3198/2315 tok/s;     54 sec;
[2024-02-28 13:45:22,033 INFO] Step 11100/14800; acc: 66.9; ppl:   3.5; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  296/ 220/64; 27155/20195 tok/s;     54 sec;
[2024-02-28 13:45:22,596 INFO] Step 11150/14800; acc: 68.3; ppl:   4.3; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  316/ 214/64; 28096/19018 tok/s;     55 sec;
[2024-02-28 13:45:23,126 INFO] Step 11200/14800; acc: 70.6; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  272/ 198/64; 25660/18747 tok/s;     55 sec;
[2024-02-28 13:45:26,857 INFO] valid stats calculation
                           took: 3.730774402618408 s.
[2024-02-28 13:45:26,857 INFO] Train perplexity: 22.2903
[2024-02-28 13:45:26,857 INFO] Train accuracy: 47.9958
[2024-02-28 13:45:26,857 INFO] Sentences processed: 89600
[2024-02-28 13:45:26,857 INFO] Average bsz:  306/ 216/64
[2024-02-28 13:45:26,857 INFO] Validation perplexity: 395.482
[2024-02-28 13:45:26,857 INFO] Validation accuracy: 18.5746
[2024-02-28 13:45:26,860 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_11200.pt
[2024-02-28 13:45:27,808 INFO] Step 11250/14800; acc: 67.6; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  314/ 220/64; 3349/2348 tok/s;     60 sec;
[2024-02-28 13:45:28,528 INFO] Step 11300/14800; acc: 59.4; ppl:  10.0; xent: 2.3; lr: 1.00000; sents:    3150; bsz:  372/ 254/63; 25807/17623 tok/s;     61 sec;
[2024-02-28 13:45:29,097 INFO] Step 11350/14800; acc: 70.2; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  307/ 221/64; 27030/19409 tok/s;     61 sec;
[2024-02-28 13:45:29,639 INFO] Step 11400/14800; acc: 74.0; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  298/ 206/64; 27537/18985 tok/s;     62 sec;
[2024-02-28 13:45:33,375 INFO] valid stats calculation
                           took: 3.73565936088562 s.
[2024-02-28 13:45:33,375 INFO] Train perplexity: 18.2187
[2024-02-28 13:45:33,375 INFO] Train accuracy: 50.5089
[2024-02-28 13:45:33,375 INFO] Sentences processed: 102350
[2024-02-28 13:45:33,375 INFO] Average bsz:  308/ 217/64
[2024-02-28 13:45:33,375 INFO] Validation perplexity: 456.101
[2024-02-28 13:45:33,375 INFO] Validation accuracy: 19.3039
[2024-02-28 13:45:33,378 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_11400.pt
[2024-02-28 13:45:34,350 INFO] Step 11450/14800; acc: 65.8; ppl:   5.8; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  324/ 227/64; 3442/2409 tok/s;     67 sec;
[2024-02-28 13:45:34,928 INFO] Step 11500/14800; acc: 74.0; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  310/ 212/64; 26826/18394 tok/s;     67 sec;
[2024-02-28 13:45:35,481 INFO] Step 11550/14800; acc: 73.9; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  311/ 211/64; 28130/19084 tok/s;     68 sec;
[2024-02-28 13:45:36,010 INFO] Step 11600/14800; acc: 80.4; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  307/ 197/64; 29014/18618 tok/s;     68 sec;
[2024-02-28 13:45:39,739 INFO] valid stats calculation
                           took: 3.728170871734619 s.
[2024-02-28 13:45:39,739 INFO] Train perplexity: 15.2334
[2024-02-28 13:45:39,739 INFO] Train accuracy: 52.9826
[2024-02-28 13:45:39,739 INFO] Sentences processed: 115150
[2024-02-28 13:45:39,739 INFO] Average bsz:  308/ 217/64
[2024-02-28 13:45:39,739 INFO] Validation perplexity: 434.771
[2024-02-28 13:45:39,739 INFO] Validation accuracy: 18.7038
[2024-02-28 13:45:39,742 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_11600.pt
[2024-02-28 13:45:40,685 INFO] Step 11650/14800; acc: 80.1; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  276/ 200/64; 2957/2136 tok/s;     73 sec;
[2024-02-28 13:45:41,245 INFO] Step 11700/14800; acc: 73.4; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  285/ 210/64; 25440/18729 tok/s;     73 sec;
[2024-02-28 13:45:41,834 INFO] Step 11750/14800; acc: 69.2; ppl:   5.1; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  323/ 220/64; 27472/18671 tok/s;     74 sec;
[2024-02-28 13:45:42,461 INFO] Step 11800/14800; acc: 68.2; ppl:   6.7; xent: 1.9; lr: 1.00000; sents:    3200; bsz:  376/ 237/64; 30014/18921 tok/s;     75 sec;
[2024-02-28 13:45:46,179 INFO] valid stats calculation
                           took: 3.7186119556427 s.
[2024-02-28 13:45:46,180 INFO] Train perplexity: 13.384
[2024-02-28 13:45:46,180 INFO] Train accuracy: 54.9286
[2024-02-28 13:45:46,180 INFO] Sentences processed: 127950
[2024-02-28 13:45:46,180 INFO] Average bsz:  309/ 217/64
[2024-02-28 13:45:46,180 INFO] Validation perplexity: 425.261
[2024-02-28 13:45:46,180 INFO] Validation accuracy: 18.2607
[2024-02-28 13:45:46,182 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_11800.pt
[2024-02-28 13:45:47,093 INFO] Step 11850/14800; acc: 79.8; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  278/ 204/64; 2998/2200 tok/s;     79 sec;
[2024-02-28 13:45:47,682 INFO] Step 11900/14800; acc: 73.4; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  300/ 224/64; 25462/18999 tok/s;     80 sec;
[2024-02-28 13:45:48,204 INFO] Step 11950/14800; acc: 83.1; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  279/ 204/64; 26739/19502 tok/s;     80 sec;
[2024-02-28 13:45:48,859 INFO] Step 12000/14800; acc: 68.6; ppl:   5.8; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  349/ 260/64; 26617/19849 tok/s;     81 sec;
[2024-02-28 13:45:52,656 INFO] valid stats calculation
                           took: 3.796544313430786 s.
[2024-02-28 13:45:52,657 INFO] Train perplexity: 11.7128
[2024-02-28 13:45:52,657 INFO] Train accuracy: 56.8624
[2024-02-28 13:45:52,657 INFO] Sentences processed: 140750
[2024-02-28 13:45:52,657 INFO] Average bsz:  308/ 217/64
[2024-02-28 13:45:52,657 INFO] Validation perplexity: 551.849
[2024-02-28 13:45:52,657 INFO] Validation accuracy: 17.4298
[2024-02-28 13:45:52,659 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_12000.pt
[2024-02-28 13:45:53,647 INFO] Step 12050/14800; acc: 72.5; ppl:   4.7; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  313/ 219/64; 3269/2288 tok/s;     86 sec;
[2024-02-28 13:45:54,241 INFO] Step 12100/14800; acc: 70.6; ppl:   5.4; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  311/ 245/64; 26170/20638 tok/s;     86 sec;
[2024-02-28 13:45:54,849 INFO] Step 12150/14800; acc: 74.2; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  343/ 257/64; 28257/21186 tok/s;     87 sec;
[2024-02-28 13:45:55,407 INFO] Step 12200/14800; acc: 78.2; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  288/ 228/64; 25821/20485 tok/s;     88 sec;
[2024-02-28 13:45:59,150 INFO] valid stats calculation
                           took: 3.7429049015045166 s.
[2024-02-28 13:45:59,150 INFO] Train perplexity: 10.6598
[2024-02-28 13:45:59,150 INFO] Train accuracy: 58.3988
[2024-02-28 13:45:59,150 INFO] Sentences processed: 153550
[2024-02-28 13:45:59,150 INFO] Average bsz:  309/ 219/64
[2024-02-28 13:45:59,150 INFO] Validation perplexity: 635.738
[2024-02-28 13:45:59,150 INFO] Validation accuracy: 17.6514
[2024-02-28 13:45:59,153 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_12200.pt
[2024-02-28 13:46:00,071 INFO] Step 12250/14800; acc: 79.3; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  310/ 209/64; 3320/2243 tok/s;     92 sec;
[2024-02-28 13:46:00,682 INFO] Step 12300/14800; acc: 80.0; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  320/ 227/64; 26202/18565 tok/s;     93 sec;
[2024-02-28 13:46:01,283 INFO] Step 12350/14800; acc: 70.5; ppl:   5.2; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  310/ 228/64; 25769/18961 tok/s;     93 sec;
[2024-02-28 13:46:01,862 INFO] Step 12400/14800; acc: 75.9; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  318/ 227/64; 27452/19651 tok/s;     94 sec;
[2024-02-28 13:46:05,610 INFO] valid stats calculation
                           took: 3.7481563091278076 s.
[2024-02-28 13:46:05,611 INFO] Train perplexity: 9.80434
[2024-02-28 13:46:05,611 INFO] Train accuracy: 59.8037
[2024-02-28 13:46:05,611 INFO] Sentences processed: 166350
[2024-02-28 13:46:05,611 INFO] Average bsz:  309/ 219/64
[2024-02-28 13:46:05,611 INFO] Validation perplexity: 421.992
[2024-02-28 13:46:05,611 INFO] Validation accuracy: 17.836
[2024-02-28 13:46:05,613 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_12400.pt
[2024-02-28 13:46:06,521 INFO] Step 12450/14800; acc: 86.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  292/ 214/64; 3132/2293 tok/s;     99 sec;
[2024-02-28 13:46:07,071 INFO] Step 12500/14800; acc: 83.9; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  306/ 225/64; 27836/20455 tok/s;     99 sec;
[2024-02-28 13:46:07,712 INFO] Step 12550/14800; acc: 70.8; ppl:   5.9; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  350/ 239/64; 27284/18594 tok/s;    100 sec;
[2024-02-28 13:46:08,216 INFO] Step 12600/14800; acc: 88.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  273/ 189/64; 27083/18753 tok/s;    100 sec;
[2024-02-28 13:46:11,936 INFO] valid stats calculation
                           took: 3.719893455505371 s.
[2024-02-28 13:46:11,936 INFO] Train perplexity: 8.90775
[2024-02-28 13:46:11,937 INFO] Train accuracy: 61.3641
[2024-02-28 13:46:11,937 INFO] Sentences processed: 179150
[2024-02-28 13:46:11,937 INFO] Average bsz:  309/ 219/64
[2024-02-28 13:46:11,937 INFO] Validation perplexity: 540.204
[2024-02-28 13:46:11,937 INFO] Validation accuracy: 17.4945
[2024-02-28 13:46:11,939 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_12600.pt
[2024-02-28 13:46:12,872 INFO] Step 12650/14800; acc: 86.0; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  303/ 224/64; 3258/2404 tok/s;    105 sec;
[2024-02-28 13:46:13,410 INFO] Step 12700/14800; acc: 81.2; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  298/ 211/64; 27723/19569 tok/s;    106 sec;
[2024-02-28 13:46:13,959 INFO] Step 12750/14800; acc: 85.9; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  279/ 210/64; 25414/19155 tok/s;    106 sec;
[2024-02-28 13:46:14,514 INFO] Step 12800/14800; acc: 84.2; ppl:   2.3; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  313/ 214/64; 28189/19328 tok/s;    107 sec;
[2024-02-28 13:46:18,246 INFO] valid stats calculation
                           took: 3.7323431968688965 s.
[2024-02-28 13:46:18,247 INFO] Train perplexity: 8.13092
[2024-02-28 13:46:18,247 INFO] Train accuracy: 62.8684
[2024-02-28 13:46:18,247 INFO] Sentences processed: 191950
[2024-02-28 13:46:18,247 INFO] Average bsz:  308/ 219/64
[2024-02-28 13:46:18,247 INFO] Validation perplexity: 731.846
[2024-02-28 13:46:18,247 INFO] Validation accuracy: 16.0912
[2024-02-28 13:46:18,249 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_12800.pt
[2024-02-28 13:46:19,118 INFO] Step 12850/14800; acc: 90.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  287/ 190/64; 3114/2061 tok/s;    111 sec;
[2024-02-28 13:46:19,659 INFO] Step 12900/14800; acc: 87.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  308/ 224/64; 28533/20752 tok/s;    112 sec;
[2024-02-28 13:46:20,192 INFO] Step 12950/14800; acc: 78.0; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  305/ 215/64; 28579/20177 tok/s;    112 sec;
[2024-02-28 13:46:20,731 INFO] Step 13000/14800; acc: 78.7; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  299/ 219/64; 27763/20282 tok/s;    113 sec;
[2024-02-28 13:46:24,692 INFO] valid stats calculation
                           took: 3.960686445236206 s.
[2024-02-28 13:46:24,693 INFO] Train perplexity: 7.56965
[2024-02-28 13:46:24,693 INFO] Train accuracy: 64.1265
[2024-02-28 13:46:24,693 INFO] Sentences processed: 204750
[2024-02-28 13:46:24,693 INFO] Average bsz:  308/ 218/64
[2024-02-28 13:46:24,693 INFO] Validation perplexity: 438.632
[2024-02-28 13:46:24,693 INFO] Validation accuracy: 18.7038
[2024-02-28 13:46:24,695 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_13000.pt
[2024-02-28 13:46:25,563 INFO] Step 13050/14800; acc: 92.2; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  301/ 213/64; 3113/2199 tok/s;    118 sec;
[2024-02-28 13:46:26,071 INFO] Step 13100/14800; acc: 91.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  273/ 214/64; 26849/21051 tok/s;    118 sec;
[2024-02-28 13:46:26,623 INFO] Step 13150/14800; acc: 82.7; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  339/ 225/64; 30676/20369 tok/s;    119 sec;
[2024-02-28 13:46:27,297 INFO] Step 13200/14800; acc: 71.2; ppl:   6.3; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  341/ 256/64; 25298/18983 tok/s;    120 sec;
[2024-02-28 13:46:31,288 INFO] valid stats calculation
                           took: 3.9904632568359375 s.
[2024-02-28 13:46:31,288 INFO] Train perplexity: 7.06535
[2024-02-28 13:46:31,289 INFO] Train accuracy: 65.3269
[2024-02-28 13:46:31,289 INFO] Sentences processed: 217550
[2024-02-28 13:46:31,289 INFO] Average bsz:  308/ 219/64
[2024-02-28 13:46:31,289 INFO] Validation perplexity: 703.505
[2024-02-28 13:46:31,289 INFO] Validation accuracy: 17.8822
[2024-02-28 13:46:31,291 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_13200.pt
[2024-02-28 13:46:32,176 INFO] Step 13250/14800; acc: 86.2; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  325/ 218/64; 3332/2234 tok/s;    124 sec;
[2024-02-28 13:46:35,709 INFO] Step 13300/14800; acc: 86.6; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  313/ 217/64; 4430/3069 tok/s;    128 sec;
[2024-02-28 13:46:36,376 INFO] Step 13350/14800; acc: 79.8; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  276/ 211/64; 20696/15829 tok/s;    129 sec;
[2024-02-28 13:46:36,912 INFO] Step 13400/14800; acc: 93.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  311/ 211/64; 29054/19728 tok/s;    129 sec;
[2024-02-28 13:46:40,655 INFO] valid stats calculation
                           took: 3.7426276206970215 s.
[2024-02-28 13:46:40,655 INFO] Train perplexity: 6.60041
[2024-02-28 13:46:40,655 INFO] Train accuracy: 66.4863
[2024-02-28 13:46:40,655 INFO] Sentences processed: 230350
[2024-02-28 13:46:40,655 INFO] Average bsz:  308/ 218/64
[2024-02-28 13:46:40,655 INFO] Validation perplexity: 470.706
[2024-02-28 13:46:40,655 INFO] Validation accuracy: 18.39
[2024-02-28 13:46:40,658 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_13400.pt
[2024-02-28 13:46:41,669 INFO] Step 13450/14800; acc: 77.2; ppl:   4.3; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  348/ 238/64; 3663/2504 tok/s;    134 sec;
[2024-02-28 13:46:42,234 INFO] Step 13500/14800; acc: 88.3; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3155; bsz:  304/ 194/63; 26857/17190 tok/s;    134 sec;
[2024-02-28 13:46:42,799 INFO] Step 13550/14800; acc: 90.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  295/ 229/64; 26111/20278 tok/s;    135 sec;
[2024-02-28 13:46:43,343 INFO] Step 13600/14800; acc: 87.2; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  310/ 215/64; 28462/19762 tok/s;    136 sec;
[2024-02-28 13:46:47,130 INFO] valid stats calculation
                           took: 3.786693811416626 s.
[2024-02-28 13:46:47,130 INFO] Train perplexity: 6.23724
[2024-02-28 13:46:47,130 INFO] Train accuracy: 67.4976
[2024-02-28 13:46:47,130 INFO] Sentences processed: 243105
[2024-02-28 13:46:47,130 INFO] Average bsz:  308/ 219/64
[2024-02-28 13:46:47,130 INFO] Validation perplexity: 452.806
[2024-02-28 13:46:47,130 INFO] Validation accuracy: 19.3316
[2024-02-28 13:46:47,133 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_13600.pt
[2024-02-28 13:46:48,064 INFO] Step 13650/14800; acc: 84.0; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  298/ 214/64; 3152/2266 tok/s;    140 sec;
[2024-02-28 13:46:48,677 INFO] Step 13700/14800; acc: 78.0; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  315/ 236/64; 25698/19263 tok/s;    141 sec;
[2024-02-28 13:46:49,192 INFO] Step 13750/14800; acc: 93.2; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  279/ 193/64; 27066/18748 tok/s;    141 sec;
[2024-02-28 13:46:49,716 INFO] Step 13800/14800; acc: 94.0; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  280/ 199/64; 26751/18985 tok/s;    142 sec;
[2024-02-28 13:46:53,456 INFO] valid stats calculation
                           took: 3.7391371726989746 s.
[2024-02-28 13:46:53,456 INFO] Train perplexity: 5.91693
[2024-02-28 13:46:53,456 INFO] Train accuracy: 68.4281
[2024-02-28 13:46:53,456 INFO] Sentences processed: 255905
[2024-02-28 13:46:53,456 INFO] Average bsz:  307/ 218/64
[2024-02-28 13:46:53,456 INFO] Validation perplexity: 457.054
[2024-02-28 13:46:53,456 INFO] Validation accuracy: 17.0329
[2024-02-28 13:46:53,459 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_13800.pt
[2024-02-28 13:46:54,322 INFO] Step 13850/14800; acc: 93.2; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  246/ 177/64; 2668/1919 tok/s;    147 sec;
[2024-02-28 13:46:54,961 INFO] Step 13900/14800; acc: 74.9; ppl:   4.8; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  342/ 259/64; 26774/20300 tok/s;    147 sec;
[2024-02-28 13:46:55,624 INFO] Step 13950/14800; acc: 71.8; ppl:   6.2; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  373/ 259/64; 28133/19561 tok/s;    148 sec;
[2024-02-28 13:46:56,196 INFO] Step 14000/14800; acc: 79.5; ppl:   3.5; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  311/ 222/64; 27197/19421 tok/s;    148 sec;
[2024-02-28 13:46:59,939 INFO] valid stats calculation
                           took: 3.742403507232666 s.
[2024-02-28 13:46:59,940 INFO] Train perplexity: 5.78064
[2024-02-28 13:46:59,940 INFO] Train accuracy: 68.939
[2024-02-28 13:46:59,940 INFO] Sentences processed: 268705
[2024-02-28 13:46:59,940 INFO] Average bsz:  308/ 219/64
[2024-02-28 13:46:59,940 INFO] Validation perplexity: 401.746
[2024-02-28 13:46:59,940 INFO] Validation accuracy: 18.7038
[2024-02-28 13:46:59,942 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_14000.pt
[2024-02-28 13:47:00,864 INFO] Step 14050/14800; acc: 94.6; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  289/ 229/64; 3099/2455 tok/s;    153 sec;
[2024-02-28 13:47:01,492 INFO] Step 14100/14800; acc: 82.6; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  325/ 247/64; 25837/19679 tok/s;    154 sec;
[2024-02-28 13:47:02,034 INFO] Step 14150/14800; acc: 86.4; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  317/ 209/64; 29330/19268 tok/s;    154 sec;
[2024-02-28 13:47:02,562 INFO] Step 14200/14800; acc: 94.5; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  292/ 204/64; 27606/19251 tok/s;    155 sec;
[2024-02-28 13:47:06,284 INFO] valid stats calculation
                           took: 3.721731662750244 s.
[2024-02-28 13:47:06,285 INFO] Train perplexity: 5.46761
[2024-02-28 13:47:06,285 INFO] Train accuracy: 69.8792
[2024-02-28 13:47:06,285 INFO] Sentences processed: 281505
[2024-02-28 13:47:06,285 INFO] Average bsz:  308/ 219/64
[2024-02-28 13:47:06,285 INFO] Validation perplexity: 475.271
[2024-02-28 13:47:06,285 INFO] Validation accuracy: 17.9745
[2024-02-28 13:47:06,287 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_14200.pt
[2024-02-28 13:47:07,197 INFO] Step 14250/14800; acc: 87.9; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  292/ 204/64; 3148/2203 tok/s;    159 sec;
[2024-02-28 13:47:07,745 INFO] Step 14300/14800; acc: 88.2; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  284/ 215/64; 25935/19588 tok/s;    160 sec;
[2024-02-28 13:47:08,363 INFO] Step 14350/14800; acc: 80.8; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  337/ 234/64; 27248/18949 tok/s;    161 sec;
[2024-02-28 13:47:08,950 INFO] Step 14400/14800; acc: 88.4; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  317/ 226/64; 26958/19247 tok/s;    161 sec;
[2024-02-28 13:47:12,723 INFO] valid stats calculation
                           took: 3.7723560333251953 s.
[2024-02-28 13:47:12,724 INFO] Train perplexity: 5.26172
[2024-02-28 13:47:12,724 INFO] Train accuracy: 70.5923
[2024-02-28 13:47:12,724 INFO] Sentences processed: 294305
[2024-02-28 13:47:12,724 INFO] Average bsz:  308/ 219/64
[2024-02-28 13:47:12,724 INFO] Validation perplexity: 369.952
[2024-02-28 13:47:12,724 INFO] Validation accuracy: 18.1961
[2024-02-28 13:47:12,726 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_14400.pt
[2024-02-28 13:47:13,609 INFO] Step 14450/14800; acc: 93.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  268/ 201/64; 2872/2162 tok/s;    166 sec;
[2024-02-28 13:47:14,154 INFO] Step 14500/14800; acc: 96.0; ppl:   1.2; xent: 0.1; lr: 1.00000; sents:    3200; bsz:  296/ 218/64; 27129/20022 tok/s;    166 sec;
[2024-02-28 13:47:14,711 INFO] Step 14550/14800; acc: 86.3; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  312/ 224/64; 28007/20044 tok/s;    167 sec;
[2024-02-28 13:47:15,308 INFO] Step 14600/14800; acc: 85.8; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  345/ 226/64; 28940/18940 tok/s;    168 sec;
[2024-02-28 13:47:19,090 INFO] valid stats calculation
                           took: 3.7809438705444336 s.
[2024-02-28 13:47:19,090 INFO] Train perplexity: 5.01704
[2024-02-28 13:47:19,090 INFO] Train accuracy: 71.4044
[2024-02-28 13:47:19,090 INFO] Sentences processed: 307105
[2024-02-28 13:47:19,090 INFO] Average bsz:  308/ 219/64
[2024-02-28 13:47:19,090 INFO] Validation perplexity: 559.757
[2024-02-28 13:47:19,090 INFO] Validation accuracy: 17.2729
[2024-02-28 13:47:19,093 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_14600.pt
[2024-02-28 13:47:20,019 INFO] Step 14650/14800; acc: 92.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  308/ 209/64; 3269/2216 tok/s;    172 sec;
[2024-02-28 13:47:20,640 INFO] Step 14700/14800; acc: 80.1; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  333/ 236/64; 26830/18963 tok/s;    173 sec;
[2024-02-28 13:47:21,213 INFO] Step 14750/14800; acc: 85.6; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  319/ 218/64; 27804/19042 tok/s;    173 sec;
[2024-02-28 13:47:21,806 INFO] Step 14800/14800; acc: 87.3; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  292/ 212/64; 24578/17825 tok/s;    174 sec;
[2024-02-28 13:47:25,554 INFO] valid stats calculation
                           took: 3.7470123767852783 s.
[2024-02-28 13:47:25,554 INFO] Train perplexity: 4.86032
[2024-02-28 13:47:25,554 INFO] Train accuracy: 71.9984
[2024-02-28 13:47:25,554 INFO] Sentences processed: 319905
[2024-02-28 13:47:25,554 INFO] Average bsz:  308/ 219/64
[2024-02-28 13:47:25,554 INFO] Validation perplexity: 353.184
[2024-02-28 13:47:25,554 INFO] Validation accuracy: 17.9468
[2024-02-28 13:47:25,557 INFO] Saving checkpoint tg-ft-enc/tg-finetune_9800_02_step_14800.pt
