[2024-02-24 11:25:10,488 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-02-24 11:25:10,488 INFO] Parsed 2 corpora from -data.
[2024-02-24 11:25:10,489 INFO] Get special vocabs from Transforms: {'src': [], 'tgt': []}.
[2024-02-24 11:25:10,504 INFO] Reading encoder embeddings from sonar-320.txt
[2024-02-24 11:25:17,484 INFO] 	Found 626711 total vectors in file.
[2024-02-24 11:25:17,484 INFO] Reading decoder embeddings from ngt_w2v.txt
[2024-02-24 11:25:24,707 INFO] 	Found 629649 total vectors in file
[2024-02-24 11:25:24,708 INFO] After filtering to vectors in vocab:
[2024-02-24 11:25:24,710 INFO] 	* enc: 3993 match, 7223 missing, (35.60%)
[2024-02-24 11:25:24,710 INFO] 	* dec: 2817 match, 471 missing, (85.68%)
[2024-02-24 11:25:24,711 INFO] 
Saving encoder embeddings as:
	* enc: tg-both.enc_embeddings.pt
[2024-02-24 11:25:29,741 INFO] 
Saving decoder embeddings as:
	* dec: tg-both.dec_embeddings.pt
[2024-02-24 11:25:30,907 INFO] The first 10 tokens of the vocabs are:['<unk>', '<blank>', '<s>', '</s>', 'het', 'dat', 'ik', 'de', 'een', 'is']
[2024-02-24 11:25:30,907 INFO] The decoder start token is: <s>
[2024-02-24 11:25:30,907 INFO] Building model...
[2024-02-24 11:25:31,043 INFO] Switching model to float32 for amp/apex_amp
[2024-02-24 11:25:31,043 INFO] Non quantized layer compute is fp32
[2024-02-24 11:25:32,866 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(11216, 320, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(320, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(3288, 320, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(820, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=3288, bias=True)
)
[2024-02-24 11:25:32,866 INFO] encoder: 7237120
[2024-02-24 11:25:32,866 INFO] decoder: 8097448
[2024-02-24 11:25:32,866 INFO] * number of parameters: 15334568
[2024-02-24 11:25:32,866 INFO] Trainable parameters = {'torch.float32': 15334568, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-02-24 11:25:32,866 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-02-24 11:25:32,866 INFO]  * src vocab size = 11216
[2024-02-24 11:25:32,866 INFO]  * tgt vocab size = 3288
[2024-02-24 11:25:32,867 INFO] Starting training on GPU: [0]
[2024-02-24 11:25:32,867 INFO] Start training loop and validate every 200 steps...
[2024-02-24 11:25:32,867 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-02-24 11:25:48,006 INFO] Step 50/10000; acc: 20.8; ppl: 10240.1; xent: 9.2; lr: 1.00000; sents:    3200; bsz:  255/ 203/64; 841/670 tok/s;     15 sec;
[2024-02-24 11:25:48,594 INFO] Step 100/10000; acc: 20.4; ppl: 2542.4; xent: 7.8; lr: 1.00000; sents:    3200; bsz:  347/ 243/64; 29512/20692 tok/s;     16 sec;
[2024-02-24 11:25:49,105 INFO] Step 150/10000; acc: 22.2; ppl: 323.7; xent: 5.8; lr: 1.00000; sents:    3200; bsz:  307/ 231/64; 30103/22656 tok/s;     16 sec;
[2024-02-24 11:25:49,666 INFO] Step 200/10000; acc: 23.4; ppl: 238.7; xent: 5.5; lr: 1.00000; sents:    3200; bsz:  346/ 252/64; 30865/22479 tok/s;     17 sec;
[2024-02-24 11:25:53,667 INFO] valid stats calculation
                           took: 4.000643968582153 s.
[2024-02-24 11:25:53,667 INFO] Train perplexity: 1085.86
[2024-02-24 11:25:53,667 INFO] Train accuracy: 21.7655
[2024-02-24 11:25:53,667 INFO] Sentences processed: 12800
[2024-02-24 11:25:53,667 INFO] Average bsz:  314/ 232/64
[2024-02-24 11:25:53,668 INFO] Validation perplexity: 784.418
[2024-02-24 11:25:53,668 INFO] Validation accuracy: 14.4295
[2024-02-24 11:25:53,668 INFO] Saving checkpoint tg-both/tg_01_step_200.pt
[2024-02-24 11:25:54,379 INFO] Step 250/10000; acc: 22.0; ppl: 229.8; xent: 5.4; lr: 1.00000; sents:    3200; bsz:  386/ 268/64; 4098/2840 tok/s;     22 sec;
[2024-02-24 11:25:54,967 INFO] Step 300/10000; acc: 23.3; ppl: 177.3; xent: 5.2; lr: 1.00000; sents:    3200; bsz:  334/ 247/64; 28409/21058 tok/s;     22 sec;
[2024-02-24 11:25:55,465 INFO] Step 350/10000; acc: 27.9; ppl: 117.2; xent: 4.8; lr: 1.00000; sents:    3200; bsz:  276/ 232/64; 27765/23256 tok/s;     23 sec;
[2024-02-24 11:25:56,014 INFO] Step 400/10000; acc: 30.4; ppl: 113.7; xent: 4.7; lr: 1.00000; sents:    3200; bsz:  289/ 202/64; 26361/18429 tok/s;     23 sec;
[2024-02-24 11:26:00,100 INFO] valid stats calculation
                           took: 4.085660696029663 s.
[2024-02-24 11:26:00,100 INFO] Train perplexity: 408.605
[2024-02-24 11:26:00,100 INFO] Train accuracy: 23.6867
[2024-02-24 11:26:00,100 INFO] Sentences processed: 25600
[2024-02-24 11:26:00,100 INFO] Average bsz:  318/ 235/64
[2024-02-24 11:26:00,100 INFO] Validation perplexity: 595.407
[2024-02-24 11:26:00,100 INFO] Validation accuracy: 13.8017
[2024-02-24 11:26:00,101 INFO] Saving checkpoint tg-both/tg_01_step_400.pt
[2024-02-24 11:26:00,652 INFO] Step 450/10000; acc: 30.9; ppl: 100.3; xent: 4.6; lr: 1.00000; sents:    3200; bsz:  271/ 207/64; 2925/2234 tok/s;     28 sec;
[2024-02-24 11:26:01,097 INFO] Step 500/10000; acc: 31.8; ppl:  95.2; xent: 4.6; lr: 1.00000; sents:    3200; bsz:  312/ 197/64; 35135/22146 tok/s;     28 sec;
[2024-02-24 11:26:01,607 INFO] Step 550/10000; acc: 25.9; ppl: 122.3; xent: 4.8; lr: 1.00000; sents:    3200; bsz:  314/ 238/64; 30777/23311 tok/s;     29 sec;
[2024-02-24 11:26:02,244 INFO] Step 600/10000; acc: 29.0; ppl: 101.0; xent: 4.6; lr: 1.00000; sents:    3200; bsz:  291/ 221/64; 22818/17386 tok/s;     29 sec;
[2024-02-24 11:26:06,214 INFO] valid stats calculation
                           took: 3.969717264175415 s.
[2024-02-24 11:26:06,214 INFO] Train perplexity: 266.242
[2024-02-24 11:26:06,214 INFO] Train accuracy: 25.4341
[2024-02-24 11:26:06,214 INFO] Sentences processed: 38400
[2024-02-24 11:26:06,214 INFO] Average bsz:  311/ 228/64
[2024-02-24 11:26:06,214 INFO] Validation perplexity: 764.376
[2024-02-24 11:26:06,214 INFO] Validation accuracy: 14.651
[2024-02-24 11:26:06,215 INFO] Saving checkpoint tg-both/tg_01_step_600.pt
[2024-02-24 11:26:06,834 INFO] Step 650/10000; acc: 22.4; ppl: 166.8; xent: 5.1; lr: 1.00000; sents:    3200; bsz:  357/ 258/64; 3894/2812 tok/s;     34 sec;
[2024-02-24 11:26:07,284 INFO] Step 700/10000; acc: 37.3; ppl:  60.0; xent: 4.1; lr: 1.00000; sents:    3200; bsz:  275/ 177/64; 30558/19614 tok/s;     34 sec;
[2024-02-24 11:26:07,901 INFO] Step 750/10000; acc: 34.8; ppl:  67.6; xent: 4.2; lr: 1.00000; sents:    3200; bsz:  287/ 196/64; 23228/15865 tok/s;     35 sec;
[2024-02-24 11:26:08,564 INFO] Step 800/10000; acc: 30.7; ppl:  86.7; xent: 4.5; lr: 1.00000; sents:    3200; bsz:  322/ 217/64; 24332/16359 tok/s;     36 sec;
[2024-02-24 11:26:12,526 INFO] valid stats calculation
                           took: 3.9624128341674805 s.
[2024-02-24 11:26:12,527 INFO] Train perplexity: 207.441
[2024-02-24 11:26:12,527 INFO] Train accuracy: 26.6305
[2024-02-24 11:26:12,527 INFO] Sentences processed: 51200
[2024-02-24 11:26:12,527 INFO] Average bsz:  311/ 224/64
[2024-02-24 11:26:12,527 INFO] Validation perplexity: 539.856
[2024-02-24 11:26:12,527 INFO] Validation accuracy: 15.6019
[2024-02-24 11:26:12,528 INFO] Saving checkpoint tg-both/tg_01_step_800.pt
[2024-02-24 11:26:13,164 INFO] Step 850/10000; acc: 29.2; ppl:  87.5; xent: 4.5; lr: 1.00000; sents:    3200; bsz:  314/ 226/64; 3408/2456 tok/s;     40 sec;
[2024-02-24 11:26:13,779 INFO] Step 900/10000; acc: 34.7; ppl:  65.0; xent: 4.2; lr: 1.00000; sents:    3200; bsz:  283/ 197/64; 22996/16026 tok/s;     41 sec;
[2024-02-24 11:26:14,476 INFO] Step 950/10000; acc: 34.6; ppl:  60.6; xent: 4.1; lr: 1.00000; sents:    3200; bsz:  260/ 194/64; 18657/13960 tok/s;     42 sec;
[2024-02-24 11:26:15,103 INFO] Step 1000/10000; acc: 33.3; ppl:  66.7; xent: 4.2; lr: 1.00000; sents:    3200; bsz:  310/ 203/64; 24703/16201 tok/s;     42 sec;
[2024-02-24 11:26:18,990 INFO] valid stats calculation
                           took: 3.886993646621704 s.
[2024-02-24 11:26:18,991 INFO] Train perplexity: 169.38
[2024-02-24 11:26:18,991 INFO] Train accuracy: 27.7804
[2024-02-24 11:26:18,991 INFO] Sentences processed: 64000
[2024-02-24 11:26:18,991 INFO] Average bsz:  307/ 220/64
[2024-02-24 11:26:18,991 INFO] Validation perplexity: 428.446
[2024-02-24 11:26:18,991 INFO] Validation accuracy: 15.3711
[2024-02-24 11:26:18,992 INFO] Saving checkpoint tg-both/tg_01_step_1000.pt
[2024-02-24 11:26:19,620 INFO] Step 1050/10000; acc: 36.8; ppl:  49.3; xent: 3.9; lr: 1.00000; sents:    3200; bsz:  253/ 193/64; 2806/2140 tok/s;     47 sec;
[2024-02-24 11:26:20,197 INFO] Step 1100/10000; acc: 30.4; ppl:  77.2; xent: 4.3; lr: 1.00000; sents:    3200; bsz:  313/ 213/64; 27107/18441 tok/s;     47 sec;
[2024-02-24 11:26:20,866 INFO] Step 1150/10000; acc: 29.6; ppl:  73.8; xent: 4.3; lr: 1.00000; sents:    3200; bsz:  304/ 232/64; 22701/17313 tok/s;     48 sec;
[2024-02-24 11:26:21,490 INFO] Step 1200/10000; acc: 35.4; ppl:  59.2; xent: 4.1; lr: 1.00000; sents:    3200; bsz:  325/ 195/64; 26065/15611 tok/s;     49 sec;
[2024-02-24 11:26:25,457 INFO] valid stats calculation
                           took: 3.9663755893707275 s.
[2024-02-24 11:26:25,457 INFO] Train perplexity: 145.328
[2024-02-24 11:26:25,457 INFO] Train accuracy: 28.5813
[2024-02-24 11:26:25,457 INFO] Sentences processed: 76800
[2024-02-24 11:26:25,457 INFO] Average bsz:  305/ 218/64
[2024-02-24 11:26:25,457 INFO] Validation perplexity: 326.291
[2024-02-24 11:26:25,457 INFO] Validation accuracy: 15.6019
[2024-02-24 11:26:25,458 INFO] Saving checkpoint tg-both/tg_01_step_1200.pt
[2024-02-24 11:26:26,090 INFO] Step 1250/10000; acc: 39.5; ppl:  40.8; xent: 3.7; lr: 1.00000; sents:    3200; bsz:  281/ 183/64; 3055/1986 tok/s;     53 sec;
[2024-02-24 11:26:26,637 INFO] Step 1300/10000; acc: 35.2; ppl:  52.2; xent: 4.0; lr: 1.00000; sents:    3200; bsz:  283/ 200/64; 25858/18241 tok/s;     54 sec;
[2024-02-24 11:26:27,365 INFO] Step 1350/10000; acc: 28.1; ppl:  93.0; xent: 4.5; lr: 1.00000; sents:    3200; bsz:  339/ 241/64; 23311/16561 tok/s;     54 sec;
[2024-02-24 11:26:28,014 INFO] Step 1400/10000; acc: 33.5; ppl:  57.9; xent: 4.1; lr: 1.00000; sents:    3200; bsz:  308/ 201/64; 23759/15451 tok/s;     55 sec;
[2024-02-24 11:26:31,917 INFO] valid stats calculation
                           took: 3.902661085128784 s.
[2024-02-24 11:26:31,917 INFO] Train perplexity: 128.876
[2024-02-24 11:26:31,917 INFO] Train accuracy: 29.2748
[2024-02-24 11:26:31,917 INFO] Sentences processed: 89600
[2024-02-24 11:26:31,917 INFO] Average bsz:  305/ 217/64
[2024-02-24 11:26:31,918 INFO] Validation perplexity: 498.378
[2024-02-24 11:26:31,918 INFO] Validation accuracy: 15.7127
[2024-02-24 11:26:31,918 INFO] Saving checkpoint tg-both/tg_01_step_1400.pt
[2024-02-24 11:26:32,608 INFO] Step 1450/10000; acc: 31.3; ppl:  58.7; xent: 4.1; lr: 1.00000; sents:    3200; bsz:  290/ 226/64; 3162/2460 tok/s;     60 sec;
[2024-02-24 11:26:33,075 INFO] Step 1500/10000; acc: 38.7; ppl:  38.6; xent: 3.7; lr: 1.00000; sents:    3200; bsz:  287/ 185/64; 30710/19777 tok/s;     60 sec;
[2024-02-24 11:26:33,901 INFO] Step 1550/10000; acc: 27.5; ppl:  96.8; xent: 4.6; lr: 1.00000; sents:    3200; bsz:  369/ 268/64; 22351/16223 tok/s;     61 sec;
[2024-02-24 11:26:34,638 INFO] Step 1600/10000; acc: 31.2; ppl:  56.6; xent: 4.0; lr: 1.00000; sents:    3200; bsz:  314/ 227/64; 21302/15390 tok/s;     62 sec;
[2024-02-24 11:26:38,583 INFO] valid stats calculation
                           took: 3.9444050788879395 s.
[2024-02-24 11:26:38,583 INFO] Train perplexity: 117.171
[2024-02-24 11:26:38,583 INFO] Train accuracy: 29.5844
[2024-02-24 11:26:38,583 INFO] Sentences processed: 102400
[2024-02-24 11:26:38,583 INFO] Average bsz:  306/ 218/64
[2024-02-24 11:26:38,583 INFO] Validation perplexity: 392.16
[2024-02-24 11:26:38,583 INFO] Validation accuracy: 17.0421
[2024-02-24 11:26:38,584 INFO] Saving checkpoint tg-both/tg_01_step_1600.pt
[2024-02-24 11:26:39,360 INFO] Step 1650/10000; acc: 30.9; ppl:  72.8; xent: 4.3; lr: 1.00000; sents:    3150; bsz:  354/ 234/63; 3747/2475 tok/s;     66 sec;
[2024-02-24 11:26:39,927 INFO] Step 1700/10000; acc: 33.2; ppl:  49.6; xent: 3.9; lr: 1.00000; sents:    3200; bsz:  286/ 218/64; 25245/19187 tok/s;     67 sec;
[2024-02-24 11:26:40,581 INFO] Step 1750/10000; acc: 33.8; ppl:  46.1; xent: 3.8; lr: 1.00000; sents:    3200; bsz:  329/ 210/64; 25161/16068 tok/s;     68 sec;
[2024-02-24 11:26:41,254 INFO] Step 1800/10000; acc: 33.9; ppl:  41.6; xent: 3.7; lr: 1.00000; sents:    3200; bsz:  297/ 218/64; 22087/16189 tok/s;     68 sec;
[2024-02-24 11:26:45,309 INFO] valid stats calculation
                           took: 4.054612874984741 s.
[2024-02-24 11:26:45,309 INFO] Train perplexity: 106.903
[2024-02-24 11:26:45,309 INFO] Train accuracy: 29.9575
[2024-02-24 11:26:45,309 INFO] Sentences processed: 115150
[2024-02-24 11:26:45,309 INFO] Average bsz:  307/ 218/64
[2024-02-24 11:26:45,309 INFO] Validation perplexity: 315.492
[2024-02-24 11:26:45,309 INFO] Validation accuracy: 15.325
[2024-02-24 11:26:45,310 INFO] Saving checkpoint tg-both/tg_01_step_1800.pt
[2024-02-24 11:26:46,016 INFO] Step 1850/10000; acc: 32.4; ppl:  52.7; xent: 4.0; lr: 1.00000; sents:    3200; bsz:  314/ 217/64; 3293/2276 tok/s;     73 sec;
[2024-02-24 11:26:46,520 INFO] Step 1900/10000; acc: 34.4; ppl:  38.2; xent: 3.6; lr: 1.00000; sents:    3200; bsz:  306/ 207/64; 30377/20580 tok/s;     74 sec;
[2024-02-24 11:26:47,235 INFO] Step 1950/10000; acc: 30.6; ppl:  55.6; xent: 4.0; lr: 1.00000; sents:    3200; bsz:  319/ 240/64; 22317/16823 tok/s;     74 sec;
[2024-02-24 11:26:47,862 INFO] Step 2000/10000; acc: 37.4; ppl:  28.6; xent: 3.4; lr: 1.00000; sents:    3200; bsz:  257/ 197/64; 20525/15725 tok/s;     75 sec;
[2024-02-24 11:26:51,739 INFO] valid stats calculation
                           took: 3.8767237663269043 s.
[2024-02-24 11:26:51,739 INFO] Train perplexity: 97.703
[2024-02-24 11:26:51,739 INFO] Train accuracy: 30.3133
[2024-02-24 11:26:51,739 INFO] Sentences processed: 127950
[2024-02-24 11:26:51,739 INFO] Average bsz:  307/ 218/64
[2024-02-24 11:26:51,739 INFO] Validation perplexity: 265.606
[2024-02-24 11:26:51,739 INFO] Validation accuracy: 16.1743
[2024-02-24 11:26:51,740 INFO] Saving checkpoint tg-both/tg_01_step_2000.pt
[2024-02-24 11:26:52,402 INFO] Step 2050/10000; acc: 33.3; ppl:  39.8; xent: 3.7; lr: 1.00000; sents:    3200; bsz:  319/ 221/64; 3518/2432 tok/s;     80 sec;
[2024-02-24 11:26:53,042 INFO] Step 2100/10000; acc: 33.5; ppl:  49.4; xent: 3.9; lr: 1.00000; sents:    3200; bsz:  318/ 226/64; 24852/17705 tok/s;     80 sec;
[2024-02-24 11:26:53,695 INFO] Step 2150/10000; acc: 33.5; ppl:  36.3; xent: 3.6; lr: 1.00000; sents:    3200; bsz:  298/ 223/64; 22828/17099 tok/s;     81 sec;
[2024-02-24 11:26:54,453 INFO] Step 2200/10000; acc: 30.7; ppl:  48.8; xent: 3.9; lr: 1.00000; sents:    3200; bsz:  323/ 246/64; 21329/16205 tok/s;     82 sec;
[2024-02-24 11:26:58,451 INFO] valid stats calculation
                           took: 3.997751474380493 s.
[2024-02-24 11:26:58,451 INFO] Train perplexity: 90.4371
[2024-02-24 11:26:58,451 INFO] Train accuracy: 30.5383
[2024-02-24 11:26:58,451 INFO] Sentences processed: 140750
[2024-02-24 11:26:58,451 INFO] Average bsz:  307/ 219/64
[2024-02-24 11:26:58,451 INFO] Validation perplexity: 237.42
[2024-02-24 11:26:58,451 INFO] Validation accuracy: 16.3589
[2024-02-24 11:26:58,452 INFO] Saving checkpoint tg-both/tg_01_step_2200.pt
[2024-02-24 11:26:59,116 INFO] Step 2250/10000; acc: 36.8; ppl:  28.5; xent: 3.4; lr: 1.00000; sents:    3200; bsz:  278/ 199/64; 2981/2138 tok/s;     86 sec;
[2024-02-24 11:26:59,787 INFO] Step 2300/10000; acc: 28.4; ppl:  66.0; xent: 4.2; lr: 1.00000; sents:    3200; bsz:  377/ 270/64; 28133/20121 tok/s;     87 sec;
[2024-02-24 11:27:00,406 INFO] Step 2350/10000; acc: 38.3; ppl:  25.8; xent: 3.3; lr: 1.00000; sents:    3200; bsz:  298/ 200/64; 24085/16166 tok/s;     88 sec;
[2024-02-24 11:27:01,095 INFO] Step 2400/10000; acc: 35.8; ppl:  30.6; xent: 3.4; lr: 1.00000; sents:    3200; bsz:  288/ 217/64; 20895/15779 tok/s;     88 sec;
[2024-02-24 11:27:05,013 INFO] valid stats calculation
                           took: 3.917550802230835 s.
[2024-02-24 11:27:05,013 INFO] Train perplexity: 83.7982
[2024-02-24 11:27:05,014 INFO] Train accuracy: 30.8575
[2024-02-24 11:27:05,014 INFO] Sentences processed: 153550
[2024-02-24 11:27:05,014 INFO] Average bsz:  308/ 219/64
[2024-02-24 11:27:05,014 INFO] Validation perplexity: 322.181
[2024-02-24 11:27:05,014 INFO] Validation accuracy: 11.7984
[2024-02-24 11:27:05,014 INFO] Saving checkpoint tg-both/tg_01_step_2400.pt
[2024-02-24 11:27:05,775 INFO] Step 2450/10000; acc: 32.5; ppl:  43.1; xent: 3.8; lr: 1.00000; sents:    3200; bsz:  322/ 238/64; 3445/2544 tok/s;     93 sec;
[2024-02-24 11:27:06,379 INFO] Step 2500/10000; acc: 36.7; ppl:  24.4; xent: 3.2; lr: 1.00000; sents:    3200; bsz:  287/ 221/64; 23747/18340 tok/s;     94 sec;
[2024-02-24 11:27:07,034 INFO] Step 2550/10000; acc: 39.5; ppl:  21.4; xent: 3.1; lr: 1.00000; sents:    3200; bsz:  279/ 201/64; 21328/15332 tok/s;     94 sec;
[2024-02-24 11:27:07,731 INFO] Step 2600/10000; acc: 35.7; ppl:  27.6; xent: 3.3; lr: 1.00000; sents:    3200; bsz:  314/ 229/64; 22497/16411 tok/s;     95 sec;
[2024-02-24 11:27:11,750 INFO] valid stats calculation
                           took: 4.019406318664551 s.
[2024-02-24 11:27:11,751 INFO] Train perplexity: 77.0301
[2024-02-24 11:27:11,751 INFO] Train accuracy: 31.2575
[2024-02-24 11:27:11,751 INFO] Sentences processed: 166350
[2024-02-24 11:27:11,751 INFO] Average bsz:  307/ 219/64
[2024-02-24 11:27:11,751 INFO] Validation perplexity: 245.725
[2024-02-24 11:27:11,751 INFO] Validation accuracy: 15.1588
[2024-02-24 11:27:11,752 INFO] Saving checkpoint tg-both/tg_01_step_2600.pt
[2024-02-24 11:27:12,381 INFO] Step 2650/10000; acc: 39.6; ppl:  19.9; xent: 3.0; lr: 1.00000; sents:    3200; bsz:  299/ 214/64; 3220/2305 tok/s;    100 sec;
[2024-02-24 11:27:13,015 INFO] Step 2700/10000; acc: 43.7; ppl:  18.2; xent: 2.9; lr: 1.00000; sents:    3200; bsz:  297/ 194/64; 23390/15289 tok/s;    100 sec;
[2024-02-24 11:27:13,671 INFO] Step 2750/10000; acc: 39.9; ppl:  22.7; xent: 3.1; lr: 1.00000; sents:    3200; bsz:  333/ 211/64; 25395/16125 tok/s;    101 sec;
[2024-02-24 11:27:14,401 INFO] Step 2800/10000; acc: 36.9; ppl:  29.5; xent: 3.4; lr: 1.00000; sents:    3200; bsz:  352/ 231/64; 24073/15838 tok/s;    102 sec;
[2024-02-24 11:27:18,289 INFO] valid stats calculation
                           took: 3.8873813152313232 s.
[2024-02-24 11:27:18,289 INFO] Train perplexity: 70.7088
[2024-02-24 11:27:18,289 INFO] Train accuracy: 31.8562
[2024-02-24 11:27:18,289 INFO] Sentences processed: 179150
[2024-02-24 11:27:18,289 INFO] Average bsz:  308/ 219/64
[2024-02-24 11:27:18,289 INFO] Validation perplexity: 276.134
[2024-02-24 11:27:18,289 INFO] Validation accuracy: 15.7127
[2024-02-24 11:27:18,290 INFO] Saving checkpoint tg-both/tg_01_step_2800.pt
[2024-02-24 11:27:18,909 INFO] Step 2850/10000; acc: 46.0; ppl:  15.1; xent: 2.7; lr: 1.00000; sents:    3200; bsz:  282/ 192/64; 3123/2131 tok/s;    106 sec;
[2024-02-24 11:27:19,521 INFO] Step 2900/10000; acc: 44.2; ppl:  17.5; xent: 2.9; lr: 1.00000; sents:    3200; bsz:  340/ 207/64; 27787/16936 tok/s;    107 sec;
[2024-02-24 11:27:20,241 INFO] Step 2950/10000; acc: 39.0; ppl:  26.8; xent: 3.3; lr: 1.00000; sents:    3200; bsz:  335/ 230/64; 23268/15975 tok/s;    107 sec;
[2024-02-24 11:27:20,903 INFO] Step 3000/10000; acc: 48.6; ppl:  12.2; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  303/ 190/64; 22917/14379 tok/s;    108 sec;
[2024-02-24 11:27:24,800 INFO] valid stats calculation
                           took: 3.8969051837921143 s.
[2024-02-24 11:27:24,801 INFO] Train perplexity: 64.7893
[2024-02-24 11:27:24,801 INFO] Train accuracy: 32.6303
[2024-02-24 11:27:24,801 INFO] Sentences processed: 191950
[2024-02-24 11:27:24,801 INFO] Average bsz:  308/ 218/64
[2024-02-24 11:27:24,801 INFO] Validation perplexity: 319.355
[2024-02-24 11:27:24,801 INFO] Validation accuracy: 17.4298
[2024-02-24 11:27:24,802 INFO] Saving checkpoint tg-both/tg_01_step_3000.pt
[2024-02-24 11:27:25,446 INFO] Step 3050/10000; acc: 52.7; ppl:   8.6; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  266/ 183/64; 2930/2009 tok/s;    113 sec;
[2024-02-24 11:27:26,042 INFO] Step 3100/10000; acc: 46.9; ppl:  13.3; xent: 2.6; lr: 1.00000; sents:    3200; bsz:  284/ 208/64; 23870/17432 tok/s;    113 sec;
[2024-02-24 11:27:26,768 INFO] Step 3150/10000; acc: 41.1; ppl:  19.1; xent: 2.9; lr: 1.00000; sents:    3200; bsz:  327/ 248/64; 22504/17088 tok/s;    114 sec;
[2024-02-24 11:27:27,547 INFO] Step 3200/10000; acc: 34.8; ppl:  32.7; xent: 3.5; lr: 1.00000; sents:    3200; bsz:  355/ 281/64; 22795/18015 tok/s;    115 sec;
[2024-02-24 11:27:31,530 INFO] valid stats calculation
                           took: 3.982304096221924 s.
[2024-02-24 11:27:31,530 INFO] Train perplexity: 59.4951
[2024-02-24 11:27:31,530 INFO] Train accuracy: 33.2971
[2024-02-24 11:27:31,530 INFO] Sentences processed: 204750
[2024-02-24 11:27:31,530 INFO] Average bsz:  308/ 219/64
[2024-02-24 11:27:31,530 INFO] Validation perplexity: 284.665
[2024-02-24 11:27:31,530 INFO] Validation accuracy: 16.9775
[2024-02-24 11:27:31,531 INFO] Saving checkpoint tg-both/tg_01_step_3200.pt
[2024-02-24 11:27:32,217 INFO] Step 3250/10000; acc: 38.9; ppl:  23.4; xent: 3.2; lr: 1.00000; sents:    3200; bsz:  349/ 258/64; 3737/2767 tok/s;    119 sec;
[2024-02-24 11:27:32,805 INFO] Step 3300/10000; acc: 46.2; ppl:  13.0; xent: 2.6; lr: 1.00000; sents:    3200; bsz:  292/ 224/64; 24812/19077 tok/s;    120 sec;
[2024-02-24 11:27:33,442 INFO] Step 3350/10000; acc: 49.7; ppl:   9.0; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  296/ 216/64; 23224/16991 tok/s;    121 sec;
[2024-02-24 11:27:34,086 INFO] Step 3400/10000; acc: 54.4; ppl:   6.9; xent: 1.9; lr: 1.00000; sents:    3200; bsz:  293/ 198/64; 22753/15400 tok/s;    121 sec;
[2024-02-24 11:27:38,229 INFO] valid stats calculation
                           took: 4.142427206039429 s.
[2024-02-24 11:27:38,230 INFO] Train perplexity: 54.0903
[2024-02-24 11:27:38,230 INFO] Train accuracy: 34.1098
[2024-02-24 11:27:38,230 INFO] Sentences processed: 217550
[2024-02-24 11:27:38,230 INFO] Average bsz:  308/ 219/64
[2024-02-24 11:27:38,230 INFO] Validation perplexity: 472.642
[2024-02-24 11:27:38,230 INFO] Validation accuracy: 17.5591
[2024-02-24 11:27:38,231 INFO] Saving checkpoint tg-both/tg_01_step_3400.pt
[2024-02-24 11:27:38,885 INFO] Step 3450/10000; acc: 50.0; ppl:  11.1; xent: 2.4; lr: 1.00000; sents:    3200; bsz:  324/ 208/64; 3373/2172 tok/s;    126 sec;
[2024-02-24 11:27:41,886 INFO] Step 3500/10000; acc: 56.6; ppl:   7.3; xent: 2.0; lr: 1.00000; sents:    3200; bsz:  291/ 202/64; 4847/3360 tok/s;    129 sec;
[2024-02-24 11:27:42,517 INFO] Step 3550/10000; acc: 53.0; ppl:   7.8; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  302/ 217/64; 23974/17204 tok/s;    130 sec;
[2024-02-24 11:27:43,052 INFO] Step 3600/10000; acc: 51.4; ppl:   9.0; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  302/ 237/64; 28227/22161 tok/s;    130 sec;
[2024-02-24 11:27:47,077 INFO] valid stats calculation
                           took: 4.0247275829315186 s.
[2024-02-24 11:27:47,078 INFO] Train perplexity: 48.9391
[2024-02-24 11:27:47,078 INFO] Train accuracy: 35.1276
[2024-02-24 11:27:47,078 INFO] Sentences processed: 230350
[2024-02-24 11:27:47,078 INFO] Average bsz:  308/ 219/64
[2024-02-24 11:27:47,078 INFO] Validation perplexity: 370.43
[2024-02-24 11:27:47,078 INFO] Validation accuracy: 17.7714
[2024-02-24 11:27:47,079 INFO] Saving checkpoint tg-both/tg_01_step_3600.pt
[2024-02-24 11:27:47,637 INFO] Step 3650/10000; acc: 60.4; ppl:   4.7; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  270/ 192/64; 2945/2093 tok/s;    135 sec;
[2024-02-24 11:27:48,207 INFO] Step 3700/10000; acc: 50.6; ppl:  10.2; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  355/ 250/64; 31204/21982 tok/s;    135 sec;
[2024-02-24 11:27:48,730 INFO] Step 3750/10000; acc: 54.5; ppl:   9.0; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  333/ 235/64; 31896/22466 tok/s;    136 sec;
[2024-02-24 11:27:49,241 INFO] Step 3800/10000; acc: 62.2; ppl:   6.0; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  326/ 208/64; 31905/20386 tok/s;    136 sec;
[2024-02-24 11:27:53,391 INFO] valid stats calculation
                           took: 4.150188207626343 s.
[2024-02-24 11:27:53,392 INFO] Train perplexity: 44.249
[2024-02-24 11:27:53,392 INFO] Train accuracy: 36.2633
[2024-02-24 11:27:53,392 INFO] Sentences processed: 243150
[2024-02-24 11:27:53,392 INFO] Average bsz:  309/ 219/64
[2024-02-24 11:27:53,392 INFO] Validation perplexity: 466.828
[2024-02-24 11:27:53,392 INFO] Validation accuracy: 17.5037
[2024-02-24 11:27:53,393 INFO] Saving checkpoint tg-both/tg_01_step_3800.pt
[2024-02-24 11:27:53,963 INFO] Step 3850/10000; acc: 59.6; ppl:   5.7; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  305/ 221/64; 3226/2343 tok/s;    141 sec;
[2024-02-24 11:27:54,438 INFO] Step 3900/10000; acc: 61.1; ppl:   6.1; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  275/ 211/64; 28948/22142 tok/s;    142 sec;
[2024-02-24 11:27:54,888 INFO] Step 3950/10000; acc: 70.2; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  274/ 200/64; 30442/22234 tok/s;    142 sec;
[2024-02-24 11:27:55,366 INFO] Step 4000/10000; acc: 72.0; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  302/ 204/64; 31628/21334 tok/s;    142 sec;
[2024-02-24 11:27:59,356 INFO] valid stats calculation
                           took: 3.989737033843994 s.
[2024-02-24 11:27:59,357 INFO] Train perplexity: 39.5625
[2024-02-24 11:27:59,357 INFO] Train accuracy: 37.6636
[2024-02-24 11:27:59,357 INFO] Sentences processed: 255950
[2024-02-24 11:27:59,357 INFO] Average bsz:  308/ 218/64
[2024-02-24 11:27:59,357 INFO] Validation perplexity: 610.653
[2024-02-24 11:27:59,357 INFO] Validation accuracy: 17.6514
[2024-02-24 11:27:59,358 INFO] Saving checkpoint tg-both/tg_01_step_4000.pt
[2024-02-24 11:27:59,889 INFO] Step 4050/10000; acc: 69.3; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  283/ 201/64; 3128/2223 tok/s;    147 sec;
[2024-02-24 11:28:00,425 INFO] Step 4100/10000; acc: 68.0; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  301/ 213/64; 28045/19848 tok/s;    148 sec;
[2024-02-24 11:28:01,124 INFO] Step 4150/10000; acc: 58.9; ppl:  10.1; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  318/ 239/64; 22737/17093 tok/s;    148 sec;
[2024-02-24 11:28:01,670 INFO] Step 4200/10000; acc: 72.8; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  262/ 200/64; 24071/18317 tok/s;    149 sec;
[2024-02-24 11:28:05,705 INFO] valid stats calculation
                           took: 4.034967660903931 s.
[2024-02-24 11:28:05,705 INFO] Train perplexity: 35.7934
[2024-02-24 11:28:05,705 INFO] Train accuracy: 39.0233
[2024-02-24 11:28:05,705 INFO] Sentences processed: 268750
[2024-02-24 11:28:05,706 INFO] Average bsz:  307/ 218/64
[2024-02-24 11:28:05,706 INFO] Validation perplexity: 684.904
[2024-02-24 11:28:05,706 INFO] Validation accuracy: 17.6976
[2024-02-24 11:28:05,706 INFO] Saving checkpoint tg-both/tg_01_step_4200.pt
[2024-02-24 11:28:06,457 INFO] Step 4250/10000; acc: 69.8; ppl:   4.7; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  305/ 210/64; 3188/2197 tok/s;    154 sec;
[2024-02-24 11:28:07,160 INFO] Step 4300/10000; acc: 68.8; ppl:   4.6; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  308/ 209/64; 21963/14852 tok/s;    154 sec;
[2024-02-24 11:28:07,867 INFO] Step 4350/10000; acc: 69.6; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  299/ 231/64; 21139/16341 tok/s;    155 sec;
[2024-02-24 11:28:08,475 INFO] Step 4400/10000; acc: 70.4; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  295/ 217/64; 24241/17826 tok/s;    156 sec;
[2024-02-24 11:28:12,577 INFO] valid stats calculation
                           took: 4.100937843322754 s.
[2024-02-24 11:28:12,577 INFO] Train perplexity: 32.5313
[2024-02-24 11:28:12,577 INFO] Train accuracy: 40.4066
[2024-02-24 11:28:12,577 INFO] Sentences processed: 281550
[2024-02-24 11:28:12,577 INFO] Average bsz:  307/ 218/64
[2024-02-24 11:28:12,577 INFO] Validation perplexity: 676.488
[2024-02-24 11:28:12,577 INFO] Validation accuracy: 17.2083
[2024-02-24 11:28:12,578 INFO] Saving checkpoint tg-both/tg_01_step_4400.pt
[2024-02-24 11:28:13,285 INFO] Step 4450/10000; acc: 78.5; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  279/ 207/64; 2901/2147 tok/s;    160 sec;
[2024-02-24 11:28:13,948 INFO] Step 4500/10000; acc: 79.9; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  283/ 224/64; 21321/16883 tok/s;    161 sec;
[2024-02-24 11:28:14,601 INFO] Step 4550/10000; acc: 80.0; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  284/ 212/64; 21790/16293 tok/s;    162 sec;
[2024-02-24 11:28:15,219 INFO] Step 4600/10000; acc: 77.2; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  288/ 194/64; 23303/15683 tok/s;    162 sec;
[2024-02-24 11:28:19,229 INFO] valid stats calculation
                           took: 4.0101635456085205 s.
[2024-02-24 11:28:19,230 INFO] Train perplexity: 29.1002
[2024-02-24 11:28:19,230 INFO] Train accuracy: 42.0168
[2024-02-24 11:28:19,230 INFO] Sentences processed: 294350
[2024-02-24 11:28:19,230 INFO] Average bsz:  306/ 218/64
[2024-02-24 11:28:19,230 INFO] Validation perplexity: 633.798
[2024-02-24 11:28:19,230 INFO] Validation accuracy: 15.7866
[2024-02-24 11:28:19,231 INFO] Saving checkpoint tg-both/tg_01_step_4600.pt
[2024-02-24 11:28:20,017 INFO] Step 4650/10000; acc: 69.2; ppl:   5.4; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  330/ 225/64; 3435/2348 tok/s;    167 sec;
[2024-02-24 11:28:20,703 INFO] Step 4700/10000; acc: 73.7; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  320/ 218/64; 23313/15850 tok/s;    168 sec;
[2024-02-24 11:28:21,402 INFO] Step 4750/10000; acc: 73.7; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  306/ 222/64; 21921/15894 tok/s;    169 sec;
[2024-02-24 11:28:22,095 INFO] Step 4800/10000; acc: 77.0; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  318/ 230/64; 22955/16546 tok/s;    169 sec;
[2024-02-24 11:28:26,108 INFO] valid stats calculation
                           took: 4.011994123458862 s.
[2024-02-24 11:28:26,108 INFO] Train perplexity: 26.7625
[2024-02-24 11:28:26,108 INFO] Train accuracy: 43.3589
[2024-02-24 11:28:26,108 INFO] Sentences processed: 307150
[2024-02-24 11:28:26,108 INFO] Average bsz:  306/ 218/64
[2024-02-24 11:28:26,108 INFO] Validation perplexity: 763.506
[2024-02-24 11:28:26,108 INFO] Validation accuracy: 17.4114
[2024-02-24 11:28:26,109 INFO] Saving checkpoint tg-both/tg_01_step_4800.pt
[2024-02-24 11:28:26,891 INFO] Step 4850/10000; acc: 72.8; ppl:   4.8; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  322/ 233/64; 3356/2425 tok/s;    174 sec;
[2024-02-24 11:28:27,554 INFO] Step 4900/10000; acc: 82.1; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  298/ 213/64; 22489/16092 tok/s;    175 sec;
[2024-02-24 11:28:28,282 INFO] Step 4950/10000; acc: 72.6; ppl:   4.8; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  348/ 224/64; 23906/15399 tok/s;    175 sec;
[2024-02-24 11:28:29,017 INFO] Step 5000/10000; acc: 76.6; ppl:   3.9; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  331/ 218/64; 22496/14834 tok/s;    176 sec;
[2024-02-24 11:28:33,018 INFO] valid stats calculation
                           took: 4.00054144859314 s.
[2024-02-24 11:28:33,018 INFO] Train perplexity: 24.7253
[2024-02-24 11:28:33,018 INFO] Train accuracy: 44.6849
[2024-02-24 11:28:33,018 INFO] Sentences processed: 319950
[2024-02-24 11:28:33,018 INFO] Average bsz:  307/ 218/64
[2024-02-24 11:28:33,018 INFO] Validation perplexity: 584.657
[2024-02-24 11:28:33,018 INFO] Validation accuracy: 15.9158
[2024-02-24 11:28:33,019 INFO] Saving checkpoint tg-both/tg_01_step_5000.pt
[2024-02-24 11:28:33,680 INFO] Step 5050/10000; acc: 85.1; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  305/ 217/64; 3266/2325 tok/s;    181 sec;
[2024-02-24 11:28:34,351 INFO] Step 5100/10000; acc: 89.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  292/ 214/64; 21782/15954 tok/s;    181 sec;
[2024-02-24 11:28:35,061 INFO] Step 5150/10000; acc: 80.5; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  325/ 224/64; 22906/15797 tok/s;    182 sec;
[2024-02-24 11:28:35,689 INFO] Step 5200/10000; acc: 89.4; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  244/ 187/64; 19451/14868 tok/s;    183 sec;
[2024-02-24 11:28:39,655 INFO] valid stats calculation
                           took: 3.964777708053589 s.
[2024-02-24 11:28:39,655 INFO] Train perplexity: 22.4698
[2024-02-24 11:28:39,655 INFO] Train accuracy: 46.2161
[2024-02-24 11:28:39,655 INFO] Sentences processed: 332750
[2024-02-24 11:28:39,655 INFO] Average bsz:  306/ 218/64
[2024-02-24 11:28:39,655 INFO] Validation perplexity: 808.08
[2024-02-24 11:28:39,655 INFO] Validation accuracy: 17.7806
[2024-02-24 11:28:39,656 INFO] Saving checkpoint tg-both/tg_01_step_5200.pt
[2024-02-24 11:28:40,264 INFO] Step 5250/10000; acc: 84.8; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  298/ 221/64; 3260/2411 tok/s;    187 sec;
[2024-02-24 11:28:40,915 INFO] Step 5300/10000; acc: 88.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  287/ 220/64; 22009/16854 tok/s;    188 sec;
[2024-02-24 11:28:41,655 INFO] Step 5350/10000; acc: 85.1; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  286/ 209/64; 19368/14148 tok/s;    189 sec;
[2024-02-24 11:28:42,340 INFO] Step 5400/10000; acc: 77.7; ppl:   4.2; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  309/ 203/64; 22554/14804 tok/s;    189 sec;
[2024-02-24 11:28:46,376 INFO] valid stats calculation
                           took: 4.035148620605469 s.
[2024-02-24 11:28:46,376 INFO] Train perplexity: 20.6912
[2024-02-24 11:28:46,376 INFO] Train accuracy: 47.5948
[2024-02-24 11:28:46,376 INFO] Sentences processed: 345550
[2024-02-24 11:28:46,376 INFO] Average bsz:  306/ 218/64
[2024-02-24 11:28:46,377 INFO] Validation perplexity: 637.732
[2024-02-24 11:28:46,377 INFO] Validation accuracy: 15.3065
[2024-02-24 11:28:46,378 INFO] Saving checkpoint tg-both/tg_01_step_5400.pt
[2024-02-24 11:28:47,001 INFO] Step 5450/10000; acc: 86.6; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  280/ 201/64; 3007/2158 tok/s;    194 sec;
[2024-02-24 11:28:47,743 INFO] Step 5500/10000; acc: 74.6; ppl:   4.8; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  359/ 252/64; 24192/16991 tok/s;    195 sec;
[2024-02-24 11:28:48,403 INFO] Step 5550/10000; acc: 83.5; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  301/ 213/64; 22766/16092 tok/s;    196 sec;
[2024-02-24 11:28:49,047 INFO] Step 5600/10000; acc: 92.2; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  291/ 206/64; 22573/16010 tok/s;    196 sec;
[2024-02-24 11:28:53,074 INFO] valid stats calculation
                           took: 4.026112079620361 s.
[2024-02-24 11:28:53,074 INFO] Train perplexity: 19.178
[2024-02-24 11:28:53,074 INFO] Train accuracy: 48.886
[2024-02-24 11:28:53,074 INFO] Sentences processed: 358350
[2024-02-24 11:28:53,074 INFO] Average bsz:  306/ 218/64
[2024-02-24 11:28:53,074 INFO] Validation perplexity: 718.624
[2024-02-24 11:28:53,074 INFO] Validation accuracy: 18.3346
[2024-02-24 11:28:53,075 INFO] Saving checkpoint tg-both/tg_01_step_5600.pt
[2024-02-24 11:28:53,806 INFO] Step 5650/10000; acc: 69.1; ppl:   8.3; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  340/ 252/64; 3571/2643 tok/s;    201 sec;
[2024-02-24 11:28:54,479 INFO] Step 5700/10000; acc: 90.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  305/ 209/64; 22650/15529 tok/s;    202 sec;
[2024-02-24 11:28:55,153 INFO] Step 5750/10000; acc: 88.0; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  317/ 216/64; 23543/16015 tok/s;    202 sec;
[2024-02-24 11:28:55,809 INFO] Step 5800/10000; acc: 91.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  272/ 194/64; 20704/14758 tok/s;    203 sec;
[2024-02-24 11:28:59,779 INFO] valid stats calculation
                           took: 3.9691739082336426 s.
[2024-02-24 11:28:59,779 INFO] Train perplexity: 17.9236
[2024-02-24 11:28:59,779 INFO] Train accuracy: 50.0887
[2024-02-24 11:28:59,779 INFO] Sentences processed: 371150
[2024-02-24 11:28:59,779 INFO] Average bsz:  306/ 218/64
[2024-02-24 11:28:59,780 INFO] Validation perplexity: 709.177
[2024-02-24 11:28:59,780 INFO] Validation accuracy: 18.3346
[2024-02-24 11:28:59,780 INFO] Saving checkpoint tg-both/tg_01_step_5800.pt
[2024-02-24 11:29:00,389 INFO] Step 5850/10000; acc: 88.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  292/ 198/64; 3187/2167 tok/s;    208 sec;
[2024-02-24 11:29:01,040 INFO] Step 5900/10000; acc: 84.5; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  300/ 192/64; 23005/14745 tok/s;    208 sec;
[2024-02-24 11:29:01,784 INFO] Step 5950/10000; acc: 77.7; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  321/ 236/64; 21602/15850 tok/s;    209 sec;
[2024-02-24 11:29:02,458 INFO] Step 6000/10000; acc: 94.1; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  314/ 210/64; 23270/15578 tok/s;    210 sec;
[2024-02-24 11:29:06,405 INFO] valid stats calculation
                           took: 3.946841239929199 s.
[2024-02-24 11:29:06,405 INFO] Train perplexity: 16.7555
[2024-02-24 11:29:06,405 INFO] Train accuracy: 51.2411
[2024-02-24 11:29:06,405 INFO] Sentences processed: 383950
[2024-02-24 11:29:06,405 INFO] Average bsz:  306/ 217/64
[2024-02-24 11:29:06,406 INFO] Validation perplexity: 833.538
[2024-02-24 11:29:06,406 INFO] Validation accuracy: 18.51
[2024-02-24 11:29:06,406 INFO] Saving checkpoint tg-both/tg_01_step_6000.pt
[2024-02-24 11:29:07,139 INFO] Step 6050/10000; acc: 80.7; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3155; bsz:  337/ 227/63; 3599/2426 tok/s;    214 sec;
[2024-02-24 11:29:07,865 INFO] Step 6100/10000; acc: 86.4; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  293/ 232/64; 20179/15972 tok/s;    215 sec;
[2024-02-24 11:29:08,538 INFO] Step 6150/10000; acc: 90.7; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  321/ 215/64; 23881/16006 tok/s;    216 sec;
[2024-02-24 11:29:09,256 INFO] Step 6200/10000; acc: 79.3; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  347/ 229/64; 24198/15921 tok/s;    216 sec;
[2024-02-24 11:29:13,221 INFO] valid stats calculation
                           took: 3.964296579360962 s.
[2024-02-24 11:29:13,221 INFO] Train perplexity: 15.7383
[2024-02-24 11:29:13,221 INFO] Train accuracy: 52.3431
[2024-02-24 11:29:13,221 INFO] Sentences processed: 396705
[2024-02-24 11:29:13,221 INFO] Average bsz:  307/ 218/64
[2024-02-24 11:29:13,221 INFO] Validation perplexity: 570.668
[2024-02-24 11:29:13,221 INFO] Validation accuracy: 17.0513
[2024-02-24 11:29:13,222 INFO] Saving checkpoint tg-both/tg_01_step_6200.pt
[2024-02-24 11:29:13,897 INFO] Step 6250/10000; acc: 76.1; ppl:   4.4; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  331/ 239/64; 3571/2579 tok/s;    221 sec;
[2024-02-24 11:29:14,685 INFO] Step 6300/10000; acc: 74.6; ppl:   5.4; xent: 1.7; lr: 1.00000; sents:    3195; bsz:  371/ 265/64; 23535/16843 tok/s;    222 sec;
[2024-02-24 11:29:15,351 INFO] Step 6350/10000; acc: 86.4; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  316/ 227/64; 23740/17032 tok/s;    222 sec;
[2024-02-24 11:29:16,036 INFO] Step 6400/10000; acc: 84.2; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  268/ 209/64; 19602/15259 tok/s;    223 sec;
[2024-02-24 11:29:20,038 INFO] valid stats calculation
                           took: 4.0020692348480225 s.
[2024-02-24 11:29:20,039 INFO] Train perplexity: 14.9628
[2024-02-24 11:29:20,039 INFO] Train accuracy: 53.2729
[2024-02-24 11:29:20,039 INFO] Sentences processed: 409500
[2024-02-24 11:29:20,039 INFO] Average bsz:  307/ 218/64
[2024-02-24 11:29:20,039 INFO] Validation perplexity: 481.51
[2024-02-24 11:29:20,039 INFO] Validation accuracy: 17.7899
[2024-02-24 11:29:20,040 INFO] Saving checkpoint tg-both/tg_01_step_6400.pt
[2024-02-24 11:29:20,736 INFO] Step 6450/10000; acc: 80.8; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  312/ 231/64; 3322/2462 tok/s;    228 sec;
[2024-02-24 11:29:21,438 INFO] Step 6500/10000; acc: 93.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  300/ 198/64; 21356/14143 tok/s;    229 sec;
[2024-02-24 11:29:22,053 INFO] Step 6550/10000; acc: 91.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  306/ 194/64; 24876/15770 tok/s;    229 sec;
[2024-02-24 11:29:22,866 INFO] Step 6600/10000; acc: 74.3; ppl:   5.2; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  355/ 256/64; 21825/15737 tok/s;    230 sec;
[2024-02-24 11:29:26,906 INFO] valid stats calculation
                           took: 4.0391340255737305 s.
[2024-02-24 11:29:26,906 INFO] Train perplexity: 14.1849
[2024-02-24 11:29:26,906 INFO] Train accuracy: 54.2139
[2024-02-24 11:29:26,906 INFO] Sentences processed: 422300
[2024-02-24 11:29:26,906 INFO] Average bsz:  308/ 218/64
[2024-02-24 11:29:26,906 INFO] Validation perplexity: 489.454
[2024-02-24 11:29:26,906 INFO] Validation accuracy: 16.3866
[2024-02-24 11:29:26,907 INFO] Saving checkpoint tg-both/tg_01_step_6600.pt
[2024-02-24 11:29:27,452 INFO] Step 6650/10000; acc: 92.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  323/ 218/64; 3518/2381 tok/s;    235 sec;
[2024-02-24 11:29:28,215 INFO] Step 6700/10000; acc: 83.7; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  352/ 246/64; 23058/16124 tok/s;    235 sec;
[2024-02-24 11:29:28,873 INFO] Step 6750/10000; acc: 92.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  279/ 190/64; 21211/14446 tok/s;    236 sec;
[2024-02-24 11:29:29,506 INFO] Step 6800/10000; acc: 85.9; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  308/ 204/64; 24373/16119 tok/s;    237 sec;
[2024-02-24 11:29:33,585 INFO] valid stats calculation
                           took: 4.078970432281494 s.
[2024-02-24 11:29:33,585 INFO] Train perplexity: 13.3947
[2024-02-24 11:29:33,585 INFO] Train accuracy: 55.1967
[2024-02-24 11:29:33,585 INFO] Sentences processed: 435100
[2024-02-24 11:29:33,585 INFO] Average bsz:  308/ 218/64
[2024-02-24 11:29:33,585 INFO] Validation perplexity: 517.156
[2024-02-24 11:29:33,585 INFO] Validation accuracy: 17.116
[2024-02-24 11:29:33,586 INFO] Saving checkpoint tg-both/tg_01_step_6800.pt
[2024-02-24 11:29:34,252 INFO] Step 6850/10000; acc: 72.3; ppl:   5.5; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  338/ 232/64; 3563/2446 tok/s;    241 sec;
[2024-02-24 11:29:35,016 INFO] Step 6900/10000; acc: 72.3; ppl:   6.0; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  383/ 287/64; 25091/18800 tok/s;    242 sec;
[2024-02-24 11:29:36,189 INFO] Step 6950/10000; acc: 92.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  296/ 209/64; 12640/8922 tok/s;    243 sec;
[2024-02-24 11:29:36,895 INFO] Step 7000/10000; acc: 92.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  310/ 208/64; 21927/14712 tok/s;    244 sec;
[2024-02-24 11:29:40,960 INFO] valid stats calculation
                           took: 4.064429759979248 s.
[2024-02-24 11:29:40,960 INFO] Train perplexity: 12.8206
[2024-02-24 11:29:40,960 INFO] Train accuracy: 55.9883
[2024-02-24 11:29:40,960 INFO] Sentences processed: 447900
[2024-02-24 11:29:40,960 INFO] Average bsz:  309/ 219/64
[2024-02-24 11:29:40,960 INFO] Validation perplexity: 452.877
[2024-02-24 11:29:40,960 INFO] Validation accuracy: 18.233
[2024-02-24 11:29:40,961 INFO] Saving checkpoint tg-both/tg_01_step_7000.pt
[2024-02-24 11:29:41,711 INFO] Step 7050/10000; acc: 96.9; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    3200; bsz:  314/ 227/64; 3256/2352 tok/s;    249 sec;
[2024-02-24 11:29:42,366 INFO] Step 7100/10000; acc: 97.3; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    3200; bsz:  312/ 211/64; 23833/16077 tok/s;    249 sec;
[2024-02-24 11:29:43,054 INFO] Step 7150/10000; acc: 95.4; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  259/ 200/64; 18815/14530 tok/s;    250 sec;
[2024-02-24 11:29:43,667 INFO] Step 7200/10000; acc: 96.3; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    3200; bsz:  265/ 209/64; 21614/17020 tok/s;    251 sec;
[2024-02-24 11:29:47,693 INFO] valid stats calculation
                           took: 4.025723695755005 s.
[2024-02-24 11:29:47,693 INFO] Train perplexity: 12.0128
[2024-02-24 11:29:47,693 INFO] Train accuracy: 57.077
[2024-02-24 11:29:47,693 INFO] Sentences processed: 460700
[2024-02-24 11:29:47,693 INFO] Average bsz:  308/ 218/64
[2024-02-24 11:29:47,693 INFO] Validation perplexity: 562.305
[2024-02-24 11:29:47,693 INFO] Validation accuracy: 17.4391
[2024-02-24 11:29:47,694 INFO] Saving checkpoint tg-both/tg_01_step_7200.pt
[2024-02-24 11:29:48,199 INFO] Step 7250/10000; acc: 95.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  259/ 191/64; 2852/2104 tok/s;    255 sec;
[2024-02-24 11:29:48,671 INFO] Step 7300/10000; acc: 89.1; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  306/ 208/64; 32414/22083 tok/s;    256 sec;
[2024-02-24 11:29:49,142 INFO] Step 7350/10000; acc: 92.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  306/ 214/64; 32495/22780 tok/s;    256 sec;
[2024-02-24 11:29:49,703 INFO] Step 7400/10000; acc: 77.2; ppl:   4.2; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  358/ 243/64; 31964/21715 tok/s;    257 sec;
[2024-02-24 11:29:53,647 INFO] valid stats calculation
                           took: 3.94415283203125 s.
[2024-02-24 11:29:53,648 INFO] Train perplexity: 11.4595
[2024-02-24 11:29:53,648 INFO] Train accuracy: 57.8949
[2024-02-24 11:29:53,648 INFO] Sentences processed: 473500
[2024-02-24 11:29:53,648 INFO] Average bsz:  308/ 218/64
[2024-02-24 11:29:53,648 INFO] Validation perplexity: 563.009
[2024-02-24 11:29:53,648 INFO] Validation accuracy: 16.2943
[2024-02-24 11:29:53,649 INFO] Saving checkpoint tg-both/tg_01_step_7400.pt
[2024-02-24 11:29:54,231 INFO] Step 7450/10000; acc: 94.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  320/ 216/64; 3533/2389 tok/s;    261 sec;
[2024-02-24 11:29:54,716 INFO] Step 7500/10000; acc: 90.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  288/ 218/64; 29699/22533 tok/s;    262 sec;
[2024-02-24 11:29:55,171 INFO] Step 7550/10000; acc: 92.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  301/ 205/64; 33074/22534 tok/s;    262 sec;
[2024-02-24 11:29:55,641 INFO] Step 7600/10000; acc: 92.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  310/ 208/64; 33040/22161 tok/s;    263 sec;
[2024-02-24 11:29:59,478 INFO] valid stats calculation
                           took: 3.8362481594085693 s.
[2024-02-24 11:29:59,478 INFO] Train perplexity: 10.8741
[2024-02-24 11:29:59,478 INFO] Train accuracy: 58.7853
[2024-02-24 11:29:59,478 INFO] Sentences processed: 486300
[2024-02-24 11:29:59,478 INFO] Average bsz:  308/ 218/64
[2024-02-24 11:29:59,478 INFO] Validation perplexity: 491.536
[2024-02-24 11:29:59,478 INFO] Validation accuracy: 18.9254
[2024-02-24 11:29:59,479 INFO] Saving checkpoint tg-both/tg_01_step_7600.pt
[2024-02-24 11:30:00,017 INFO] Step 7650/10000; acc: 93.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  285/ 207/64; 3262/2364 tok/s;    267 sec;
[2024-02-24 11:30:00,517 INFO] Step 7700/10000; acc: 87.1; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  291/ 241/64; 29086/24094 tok/s;    268 sec;
[2024-02-24 11:30:01,050 INFO] Step 7750/10000; acc: 77.9; ppl:   4.3; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  337/ 238/64; 31607/22280 tok/s;    268 sec;
[2024-02-24 11:30:01,494 INFO] Step 7800/10000; acc: 90.4; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  300/ 192/64; 33778/21610 tok/s;    269 sec;
[2024-02-24 11:30:05,345 INFO] valid stats calculation
                           took: 3.851323127746582 s.
[2024-02-24 11:30:05,346 INFO] Train perplexity: 10.4523
[2024-02-24 11:30:05,346 INFO] Train accuracy: 59.5081
[2024-02-24 11:30:05,346 INFO] Sentences processed: 499100
[2024-02-24 11:30:05,346 INFO] Average bsz:  308/ 218/64
[2024-02-24 11:30:05,346 INFO] Validation perplexity: 523.567
[2024-02-24 11:30:05,346 INFO] Validation accuracy: 15.8696
[2024-02-24 11:30:05,347 INFO] Saving checkpoint tg-both/tg_01_step_7800.pt
[2024-02-24 11:30:05,857 INFO] Step 7850/10000; acc: 91.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  298/ 186/64; 3417/2132 tok/s;    273 sec;
[2024-02-24 11:30:06,290 INFO] Step 7900/10000; acc: 96.1; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    3200; bsz:  268/ 196/64; 30892/22615 tok/s;    273 sec;
[2024-02-24 11:30:06,754 INFO] Step 7950/10000; acc: 90.1; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  297/ 222/64; 32031/23909 tok/s;    274 sec;
[2024-02-24 11:30:07,242 INFO] Step 8000/10000; acc: 86.3; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  321/ 233/64; 32947/23872 tok/s;    274 sec;
[2024-02-24 11:30:11,244 INFO] valid stats calculation
                           took: 4.001718997955322 s.
[2024-02-24 11:30:11,244 INFO] Train perplexity: 10.0014
[2024-02-24 11:30:11,244 INFO] Train accuracy: 60.2574
[2024-02-24 11:30:11,244 INFO] Sentences processed: 511900
[2024-02-24 11:30:11,244 INFO] Average bsz:  307/ 218/64
[2024-02-24 11:30:11,245 INFO] Validation perplexity: 392.368
[2024-02-24 11:30:11,245 INFO] Validation accuracy: 18.8331
[2024-02-24 11:30:11,246 INFO] Saving checkpoint tg-both/tg_01_step_8000.pt
[2024-02-24 11:30:11,848 INFO] Step 8050/10000; acc: 77.9; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  335/ 234/64; 3635/2542 tok/s;    279 sec;
[2024-02-24 11:30:12,295 INFO] Step 8100/10000; acc: 92.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  297/ 201/64; 33210/22454 tok/s;    279 sec;
[2024-02-24 11:30:12,863 INFO] Step 8150/10000; acc: 78.9; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  317/ 243/64; 27952/21385 tok/s;    280 sec;
[2024-02-24 11:30:13,333 INFO] Step 8200/10000; acc: 90.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  294/ 216/64; 31345/22966 tok/s;    280 sec;
[2024-02-24 11:30:17,271 INFO] valid stats calculation
                           took: 3.9375548362731934 s.
[2024-02-24 11:30:17,271 INFO] Train perplexity: 9.66518
[2024-02-24 11:30:17,271 INFO] Train accuracy: 60.8618
[2024-02-24 11:30:17,271 INFO] Sentences processed: 524700
[2024-02-24 11:30:17,271 INFO] Average bsz:  308/ 218/64
[2024-02-24 11:30:17,271 INFO] Validation perplexity: 436.338
[2024-02-24 11:30:17,271 INFO] Validation accuracy: 18.4915
[2024-02-24 11:30:17,272 INFO] Saving checkpoint tg-both/tg_01_step_8200.pt
[2024-02-24 11:30:17,830 INFO] Step 8250/10000; acc: 93.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  285/ 214/64; 3174/2381 tok/s;    285 sec;
[2024-02-24 11:30:18,362 INFO] Step 8300/10000; acc: 81.3; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  316/ 235/64; 29716/22119 tok/s;    285 sec;
[2024-02-24 11:30:18,834 INFO] Step 8350/10000; acc: 92.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  289/ 204/64; 30612/21611 tok/s;    286 sec;
[2024-02-24 11:30:19,370 INFO] Step 8400/10000; acc: 90.1; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  335/ 244/64; 31324/22820 tok/s;    287 sec;
[2024-02-24 11:30:23,333 INFO] valid stats calculation
                           took: 3.9629998207092285 s.
[2024-02-24 11:30:23,333 INFO] Train perplexity: 9.28672
[2024-02-24 11:30:23,334 INFO] Train accuracy: 61.5502
[2024-02-24 11:30:23,334 INFO] Sentences processed: 537500
[2024-02-24 11:30:23,334 INFO] Average bsz:  307/ 218/64
[2024-02-24 11:30:23,334 INFO] Validation perplexity: 407.94
[2024-02-24 11:30:23,334 INFO] Validation accuracy: 17.8637
[2024-02-24 11:30:23,335 INFO] Saving checkpoint tg-both/tg_01_step_8400.pt
[2024-02-24 11:30:24,012 INFO] Step 8450/10000; acc: 85.6; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3155; bsz:  336/ 247/63; 3615/2665 tok/s;    291 sec;
[2024-02-24 11:30:24,664 INFO] Step 8500/10000; acc: 84.6; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  311/ 217/64; 23868/16646 tok/s;    292 sec;
[2024-02-24 11:30:25,350 INFO] Step 8550/10000; acc: 85.2; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  335/ 226/64; 24466/16471 tok/s;    292 sec;
[2024-02-24 11:30:26,056 INFO] Step 8600/10000; acc: 90.3; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  341/ 240/64; 24138/17018 tok/s;    293 sec;
[2024-02-24 11:30:29,999 INFO] valid stats calculation
                           took: 3.9426300525665283 s.
[2024-02-24 11:30:29,999 INFO] Train perplexity: 8.97805
[2024-02-24 11:30:29,999 INFO] Train accuracy: 62.1674
[2024-02-24 11:30:29,999 INFO] Sentences processed: 550255
[2024-02-24 11:30:29,999 INFO] Average bsz:  308/ 219/64
[2024-02-24 11:30:29,999 INFO] Validation perplexity: 378.518
[2024-02-24 11:30:29,999 INFO] Validation accuracy: 17.1898
[2024-02-24 11:30:30,000 INFO] Saving checkpoint tg-both/tg_01_step_8600.pt
[2024-02-24 11:30:30,712 INFO] Step 8650/10000; acc: 81.1; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  365/ 250/64; 3920/2690 tok/s;    298 sec;
[2024-02-24 11:30:31,424 INFO] Step 8700/10000; acc: 80.3; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  324/ 242/64; 22739/17000 tok/s;    299 sec;
[2024-02-24 11:30:32,247 INFO] Step 8750/10000; acc: 76.1; ppl:   4.5; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  370/ 262/64; 22455/15932 tok/s;    299 sec;
[2024-02-24 11:30:32,927 INFO] Step 8800/10000; acc: 89.2; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  324/ 218/64; 23850/16038 tok/s;    300 sec;
[2024-02-24 11:30:36,898 INFO] valid stats calculation
                           took: 3.9714744091033936 s.
[2024-02-24 11:30:36,899 INFO] Train perplexity: 8.74628
[2024-02-24 11:30:36,899 INFO] Train accuracy: 62.6522
[2024-02-24 11:30:36,899 INFO] Sentences processed: 563055
[2024-02-24 11:30:36,899 INFO] Average bsz:  309/ 219/64
[2024-02-24 11:30:36,899 INFO] Validation perplexity: 392.719
[2024-02-24 11:30:36,899 INFO] Validation accuracy: 19.3224
[2024-02-24 11:30:36,900 INFO] Saving checkpoint tg-both/tg_01_step_8800.pt
[2024-02-24 11:30:37,511 INFO] Step 8850/10000; acc: 87.2; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  296/ 217/64; 3229/2364 tok/s;    305 sec;
[2024-02-24 11:30:38,171 INFO] Step 8900/10000; acc: 90.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  311/ 215/64; 23580/16291 tok/s;    305 sec;
[2024-02-24 11:30:38,871 INFO] Step 8950/10000; acc: 88.6; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  306/ 224/64; 21827/16027 tok/s;    306 sec;
[2024-02-24 11:30:39,560 INFO] Step 9000/10000; acc: 95.5; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  303/ 211/64; 22050/15310 tok/s;    307 sec;
[2024-02-24 11:30:43,493 INFO] valid stats calculation
                           took: 3.932948350906372 s.
[2024-02-24 11:30:43,493 INFO] Train perplexity: 8.44252
[2024-02-24 11:30:43,493 INFO] Train accuracy: 63.2622
[2024-02-24 11:30:43,493 INFO] Sentences processed: 575855
[2024-02-24 11:30:43,493 INFO] Average bsz:  309/ 219/64
[2024-02-24 11:30:43,493 INFO] Validation perplexity: 395.413
[2024-02-24 11:30:43,493 INFO] Validation accuracy: 17.0698
[2024-02-24 11:30:43,494 INFO] Saving checkpoint tg-both/tg_01_step_9000.pt
[2024-02-24 11:30:44,139 INFO] Step 9050/10000; acc: 78.9; ppl:   3.5; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  341/ 226/64; 3722/2464 tok/s;    311 sec;
[2024-02-24 11:30:44,861 INFO] Step 9100/10000; acc: 80.8; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  320/ 238/64; 22216/16486 tok/s;    312 sec;
[2024-02-24 11:30:45,644 INFO] Step 9150/10000; acc: 84.8; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    3195; bsz:  326/ 239/64; 20804/15258 tok/s;    313 sec;
[2024-02-24 11:30:46,290 INFO] Step 9200/10000; acc: 91.1; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  285/ 193/64; 22079/14979 tok/s;    313 sec;
[2024-02-24 11:30:50,256 INFO] valid stats calculation
                           took: 3.966141939163208 s.
[2024-02-24 11:30:50,257 INFO] Train perplexity: 8.22824
[2024-02-24 11:30:50,257 INFO] Train accuracy: 63.7141
[2024-02-24 11:30:50,257 INFO] Sentences processed: 588650
[2024-02-24 11:30:50,257 INFO] Average bsz:  309/ 219/64
[2024-02-24 11:30:50,257 INFO] Validation perplexity: 435.871
[2024-02-24 11:30:50,257 INFO] Validation accuracy: 17.6514
[2024-02-24 11:30:50,258 INFO] Saving checkpoint tg-both/tg_01_step_9200.pt
[2024-02-24 11:30:50,808 INFO] Step 9250/10000; acc: 96.9; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    3200; bsz:  292/ 192/64; 3230/2125 tok/s;    318 sec;
[2024-02-24 11:30:51,479 INFO] Step 9300/10000; acc: 96.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  307/ 203/64; 22921/15129 tok/s;    319 sec;
[2024-02-24 11:30:52,173 INFO] Step 9350/10000; acc: 81.8; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  325/ 216/64; 23402/15525 tok/s;    319 sec;
[2024-02-24 11:30:52,858 INFO] Step 9400/10000; acc: 85.4; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  298/ 224/64; 21798/16352 tok/s;    320 sec;
[2024-02-24 11:30:56,673 INFO] valid stats calculation
                           took: 3.815007209777832 s.
[2024-02-24 11:30:56,674 INFO] Train perplexity: 7.97475
[2024-02-24 11:30:56,674 INFO] Train accuracy: 64.2444
[2024-02-24 11:30:56,674 INFO] Sentences processed: 601450
[2024-02-24 11:30:56,674 INFO] Average bsz:  309/ 219/64
[2024-02-24 11:30:56,674 INFO] Validation perplexity: 419.829
[2024-02-24 11:30:56,674 INFO] Validation accuracy: 16.9221
[2024-02-24 11:30:56,675 INFO] Saving checkpoint tg-both/tg_01_step_9400.pt
[2024-02-24 11:30:57,264 INFO] Step 9450/10000; acc: 97.0; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    3200; bsz:  282/ 193/64; 3195/2193 tok/s;    324 sec;
[2024-02-24 11:30:57,861 INFO] Step 9500/10000; acc: 92.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  260/ 182/64; 21797/15301 tok/s;    325 sec;
[2024-02-24 11:30:58,561 INFO] Step 9550/10000; acc: 81.9; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  312/ 218/64; 22261/15535 tok/s;    326 sec;
[2024-02-24 11:30:59,211 INFO] Step 9600/10000; acc: 89.0; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  288/ 199/64; 22182/15299 tok/s;    326 sec;
[2024-02-24 11:31:03,131 INFO] valid stats calculation
                           took: 3.9202768802642822 s.
[2024-02-24 11:31:03,132 INFO] Train perplexity: 7.75093
[2024-02-24 11:31:03,132 INFO] Train accuracy: 64.7269
[2024-02-24 11:31:03,132 INFO] Sentences processed: 614250
[2024-02-24 11:31:03,132 INFO] Average bsz:  308/ 219/64
[2024-02-24 11:31:03,132 INFO] Validation perplexity: 390.415
[2024-02-24 11:31:03,132 INFO] Validation accuracy: 17.6883
[2024-02-24 11:31:03,133 INFO] Saving checkpoint tg-both/tg_01_step_9600.pt
[2024-02-24 11:31:03,755 INFO] Step 9650/10000; acc: 97.1; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    3200; bsz:  280/ 186/64; 3084/2042 tok/s;    331 sec;
[2024-02-24 11:31:04,344 INFO] Step 9700/10000; acc: 93.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  306/ 220/64; 25975/18671 tok/s;    331 sec;
[2024-02-24 11:31:04,986 INFO] Step 9750/10000; acc: 95.5; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  289/ 201/64; 22553/15696 tok/s;    332 sec;
[2024-02-24 11:31:05,650 INFO] Step 9800/10000; acc: 89.0; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  312/ 216/64; 23527/16242 tok/s;    333 sec;
[2024-02-24 11:31:09,564 INFO] valid stats calculation
                           took: 3.913726806640625 s.
[2024-02-24 11:31:09,564 INFO] Train perplexity: 7.4997
[2024-02-24 11:31:09,564 INFO] Train accuracy: 65.2816
[2024-02-24 11:31:09,564 INFO] Sentences processed: 627050
[2024-02-24 11:31:09,564 INFO] Average bsz:  308/ 218/64
[2024-02-24 11:31:09,564 INFO] Validation perplexity: 372.448
[2024-02-24 11:31:09,564 INFO] Validation accuracy: 18.0853
[2024-02-24 11:31:09,565 INFO] Saving checkpoint tg-both/tg_01_step_9800.pt
[2024-02-24 11:31:10,258 INFO] Step 9850/10000; acc: 86.9; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  296/ 234/64; 3208/2543 tok/s;    337 sec;
[2024-02-24 11:31:10,866 INFO] Step 9900/10000; acc: 88.3; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  309/ 218/64; 25365/17901 tok/s;    338 sec;
[2024-02-24 11:31:11,532 INFO] Step 9950/10000; acc: 89.7; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  317/ 206/64; 23865/15461 tok/s;    339 sec;
[2024-02-24 11:31:12,253 INFO] Step 10000/10000; acc: 90.8; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  307/ 229/64; 21313/15864 tok/s;    339 sec;
[2024-02-24 11:31:16,311 INFO] valid stats calculation
                           took: 4.058032035827637 s.
[2024-02-24 11:31:16,311 INFO] Train perplexity: 7.29993
[2024-02-24 11:31:16,311 INFO] Train accuracy: 65.761
[2024-02-24 11:31:16,311 INFO] Sentences processed: 639850
[2024-02-24 11:31:16,312 INFO] Average bsz:  308/ 218/64
[2024-02-24 11:31:16,312 INFO] Validation perplexity: 345.684
[2024-02-24 11:31:16,312 INFO] Validation accuracy: 19.387
[2024-02-24 11:31:16,312 INFO] Saving checkpoint tg-both/tg_01_step_10000.pt
