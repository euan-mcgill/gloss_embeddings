[2024-02-24 14:33:38,921 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-02-24 14:33:38,921 INFO] Parsed 2 corpora from -data.
[2024-02-24 14:33:38,921 INFO] Loading checkpoint from tg-pretrain/models/tg-pretrain_03_step_9200.pt
[2024-02-24 14:33:39,057 INFO] Building model...
[2024-02-24 14:33:39,118 INFO] Switching model to float32 for amp/apex_amp
[2024-02-24 14:33:39,118 INFO] Non quantized layer compute is fp32
[2024-02-24 14:33:40,957 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(32768, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(500, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(25208, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(1000, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=25208, bias=True)
)
[2024-02-24 14:33:40,957 INFO] encoder: 20392000
[2024-02-24 14:33:40,957 INFO] decoder: 30991208
[2024-02-24 14:33:40,957 INFO] * number of parameters: 51383208
[2024-02-24 14:33:40,957 INFO] Trainable parameters = {'torch.float32': 51383208, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-02-24 14:33:40,957 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-02-24 14:33:40,958 INFO]  * src vocab size = 32768
[2024-02-24 14:33:40,958 INFO]  * tgt vocab size = 25208
[2024-02-24 14:33:40,959 INFO] Starting training on GPU: [0]
[2024-02-24 14:33:40,959 INFO] Start training loop and validate every 200 steps...
[2024-02-24 14:33:40,960 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-02-24 14:33:56,244 INFO] Step 9250/14200; acc: 18.9; ppl: 2550.6; xent: 7.8; lr: 1.00000; sents:    3200; bsz:  328/ 251/64; 1072/822 tok/s;     15 sec;
[2024-02-24 14:33:56,789 INFO] Step 9300/14200; acc: 31.1; ppl: 281.0; xent: 5.6; lr: 1.00000; sents:    3200; bsz:  285/ 198/64; 26173/18192 tok/s;     16 sec;
[2024-02-24 14:33:57,375 INFO] Step 9350/14200; acc: 30.0; ppl: 189.6; xent: 5.2; lr: 1.00000; sents:    3200; bsz:  279/ 217/64; 23829/18507 tok/s;     16 sec;
[2024-02-24 14:33:57,972 INFO] Step 9400/14200; acc: 30.2; ppl: 144.3; xent: 5.0; lr: 1.00000; sents:    3200; bsz:  316/ 223/64; 26464/18681 tok/s;     17 sec;
[2024-02-24 14:34:01,730 INFO] valid stats calculation
                           took: 3.7578823566436768 s.
[2024-02-24 14:34:01,730 INFO] Train perplexity: 402.815
[2024-02-24 14:34:01,730 INFO] Train accuracy: 27.1662
[2024-02-24 14:34:01,730 INFO] Sentences processed: 12800
[2024-02-24 14:34:01,730 INFO] Average bsz:  302/ 222/64
[2024-02-24 14:34:01,731 INFO] Validation perplexity: 1048.9
[2024-02-24 14:34:01,731 INFO] Validation accuracy: 17.5314
[2024-02-24 14:34:01,733 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_9400.pt
[2024-02-24 14:34:02,558 INFO] Step 9450/14200; acc: 35.8; ppl:  78.7; xent: 4.4; lr: 1.00000; sents:    3200; bsz:  293/ 196/64; 3196/2135 tok/s;     22 sec;
[2024-02-24 14:34:03,105 INFO] Step 9500/14200; acc: 37.2; ppl:  52.3; xent: 4.0; lr: 1.00000; sents:    3200; bsz:  255/ 198/64; 23292/18142 tok/s;     22 sec;
[2024-02-24 14:34:03,762 INFO] Step 9550/14200; acc: 31.2; ppl: 101.1; xent: 4.6; lr: 1.00000; sents:    3200; bsz:  359/ 246/64; 27323/18712 tok/s;     23 sec;
[2024-02-24 14:34:04,508 INFO] Step 9600/14200; acc: 31.6; ppl: 106.7; xent: 4.7; lr: 1.00000; sents:    3200; bsz:  356/ 256/64; 23897/17157 tok/s;     24 sec;
[2024-02-24 14:34:08,265 INFO] valid stats calculation
                           took: 3.756256103515625 s.
[2024-02-24 14:34:08,265 INFO] Train perplexity: 183.389
[2024-02-24 14:34:08,265 INFO] Train accuracy: 30.4215
[2024-02-24 14:34:08,265 INFO] Sentences processed: 25600
[2024-02-24 14:34:08,265 INFO] Average bsz:  309/ 223/64
[2024-02-24 14:34:08,265 INFO] Validation perplexity: 347.063
[2024-02-24 14:34:08,265 INFO] Validation accuracy: 18.4915
[2024-02-24 14:34:08,268 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_9600.pt
[2024-02-24 14:34:09,139 INFO] Step 9650/14200; acc: 36.2; ppl:  41.9; xent: 3.7; lr: 1.00000; sents:    3200; bsz:  302/ 228/64; 3263/2461 tok/s;     28 sec;
[2024-02-24 14:34:09,843 INFO] Step 9700/14200; acc: 37.4; ppl:  52.2; xent: 4.0; lr: 1.00000; sents:    3150; bsz:  364/ 225/63; 25851/15971 tok/s;     29 sec;
[2024-02-24 14:34:10,432 INFO] Step 9750/14200; acc: 40.7; ppl:  29.7; xent: 3.4; lr: 1.00000; sents:    3200; bsz:  315/ 213/64; 26780/18100 tok/s;     29 sec;
[2024-02-24 14:34:11,018 INFO] Step 9800/14200; acc: 42.9; ppl:  23.1; xent: 3.1; lr: 1.00000; sents:    3200; bsz:  295/ 217/64; 25139/18529 tok/s;     30 sec;
[2024-02-24 14:34:14,733 INFO] valid stats calculation
                           took: 3.7145469188690186 s.
[2024-02-24 14:34:14,733 INFO] Train perplexity: 106.239
[2024-02-24 14:34:14,734 INFO] Train accuracy: 33.3408
[2024-02-24 14:34:14,734 INFO] Sentences processed: 38350
[2024-02-24 14:34:14,734 INFO] Average bsz:  312/ 222/64
[2024-02-24 14:34:14,734 INFO] Validation perplexity: 431.761
[2024-02-24 14:34:14,734 INFO] Validation accuracy: 16.8298
[2024-02-24 14:34:14,736 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_9800.pt
[2024-02-24 14:34:15,606 INFO] Step 9850/14200; acc: 46.0; ppl:  16.9; xent: 2.8; lr: 1.00000; sents:    3200; bsz:  323/ 219/64; 3518/2391 tok/s;     35 sec;
[2024-02-24 14:34:16,148 INFO] Step 9900/14200; acc: 53.0; ppl:  13.3; xent: 2.6; lr: 1.00000; sents:    3200; bsz:  278/ 181/64; 25602/16665 tok/s;     35 sec;
[2024-02-24 14:34:16,713 INFO] Step 9950/14200; acc: 51.8; ppl:   9.9; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  301/ 203/64; 26649/17958 tok/s;     36 sec;
[2024-02-24 14:34:17,316 INFO] Step 10000/14200; acc: 47.1; ppl:  15.7; xent: 2.8; lr: 1.00000; sents:    3200; bsz:  296/ 228/64; 24518/18944 tok/s;     36 sec;
[2024-02-24 14:34:21,025 INFO] valid stats calculation
                           took: 3.7086234092712402 s.
[2024-02-24 14:34:21,025 INFO] Train perplexity: 65.4116
[2024-02-24 14:34:21,025 INFO] Train accuracy: 37.1213
[2024-02-24 14:34:21,025 INFO] Sentences processed: 51150
[2024-02-24 14:34:21,026 INFO] Average bsz:  309/ 219/64
[2024-02-24 14:34:21,026 INFO] Validation perplexity: 513.37
[2024-02-24 14:34:21,026 INFO] Validation accuracy: 17.6237
[2024-02-24 14:34:21,028 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_10000.pt
[2024-02-24 14:34:21,941 INFO] Step 10050/14200; acc: 44.8; ppl:  17.7; xent: 2.9; lr: 1.00000; sents:    3200; bsz:  365/ 241/64; 3941/2603 tok/s;     41 sec;
[2024-02-24 14:34:22,520 INFO] Step 10100/14200; acc: 52.7; ppl:  10.9; xent: 2.4; lr: 1.00000; sents:    3200; bsz:  303/ 206/64; 26118/17822 tok/s;     42 sec;
[2024-02-24 14:34:23,081 INFO] Step 10150/14200; acc: 58.2; ppl:   6.0; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  297/ 201/64; 26505/17937 tok/s;     42 sec;
[2024-02-24 14:34:23,671 INFO] Step 10200/14200; acc: 55.1; ppl:   8.8; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  307/ 218/64; 26017/18444 tok/s;     43 sec;
[2024-02-24 14:34:27,389 INFO] valid stats calculation
                           took: 3.71740984916687 s.
[2024-02-24 14:34:27,389 INFO] Train perplexity: 45.33
[2024-02-24 14:34:27,389 INFO] Train accuracy: 40.1462
[2024-02-24 14:34:27,389 INFO] Sentences processed: 63950
[2024-02-24 14:34:27,389 INFO] Average bsz:  311/ 218/64
[2024-02-24 14:34:27,389 INFO] Validation perplexity: 382.861
[2024-02-24 14:34:27,389 INFO] Validation accuracy: 19.5347
[2024-02-24 14:34:27,392 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_10200.pt
[2024-02-24 14:34:28,281 INFO] Step 10250/14200; acc: 54.3; ppl:   8.9; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  303/ 236/64; 3291/2557 tok/s;     47 sec;
[2024-02-24 14:34:28,865 INFO] Step 10300/14200; acc: 60.6; ppl:   5.3; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  315/ 220/64; 26950/18869 tok/s;     48 sec;
[2024-02-24 14:34:29,576 INFO] Step 10350/14200; acc: 51.8; ppl:  15.1; xent: 2.7; lr: 1.00000; sents:    3200; bsz:  335/ 231/64; 23583/16235 tok/s;     49 sec;
[2024-02-24 14:34:30,128 INFO] Step 10400/14200; acc: 65.6; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  261/ 197/64; 23652/17855 tok/s;     49 sec;
[2024-02-24 14:34:33,889 INFO] valid stats calculation
                           took: 3.7606289386749268 s.
[2024-02-24 14:34:33,889 INFO] Train perplexity: 33.4605
[2024-02-24 14:34:33,889 INFO] Train accuracy: 43.1103
[2024-02-24 14:34:33,889 INFO] Sentences processed: 76750
[2024-02-24 14:34:33,889 INFO] Average bsz:  310/ 219/64
[2024-02-24 14:34:33,889 INFO] Validation perplexity: 432.996
[2024-02-24 14:34:33,889 INFO] Validation accuracy: 18.9808
[2024-02-24 14:34:33,892 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_10400.pt
[2024-02-24 14:34:34,826 INFO] Step 10450/14200; acc: 53.5; ppl:  11.1; xent: 2.4; lr: 1.00000; sents:    3200; bsz:  318/ 244/64; 3385/2600 tok/s;     54 sec;
[2024-02-24 14:34:35,430 INFO] Step 10500/14200; acc: 65.7; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  325/ 231/64; 26893/19074 tok/s;     54 sec;
[2024-02-24 14:34:36,000 INFO] Step 10550/14200; acc: 71.6; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  310/ 205/64; 27180/18025 tok/s;     55 sec;
[2024-02-24 14:34:36,532 INFO] Step 10600/14200; acc: 75.1; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  288/ 176/64; 27104/16537 tok/s;     56 sec;
[2024-02-24 14:34:40,269 INFO] valid stats calculation
                           took: 3.736712694168091 s.
[2024-02-24 14:34:40,269 INFO] Train perplexity: 25.2498
[2024-02-24 14:34:40,269 INFO] Train accuracy: 46.2569
[2024-02-24 14:34:40,269 INFO] Sentences processed: 89550
[2024-02-24 14:34:40,269 INFO] Average bsz:  310/ 218/64
[2024-02-24 14:34:40,269 INFO] Validation perplexity: 471.225
[2024-02-24 14:34:40,269 INFO] Validation accuracy: 19.2578
[2024-02-24 14:34:40,272 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_10600.pt
[2024-02-24 14:34:41,114 INFO] Step 10650/14200; acc: 73.9; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  293/ 202/64; 3199/2207 tok/s;     60 sec;
[2024-02-24 14:34:41,656 INFO] Step 10700/14200; acc: 76.3; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  275/ 183/64; 25390/16911 tok/s;     61 sec;
[2024-02-24 14:34:42,293 INFO] Step 10750/14200; acc: 64.4; ppl:   7.9; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  323/ 214/64; 25367/16795 tok/s;     61 sec;
[2024-02-24 14:34:42,953 INFO] Step 10800/14200; acc: 59.3; ppl:   9.8; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  342/ 234/64; 25883/17724 tok/s;     62 sec;
[2024-02-24 14:34:46,687 INFO] valid stats calculation
                           took: 3.7329952716827393 s.
[2024-02-24 14:34:46,687 INFO] Train perplexity: 20.7501
[2024-02-24 14:34:46,687 INFO] Train accuracy: 48.8563
[2024-02-24 14:34:46,687 INFO] Sentences processed: 102350
[2024-02-24 14:34:46,687 INFO] Average bsz:  310/ 217/64
[2024-02-24 14:34:46,687 INFO] Validation perplexity: 4743.9
[2024-02-24 14:34:46,687 INFO] Validation accuracy: 15.7773
[2024-02-24 14:34:46,690 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_10800.pt
[2024-02-24 14:34:47,589 INFO] Step 10850/14200; acc: 65.7; ppl:   6.8; xent: 1.9; lr: 1.00000; sents:    3200; bsz:  301/ 213/64; 3242/2294 tok/s;     67 sec;
[2024-02-24 14:34:48,156 INFO] Step 10900/14200; acc: 72.9; ppl:   3.5; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  312/ 209/64; 27521/18389 tok/s;     67 sec;
[2024-02-24 14:34:48,672 INFO] Step 10950/14200; acc: 82.7; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  229/ 172/64; 22230/16641 tok/s;     68 sec;
[2024-02-24 14:34:49,315 INFO] Step 11000/14200; acc: 69.5; ppl:   4.9; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  312/ 226/64; 24225/17576 tok/s;     68 sec;
[2024-02-24 14:34:53,084 INFO] valid stats calculation
                           took: 3.769139528274536 s.
[2024-02-24 14:34:53,085 INFO] Train perplexity: 17.4294
[2024-02-24 14:34:53,085 INFO] Train accuracy: 51.3136
[2024-02-24 14:34:53,085 INFO] Sentences processed: 115150
[2024-02-24 14:34:53,085 INFO] Average bsz:  307/ 215/64
[2024-02-24 14:34:53,085 INFO] Validation perplexity: 326.068
[2024-02-24 14:34:53,085 INFO] Validation accuracy: 17.5499
[2024-02-24 14:34:53,087 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_11000.pt
[2024-02-24 14:34:53,972 INFO] Step 11050/14200; acc: 64.9; ppl:   7.0; xent: 2.0; lr: 1.00000; sents:    3200; bsz:  328/ 226/64; 3517/2422 tok/s;     73 sec;
[2024-02-24 14:34:54,535 INFO] Step 11100/14200; acc: 81.9; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  284/ 205/64; 25210/18169 tok/s;     74 sec;
[2024-02-24 14:34:55,101 INFO] Step 11150/14200; acc: 80.7; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  284/ 206/64; 25121/18215 tok/s;     74 sec;
[2024-02-24 14:34:55,716 INFO] Step 11200/14200; acc: 78.1; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  320/ 244/64; 26049/19899 tok/s;     75 sec;
[2024-02-24 14:34:59,462 INFO] valid stats calculation
                           took: 3.7459890842437744 s.
[2024-02-24 14:34:59,462 INFO] Train perplexity: 14.5452
[2024-02-24 14:34:59,462 INFO] Train accuracy: 53.852
[2024-02-24 14:34:59,462 INFO] Sentences processed: 127950
[2024-02-24 14:34:59,462 INFO] Average bsz:  307/ 216/64
[2024-02-24 14:34:59,462 INFO] Validation perplexity: 471.703
[2024-02-24 14:34:59,463 INFO] Validation accuracy: 18.4084
[2024-02-24 14:34:59,465 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_11200.pt
[2024-02-24 14:35:00,297 INFO] Step 11250/14200; acc: 85.0; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  264/ 210/64; 2878/2294 tok/s;     79 sec;
[2024-02-24 14:35:00,846 INFO] Step 11300/14200; acc: 84.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  275/ 198/64; 25097/18093 tok/s;     80 sec;
[2024-02-24 14:35:01,493 INFO] Step 11350/14200; acc: 75.8; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  316/ 235/64; 24427/18152 tok/s;     81 sec;
[2024-02-24 14:35:02,096 INFO] Step 11400/14200; acc: 79.8; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  293/ 238/64; 24321/19787 tok/s;     81 sec;
[2024-02-24 14:35:05,824 INFO] valid stats calculation
                           took: 3.7278993129730225 s.
[2024-02-24 14:35:05,824 INFO] Train perplexity: 12.2848
[2024-02-24 14:35:05,824 INFO] Train accuracy: 56.3663
[2024-02-24 14:35:05,824 INFO] Sentences processed: 140750
[2024-02-24 14:35:05,824 INFO] Average bsz:  305/ 216/64
[2024-02-24 14:35:05,824 INFO] Validation perplexity: 507.895
[2024-02-24 14:35:05,825 INFO] Validation accuracy: 18.6484
[2024-02-24 14:35:05,827 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_11400.pt
[2024-02-24 14:35:06,847 INFO] Step 11450/14200; acc: 66.1; ppl:   7.9; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  401/ 281/64; 4215/2960 tok/s;     86 sec;
[2024-02-24 14:35:07,525 INFO] Step 11500/14200; acc: 73.3; ppl:   4.4; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  365/ 258/64; 26892/19004 tok/s;     87 sec;
[2024-02-24 14:35:08,101 INFO] Step 11550/14200; acc: 81.7; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  301/ 213/64; 26145/18503 tok/s;     87 sec;
[2024-02-24 14:35:08,782 INFO] Step 11600/14200; acc: 73.1; ppl:   4.7; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  344/ 252/64; 25246/18483 tok/s;     88 sec;
[2024-02-24 14:35:12,504 INFO] valid stats calculation
                           took: 3.722240447998047 s.
[2024-02-24 14:35:12,504 INFO] Train perplexity: 11.1862
[2024-02-24 14:35:12,505 INFO] Train accuracy: 57.9543
[2024-02-24 14:35:12,505 INFO] Sentences processed: 153550
[2024-02-24 14:35:12,505 INFO] Average bsz:  309/ 219/64
[2024-02-24 14:35:12,505 INFO] Validation perplexity: 522.87
[2024-02-24 14:35:12,505 INFO] Validation accuracy: 19.3593
[2024-02-24 14:35:12,507 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_11600.pt
[2024-02-24 14:35:13,414 INFO] Step 11650/14200; acc: 78.8; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  297/ 216/64; 3205/2330 tok/s;     92 sec;
[2024-02-24 14:35:14,043 INFO] Step 11700/14200; acc: 82.5; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  297/ 224/64; 23658/17874 tok/s;     93 sec;
[2024-02-24 14:35:14,679 INFO] Step 11750/14200; acc: 77.5; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  357/ 223/64; 28021/17533 tok/s;     94 sec;
[2024-02-24 14:35:15,268 INFO] Step 11800/14200; acc: 84.6; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  296/ 216/64; 25156/18326 tok/s;     94 sec;
[2024-02-24 14:35:19,018 INFO] valid stats calculation
                           took: 3.749363660812378 s.
[2024-02-24 14:35:19,018 INFO] Train perplexity: 10.0813
[2024-02-24 14:35:19,019 INFO] Train accuracy: 59.7183
[2024-02-24 14:35:19,019 INFO] Sentences processed: 166350
[2024-02-24 14:35:19,019 INFO] Average bsz:  309/ 219/64
[2024-02-24 14:35:19,019 INFO] Validation perplexity: 433.081
[2024-02-24 14:35:19,019 INFO] Validation accuracy: 19.8763
[2024-02-24 14:35:19,021 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_11800.pt
[2024-02-24 14:35:19,926 INFO] Step 11850/14200; acc: 89.3; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  296/ 224/64; 3174/2407 tok/s;     99 sec;
[2024-02-24 14:35:20,579 INFO] Step 11900/14200; acc: 77.5; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  340/ 210/64; 26073/16066 tok/s;    100 sec;
[2024-02-24 14:35:21,206 INFO] Step 11950/14200; acc: 82.0; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  311/ 214/64; 24826/17106 tok/s;    100 sec;
[2024-02-24 14:35:21,812 INFO] Step 12000/14200; acc: 88.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  297/ 201/64; 24482/16589 tok/s;    101 sec;
[2024-02-24 14:35:25,540 INFO] valid stats calculation
                           took: 3.7278740406036377 s.
[2024-02-24 14:35:25,541 INFO] Train perplexity: 9.08208
[2024-02-24 14:35:25,541 INFO] Train accuracy: 61.4224
[2024-02-24 14:35:25,541 INFO] Sentences processed: 179150
[2024-02-24 14:35:25,541 INFO] Average bsz:  309/ 219/64
[2024-02-24 14:35:25,541 INFO] Validation perplexity: 468.209
[2024-02-24 14:35:25,541 INFO] Validation accuracy: 18.7223
[2024-02-24 14:35:25,543 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_12000.pt
[2024-02-24 14:35:26,444 INFO] Step 12050/14200; acc: 81.0; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  301/ 227/64; 3254/2455 tok/s;    105 sec;
[2024-02-24 14:35:27,053 INFO] Step 12100/14200; acc: 81.9; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  309/ 219/64; 25384/18035 tok/s;    106 sec;
[2024-02-24 14:35:27,669 INFO] Step 12150/14200; acc: 75.7; ppl:   4.3; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  288/ 225/64; 23409/18297 tok/s;    107 sec;
[2024-02-24 14:35:28,258 INFO] Step 12200/14200; acc: 84.2; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  282/ 218/64; 23892/18537 tok/s;    107 sec;
[2024-02-24 14:35:31,989 INFO] valid stats calculation
                           took: 3.7299985885620117 s.
[2024-02-24 14:35:31,989 INFO] Train perplexity: 8.43878
[2024-02-24 14:35:31,989 INFO] Train accuracy: 62.7275
[2024-02-24 14:35:31,989 INFO] Sentences processed: 191950
[2024-02-24 14:35:31,989 INFO] Average bsz:  308/ 219/64
[2024-02-24 14:35:31,989 INFO] Validation perplexity: 375.47
[2024-02-24 14:35:31,989 INFO] Validation accuracy: 19.2485
[2024-02-24 14:35:31,992 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_12200.pt
[2024-02-24 14:35:32,901 INFO] Step 12250/14200; acc: 78.3; ppl:   3.5; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  284/ 219/64; 3061/2364 tok/s;    112 sec;
[2024-02-24 14:35:33,525 INFO] Step 12300/14200; acc: 83.5; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  322/ 221/64; 25797/17723 tok/s;    113 sec;
[2024-02-24 14:35:34,110 INFO] Step 12350/14200; acc: 80.0; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  316/ 238/64; 27023/20367 tok/s;    113 sec;
[2024-02-24 14:35:34,711 INFO] Step 12400/14200; acc: 80.4; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  328/ 227/64; 27300/18879 tok/s;    114 sec;
[2024-02-24 14:35:38,734 INFO] valid stats calculation
                           took: 4.021898984909058 s.
[2024-02-24 14:35:38,734 INFO] Train perplexity: 7.93448
[2024-02-24 14:35:38,734 INFO] Train accuracy: 63.8762
[2024-02-24 14:35:38,734 INFO] Sentences processed: 204750
[2024-02-24 14:35:38,734 INFO] Average bsz:  309/ 220/64
[2024-02-24 14:35:38,734 INFO] Validation perplexity: 567.022
[2024-02-24 14:35:38,734 INFO] Validation accuracy: 18.5469
[2024-02-24 14:35:38,737 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_12400.pt
[2024-02-24 14:35:39,555 INFO] Step 12450/14200; acc: 84.8; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  298/ 217/64; 3079/2241 tok/s;    119 sec;
[2024-02-24 14:35:40,192 INFO] Step 12500/14200; acc: 87.0; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  326/ 222/64; 25590/17431 tok/s;    119 sec;
[2024-02-24 14:35:40,730 INFO] Step 12550/14200; acc: 92.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  290/ 205/64; 27023/19112 tok/s;    120 sec;
[2024-02-24 14:35:41,266 INFO] Step 12600/14200; acc: 87.3; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  321/ 202/64; 29951/18840 tok/s;    120 sec;
[2024-02-24 14:35:45,295 INFO] valid stats calculation
                           took: 4.028133153915405 s.
[2024-02-24 14:35:45,295 INFO] Train perplexity: 7.30908
[2024-02-24 14:35:45,295 INFO] Train accuracy: 65.2399
[2024-02-24 14:35:45,295 INFO] Sentences processed: 217550
[2024-02-24 14:35:45,295 INFO] Average bsz:  309/ 219/64
[2024-02-24 14:35:45,295 INFO] Validation perplexity: 710.513
[2024-02-24 14:35:45,295 INFO] Validation accuracy: 20.2917
[2024-02-24 14:35:45,298 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_12600.pt
[2024-02-24 14:35:46,116 INFO] Step 12650/14200; acc: 91.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  305/ 206/64; 3141/2123 tok/s;    125 sec;
[2024-02-24 14:35:49,304 INFO] Step 12700/14200; acc: 92.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  276/ 190/64; 4336/2979 tok/s;    128 sec;
[2024-02-24 14:35:49,938 INFO] Step 12750/14200; acc: 93.9; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  298/ 201/64; 23531/15856 tok/s;    129 sec;
[2024-02-24 14:35:50,520 INFO] Step 12800/14200; acc: 93.7; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  311/ 223/64; 26718/19145 tok/s;    130 sec;
[2024-02-24 14:35:54,255 INFO] valid stats calculation
                           took: 3.7343647480010986 s.
[2024-02-24 14:35:54,256 INFO] Train perplexity: 6.69514
[2024-02-24 14:35:54,256 INFO] Train accuracy: 66.6805
[2024-02-24 14:35:54,256 INFO] Sentences processed: 230350
[2024-02-24 14:35:54,256 INFO] Average bsz:  308/ 218/64
[2024-02-24 14:35:54,256 INFO] Validation perplexity: 498.064
[2024-02-24 14:35:54,256 INFO] Validation accuracy: 19.9686
[2024-02-24 14:35:54,258 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_12800.pt
[2024-02-24 14:35:55,077 INFO] Step 12850/14200; acc: 93.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  282/ 190/64; 3090/2081 tok/s;    134 sec;
[2024-02-24 14:35:55,650 INFO] Step 12900/14200; acc: 94.4; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  294/ 218/64; 25679/18980 tok/s;    135 sec;
[2024-02-24 14:35:56,206 INFO] Step 12950/14200; acc: 94.9; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  282/ 201/64; 25367/18128 tok/s;    135 sec;
[2024-02-24 14:35:56,794 INFO] Step 13000/14200; acc: 90.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  315/ 224/64; 26762/19020 tok/s;    136 sec;
[2024-02-24 14:36:00,511 INFO] valid stats calculation
                           took: 3.716482639312744 s.
[2024-02-24 14:36:00,511 INFO] Train perplexity: 6.17619
[2024-02-24 14:36:00,511 INFO] Train accuracy: 68.0139
[2024-02-24 14:36:00,511 INFO] Sentences processed: 243150
[2024-02-24 14:36:00,511 INFO] Average bsz:  307/ 218/64
[2024-02-24 14:36:00,511 INFO] Validation perplexity: 534.661
[2024-02-24 14:36:00,511 INFO] Validation accuracy: 17.1067
[2024-02-24 14:36:00,514 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_13000.pt
[2024-02-24 14:36:01,420 INFO] Step 13050/14200; acc: 85.1; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  322/ 242/64; 3478/2613 tok/s;    140 sec;
[2024-02-24 14:36:02,013 INFO] Step 13100/14200; acc: 93.0; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  316/ 225/64; 26653/18995 tok/s;    141 sec;
[2024-02-24 14:36:02,604 INFO] Step 13150/14200; acc: 90.1; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  300/ 224/64; 25328/18952 tok/s;    142 sec;
[2024-02-24 14:36:03,177 INFO] Step 13200/14200; acc: 88.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  278/ 212/64; 24266/18479 tok/s;    142 sec;
[2024-02-24 14:36:06,902 INFO] valid stats calculation
                           took: 3.7249069213867188 s.
[2024-02-24 14:36:06,903 INFO] Train perplexity: 5.80367
[2024-02-24 14:36:06,903 INFO] Train accuracy: 69.1022
[2024-02-24 14:36:06,903 INFO] Sentences processed: 255950
[2024-02-24 14:36:06,903 INFO] Average bsz:  307/ 218/64
[2024-02-24 14:36:06,903 INFO] Validation perplexity: 443.953
[2024-02-24 14:36:06,903 INFO] Validation accuracy: 18.9346
[2024-02-24 14:36:06,905 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_13200.pt
[2024-02-24 14:36:07,767 INFO] Step 13250/14200; acc: 87.3; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  288/ 214/64; 3136/2337 tok/s;    147 sec;
[2024-02-24 14:36:08,351 INFO] Step 13300/14200; acc: 87.6; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  292/ 220/64; 25007/18828 tok/s;    147 sec;
[2024-02-24 14:36:08,990 INFO] Step 13350/14200; acc: 78.0; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  339/ 231/64; 26536/18094 tok/s;    148 sec;
[2024-02-24 14:36:09,665 INFO] Step 13400/14200; acc: 66.6; ppl:   9.8; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  357/ 239/64; 26487/17689 tok/s;    149 sec;
[2024-02-24 14:36:13,378 INFO] valid stats calculation
                           took: 3.712557792663574 s.
[2024-02-24 14:36:13,378 INFO] Train perplexity: 5.67623
[2024-02-24 14:36:13,378 INFO] Train accuracy: 69.6152
[2024-02-24 14:36:13,379 INFO] Sentences processed: 268750
[2024-02-24 14:36:13,379 INFO] Average bsz:  308/ 219/64
[2024-02-24 14:36:13,379 INFO] Validation perplexity: 395.028
[2024-02-24 14:36:13,379 INFO] Validation accuracy: 18.63
[2024-02-24 14:36:13,381 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_13400.pt
[2024-02-24 14:36:14,234 INFO] Step 13450/14200; acc: 88.4; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  314/ 220/64; 3432/2409 tok/s;    153 sec;
[2024-02-24 14:36:14,800 INFO] Step 13500/14200; acc: 92.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  300/ 208/64; 26494/18443 tok/s;    154 sec;
[2024-02-24 14:36:15,407 INFO] Step 13550/14200; acc: 81.2; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  295/ 219/64; 24286/18003 tok/s;    154 sec;
[2024-02-24 14:36:16,087 INFO] Step 13600/14200; acc: 75.5; ppl:   4.9; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  368/ 243/64; 27101/17895 tok/s;    155 sec;
[2024-02-24 14:36:19,809 INFO] valid stats calculation
                           took: 3.7218968868255615 s.
[2024-02-24 14:36:19,809 INFO] Train perplexity: 5.48373
[2024-02-24 14:36:19,810 INFO] Train accuracy: 70.2855
[2024-02-24 14:36:19,810 INFO] Sentences processed: 281550
[2024-02-24 14:36:19,810 INFO] Average bsz:  308/ 219/64
[2024-02-24 14:36:19,810 INFO] Validation perplexity: 460.526
[2024-02-24 14:36:19,810 INFO] Validation accuracy: 18.1961
[2024-02-24 14:36:19,812 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_13600.pt
[2024-02-24 14:36:20,706 INFO] Step 13650/14200; acc: 80.2; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  322/ 223/64; 3481/2416 tok/s;    160 sec;
[2024-02-24 14:36:21,360 INFO] Step 13700/14200; acc: 79.8; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  323/ 244/64; 24657/18660 tok/s;    160 sec;
[2024-02-24 14:36:21,981 INFO] Step 13750/14200; acc: 75.6; ppl:   4.5; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  305/ 228/64; 24549/18345 tok/s;    161 sec;
[2024-02-24 14:36:22,618 INFO] Step 13800/14200; acc: 77.8; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  321/ 226/64; 25228/17714 tok/s;    162 sec;
[2024-02-24 14:36:26,371 INFO] valid stats calculation
                           took: 3.752608060836792 s.
[2024-02-24 14:36:26,371 INFO] Train perplexity: 5.39836
[2024-02-24 14:36:26,371 INFO] Train accuracy: 70.6557
[2024-02-24 14:36:26,371 INFO] Sentences processed: 294350
[2024-02-24 14:36:26,371 INFO] Average bsz:  309/ 219/64
[2024-02-24 14:36:26,371 INFO] Validation perplexity: 497.86
[2024-02-24 14:36:26,371 INFO] Validation accuracy: 17.7714
[2024-02-24 14:36:26,374 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_13800.pt
[2024-02-24 14:36:27,242 INFO] Step 13850/14200; acc: 88.2; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  309/ 211/64; 3342/2285 tok/s;    166 sec;
[2024-02-24 14:36:27,851 INFO] Step 13900/14200; acc: 81.2; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  319/ 217/64; 26196/17836 tok/s;    167 sec;
[2024-02-24 14:36:28,441 INFO] Step 13950/14200; acc: 83.6; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  328/ 212/64; 27812/17966 tok/s;    167 sec;
[2024-02-24 14:36:29,023 INFO] Step 14000/14200; acc: 89.5; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  306/ 207/64; 26305/17775 tok/s;    168 sec;
[2024-02-24 14:36:32,757 INFO] valid stats calculation
                           took: 3.7341716289520264 s.
[2024-02-24 14:36:32,758 INFO] Train perplexity: 5.23256
[2024-02-24 14:36:32,758 INFO] Train accuracy: 71.2563
[2024-02-24 14:36:32,758 INFO] Sentences processed: 307150
[2024-02-24 14:36:32,758 INFO] Average bsz:  309/ 219/64
[2024-02-24 14:36:32,758 INFO] Validation perplexity: 321.121
[2024-02-24 14:36:32,758 INFO] Validation accuracy: 18.9993
[2024-02-24 14:36:32,760 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_14000.pt
[2024-02-24 14:36:33,621 INFO] Step 14050/14200; acc: 81.4; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  284/ 214/64; 3090/2324 tok/s;    173 sec;
[2024-02-24 14:36:34,172 INFO] Step 14100/14200; acc: 94.4; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    3200; bsz:  266/ 199/64; 24186/18058 tok/s;    173 sec;
[2024-02-24 14:36:34,776 INFO] Step 14150/14200; acc: 89.5; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  328/ 238/64; 27105/19657 tok/s;    174 sec;
[2024-02-24 14:36:35,363 INFO] Step 14200/14200; acc: 82.3; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  329/ 217/64; 28022/18510 tok/s;    174 sec;
[2024-02-24 14:36:39,231 INFO] valid stats calculation
                           took: 3.8679587841033936 s.
[2024-02-24 14:36:39,232 INFO] Train perplexity: 5.04894
[2024-02-24 14:36:39,232 INFO] Train accuracy: 71.8744
[2024-02-24 14:36:39,232 INFO] Sentences processed: 319950
[2024-02-24 14:36:39,232 INFO] Average bsz:  309/ 219/64
[2024-02-24 14:36:39,232 INFO] Validation perplexity: 315.011
[2024-02-24 14:36:39,232 INFO] Validation accuracy: 19.7747
[2024-02-24 14:36:39,234 INFO] Saving checkpoint tg-finetune/tg-finetune_9200_03_step_14200.pt
