[2024-03-01 23:05:42,354 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-01 23:05:42,354 INFO] Parsed 2 corpora from -data.
[2024-03-01 23:05:42,354 INFO] Loading checkpoint from gt-pretrain/models/gt-pretrain_01_step_1600.pt
[2024-03-01 23:17:17,674 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-01 23:17:17,674 INFO] Parsed 2 corpora from -data.
[2024-03-01 23:17:17,674 INFO] Loading checkpoint from gt-pretrain/models/gt-pretrain_01_step_1600.pt
[2024-03-01 23:18:05,188 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-01 23:18:05,188 INFO] Parsed 2 corpora from -data.
[2024-03-01 23:18:05,188 INFO] Loading checkpoint from gt-pretrain/models/gt-pretrain_02_step_1600.pt
[2024-03-01 23:18:05,337 INFO] Building model...
[2024-03-01 23:18:05,398 INFO] Switching model to float32 for amp/apex_amp
[2024-03-01 23:18:05,398 INFO] Non quantized layer compute is fp32
[2024-03-01 23:18:07,202 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(25208, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(500, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(32768, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(1000, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=32768, bias=True)
)
[2024-03-01 23:18:07,202 INFO] encoder: 16612000
[2024-03-01 23:18:07,203 INFO] decoder: 38558768
[2024-03-01 23:18:07,204 INFO] * number of parameters: 55170768
[2024-03-01 23:18:07,204 INFO] Trainable parameters = {'torch.float32': 55170768, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-01 23:18:07,204 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-01 23:18:07,204 INFO]  * src vocab size = 25208
[2024-03-01 23:18:07,204 INFO]  * tgt vocab size = 32768
[2024-03-01 23:18:07,206 INFO] Starting training on GPU: [0]
[2024-03-01 23:18:07,206 INFO] Start training loop and validate every 200 steps...
[2024-03-01 23:18:07,206 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-01 23:18:22,015 INFO] Step 1650/ 6600; acc: 22.6; ppl: 435.0; xent: 6.1; lr: 1.00000; sents:    3200; bsz:  181/ 393/64; 611/1325 tok/s;     15 sec;
[2024-03-01 23:18:22,747 INFO] Step 1700/ 6600; acc: 28.0; ppl: 201.6; xent: 5.3; lr: 1.00000; sents:    3200; bsz:  129/ 336/64; 8842/22954 tok/s;     16 sec;
[2024-03-01 23:18:23,583 INFO] Step 1750/ 6600; acc: 25.7; ppl: 181.0; xent: 5.2; lr: 1.00000; sents:    3200; bsz:  179/ 405/64; 10713/24224 tok/s;     16 sec;
[2024-03-01 23:18:24,398 INFO] Step 1800/ 6600; acc: 28.7; ppl: 110.8; xent: 4.7; lr: 1.00000; sents:    3200; bsz:  169/ 395/64; 10370/24216 tok/s;     17 sec;
[2024-03-01 23:18:28,299 INFO] valid stats calculation
                           took: 3.900935649871826 s.
[2024-03-01 23:18:28,300 INFO] Train perplexity: 204.529
[2024-03-01 23:18:28,300 INFO] Train accuracy: 26.1558
[2024-03-01 23:18:28,300 INFO] Sentences processed: 12800
[2024-03-01 23:18:28,300 INFO] Average bsz:  165/ 382/64
[2024-03-01 23:18:28,300 INFO] Validation perplexity: 413.06
[2024-03-01 23:18:28,300 INFO] Validation accuracy: 13.6204
[2024-03-01 23:18:28,303 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_1800.pt
[2024-03-01 23:18:29,497 INFO] Step 1850/ 6600; acc: 28.4; ppl: 119.5; xent: 4.8; lr: 1.00000; sents:    3200; bsz:  198/ 398/64; 1946/3904 tok/s;     22 sec;
[2024-03-01 23:18:30,456 INFO] Step 1900/ 6600; acc: 28.2; ppl:  98.5; xent: 4.6; lr: 1.00000; sents:    3200; bsz:  234/ 434/64; 12194/22625 tok/s;     23 sec;
[2024-03-01 23:18:31,340 INFO] Step 1950/ 6600; acc: 29.4; ppl:  91.5; xent: 4.5; lr: 1.00000; sents:    3200; bsz:  186/ 405/64; 10507/22892 tok/s;     24 sec;
[2024-03-01 23:18:32,401 INFO] Step 2000/ 6600; acc: 28.4; ppl:  96.9; xent: 4.6; lr: 1.00000; sents:    3200; bsz:  217/ 448/64; 10230/21115 tok/s;     25 sec;
[2024-03-01 23:18:36,293 INFO] valid stats calculation
                           took: 3.8914365768432617 s.
[2024-03-01 23:18:36,293 INFO] Train perplexity: 141.173
[2024-03-01 23:18:36,293 INFO] Train accuracy: 27.4373
[2024-03-01 23:18:36,293 INFO] Sentences processed: 25600
[2024-03-01 23:18:36,293 INFO] Average bsz:  187/ 402/64
[2024-03-01 23:18:36,293 INFO] Validation perplexity: 319.94
[2024-03-01 23:18:36,293 INFO] Validation accuracy: 18.3593
[2024-03-01 23:18:36,295 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_2000.pt
[2024-03-01 23:18:37,340 INFO] Step 2050/ 6600; acc: 36.4; ppl:  38.8; xent: 3.7; lr: 1.00000; sents:    3200; bsz:  128/ 356/64; 1296/3605 tok/s;     30 sec;
[2024-03-01 23:18:38,195 INFO] Step 2100/ 6600; acc: 33.2; ppl:  56.3; xent: 4.0; lr: 1.00000; sents:    3200; bsz:  182/ 411/64; 10624/23998 tok/s;     31 sec;
[2024-03-01 23:18:39,064 INFO] Step 2150/ 6600; acc: 35.6; ppl:  43.3; xent: 3.8; lr: 1.00000; sents:    3200; bsz:  188/ 385/64; 10826/22169 tok/s;     32 sec;
[2024-03-01 23:18:39,902 INFO] Step 2200/ 6600; acc: 34.0; ppl:  48.9; xent: 3.9; lr: 1.00000; sents:    3200; bsz:  177/ 388/64; 10555/23147 tok/s;     33 sec;
[2024-03-01 23:18:43,787 INFO] valid stats calculation
                           took: 3.884981870651245 s.
[2024-03-01 23:18:43,787 INFO] Train perplexity: 98.6236
[2024-03-01 23:18:43,787 INFO] Train accuracy: 29.8006
[2024-03-01 23:18:43,787 INFO] Sentences processed: 38400
[2024-03-01 23:18:43,787 INFO] Average bsz:  181/ 396/64
[2024-03-01 23:18:43,787 INFO] Validation perplexity: 259.308
[2024-03-01 23:18:43,788 INFO] Validation accuracy: 19.2192
[2024-03-01 23:18:43,790 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_2200.pt
[2024-03-01 23:18:45,113 INFO] Step 2250/ 6600; acc: 33.0; ppl:  52.2; xent: 4.0; lr: 1.00000; sents:    3200; bsz:  195/ 428/64; 1870/4105 tok/s;     38 sec;
[2024-03-01 23:18:45,889 INFO] Step 2300/ 6600; acc: 41.5; ppl:  21.8; xent: 3.1; lr: 1.00000; sents:    3200; bsz:  148/ 360/64; 9565/23188 tok/s;     39 sec;
[2024-03-01 23:18:46,684 INFO] Step 2350/ 6600; acc: 40.8; ppl:  22.2; xent: 3.1; lr: 1.00000; sents:    3200; bsz:  160/ 373/64; 10068/23456 tok/s;     39 sec;
[2024-03-01 23:18:47,504 INFO] Step 2400/ 6600; acc: 41.4; ppl:  24.8; xent: 3.2; lr: 1.00000; sents:    3200; bsz:  171/ 360/64; 10451/21962 tok/s;     40 sec;
[2024-03-01 23:18:51,380 INFO] valid stats calculation
                           took: 3.875580310821533 s.
[2024-03-01 23:18:51,380 INFO] Train perplexity: 73.22
[2024-03-01 23:18:51,380 INFO] Train accuracy: 32.008
[2024-03-01 23:18:51,380 INFO] Sentences processed: 51200
[2024-03-01 23:18:51,380 INFO] Average bsz:  178/ 392/64
[2024-03-01 23:18:51,380 INFO] Validation perplexity: 247.077
[2024-03-01 23:18:51,380 INFO] Validation accuracy: 19.2568
[2024-03-01 23:18:51,383 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_2400.pt
[2024-03-01 23:18:52,654 INFO] Step 2450/ 6600; acc: 40.3; ppl:  24.5; xent: 3.2; lr: 1.00000; sents:    3200; bsz:  191/ 410/64; 1857/3979 tok/s;     45 sec;
[2024-03-01 23:18:53,546 INFO] Step 2500/ 6600; acc: 40.6; ppl:  25.8; xent: 3.3; lr: 1.00000; sents:    3200; bsz:  168/ 396/64; 9407/22186 tok/s;     46 sec;
[2024-03-01 23:18:54,333 INFO] Step 2550/ 6600; acc: 46.0; ppl:  13.6; xent: 2.6; lr: 1.00000; sents:    3200; bsz:  161/ 376/64; 10250/23869 tok/s;     47 sec;
[2024-03-01 23:18:55,140 INFO] Step 2600/ 6600; acc: 46.8; ppl:  12.8; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  159/ 392/64; 9835/24292 tok/s;     48 sec;
[2024-03-01 23:18:59,060 INFO] valid stats calculation
                           took: 3.9188947677612305 s.
[2024-03-01 23:18:59,060 INFO] Train perplexity: 55.4781
[2024-03-01 23:18:59,060 INFO] Train accuracy: 34.2867
[2024-03-01 23:18:59,060 INFO] Sentences processed: 64000
[2024-03-01 23:18:59,060 INFO] Average bsz:  176/ 392/64
[2024-03-01 23:18:59,060 INFO] Validation perplexity: 314.682
[2024-03-01 23:18:59,060 INFO] Validation accuracy: 19.5707
[2024-03-01 23:18:59,063 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_2600.pt
[2024-03-01 23:19:00,108 INFO] Step 2650/ 6600; acc: 49.0; ppl:  11.0; xent: 2.4; lr: 1.00000; sents:    3200; bsz:  138/ 355/64; 1391/3573 tok/s;     53 sec;
[2024-03-01 23:19:00,915 INFO] Step 2700/ 6600; acc: 49.7; ppl:  11.7; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  169/ 384/64; 10481/23814 tok/s;     54 sec;
[2024-03-01 23:19:01,682 INFO] Step 2750/ 6600; acc: 49.6; ppl:  12.8; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  143/ 359/64; 9338/23354 tok/s;     54 sec;
[2024-03-01 23:19:02,515 INFO] Step 2800/ 6600; acc: 49.1; ppl:  11.7; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  173/ 399/64; 10378/23991 tok/s;     55 sec;
[2024-03-01 23:19:06,404 INFO] valid stats calculation
                           took: 3.889070510864258 s.
[2024-03-01 23:19:06,405 INFO] Train perplexity: 43.2914
[2024-03-01 23:19:06,405 INFO] Train accuracy: 36.6999
[2024-03-01 23:19:06,405 INFO] Sentences processed: 76800
[2024-03-01 23:19:06,405 INFO] Average bsz:  173/ 389/64
[2024-03-01 23:19:06,405 INFO] Validation perplexity: 277.837
[2024-03-01 23:19:06,405 INFO] Validation accuracy: 18.83
[2024-03-01 23:19:06,407 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_2800.pt
[2024-03-01 23:19:07,515 INFO] Step 2850/ 6600; acc: 56.4; ppl:   6.7; xent: 1.9; lr: 1.00000; sents:    3200; bsz:  160/ 394/64; 1600/3943 tok/s;     60 sec;
[2024-03-01 23:19:08,269 INFO] Step 2900/ 6600; acc: 56.5; ppl:   6.8; xent: 1.9; lr: 1.00000; sents:    3200; bsz:  138/ 347/64; 9175/23012 tok/s;     61 sec;
[2024-03-01 23:19:09,106 INFO] Step 2950/ 6600; acc: 55.5; ppl:   8.4; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  168/ 404/64; 10023/24173 tok/s;     62 sec;
[2024-03-01 23:19:09,879 INFO] Step 3000/ 6600; acc: 61.2; ppl:   5.0; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  137/ 363/64; 8856/23490 tok/s;     63 sec;
[2024-03-01 23:19:13,764 INFO] valid stats calculation
                           took: 3.88435435295105 s.
[2024-03-01 23:19:13,764 INFO] Train perplexity: 33.378
[2024-03-01 23:19:13,764 INFO] Train accuracy: 39.5716
[2024-03-01 23:19:13,764 INFO] Sentences processed: 89600
[2024-03-01 23:19:13,764 INFO] Average bsz:  170/ 388/64
[2024-03-01 23:19:13,764 INFO] Validation perplexity: 354.887
[2024-03-01 23:19:13,764 INFO] Validation accuracy: 19.0183
[2024-03-01 23:19:13,766 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_3000.pt
[2024-03-01 23:19:14,861 INFO] Step 3050/ 6600; acc: 57.2; ppl:   7.7; xent: 2.0; lr: 1.00000; sents:    3200; bsz:  141/ 363/64; 1420/3640 tok/s;     68 sec;
[2024-03-01 23:19:15,675 INFO] Step 3100/ 6600; acc: 67.2; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  182/ 396/64; 11162/24296 tok/s;     68 sec;
[2024-03-01 23:19:16,526 INFO] Step 3150/ 6600; acc: 57.6; ppl:   7.3; xent: 2.0; lr: 1.00000; sents:    3200; bsz:  177/ 390/64; 10386/22931 tok/s;     69 sec;
[2024-03-01 23:19:17,311 INFO] Step 3200/ 6600; acc: 64.0; ppl:   5.0; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  142/ 357/64; 9066/22768 tok/s;     70 sec;
[2024-03-01 23:19:21,217 INFO] valid stats calculation
                           took: 3.9056484699249268 s.
[2024-03-01 23:19:21,217 INFO] Train perplexity: 26.8795
[2024-03-01 23:19:21,217 INFO] Train accuracy: 42.2484
[2024-03-01 23:19:21,217 INFO] Sentences processed: 102400
[2024-03-01 23:19:21,217 INFO] Average bsz:  168/ 386/64
[2024-03-01 23:19:21,217 INFO] Validation perplexity: 457.096
[2024-03-01 23:19:21,217 INFO] Validation accuracy: 18.2526
[2024-03-01 23:19:21,220 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_3200.pt
[2024-03-01 23:19:22,244 INFO] Step 3250/ 6600; acc: 67.5; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  133/ 337/64; 1349/3411 tok/s;     75 sec;
[2024-03-01 23:19:23,035 INFO] Step 3300/ 6600; acc: 67.9; ppl:   4.5; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  175/ 348/64; 11039/21993 tok/s;     76 sec;
[2024-03-01 23:19:23,815 INFO] Step 3350/ 6600; acc: 65.7; ppl:   5.2; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  144/ 352/64; 9225/22539 tok/s;     77 sec;
[2024-03-01 23:19:24,597 INFO] Step 3400/ 6600; acc: 70.5; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  141/ 375/64; 9011/23970 tok/s;     77 sec;
[2024-03-01 23:19:28,457 INFO] valid stats calculation
                           took: 3.8601346015930176 s.
[2024-03-01 23:19:28,458 INFO] Train perplexity: 22.1871
[2024-03-01 23:19:28,458 INFO] Train accuracy: 44.8814
[2024-03-01 23:19:28,458 INFO] Sentences processed: 115200
[2024-03-01 23:19:28,458 INFO] Average bsz:  166/ 382/64
[2024-03-01 23:19:28,458 INFO] Validation perplexity: 467.198
[2024-03-01 23:19:28,458 INFO] Validation accuracy: 17.9701
[2024-03-01 23:19:28,460 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_3400.pt
[2024-03-01 23:19:29,549 INFO] Step 3450/ 6600; acc: 68.2; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  157/ 374/64; 1590/3772 tok/s;     82 sec;
[2024-03-01 23:19:30,390 INFO] Step 3500/ 6600; acc: 68.3; ppl:   4.4; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  165/ 373/64; 9805/22212 tok/s;     83 sec;
[2024-03-01 23:19:31,227 INFO] Step 3550/ 6600; acc: 64.9; ppl:   5.7; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  167/ 381/64; 9987/22776 tok/s;     84 sec;
[2024-03-01 23:19:32,006 INFO] Step 3600/ 6600; acc: 68.2; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  142/ 365/64; 9114/23430 tok/s;     85 sec;
[2024-03-01 23:19:35,886 INFO] valid stats calculation
                           took: 3.879335880279541 s.
[2024-03-01 23:19:35,887 INFO] Train perplexity: 18.9823
[2024-03-01 23:19:35,887 INFO] Train accuracy: 47.0846
[2024-03-01 23:19:35,887 INFO] Sentences processed: 128000
[2024-03-01 23:19:35,887 INFO] Average bsz:  165/ 382/64
[2024-03-01 23:19:35,887 INFO] Validation perplexity: 389.204
[2024-03-01 23:19:35,887 INFO] Validation accuracy: 17.2797
[2024-03-01 23:19:35,889 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_3600.pt
[2024-03-01 23:19:36,976 INFO] Step 3650/ 6600; acc: 69.4; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  159/ 377/64; 1597/3792 tok/s;     90 sec;
[2024-03-01 23:19:37,750 INFO] Step 3700/ 6600; acc: 73.2; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  141/ 363/64; 9102/23442 tok/s;     91 sec;
[2024-03-01 23:19:38,619 INFO] Step 3750/ 6600; acc: 70.0; ppl:   4.3; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  161/ 411/64; 9283/23657 tok/s;     91 sec;
[2024-03-01 23:19:39,439 INFO] Step 3800/ 6600; acc: 71.3; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  159/ 389/64; 9686/23722 tok/s;     92 sec;
[2024-03-01 23:19:43,335 INFO] valid stats calculation
                           took: 3.8959836959838867 s.
[2024-03-01 23:19:43,335 INFO] Train perplexity: 16.3286
[2024-03-01 23:19:43,335 INFO] Train accuracy: 49.2706
[2024-03-01 23:19:43,335 INFO] Sentences processed: 140800
[2024-03-01 23:19:43,335 INFO] Average bsz:  164/ 382/64
[2024-03-01 23:19:43,336 INFO] Validation perplexity: 562.926
[2024-03-01 23:19:43,336 INFO] Validation accuracy: 17.286
[2024-03-01 23:19:43,338 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_3800.pt
[2024-03-01 23:19:44,393 INFO] Step 3850/ 6600; acc: 77.2; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  143/ 353/64; 1447/3566 tok/s;     97 sec;
[2024-03-01 23:19:45,430 INFO] Step 3900/ 6600; acc: 69.5; ppl:   4.9; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  208/ 422/64; 10022/20315 tok/s;     98 sec;
[2024-03-01 23:19:46,332 INFO] Step 3950/ 6600; acc: 75.9; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  181/ 388/64; 10049/21498 tok/s;     99 sec;
[2024-03-01 23:19:47,191 INFO] Step 4000/ 6600; acc: 68.9; ppl:   6.0; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  195/ 387/64; 11336/22528 tok/s;    100 sec;
[2024-03-01 23:19:51,145 INFO] valid stats calculation
                           took: 3.9540531635284424 s.
[2024-03-01 23:19:51,145 INFO] Train perplexity: 14.4526
[2024-03-01 23:19:51,145 INFO] Train accuracy: 51.2507
[2024-03-01 23:19:51,145 INFO] Sentences processed: 153600
[2024-03-01 23:19:51,145 INFO] Average bsz:  166/ 382/64
[2024-03-01 23:19:51,146 INFO] Validation perplexity: 500.287
[2024-03-01 23:19:51,146 INFO] Validation accuracy: 19.1439
[2024-03-01 23:19:51,148 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_4000.pt
[2024-03-01 23:19:52,243 INFO] Step 4050/ 6600; acc: 75.5; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  152/ 373/64; 1508/3696 tok/s;    105 sec;
[2024-03-01 23:19:53,085 INFO] Step 4100/ 6600; acc: 77.0; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    3152; bsz:  149/ 367/63; 8825/21812 tok/s;    106 sec;
[2024-03-01 23:19:53,971 INFO] Step 4150/ 6600; acc: 78.0; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    3140; bsz:  165/ 393/63; 9313/22201 tok/s;    107 sec;
[2024-03-01 23:19:54,779 INFO] Step 4200/ 6600; acc: 80.5; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  161/ 389/64; 9987/24063 tok/s;    108 sec;
[2024-03-01 23:19:58,637 INFO] valid stats calculation
                           took: 3.857978105545044 s.
[2024-03-01 23:19:58,637 INFO] Train perplexity: 12.6784
[2024-03-01 23:19:58,637 INFO] Train accuracy: 53.2852
[2024-03-01 23:19:58,637 INFO] Sentences processed: 166292
[2024-03-01 23:19:58,637 INFO] Average bsz:  165/ 382/64
[2024-03-01 23:19:58,638 INFO] Validation perplexity: 530.985
[2024-03-01 23:19:58,638 INFO] Validation accuracy: 18.8677
[2024-03-01 23:19:58,640 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_4200.pt
[2024-03-01 23:19:59,748 INFO] Step 4250/ 6600; acc: 78.2; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  166/ 370/64; 1671/3718 tok/s;    113 sec;
[2024-03-01 23:20:00,475 INFO] Step 4300/ 6600; acc: 83.1; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  150/ 333/64; 10308/22907 tok/s;    113 sec;
[2024-03-01 23:20:01,245 INFO] Step 4350/ 6600; acc: 83.2; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  152/ 373/64; 9886/24187 tok/s;    114 sec;
[2024-03-01 23:20:02,043 INFO] Step 4400/ 6600; acc: 78.4; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  155/ 360/64; 9728/22581 tok/s;    115 sec;
[2024-03-01 23:20:06,181 INFO] valid stats calculation
                           took: 4.137303113937378 s.
[2024-03-01 23:20:06,181 INFO] Train perplexity: 11.3324
[2024-03-01 23:20:06,181 INFO] Train accuracy: 55.1291
[2024-03-01 23:20:06,181 INFO] Sentences processed: 179092
[2024-03-01 23:20:06,182 INFO] Average bsz:  164/ 381/64
[2024-03-01 23:20:06,182 INFO] Validation perplexity: 455.915
[2024-03-01 23:20:06,182 INFO] Validation accuracy: 18.7798
[2024-03-01 23:20:06,184 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_4400.pt
[2024-03-01 23:20:07,305 INFO] Step 4450/ 6600; acc: 77.2; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  160/ 366/64; 1519/3482 tok/s;    120 sec;
[2024-03-01 23:20:08,088 INFO] Step 4500/ 6600; acc: 75.8; ppl:   4.2; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  163/ 380/64; 10385/24288 tok/s;    121 sec;
[2024-03-01 23:20:08,967 INFO] Step 4550/ 6600; acc: 72.6; ppl:   4.6; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  180/ 416/64; 10240/23668 tok/s;    122 sec;
[2024-03-01 23:20:09,848 INFO] Step 4600/ 6600; acc: 71.4; ppl:   5.8; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  178/ 398/64; 10103/22561 tok/s;    123 sec;
[2024-03-01 23:20:13,989 INFO] valid stats calculation
                           took: 4.140520095825195 s.
[2024-03-01 23:20:13,990 INFO] Train perplexity: 10.6144
[2024-03-01 23:20:13,990 INFO] Train accuracy: 56.426
[2024-03-01 23:20:13,990 INFO] Sentences processed: 191892
[2024-03-01 23:20:13,990 INFO] Average bsz:  165/ 381/64
[2024-03-01 23:20:13,990 INFO] Validation perplexity: 464.729
[2024-03-01 23:20:13,990 INFO] Validation accuracy: 17.5872
[2024-03-01 23:20:13,992 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_4600.pt
[2024-03-01 23:20:15,159 INFO] Step 4650/ 6600; acc: 77.7; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  168/ 391/64; 1581/3684 tok/s;    128 sec;
[2024-03-01 23:20:15,982 INFO] Step 4700/ 6600; acc: 81.7; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  172/ 365/64; 10420/22182 tok/s;    129 sec;
[2024-03-01 23:20:16,894 INFO] Step 4750/ 6600; acc: 82.5; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  142/ 371/64; 7758/20313 tok/s;    130 sec;
[2024-03-01 23:20:17,746 INFO] Step 4800/ 6600; acc: 75.1; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  166/ 386/64; 9731/22648 tok/s;    131 sec;
[2024-03-01 23:20:21,682 INFO] valid stats calculation
                           took: 3.935213088989258 s.
[2024-03-01 23:20:21,682 INFO] Train perplexity: 9.8041
[2024-03-01 23:20:21,682 INFO] Train accuracy: 57.8383
[2024-03-01 23:20:21,682 INFO] Sentences processed: 204692
[2024-03-01 23:20:21,682 INFO] Average bsz:  165/ 381/64
[2024-03-01 23:20:21,682 INFO] Validation perplexity: 892.726
[2024-03-01 23:20:21,682 INFO] Validation accuracy: 15.8925
[2024-03-01 23:20:21,685 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_4800.pt
[2024-03-01 23:20:22,850 INFO] Step 4850/ 6600; acc: 81.4; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  200/ 425/64; 1956/4161 tok/s;    136 sec;
[2024-03-01 23:20:23,658 INFO] Step 4900/ 6600; acc: 85.6; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  152/ 385/64; 9428/23851 tok/s;    136 sec;
[2024-03-01 23:20:24,424 INFO] Step 4950/ 6600; acc: 87.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  143/ 358/64; 9362/23404 tok/s;    137 sec;
[2024-03-01 23:20:25,320 INFO] Step 5000/ 6600; acc: 71.7; ppl:   5.5; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  210/ 411/64; 11718/22928 tok/s;    138 sec;
[2024-03-01 23:20:29,210 INFO] valid stats calculation
                           took: 3.8891775608062744 s.
[2024-03-01 23:20:29,210 INFO] Train perplexity: 9.05493
[2024-03-01 23:20:29,210 INFO] Train accuracy: 59.2673
[2024-03-01 23:20:29,210 INFO] Sentences processed: 217492
[2024-03-01 23:20:29,210 INFO] Average bsz:  165/ 382/64
[2024-03-01 23:20:29,211 INFO] Validation perplexity: 534.21
[2024-03-01 23:20:29,211 INFO] Validation accuracy: 19.5142
[2024-03-01 23:20:29,213 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_5000.pt
[2024-03-01 23:20:30,361 INFO] Step 5050/ 6600; acc: 75.1; ppl:   4.9; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  186/ 391/64; 1842/3880 tok/s;    143 sec;
[2024-03-01 23:20:31,159 INFO] Step 5100/ 6600; acc: 86.2; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  156/ 375/64; 9788/23510 tok/s;    144 sec;
[2024-03-01 23:20:31,962 INFO] Step 5150/ 6600; acc: 83.9; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  160/ 370/64; 9964/23025 tok/s;    145 sec;
[2024-03-01 23:20:32,768 INFO] Step 5200/ 6600; acc: 83.6; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  149/ 362/64; 9265/22434 tok/s;    146 sec;
[2024-03-01 23:20:36,654 INFO] valid stats calculation
                           took: 3.8854124546051025 s.
[2024-03-01 23:20:36,654 INFO] Train perplexity: 8.45406
[2024-03-01 23:20:36,654 INFO] Train accuracy: 60.5129
[2024-03-01 23:20:36,654 INFO] Sentences processed: 230292
[2024-03-01 23:20:36,654 INFO] Average bsz:  165/ 381/64
[2024-03-01 23:20:36,654 INFO] Validation perplexity: 531.17
[2024-03-01 23:20:36,654 INFO] Validation accuracy: 18.1898
[2024-03-01 23:20:36,657 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_5200.pt
[2024-03-01 23:20:37,881 INFO] Step 5250/ 6600; acc: 71.7; ppl:   5.6; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  194/ 414/64; 1895/4051 tok/s;    151 sec;
[2024-03-01 23:20:38,675 INFO] Step 5300/ 6600; acc: 84.5; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  152/ 371/64; 9591/23370 tok/s;    151 sec;
[2024-03-01 23:20:39,471 INFO] Step 5350/ 6600; acc: 85.1; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  161/ 370/64; 10132/23273 tok/s;    152 sec;
[2024-03-01 23:20:40,583 INFO] Step 5400/ 6600; acc: 72.7; ppl:   5.2; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  207/ 434/64; 9327/19491 tok/s;    153 sec;
[2024-03-01 23:20:44,473 INFO] valid stats calculation
                           took: 3.889035940170288 s.
[2024-03-01 23:20:44,473 INFO] Train perplexity: 8.06059
[2024-03-01 23:20:44,473 INFO] Train accuracy: 61.4751
[2024-03-01 23:20:44,473 INFO] Sentences processed: 243092
[2024-03-01 23:20:44,473 INFO] Average bsz:  166/ 382/64
[2024-03-01 23:20:44,473 INFO] Validation perplexity: 515.37
[2024-03-01 23:20:44,473 INFO] Validation accuracy: 18.5099
[2024-03-01 23:20:44,476 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_5400.pt
[2024-03-01 23:20:45,656 INFO] Step 5450/ 6600; acc: 72.8; ppl:   5.2; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  206/ 410/64; 2027/4044 tok/s;    158 sec;
[2024-03-01 23:20:46,449 INFO] Step 5500/ 6600; acc: 86.2; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  140/ 376/64; 8797/23679 tok/s;    159 sec;
[2024-03-01 23:20:47,308 INFO] Step 5550/ 6600; acc: 81.9; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  167/ 388/64; 9730/22594 tok/s;    160 sec;
[2024-03-01 23:20:48,203 INFO] Step 5600/ 6600; acc: 80.8; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  153/ 379/64; 8526/21184 tok/s;    161 sec;
[2024-03-01 23:20:52,084 INFO] valid stats calculation
                           took: 3.8808753490448 s.
[2024-03-01 23:20:52,084 INFO] Train perplexity: 7.66455
[2024-03-01 23:20:52,085 INFO] Train accuracy: 62.4293
[2024-03-01 23:20:52,085 INFO] Sentences processed: 255892
[2024-03-01 23:20:52,085 INFO] Average bsz:  166/ 383/64
[2024-03-01 23:20:52,085 INFO] Validation perplexity: 513.78
[2024-03-01 23:20:52,085 INFO] Validation accuracy: 17.6437
[2024-03-01 23:20:52,087 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_5600.pt
[2024-03-01 23:20:53,184 INFO] Step 5650/ 6600; acc: 82.8; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  156/ 365/64; 1566/3663 tok/s;    166 sec;
[2024-03-01 23:20:54,001 INFO] Step 5700/ 6600; acc: 84.5; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  133/ 373/64; 8157/22812 tok/s;    167 sec;
[2024-03-01 23:20:54,826 INFO] Step 5750/ 6600; acc: 86.1; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  150/ 344/64; 9060/20852 tok/s;    168 sec;
[2024-03-01 23:20:55,697 INFO] Step 5800/ 6600; acc: 82.3; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  166/ 395/64; 9536/22685 tok/s;    168 sec;
[2024-03-01 23:20:59,578 INFO] valid stats calculation
                           took: 3.8806893825531006 s.
[2024-03-01 23:20:59,579 INFO] Train perplexity: 7.26486
[2024-03-01 23:20:59,579 INFO] Train accuracy: 63.4162
[2024-03-01 23:20:59,579 INFO] Sentences processed: 268692
[2024-03-01 23:20:59,579 INFO] Average bsz:  165/ 382/64
[2024-03-01 23:20:59,579 INFO] Validation perplexity: 423.561
[2024-03-01 23:20:59,579 INFO] Validation accuracy: 18.5413
[2024-03-01 23:20:59,581 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_5800.pt
[2024-03-01 23:21:00,698 INFO] Step 5850/ 6600; acc: 86.2; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  162/ 372/64; 1620/3718 tok/s;    173 sec;
[2024-03-01 23:21:01,569 INFO] Step 5900/ 6600; acc: 82.2; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  171/ 397/64; 9813/22807 tok/s;    174 sec;
[2024-03-01 23:21:02,321 INFO] Step 5950/ 6600; acc: 85.7; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  130/ 327/64; 8636/21776 tok/s;    175 sec;
[2024-03-01 23:21:03,177 INFO] Step 6000/ 6600; acc: 84.4; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3140; bsz:  165/ 366/63; 9640/21403 tok/s;    176 sec;
[2024-03-01 23:21:07,090 INFO] valid stats calculation
                           took: 3.9127750396728516 s.
[2024-03-01 23:21:07,090 INFO] Train perplexity: 6.91815
[2024-03-01 23:21:07,090 INFO] Train accuracy: 64.3372
[2024-03-01 23:21:07,091 INFO] Sentences processed: 281432
[2024-03-01 23:21:07,091 INFO] Average bsz:  165/ 381/64
[2024-03-01 23:21:07,091 INFO] Validation perplexity: 445.167
[2024-03-01 23:21:07,091 INFO] Validation accuracy: 19.6209
[2024-03-01 23:21:07,093 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_6000.pt
[2024-03-01 23:21:08,160 INFO] Step 6050/ 6600; acc: 83.9; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  157/ 361/64; 1580/3618 tok/s;    181 sec;
[2024-03-01 23:21:08,925 INFO] Step 6100/ 6600; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  147/ 356/64; 9620/23256 tok/s;    182 sec;
[2024-03-01 23:21:09,802 INFO] Step 6150/ 6600; acc: 80.4; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  168/ 408/64; 9599/23274 tok/s;    183 sec;
[2024-03-01 23:21:10,645 INFO] Step 6200/ 6600; acc: 86.6; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  168/ 410/64; 9947/24328 tok/s;    183 sec;
[2024-03-01 23:21:14,525 INFO] valid stats calculation
                           took: 3.87939715385437 s.
[2024-03-01 23:21:14,525 INFO] Train perplexity: 6.58159
[2024-03-01 23:21:14,525 INFO] Train accuracy: 65.2549
[2024-03-01 23:21:14,525 INFO] Sentences processed: 294232
[2024-03-01 23:21:14,525 INFO] Average bsz:  165/ 381/64
[2024-03-01 23:21:14,525 INFO] Validation perplexity: 429.564
[2024-03-01 23:21:14,525 INFO] Validation accuracy: 19.42
[2024-03-01 23:21:14,527 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_6200.pt
[2024-03-01 23:21:15,670 INFO] Step 6250/ 6600; acc: 87.7; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  176/ 395/64; 1753/3930 tok/s;    188 sec;
[2024-03-01 23:21:16,458 INFO] Step 6300/ 6600; acc: 88.1; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  165/ 368/64; 10479/23386 tok/s;    189 sec;
[2024-03-01 23:21:17,220 INFO] Step 6350/ 6600; acc: 87.3; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  156/ 350/64; 10248/22943 tok/s;    190 sec;
[2024-03-01 23:21:18,111 INFO] Step 6400/ 6600; acc: 83.7; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  192/ 416/64; 10786/23324 tok/s;    191 sec;
[2024-03-01 23:21:21,971 INFO] valid stats calculation
                           took: 3.8595077991485596 s.
[2024-03-01 23:21:21,971 INFO] Train perplexity: 6.26828
[2024-03-01 23:21:21,971 INFO] Train accuracy: 66.147
[2024-03-01 23:21:21,972 INFO] Sentences processed: 307032
[2024-03-01 23:21:21,972 INFO] Average bsz:  165/ 381/64
[2024-03-01 23:21:21,972 INFO] Validation perplexity: 512.538
[2024-03-01 23:21:21,972 INFO] Validation accuracy: 19.2945
[2024-03-01 23:21:21,974 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_6400.pt
[2024-03-01 23:21:23,047 INFO] Step 6450/ 6600; acc: 91.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  143/ 371/64; 1452/3761 tok/s;    196 sec;
[2024-03-01 23:21:23,846 INFO] Step 6500/ 6600; acc: 89.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  160/ 381/64; 10019/23829 tok/s;    197 sec;
[2024-03-01 23:21:24,633 INFO] Step 6550/ 6600; acc: 85.0; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  143/ 354/64; 9110/22507 tok/s;    197 sec;
[2024-03-01 23:21:25,498 INFO] Step 6600/ 6600; acc: 83.4; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  156/ 376/64; 9016/21767 tok/s;    198 sec;
[2024-03-01 23:21:29,394 INFO] valid stats calculation
                           took: 3.8950977325439453 s.
[2024-03-01 23:21:29,394 INFO] Train perplexity: 5.99562
[2024-03-01 23:21:29,394 INFO] Train accuracy: 66.97
[2024-03-01 23:21:29,394 INFO] Sentences processed: 319832
[2024-03-01 23:21:29,394 INFO] Average bsz:  164/ 381/64
[2024-03-01 23:21:29,394 INFO] Validation perplexity: 546.628
[2024-03-01 23:21:29,394 INFO] Validation accuracy: 18.0957
[2024-03-01 23:21:29,396 INFO] Saving checkpoint gt-finetune/gt-finetune_1600_01_step_6600.pt
