[2024-03-13 09:19:26,019 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-13 09:19:26,019 INFO] Parsed 2 corpora from -data.
[2024-03-13 09:19:26,019 INFO] Loading checkpoint from tg-pt-both/models/tg-pt-both_01_step_3200.pt
[2024-03-13 09:19:26,089 INFO] Building model...
[2024-03-13 09:19:26,144 INFO] Switching model to float32 for amp/apex_amp
[2024-03-13 09:19:26,144 INFO] Non quantized layer compute is fp32
[2024-03-13 09:19:28,011 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-13 09:19:28,011 INFO] encoder: 8952800
[2024-03-13 09:19:28,012 INFO] decoder: 16687344
[2024-03-13 09:19:28,012 INFO] * number of parameters: 25640144
[2024-03-13 09:19:28,012 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 09:19:28,012 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 09:19:28,012 INFO]  * src vocab size = 17816
[2024-03-13 09:19:28,012 INFO]  * tgt vocab size = 14144
[2024-03-13 09:19:28,013 INFO] Starting training on GPU: [0]
[2024-03-13 09:19:28,013 INFO] Start training loop and validate every 200 steps...
[2024-03-13 09:19:28,014 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-13 09:19:34,455 INFO] Step 3250/ 8200; acc: 10.9; ppl: 66301.9; xent: 11.1; lr: 1.00000; sents:    2270; bsz:  565/ 490/45; 4387/3801 tok/s;      6 sec;
[2024-03-13 09:19:37,959 INFO] Step 3300/ 8200; acc: 12.3; ppl: 2816.5; xent: 7.9; lr: 1.00000; sents:    2369; bsz:  569/ 496/47; 8115/7079 tok/s;     10 sec;
[2024-03-13 09:19:41,564 INFO] Step 3350/ 8200; acc: 15.9; ppl: 707.4; xent: 6.6; lr: 1.00000; sents:    2363; bsz:  585/ 508/47; 8115/7044 tok/s;     14 sec;
[2024-03-13 09:19:45,201 INFO] Step 3400/ 8200; acc: 19.0; ppl: 318.3; xent: 5.8; lr: 1.00000; sents:    2365; bsz:  585/ 507/47; 8044/6974 tok/s;     17 sec;
[2024-03-13 09:19:48,736 INFO] valid stats calculation
                           took: 3.535060167312622 s.
[2024-03-13 09:19:48,736 INFO] Train perplexity: 2472.55
[2024-03-13 09:19:48,737 INFO] Train accuracy: 14.5832
[2024-03-13 09:19:48,737 INFO] Sentences processed: 9367
[2024-03-13 09:19:48,737 INFO] Average bsz:  576/ 500/47
[2024-03-13 09:19:48,737 INFO] Validation perplexity: 444.069
[2024-03-13 09:19:48,737 INFO] Validation accuracy: 16.0449
[2024-03-13 09:19:48,738 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_3400.pt
[2024-03-13 09:19:51,469 INFO] Step 3450/ 8200; acc: 22.9; ppl: 164.1; xent: 5.1; lr: 1.00000; sents:    2367; bsz:  564/ 491/47; 4502/3917 tok/s;     23 sec;
[2024-03-13 09:19:55,107 INFO] Step 3500/ 8200; acc: 27.0; ppl: 104.6; xent: 4.7; lr: 1.00000; sents:    2251; bsz:  549/ 475/45; 7546/6526 tok/s;     27 sec;
[2024-03-13 09:19:58,793 INFO] Step 3550/ 8200; acc: 29.5; ppl:  73.2; xent: 4.3; lr: 1.00000; sents:    2378; bsz:  586/ 509/48; 7944/6906 tok/s;     31 sec;
[2024-03-13 09:20:02,369 INFO] Step 3600/ 8200; acc: 32.9; ppl:  50.2; xent: 3.9; lr: 1.00000; sents:    2280; bsz:  562/ 488/46; 7867/6819 tok/s;     34 sec;
[2024-03-13 09:20:05,896 INFO] valid stats calculation
                           took: 3.5268054008483887 s.
[2024-03-13 09:20:05,896 INFO] Train perplexity: 476.534
[2024-03-13 09:20:05,896 INFO] Train accuracy: 21.264
[2024-03-13 09:20:05,897 INFO] Sentences processed: 18643
[2024-03-13 09:20:05,897 INFO] Average bsz:  571/ 495/47
[2024-03-13 09:20:05,897 INFO] Validation perplexity: 224.08
[2024-03-13 09:20:05,897 INFO] Validation accuracy: 25.8724
[2024-03-13 09:20:05,898 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_3600.pt
[2024-03-13 09:20:08,409 INFO] Step 3650/ 8200; acc: 36.1; ppl:  36.6; xent: 3.6; lr: 1.00000; sents:    2381; bsz:  568/ 495/48; 4702/4095 tok/s;     40 sec;
[2024-03-13 09:20:11,918 INFO] Step 3700/ 8200; acc: 38.1; ppl:  28.5; xent: 3.3; lr: 1.00000; sents:    2261; bsz:  552/ 477/45; 7864/6795 tok/s;     44 sec;
[2024-03-13 09:20:15,441 INFO] Step 3750/ 8200; acc: 41.1; ppl:  21.7; xent: 3.1; lr: 1.00000; sents:    2486; bsz:  591/ 514/50; 8389/7304 tok/s;     47 sec;
[2024-03-13 09:20:18,978 INFO] Step 3800/ 8200; acc: 42.6; ppl:  19.0; xent: 2.9; lr: 1.00000; sents:    2252; bsz:  551/ 477/45; 7792/6738 tok/s;     51 sec;
[2024-03-13 09:20:22,434 INFO] valid stats calculation
                           took: 3.456102132797241 s.
[2024-03-13 09:20:22,435 INFO] Train perplexity: 180.908
[2024-03-13 09:20:22,435 INFO] Train accuracy: 27.2963
[2024-03-13 09:20:22,435 INFO] Sentences processed: 28023
[2024-03-13 09:20:22,435 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:20:22,435 INFO] Validation perplexity: 281.609
[2024-03-13 09:20:22,435 INFO] Validation accuracy: 27.3967
[2024-03-13 09:20:22,436 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_3800.pt
[2024-03-13 09:20:24,897 INFO] Step 3850/ 8200; acc: 45.0; ppl:  15.2; xent: 2.7; lr: 1.00000; sents:    2367; bsz:  567/ 499/47; 4792/4215 tok/s;     57 sec;
[2024-03-13 09:20:28,189 INFO] Step 3900/ 8200; acc: 46.3; ppl:  13.5; xent: 2.6; lr: 1.00000; sents:    2364; bsz:  587/ 514/47; 8921/7800 tok/s;     60 sec;
[2024-03-13 09:20:31,833 INFO] Step 3950/ 8200; acc: 48.2; ppl:  11.5; xent: 2.4; lr: 1.00000; sents:    2271; bsz:  567/ 490/45; 7777/6721 tok/s;     64 sec;
[2024-03-13 09:20:35,357 INFO] Step 4000/ 8200; acc: 51.2; ppl:   9.4; xent: 2.2; lr: 1.00000; sents:    2365; bsz:  561/ 487/47; 7956/6904 tok/s;     67 sec;
[2024-03-13 09:20:38,893 INFO] valid stats calculation
                           took: 3.5353920459747314 s.
[2024-03-13 09:20:38,893 INFO] Train perplexity: 91.8898
[2024-03-13 09:20:38,893 INFO] Train accuracy: 32.4103
[2024-03-13 09:20:38,893 INFO] Sentences processed: 37390
[2024-03-13 09:20:38,893 INFO] Average bsz:  569/ 495/47
[2024-03-13 09:20:38,893 INFO] Validation perplexity: 325.094
[2024-03-13 09:20:38,893 INFO] Validation accuracy: 28.3193
[2024-03-13 09:20:38,895 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_4000.pt
[2024-03-13 09:20:41,474 INFO] Step 4050/ 8200; acc: 52.3; ppl:   8.6; xent: 2.1; lr: 1.00000; sents:    2372; bsz:  575/ 500/47; 4700/4083 tok/s;     73 sec;
[2024-03-13 09:20:44,608 INFO] Step 4100/ 8200; acc: 54.3; ppl:   7.5; xent: 2.0; lr: 1.00000; sents:    2268; bsz:  557/ 483/45; 8892/7702 tok/s;     77 sec;
[2024-03-13 09:20:48,346 INFO] Step 4150/ 8200; acc: 57.6; ppl:   6.3; xent: 1.8; lr: 1.00000; sents:    2376; bsz:  565/ 495/48; 7563/6622 tok/s;     80 sec;
[2024-03-13 09:20:51,893 INFO] Step 4200/ 8200; acc: 56.8; ppl:   6.3; xent: 1.8; lr: 1.00000; sents:    2284; bsz:  579/ 498/46; 8168/7017 tok/s;     84 sec;
[2024-03-13 09:20:55,404 INFO] valid stats calculation
                           took: 3.5108425617218018 s.
[2024-03-13 09:20:55,404 INFO] Train perplexity: 55.0796
[2024-03-13 09:20:55,404 INFO] Train accuracy: 36.9738
[2024-03-13 09:20:55,404 INFO] Sentences processed: 46690
[2024-03-13 09:20:55,404 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:20:55,404 INFO] Validation perplexity: 427.537
[2024-03-13 09:20:55,404 INFO] Validation accuracy: 28.9611
[2024-03-13 09:20:55,406 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_4200.pt
[2024-03-13 09:20:57,964 INFO] Step 4250/ 8200; acc: 60.5; ppl:   5.2; xent: 1.7; lr: 1.00000; sents:    2376; bsz:  564/ 493/48; 4648/4060 tok/s;     90 sec;
[2024-03-13 09:21:01,022 INFO] Step 4300/ 8200; acc: 61.6; ppl:   4.8; xent: 1.6; lr: 1.00000; sents:    2375; bsz:  579/ 498/48; 9464/8143 tok/s;     93 sec;
[2024-03-13 09:21:04,564 INFO] Step 4350/ 8200; acc: 63.0; ppl:   4.3; xent: 1.5; lr: 1.00000; sents:    2271; bsz:  547/ 474/45; 7719/6690 tok/s;     97 sec;
[2024-03-13 09:21:08,135 INFO] Step 4400/ 8200; acc: 64.6; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    2366; bsz:  577/ 501/47; 8083/7017 tok/s;    100 sec;
[2024-03-13 09:21:11,574 INFO] valid stats calculation
                           took: 3.439059019088745 s.
[2024-03-13 09:21:11,575 INFO] Train perplexity: 36.4831
[2024-03-13 09:21:11,575 INFO] Train accuracy: 41.197
[2024-03-13 09:21:11,575 INFO] Sentences processed: 56078
[2024-03-13 09:21:11,575 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:21:11,575 INFO] Validation perplexity: 487.568
[2024-03-13 09:21:11,575 INFO] Validation accuracy: 30.1243
[2024-03-13 09:21:11,576 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_4400.pt
[2024-03-13 09:21:14,281 INFO] Step 4450/ 8200; acc: 66.5; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 4590/3990 tok/s;    106 sec;
[2024-03-13 09:21:17,184 INFO] Step 4500/ 8200; acc: 66.3; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    2264; bsz:  582/ 502/45; 10028/8654 tok/s;    109 sec;
[2024-03-13 09:21:20,709 INFO] Step 4550/ 8200; acc: 69.0; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    2369; bsz:  566/ 491/47; 8023/6967 tok/s;    113 sec;
[2024-03-13 09:21:24,265 INFO] Step 4600/ 8200; acc: 69.8; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    2267; bsz:  561/ 483/45; 7889/6795 tok/s;    116 sec;
[2024-03-13 09:21:27,726 INFO] valid stats calculation
                           took: 3.4599366188049316 s.
[2024-03-13 09:21:27,726 INFO] Train perplexity: 26.081
[2024-03-13 09:21:27,726 INFO] Train accuracy: 44.9962
[2024-03-13 09:21:27,726 INFO] Sentences processed: 65344
[2024-03-13 09:21:27,726 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:21:27,727 INFO] Validation perplexity: 562.755
[2024-03-13 09:21:27,727 INFO] Validation accuracy: 29.0413
[2024-03-13 09:21:27,728 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_4600.pt
[2024-03-13 09:21:30,699 INFO] Step 4650/ 8200; acc: 71.4; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    2372; bsz:  580/ 501/47; 4511/3896 tok/s;    123 sec;
[2024-03-13 09:21:33,327 INFO] Step 4700/ 8200; acc: 72.2; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    2371; bsz:  564/ 490/47; 10734/9317 tok/s;    125 sec;
[2024-03-13 09:21:36,943 INFO] Step 4750/ 8200; acc: 73.1; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    2375; bsz:  583/ 505/48; 8063/6979 tok/s;    129 sec;
[2024-03-13 09:21:40,502 INFO] Step 4800/ 8200; acc: 74.7; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2382; bsz:  565/ 492/48; 7941/6912 tok/s;    132 sec;
[2024-03-13 09:21:43,952 INFO] valid stats calculation
                           took: 3.449411630630493 s.
[2024-03-13 09:21:43,952 INFO] Train perplexity: 19.6325
[2024-03-13 09:21:43,952 INFO] Train accuracy: 48.4949
[2024-03-13 09:21:43,952 INFO] Sentences processed: 74844
[2024-03-13 09:21:43,952 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:21:43,952 INFO] Validation perplexity: 802.199
[2024-03-13 09:21:43,952 INFO] Validation accuracy: 30.4051
[2024-03-13 09:21:43,953 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_4800.pt
[2024-03-13 09:21:47,060 INFO] Step 4850/ 8200; acc: 75.4; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2274; bsz:  557/ 483/45; 4251/3685 tok/s;    139 sec;
[2024-03-13 09:21:49,539 INFO] Step 4900/ 8200; acc: 76.7; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2376; bsz:  568/ 496/48; 11464/10004 tok/s;    142 sec;
[2024-03-13 09:21:53,191 INFO] Step 4950/ 8200; acc: 76.5; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2272; bsz:  584/ 503/45; 7990/6886 tok/s;    145 sec;
[2024-03-13 09:21:56,760 INFO] Step 5000/ 8200; acc: 78.5; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2366; bsz:  569/ 497/47; 7966/6958 tok/s;    149 sec;
[2024-03-13 09:22:00,236 INFO] valid stats calculation
                           took: 3.4754016399383545 s.
[2024-03-13 09:22:00,236 INFO] Train perplexity: 15.4699
[2024-03-13 09:22:00,236 INFO] Train accuracy: 51.6417
[2024-03-13 09:22:00,236 INFO] Sentences processed: 84132
[2024-03-13 09:22:00,236 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:22:00,236 INFO] Validation perplexity: 1035.09
[2024-03-13 09:22:00,236 INFO] Validation accuracy: 29.8436
[2024-03-13 09:22:00,237 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_5000.pt
[2024-03-13 09:22:03,490 INFO] Step 5050/ 8200; acc: 79.3; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2248; bsz:  550/ 476/45; 4086/3534 tok/s;    155 sec;
[2024-03-13 09:22:05,909 INFO] Step 5100/ 8200; acc: 80.4; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2484; bsz:  602/ 524/50; 12440/10827 tok/s;    158 sec;
[2024-03-13 09:22:09,387 INFO] Step 5150/ 8200; acc: 80.5; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2244; bsz:  547/ 474/45; 7867/6813 tok/s;    161 sec;
[2024-03-13 09:22:12,982 INFO] Step 5200/ 8200; acc: 81.2; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2367; bsz:  579/ 502/47; 8056/6979 tok/s;    165 sec;
[2024-03-13 09:22:16,425 INFO] valid stats calculation
                           took: 3.4425151348114014 s.
[2024-03-13 09:22:16,425 INFO] Train perplexity: 12.6109
[2024-03-13 09:22:16,425 INFO] Train accuracy: 54.5125
[2024-03-13 09:22:16,425 INFO] Sentences processed: 93475
[2024-03-13 09:22:16,426 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:22:16,426 INFO] Validation perplexity: 1631.1
[2024-03-13 09:22:16,426 INFO] Validation accuracy: 29.6029
[2024-03-13 09:22:16,427 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_5200.pt
[2024-03-13 09:22:19,917 INFO] Step 5250/ 8200; acc: 82.2; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2268; bsz:  558/ 484/45; 4023/3488 tok/s;    172 sec;
[2024-03-13 09:22:22,355 INFO] Step 5300/ 8200; acc: 83.4; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2379; bsz:  568/ 494/48; 11649/10143 tok/s;    174 sec;
[2024-03-13 09:22:25,711 INFO] Step 5350/ 8200; acc: 83.8; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2383; bsz:  567/ 495/48; 8454/7372 tok/s;    178 sec;
[2024-03-13 09:22:29,338 INFO] Step 5400/ 8200; acc: 83.8; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2267; bsz:  570/ 491/45; 7861/6773 tok/s;    181 sec;
[2024-03-13 09:22:32,798 INFO] valid stats calculation
                           took: 3.458948850631714 s.
[2024-03-13 09:22:32,798 INFO] Train perplexity: 10.571
[2024-03-13 09:22:32,798 INFO] Train accuracy: 57.1148
[2024-03-13 09:22:32,798 INFO] Sentences processed: 102772
[2024-03-13 09:22:32,798 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:22:32,799 INFO] Validation perplexity: 1944.55
[2024-03-13 09:22:32,799 INFO] Validation accuracy: 29.4023
[2024-03-13 09:22:32,800 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_5400.pt
[2024-03-13 09:22:36,218 INFO] Step 5450/ 8200; acc: 84.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 4093/3555 tok/s;    188 sec;
[2024-03-13 09:22:38,661 INFO] Step 5500/ 8200; acc: 84.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2275; bsz:  567/ 492/46; 11613/10062 tok/s;    191 sec;
[2024-03-13 09:22:41,919 INFO] Step 5550/ 8200; acc: 85.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2367; bsz:  566/ 498/47; 8694/7635 tok/s;    194 sec;
[2024-03-13 09:22:45,486 INFO] Step 5600/ 8200; acc: 85.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2367; bsz:  588/ 515/47; 8239/7214 tok/s;    197 sec;
[2024-03-13 09:22:48,945 INFO] valid stats calculation
                           took: 3.458373785018921 s.
[2024-03-13 09:22:48,945 INFO] Train perplexity: 9.05692
[2024-03-13 09:22:48,945 INFO] Train accuracy: 59.4505
[2024-03-13 09:22:48,945 INFO] Sentences processed: 112156
[2024-03-13 09:22:48,945 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:22:48,945 INFO] Validation perplexity: 2788.69
[2024-03-13 09:22:48,945 INFO] Validation accuracy: 28.8408
[2024-03-13 09:22:48,947 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_5600.pt
[2024-03-13 09:22:52,612 INFO] Step 5650/ 8200; acc: 86.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2260; bsz:  555/ 480/45; 3897/3371 tok/s;    205 sec;
[2024-03-13 09:22:55,043 INFO] Step 5700/ 8200; acc: 86.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2367; bsz:  571/ 492/47; 11748/10127 tok/s;    207 sec;
[2024-03-13 09:22:57,963 INFO] Step 5750/ 8200; acc: 87.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2365; bsz:  562/ 489/47; 9615/8372 tok/s;    210 sec;
[2024-03-13 09:23:01,662 INFO] Step 5800/ 8200; acc: 87.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2373; bsz:  582/ 507/47; 7864/6851 tok/s;    214 sec;
[2024-03-13 09:23:05,110 INFO] valid stats calculation
                           took: 3.4471189975738525 s.
[2024-03-13 09:23:05,110 INFO] Train perplexity: 7.9185
[2024-03-13 09:23:05,110 INFO] Train accuracy: 61.549
[2024-03-13 09:23:05,110 INFO] Sentences processed: 121521
[2024-03-13 09:23:05,110 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:23:05,110 INFO] Validation perplexity: 2599.86
[2024-03-13 09:23:05,110 INFO] Validation accuracy: 29.0814
[2024-03-13 09:23:05,111 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_5800.pt
[2024-03-13 09:23:08,955 INFO] Step 5850/ 8200; acc: 87.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2371; bsz:  565/ 494/47; 3873/3388 tok/s;    221 sec;
[2024-03-13 09:23:11,580 INFO] Step 5900/ 8200; acc: 88.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2279; bsz:  562/ 486/46; 10713/9253 tok/s;    224 sec;
[2024-03-13 09:23:14,444 INFO] Step 5950/ 8200; acc: 88.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2381; bsz:  566/ 491/48; 9886/8577 tok/s;    226 sec;
[2024-03-13 09:23:18,089 INFO] Step 6000/ 8200; acc: 88.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2276; bsz:  574/ 493/46; 7881/6761 tok/s;    230 sec;
[2024-03-13 09:23:21,539 INFO] valid stats calculation
                           took: 3.4501473903656006 s.
[2024-03-13 09:23:21,540 INFO] Train perplexity: 7.03883
[2024-03-13 09:23:21,540 INFO] Train accuracy: 63.4308
[2024-03-13 09:23:21,540 INFO] Sentences processed: 130828
[2024-03-13 09:23:21,540 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:23:21,540 INFO] Validation perplexity: 2664.38
[2024-03-13 09:23:21,540 INFO] Validation accuracy: 30.4854
[2024-03-13 09:23:21,541 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_6000.pt
[2024-03-13 09:23:25,169 INFO] Step 6050/ 8200; acc: 89.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  566/ 491/48; 3996/3466 tok/s;    237 sec;
[2024-03-13 09:23:28,026 INFO] Step 6100/ 8200; acc: 89.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2273; bsz:  565/ 489/45; 9891/8559 tok/s;    240 sec;
[2024-03-13 09:23:30,859 INFO] Step 6150/ 8200; acc: 89.3; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2366; bsz:  583/ 506/47; 10300/8936 tok/s;    243 sec;
[2024-03-13 09:23:34,403 INFO] Step 6200/ 8200; acc: 89.9; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 7963/6920 tok/s;    246 sec;
[2024-03-13 09:23:37,856 INFO] valid stats calculation
                           took: 3.452812910079956 s.
[2024-03-13 09:23:37,857 INFO] Train perplexity: 6.33336
[2024-03-13 09:23:37,857 INFO] Train accuracy: 65.1642
[2024-03-13 09:23:37,857 INFO] Sentences processed: 140208
[2024-03-13 09:23:37,857 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:23:37,857 INFO] Validation perplexity: 2806.49
[2024-03-13 09:23:37,857 INFO] Validation accuracy: 30.4854
[2024-03-13 09:23:37,858 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_6200.pt
[2024-03-13 09:23:41,461 INFO] Step 6250/ 8200; acc: 90.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2362; bsz:  562/ 488/47; 3983/3458 tok/s;    253 sec;
[2024-03-13 09:23:44,385 INFO] Step 6300/ 8200; acc: 90.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2267; bsz:  577/ 495/45; 9876/8463 tok/s;    256 sec;
[2024-03-13 09:23:46,890 INFO] Step 6350/ 8200; acc: 90.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2369; bsz:  563/ 489/47; 11250/9763 tok/s;    259 sec;
[2024-03-13 09:23:50,568 INFO] Step 6400/ 8200; acc: 90.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2270; bsz:  559/ 485/45; 7600/6593 tok/s;    263 sec;
[2024-03-13 09:23:54,065 INFO] valid stats calculation
                           took: 3.4965267181396484 s.
[2024-03-13 09:23:54,066 INFO] Train perplexity: 5.76856
[2024-03-13 09:23:54,066 INFO] Train accuracy: 66.7174
[2024-03-13 09:23:54,066 INFO] Sentences processed: 149476
[2024-03-13 09:23:54,066 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:23:54,066 INFO] Validation perplexity: 3519.65
[2024-03-13 09:23:54,066 INFO] Validation accuracy: 29.6831
[2024-03-13 09:23:54,067 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_6400.pt
[2024-03-13 09:23:57,809 INFO] Step 6450/ 8200; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2371; bsz:  566/ 493/47; 3907/3405 tok/s;    270 sec;
[2024-03-13 09:24:00,822 INFO] Step 6500/ 8200; acc: 91.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  582/ 503/48; 9657/8354 tok/s;    273 sec;
[2024-03-13 09:24:03,469 INFO] Step 6550/ 8200; acc: 91.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2382; bsz:  568/ 496/48; 10738/9380 tok/s;    275 sec;
[2024-03-13 09:24:07,087 INFO] Step 6600/ 8200; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  590/ 511/48; 8153/7065 tok/s;    279 sec;
[2024-03-13 09:24:10,590 INFO] valid stats calculation
                           took: 3.5033483505249023 s.
[2024-03-13 09:24:10,591 INFO] Train perplexity: 5.29467
[2024-03-13 09:24:10,591 INFO] Train accuracy: 68.1602
[2024-03-13 09:24:10,591 INFO] Sentences processed: 158980
[2024-03-13 09:24:10,591 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:24:10,591 INFO] Validation perplexity: 4453.41
[2024-03-13 09:24:10,591 INFO] Validation accuracy: 30.6859
[2024-03-13 09:24:10,592 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_6600.pt
[2024-03-13 09:24:14,317 INFO] Step 6650/ 8200; acc: 91.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2280; bsz:  565/ 490/46; 3908/3391 tok/s;    286 sec;
[2024-03-13 09:24:17,525 INFO] Step 6700/ 8200; acc: 91.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2247; bsz:  550/ 477/45; 8567/7429 tok/s;    290 sec;
[2024-03-13 09:24:19,968 INFO] Step 6750/ 8200; acc: 91.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  586/ 506/47; 11982/10347 tok/s;    292 sec;
[2024-03-13 09:24:23,325 INFO] Step 6800/ 8200; acc: 91.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2368; bsz:  567/ 493/47; 8443/7347 tok/s;    295 sec;
[2024-03-13 09:24:26,778 INFO] valid stats calculation
                           took: 3.453145742416382 s.
[2024-03-13 09:24:26,779 INFO] Train perplexity: 4.90792
[2024-03-13 09:24:26,779 INFO] Train accuracy: 69.4411
[2024-03-13 09:24:26,779 INFO] Sentences processed: 168242
[2024-03-13 09:24:26,779 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:24:26,779 INFO] Validation perplexity: 6757.06
[2024-03-13 09:24:26,779 INFO] Validation accuracy: 30.004
[2024-03-13 09:24:26,780 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_6800.pt
[2024-03-13 09:24:30,358 INFO] Step 6850/ 8200; acc: 92.1; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2249; bsz:  551/ 478/45; 3918/3401 tok/s;    302 sec;
[2024-03-13 09:24:33,801 INFO] Step 6900/ 8200; acc: 91.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2365; bsz:  578/ 500/47; 8389/7254 tok/s;    306 sec;
[2024-03-13 09:24:36,170 INFO] Step 6950/ 8200; acc: 92.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  566/ 492/47; 11941/10380 tok/s;    308 sec;
[2024-03-13 09:24:39,356 INFO] Step 7000/ 8200; acc: 92.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  569/ 497/48; 8924/7805 tok/s;    311 sec;
[2024-03-13 09:24:42,798 INFO] valid stats calculation
                           took: 3.4411861896514893 s.
[2024-03-13 09:24:42,798 INFO] Train perplexity: 4.57953
[2024-03-13 09:24:42,798 INFO] Train accuracy: 70.6318
[2024-03-13 09:24:42,798 INFO] Sentences processed: 177605
[2024-03-13 09:24:42,798 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:24:42,798 INFO] Validation perplexity: 6714.75
[2024-03-13 09:24:42,798 INFO] Validation accuracy: 30.004
[2024-03-13 09:24:42,800 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_7000.pt
[2024-03-13 09:24:46,629 INFO] Step 7050/ 8200; acc: 92.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2272; bsz:  574/ 498/45; 3946/3424 tok/s;    319 sec;
[2024-03-13 09:24:50,189 INFO] Step 7100/ 8200; acc: 92.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  565/ 490/48; 7933/6879 tok/s;    322 sec;
[2024-03-13 09:24:52,730 INFO] Step 7150/ 8200; acc: 92.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  564/ 492/48; 11096/9678 tok/s;    325 sec;
[2024-03-13 09:24:55,847 INFO] Step 7200/ 8200; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2278; bsz:  567/ 490/46; 9100/7867 tok/s;    328 sec;
[2024-03-13 09:24:59,316 INFO] valid stats calculation
                           took: 3.4684195518493652 s.
[2024-03-13 09:24:59,316 INFO] Train perplexity: 4.29947
[2024-03-13 09:24:59,316 INFO] Train accuracy: 71.7303
[2024-03-13 09:24:59,316 INFO] Sentences processed: 186912
[2024-03-13 09:24:59,316 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:24:59,316 INFO] Validation perplexity: 5709.45
[2024-03-13 09:24:59,316 INFO] Validation accuracy: 29.643
[2024-03-13 09:24:59,317 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_7200.pt
[2024-03-13 09:25:03,080 INFO] Step 7250/ 8200; acc: 92.7; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2372; bsz:  587/ 515/47; 4060/3561 tok/s;    335 sec;
[2024-03-13 09:25:06,731 INFO] Step 7300/ 8200; acc: 93.3; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  578/ 498/47; 7912/6820 tok/s;    339 sec;
[2024-03-13 09:25:09,171 INFO] Step 7350/ 8200; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  561/ 487/47; 11487/9977 tok/s;    341 sec;
[2024-03-13 09:25:11,901 INFO] Step 7400/ 8200; acc: 92.8; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2260; bsz:  554/ 481/45; 10139/8802 tok/s;    344 sec;
[2024-03-13 09:25:15,340 INFO] valid stats calculation
                           took: 3.438169002532959 s.
[2024-03-13 09:25:15,340 INFO] Train perplexity: 4.05699
[2024-03-13 09:25:15,340 INFO] Train accuracy: 72.7431
[2024-03-13 09:25:15,340 INFO] Sentences processed: 196278
[2024-03-13 09:25:15,340 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:25:15,341 INFO] Validation perplexity: 8300.62
[2024-03-13 09:25:15,341 INFO] Validation accuracy: 29.282
[2024-03-13 09:25:15,342 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_7400.pt
[2024-03-13 09:25:19,067 INFO] Step 7450/ 8200; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  563/ 492/47; 3932/3433 tok/s;    351 sec;
[2024-03-13 09:25:22,792 INFO] Step 7500/ 8200; acc: 93.2; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2268; bsz:  576/ 496/45; 7728/6658 tok/s;    355 sec;
[2024-03-13 09:25:25,574 INFO] Step 7550/ 8200; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2373; bsz:  566/ 495/47; 10176/8901 tok/s;    358 sec;
[2024-03-13 09:25:28,337 INFO] Step 7600/ 8200; acc: 93.5; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2372; bsz:  565/ 491/47; 10231/8885 tok/s;    360 sec;
[2024-03-13 09:25:31,777 INFO] valid stats calculation
                           took: 3.439739227294922 s.
[2024-03-13 09:25:31,777 INFO] Train perplexity: 3.84797
[2024-03-13 09:25:31,777 INFO] Train accuracy: 73.6763
[2024-03-13 09:25:31,777 INFO] Sentences processed: 205658
[2024-03-13 09:25:31,777 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:25:31,777 INFO] Validation perplexity: 7438.89
[2024-03-13 09:25:31,777 INFO] Validation accuracy: 30.1243
[2024-03-13 09:25:31,779 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_7600.pt
[2024-03-13 09:25:35,665 INFO] Step 7650/ 8200; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2274; bsz:  578/ 496/45; 3944/3386 tok/s;    368 sec;
[2024-03-13 09:25:39,138 INFO] Step 7700/ 8200; acc: 93.5; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2382; bsz:  561/ 487/48; 8076/7018 tok/s;    371 sec;
[2024-03-13 09:25:42,072 INFO] Step 7750/ 8200; acc: 93.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2376; bsz:  567/ 491/48; 9666/8374 tok/s;    374 sec;
[2024-03-13 09:25:44,603 INFO] Step 7800/ 8200; acc: 93.6; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2375; bsz:  586/ 508/48; 11583/10038 tok/s;    377 sec;
[2024-03-13 09:25:48,031 INFO] valid stats calculation
                           took: 3.4274072647094727 s.
[2024-03-13 09:25:48,032 INFO] Train perplexity: 3.66376
[2024-03-13 09:25:48,032 INFO] Train accuracy: 74.5446
[2024-03-13 09:25:48,032 INFO] Sentences processed: 215065
[2024-03-13 09:25:48,032 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:25:48,032 INFO] Validation perplexity: 7522.6
[2024-03-13 09:25:48,032 INFO] Validation accuracy: 30.1645
[2024-03-13 09:25:48,033 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_7800.pt
[2024-03-13 09:25:51,884 INFO] Step 7850/ 8200; acc: 93.7; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2273; bsz:  564/ 489/45; 3877/3358 tok/s;    384 sec;
[2024-03-13 09:25:55,355 INFO] Step 7900/ 8200; acc: 93.6; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2366; bsz:  563/ 489/47; 8107/7048 tok/s;    387 sec;
[2024-03-13 09:25:58,494 INFO] Step 7950/ 8200; acc: 93.7; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2263; bsz:  560/ 483/45; 8913/7691 tok/s;    390 sec;
[2024-03-13 09:26:00,890 INFO] Step 8000/ 8200; acc: 94.0; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2365; bsz:  580/ 500/47; 12098/10423 tok/s;    393 sec;
[2024-03-13 09:26:04,508 INFO] valid stats calculation
                           took: 3.617901563644409 s.
[2024-03-13 09:26:04,509 INFO] Train perplexity: 3.50398
[2024-03-13 09:26:04,509 INFO] Train accuracy: 75.3395
[2024-03-13 09:26:04,509 INFO] Sentences processed: 224332
[2024-03-13 09:26:04,509 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:26:04,509 INFO] Validation perplexity: 10473.1
[2024-03-13 09:26:04,509 INFO] Validation accuracy: 30.004
[2024-03-13 09:26:04,510 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_8000.pt
[2024-03-13 09:26:08,164 INFO] Step 8050/ 8200; acc: 93.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  566/ 494/47; 3891/3398 tok/s;    400 sec;
[2024-03-13 09:26:11,783 INFO] Step 8100/ 8200; acc: 93.6; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2267; bsz:  576/ 495/45; 7961/6843 tok/s;    404 sec;
[2024-03-13 09:26:15,102 INFO] Step 8150/ 8200; acc: 93.5; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2372; bsz:  564/ 492/47; 8496/7420 tok/s;    407 sec;
[2024-03-13 09:26:17,523 INFO] Step 8200/ 8200; acc: 94.0; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2371; bsz:  567/ 494/47; 11718/10199 tok/s;    410 sec;
[2024-03-13 09:26:21,004 INFO] valid stats calculation
                           took: 3.4804935455322266 s.
[2024-03-13 09:26:21,004 INFO] Train perplexity: 3.36109
[2024-03-13 09:26:21,004 INFO] Train accuracy: 76.0753
[2024-03-13 09:26:21,004 INFO] Sentences processed: 233709
[2024-03-13 09:26:21,004 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:26:21,004 INFO] Validation perplexity: 8117.5
[2024-03-13 09:26:21,004 INFO] Validation accuracy: 30.004
[2024-03-13 09:26:21,006 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_02_step_8200.pt
