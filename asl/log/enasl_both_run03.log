[2024-03-08 17:31:29,623 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-08 17:31:29,623 INFO] Parsed 2 corpora from -data.
[2024-03-08 17:31:29,623 INFO] Get special vocabs from Transforms: {'src': [], 'tgt': []}.
[2024-03-08 17:31:29,628 INFO] Reading encoder embeddings from en_w2v.txt
[2024-03-08 17:32:04,830 INFO] 	Found 3000000 total vectors in file.
[2024-03-08 17:32:04,830 INFO] Reading decoder embeddings from asl_w2v.txt
[2024-03-08 17:32:40,141 INFO] 	Found 3002605 total vectors in file
[2024-03-08 17:32:40,141 INFO] After filtering to vectors in vocab:
[2024-03-08 17:32:40,142 INFO] 	* enc: 2268 match, 116 missing, (95.13%)
[2024-03-08 17:32:40,143 INFO] 	* dec: 1833 match, 583 missing, (75.87%)
[2024-03-08 17:32:40,143 INFO] 
Saving encoder embeddings as:
	* enc: tg-both.enc_embeddings.pt
[2024-03-08 17:32:40,625 INFO] 
Saving decoder embeddings as:
	* dec: tg-both.dec_embeddings.pt
[2024-03-08 17:32:41,058 INFO] The first 10 tokens of the vocabs are:['<unk>', '<blank>', '<s>', '</s>', '.', 'the', ',', 'i', 'to', 'it']
[2024-03-08 17:32:41,058 INFO] The decoder start token is: <s>
[2024-03-08 17:32:41,058 INFO] Building model...
[2024-03-08 17:32:41,173 INFO] Switching model to float32 for amp/apex_amp
[2024-03-08 17:32:41,173 INFO] Non quantized layer compute is fp32
[2024-03-08 17:32:42,964 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(2384, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(2416, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=2416, bias=True)
)
[2024-03-08 17:32:42,964 INFO] encoder: 4323200
[2024-03-08 17:32:42,965 INFO] decoder: 7293216
[2024-03-08 17:32:42,965 INFO] * number of parameters: 11616416
[2024-03-08 17:32:42,965 INFO] Trainable parameters = {'torch.float32': 11616416, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-08 17:32:42,965 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-08 17:32:42,965 INFO]  * src vocab size = 2384
[2024-03-08 17:32:42,965 INFO]  * tgt vocab size = 2416
[2024-03-08 17:32:42,966 INFO] Starting training on GPU: [0]
[2024-03-08 17:32:42,966 INFO] Start training loop and validate every 200 steps...
[2024-03-08 17:32:42,966 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-08 17:32:47,473 INFO] Step 50/10000; acc: 8.6; ppl: 36185.6; xent: 10.5; lr: 1.00000; sents:    2366; bsz:  569/ 497/47; 6316/5516 tok/s;      5 sec;
[2024-03-08 17:32:49,900 INFO] Step 100/10000; acc: 9.4; ppl: 6016.5; xent: 8.7; lr: 1.00000; sents:    2369; bsz:  590/ 512/47; 12150/10543 tok/s;      7 sec;
[2024-03-08 17:32:52,306 INFO] Step 150/10000; acc: 11.4; ppl: 1560.9; xent: 7.4; lr: 1.00000; sents:    2267; bsz:  560/ 485/45; 11640/10077 tok/s;      9 sec;
[2024-03-08 17:32:54,579 INFO] Step 200/10000; acc: 11.2; ppl: 541.4; xent: 6.3; lr: 1.00000; sents:    2244; bsz:  546/ 472/45; 12012/10393 tok/s;     12 sec;
[2024-03-08 17:32:56,918 INFO] valid stats calculation
                           took: 2.33918833732605 s.
[2024-03-08 17:32:56,919 INFO] Train perplexity: 3807.31
[2024-03-08 17:32:56,919 INFO] Train accuracy: 10.1251
[2024-03-08 17:32:56,919 INFO] Sentences processed: 9246
[2024-03-08 17:32:56,919 INFO] Average bsz:  566/ 492/46
[2024-03-08 17:32:56,919 INFO] Validation perplexity: 10149.4
[2024-03-08 17:32:56,919 INFO] Validation accuracy: 12.1139
[2024-03-08 17:32:56,919 INFO] Saving checkpoint tg-both/tg_03_step_200.pt
[2024-03-08 17:32:59,340 INFO] Step 250/10000; acc: 12.2; ppl: 464.4; xent: 6.1; lr: 1.00000; sents:    2488; bsz:  603/ 526/50; 6338/5523 tok/s;     16 sec;
[2024-03-08 17:33:01,848 INFO] Step 300/10000; acc: 12.3; ppl: 367.8; xent: 5.9; lr: 1.00000; sents:    2251; bsz:  549/ 475/45; 10946/9465 tok/s;     19 sec;
[2024-03-08 17:33:04,309 INFO] Step 350/10000; acc: 13.3; ppl: 304.1; xent: 5.7; lr: 1.00000; sents:    2378; bsz:  568/ 494/48; 11531/10043 tok/s;     21 sec;
[2024-03-08 17:33:06,896 INFO] Step 400/10000; acc: 15.6; ppl: 246.7; xent: 5.5; lr: 1.00000; sents:    2280; bsz:  581/ 502/46; 11221/9709 tok/s;     24 sec;
[2024-03-08 17:33:09,074 INFO] valid stats calculation
                           took: 2.176812171936035 s.
[2024-03-08 17:33:09,074 INFO] Train perplexity: 1122.67
[2024-03-08 17:33:09,074 INFO] Train accuracy: 11.744
[2024-03-08 17:33:09,074 INFO] Sentences processed: 18643
[2024-03-08 17:33:09,074 INFO] Average bsz:  571/ 495/47
[2024-03-08 17:33:09,074 INFO] Validation perplexity: 373.09
[2024-03-08 17:33:09,074 INFO] Validation accuracy: 11.4721
[2024-03-08 17:33:09,075 INFO] Saving checkpoint tg-both/tg_03_step_400.pt
[2024-03-08 17:33:11,603 INFO] Step 450/10000; acc: 16.6; ppl: 203.5; xent: 5.3; lr: 1.00000; sents:    2381; bsz:  568/ 495/48; 6034/5255 tok/s;     29 sec;
[2024-03-08 17:33:14,026 INFO] Step 500/10000; acc: 17.5; ppl: 180.0; xent: 5.2; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 11955/10324 tok/s;     31 sec;
[2024-03-08 17:33:16,756 INFO] Step 550/10000; acc: 18.8; ppl: 158.0; xent: 5.1; lr: 1.00000; sents:    2372; bsz:  564/ 491/47; 10328/9000 tok/s;     34 sec;
[2024-03-08 17:33:19,170 INFO] Step 600/10000; acc: 19.5; ppl: 144.4; xent: 5.0; lr: 1.00000; sents:    2252; bsz:  551/ 477/45; 11415/9871 tok/s;     36 sec;
[2024-03-08 17:33:21,230 INFO] valid stats calculation
                           took: 2.0594334602355957 s.
[2024-03-08 17:33:21,231 INFO] Train perplexity: 601.203
[2024-03-08 17:33:21,231 INFO] Train accuracy: 13.8393
[2024-03-08 17:33:21,231 INFO] Sentences processed: 28023
[2024-03-08 17:33:21,231 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:33:21,231 INFO] Validation perplexity: 343.056
[2024-03-08 17:33:21,231 INFO] Validation accuracy: 14.8014
[2024-03-08 17:33:21,231 INFO] Saving checkpoint tg-both/tg_03_step_600.pt
[2024-03-08 17:33:23,645 INFO] Step 650/10000; acc: 21.2; ppl: 127.1; xent: 4.8; lr: 1.00000; sents:    2271; bsz:  567/ 491/45; 6335/5483 tok/s;     41 sec;
[2024-03-08 17:33:26,028 INFO] Step 700/10000; acc: 21.1; ppl: 119.1; xent: 4.8; lr: 1.00000; sents:    2364; bsz:  587/ 513/47; 12321/10766 tok/s;     43 sec;
[2024-03-08 17:33:28,439 INFO] Step 750/10000; acc: 22.4; ppl: 107.4; xent: 4.7; lr: 1.00000; sents:    2367; bsz:  567/ 499/47; 11767/10342 tok/s;     45 sec;
[2024-03-08 17:33:30,789 INFO] Step 800/10000; acc: 23.8; ppl:  92.9; xent: 4.5; lr: 1.00000; sents:    2365; bsz:  561/ 487/47; 11931/10354 tok/s;     48 sec;
[2024-03-08 17:33:32,829 INFO] valid stats calculation
                           took: 2.0398495197296143 s.
[2024-03-08 17:33:32,830 INFO] Train perplexity: 393.216
[2024-03-08 17:33:32,830 INFO] Train accuracy: 15.9205
[2024-03-08 17:33:32,830 INFO] Sentences processed: 37390
[2024-03-08 17:33:32,830 INFO] Average bsz:  569/ 495/47
[2024-03-08 17:33:32,830 INFO] Validation perplexity: 274.189
[2024-03-08 17:33:32,830 INFO] Validation accuracy: 18.933
[2024-03-08 17:33:32,830 INFO] Saving checkpoint tg-both/tg_03_step_800.pt
[2024-03-08 17:33:35,452 INFO] Step 850/10000; acc: 23.7; ppl:  89.3; xent: 4.5; lr: 1.00000; sents:    2269; bsz:  569/ 491/45; 6099/5270 tok/s;     52 sec;
[2024-03-08 17:33:37,881 INFO] Step 900/10000; acc: 24.7; ppl:  76.3; xent: 4.3; lr: 1.00000; sents:    2371; bsz:  563/ 491/47; 11599/10102 tok/s;     55 sec;
[2024-03-08 17:33:40,397 INFO] Step 950/10000; acc: 25.8; ppl:  71.5; xent: 4.3; lr: 1.00000; sents:    2376; bsz:  581/ 506/48; 11555/10054 tok/s;     57 sec;
[2024-03-08 17:33:42,824 INFO] Step 1000/10000; acc: 27.2; ppl:  59.4; xent: 4.1; lr: 1.00000; sents:    2284; bsz:  563/ 487/46; 11609/10033 tok/s;     60 sec;
[2024-03-08 17:33:45,071 INFO] valid stats calculation
                           took: 2.2464826107025146 s.
[2024-03-08 17:33:45,072 INFO] Train perplexity: 281.204
[2024-03-08 17:33:45,072 INFO] Train accuracy: 17.8039
[2024-03-08 17:33:45,072 INFO] Sentences processed: 46690
[2024-03-08 17:33:45,072 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:33:45,072 INFO] Validation perplexity: 241.32
[2024-03-08 17:33:45,072 INFO] Validation accuracy: 22.5431
[2024-03-08 17:33:45,072 INFO] Saving checkpoint tg-both/tg_03_step_1000.pt
[2024-03-08 17:33:47,644 INFO] Step 1050/10000; acc: 28.4; ppl:  53.7; xent: 4.0; lr: 1.00000; sents:    2376; bsz:  564/ 493/48; 5855/5115 tok/s;     65 sec;
[2024-03-08 17:33:50,292 INFO] Step 1100/10000; acc: 28.6; ppl:  50.0; xent: 3.9; lr: 1.00000; sents:    2375; bsz:  565/ 490/48; 10677/9264 tok/s;     67 sec;
[2024-03-08 17:33:53,980 INFO] Step 1150/10000; acc: 29.4; ppl:  46.5; xent: 3.8; lr: 1.00000; sents:    2371; bsz:  579/ 498/47; 7844/6752 tok/s;     71 sec;
[2024-03-08 17:33:57,700 INFO] Step 1200/10000; acc: 31.1; ppl:  39.6; xent: 3.7; lr: 1.00000; sents:    2266; bsz:  559/ 484/45; 7514/6513 tok/s;     75 sec;
[2024-03-08 17:34:00,985 INFO] valid stats calculation
                           took: 3.284377336502075 s.
[2024-03-08 17:34:00,986 INFO] Train perplexity: 209.143
[2024-03-08 17:34:00,986 INFO] Train accuracy: 19.7231
[2024-03-08 17:34:00,986 INFO] Sentences processed: 56078
[2024-03-08 17:34:00,986 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:34:00,986 INFO] Validation perplexity: 198.451
[2024-03-08 17:34:00,986 INFO] Validation accuracy: 23.3454
[2024-03-08 17:34:00,987 INFO] Saving checkpoint tg-both/tg_03_step_1200.pt
[2024-03-08 17:34:04,138 INFO] Step 1250/10000; acc: 31.7; ppl:  36.4; xent: 3.6; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 4370/3789 tok/s;     81 sec;
[2024-03-08 17:34:06,737 INFO] Step 1300/10000; acc: 33.4; ppl:  32.2; xent: 3.5; lr: 1.00000; sents:    2362; bsz:  563/ 489/47; 10834/9412 tok/s;     84 sec;
[2024-03-08 17:34:09,749 INFO] Step 1350/10000; acc: 34.7; ppl:  29.1; xent: 3.4; lr: 1.00000; sents:    2369; bsz:  586/ 507/47; 9734/8417 tok/s;     87 sec;
[2024-03-08 17:34:12,831 INFO] Step 1400/10000; acc: 35.9; ppl:  25.8; xent: 3.2; lr: 1.00000; sents:    2367; bsz:  579/ 500/47; 9401/8111 tok/s;     90 sec;
[2024-03-08 17:34:15,304 INFO] valid stats calculation
                           took: 2.4722931385040283 s.
[2024-03-08 17:34:15,304 INFO] Train perplexity: 158.75
[2024-03-08 17:34:15,304 INFO] Train accuracy: 21.7599
[2024-03-08 17:34:15,304 INFO] Sentences processed: 65444
[2024-03-08 17:34:15,304 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:34:15,304 INFO] Validation perplexity: 225.505
[2024-03-08 17:34:15,304 INFO] Validation accuracy: 25.0301
[2024-03-08 17:34:15,305 INFO] Saving checkpoint tg-both/tg_03_step_1400.pt
[2024-03-08 17:34:17,922 INFO] Step 1450/10000; acc: 38.7; ppl:  20.6; xent: 3.0; lr: 1.00000; sents:    2372; bsz:  564/ 489/47; 5541/4805 tok/s;     95 sec;
[2024-03-08 17:34:20,821 INFO] Step 1500/10000; acc: 39.1; ppl:  19.4; xent: 3.0; lr: 1.00000; sents:    2271; bsz:  562/ 485/45; 9693/8366 tok/s;     98 sec;
[2024-03-08 17:34:23,221 INFO] Step 1550/10000; acc: 41.7; ppl:  16.8; xent: 2.8; lr: 1.00000; sents:    2375; bsz:  583/ 505/48; 12145/10512 tok/s;    100 sec;
[2024-03-08 17:34:25,982 INFO] Step 1600/10000; acc: 44.2; ppl:  13.5; xent: 2.6; lr: 1.00000; sents:    2280; bsz:  543/ 474/46; 9836/8595 tok/s;    103 sec;
[2024-03-08 17:34:28,649 INFO] valid stats calculation
                           took: 2.6670634746551514 s.
[2024-03-08 17:34:28,650 INFO] Train perplexity: 120.736
[2024-03-08 17:34:28,650 INFO] Train accuracy: 24.1282
[2024-03-08 17:34:28,650 INFO] Sentences processed: 74742
[2024-03-08 17:34:28,650 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:34:28,650 INFO] Validation perplexity: 439.797
[2024-03-08 17:34:28,650 INFO] Validation accuracy: 24.99
[2024-03-08 17:34:28,651 INFO] Saving checkpoint tg-both/tg_03_step_1600.pt
[2024-03-08 17:34:32,095 INFO] Step 1650/10000; acc: 45.0; ppl:  12.7; xent: 2.5; lr: 1.00000; sents:    2376; bsz:  580/ 501/48; 4742/4097 tok/s;    109 sec;
[2024-03-08 17:34:34,587 INFO] Step 1700/10000; acc: 47.1; ppl:  10.8; xent: 2.4; lr: 1.00000; sents:    2280; bsz:  563/ 487/46; 11301/9770 tok/s;    112 sec;
[2024-03-08 17:34:37,369 INFO] Step 1750/10000; acc: 48.4; ppl:  10.1; xent: 2.3; lr: 1.00000; sents:    2368; bsz:  589/ 512/47; 10583/9203 tok/s;    114 sec;
[2024-03-08 17:34:40,026 INFO] Step 1800/10000; acc: 51.1; ppl:   8.5; xent: 2.1; lr: 1.00000; sents:    2366; bsz:  569/ 497/47; 10703/9347 tok/s;    117 sec;
[2024-03-08 17:34:42,284 INFO] valid stats calculation
                           took: 2.2576072216033936 s.
[2024-03-08 17:34:42,285 INFO] Train perplexity: 91.7206
[2024-03-08 17:34:42,285 INFO] Train accuracy: 26.7959
[2024-03-08 17:34:42,285 INFO] Sentences processed: 84132
[2024-03-08 17:34:42,285 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:34:42,285 INFO] Validation perplexity: 442.008
[2024-03-08 17:34:42,285 INFO] Validation accuracy: 23.5459
[2024-03-08 17:34:42,286 INFO] Saving checkpoint tg-both/tg_03_step_1800.pt
[2024-03-08 17:34:44,749 INFO] Step 1850/10000; acc: 52.9; ppl:   7.7; xent: 2.0; lr: 1.00000; sents:    2369; bsz:  587/ 508/47; 6213/5375 tok/s;    122 sec;
[2024-03-08 17:34:47,112 INFO] Step 1900/10000; acc: 55.5; ppl:   6.5; xent: 1.9; lr: 1.00000; sents:    2242; bsz:  548/ 475/45; 11594/10054 tok/s;    124 sec;
[2024-03-08 17:34:49,496 INFO] Step 1950/10000; acc: 57.9; ppl:   5.9; xent: 1.8; lr: 1.00000; sents:    2365; bsz:  564/ 490/47; 11833/10289 tok/s;    127 sec;
[2024-03-08 17:34:51,951 INFO] Step 2000/10000; acc: 60.1; ppl:   5.2; xent: 1.6; lr: 1.00000; sents:    2367; bsz:  561/ 488/47; 11425/9937 tok/s;    129 sec;
[2024-03-08 17:34:53,982 INFO] valid stats calculation
                           took: 2.030561685562134 s.
[2024-03-08 17:34:53,982 INFO] Train perplexity: 70.2639
[2024-03-08 17:34:53,982 INFO] Train accuracy: 29.7522
[2024-03-08 17:34:53,982 INFO] Sentences processed: 93475
[2024-03-08 17:34:53,982 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:34:53,982 INFO] Validation perplexity: 618.215
[2024-03-08 17:34:53,982 INFO] Validation accuracy: 24.8295
[2024-03-08 17:34:53,983 INFO] Saving checkpoint tg-both/tg_03_step_2000.pt
[2024-03-08 17:34:56,559 INFO] Step 2050/10000; acc: 61.1; ppl:   4.8; xent: 1.6; lr: 1.00000; sents:    2268; bsz:  558/ 482/45; 6052/5231 tok/s;    134 sec;
[2024-03-08 17:34:59,059 INFO] Step 2100/10000; acc: 63.0; ppl:   4.4; xent: 1.5; lr: 1.00000; sents:    2379; bsz:  587/ 510/48; 11735/10205 tok/s;    136 sec;
[2024-03-08 17:35:01,422 INFO] Step 2150/10000; acc: 65.8; ppl:   3.9; xent: 1.3; lr: 1.00000; sents:    2383; bsz:  567/ 495/48; 12004/10468 tok/s;    138 sec;
[2024-03-08 17:35:03,844 INFO] Step 2200/10000; acc: 66.6; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    2267; bsz:  555/ 481/45; 11457/9924 tok/s;    141 sec;
[2024-03-08 17:35:05,989 INFO] valid stats calculation
                           took: 2.1443705558776855 s.
[2024-03-08 17:35:05,990 INFO] Train perplexity: 54.3922
[2024-03-08 17:35:05,990 INFO] Train accuracy: 32.8654
[2024-03-08 17:35:05,990 INFO] Sentences processed: 102772
[2024-03-08 17:35:05,990 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:35:05,990 INFO] Validation perplexity: 1094.53
[2024-03-08 17:35:05,990 INFO] Validation accuracy: 25.4312
[2024-03-08 17:35:05,990 INFO] Saving checkpoint tg-both/tg_03_step_2200.pt
[2024-03-08 17:35:08,509 INFO] Step 2250/10000; acc: 68.4; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 6202/5358 tok/s;    146 sec;
[2024-03-08 17:35:11,007 INFO] Step 2300/10000; acc: 69.1; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    2372; bsz:  586/ 513/47; 11734/10273 tok/s;    148 sec;
[2024-03-08 17:35:13,514 INFO] Step 2350/10000; acc: 71.7; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    2366; bsz:  567/ 497/47; 11310/9916 tok/s;    151 sec;
[2024-03-08 17:35:16,168 INFO] Step 2400/10000; acc: 71.4; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    2271; bsz:  568/ 493/45; 10709/9296 tok/s;    153 sec;
[2024-03-08 17:35:18,299 INFO] valid stats calculation
                           took: 2.1303584575653076 s.
[2024-03-08 17:35:18,299 INFO] Train perplexity: 42.7519
[2024-03-08 17:35:18,299 INFO] Train accuracy: 36.0146
[2024-03-08 17:35:18,300 INFO] Sentences processed: 112156
[2024-03-08 17:35:18,300 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:35:18,300 INFO] Validation perplexity: 1432.83
[2024-03-08 17:35:18,300 INFO] Validation accuracy: 23.9069
[2024-03-08 17:35:18,300 INFO] Saving checkpoint tg-both/tg_03_step_2400.pt
[2024-03-08 17:35:20,770 INFO] Step 2450/10000; acc: 74.4; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    2260; bsz:  555/ 480/45; 6035/5221 tok/s;    158 sec;
[2024-03-08 17:35:23,175 INFO] Step 2500/10000; acc: 75.5; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2367; bsz:  559/ 485/47; 11633/10086 tok/s;    160 sec;
[2024-03-08 17:35:25,560 INFO] Step 2550/10000; acc: 75.7; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 12013/10399 tok/s;    163 sec;
[2024-03-08 17:35:27,975 INFO] Step 2600/10000; acc: 77.5; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2276; bsz:  563/ 487/46; 11660/10079 tok/s;    165 sec;
[2024-03-08 17:35:30,312 INFO] valid stats calculation
                           took: 2.3362138271331787 s.
[2024-03-08 17:35:30,312 INFO] Train perplexity: 34.4234
[2024-03-08 17:35:30,312 INFO] Train accuracy: 39.0315
[2024-03-08 17:35:30,312 INFO] Sentences processed: 121424
[2024-03-08 17:35:30,312 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:35:30,312 INFO] Validation perplexity: 2001.98
[2024-03-08 17:35:30,312 INFO] Validation accuracy: 25.712
[2024-03-08 17:35:30,313 INFO] Saving checkpoint tg-both/tg_03_step_2600.pt
[2024-03-08 17:35:32,914 INFO] Step 2650/10000; acc: 78.0; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2372; bsz:  566/ 495/47; 5727/5012 tok/s;    170 sec;
[2024-03-08 17:35:35,485 INFO] Step 2700/10000; acc: 78.8; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2375; bsz:  580/ 505/48; 11288/9825 tok/s;    173 sec;
[2024-03-08 17:35:37,971 INFO] Step 2750/10000; acc: 79.3; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2381; bsz:  579/ 499/48; 11648/10041 tok/s;    175 sec;
[2024-03-08 17:35:40,459 INFO] Step 2800/10000; acc: 80.8; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2276; bsz:  562/ 485/46; 11287/9743 tok/s;    177 sec;
[2024-03-08 17:35:42,557 INFO] valid stats calculation
                           took: 2.097360849380493 s.
[2024-03-08 17:35:42,558 INFO] Train perplexity: 28.1881
[2024-03-08 17:35:42,558 INFO] Train accuracy: 41.9143
[2024-03-08 17:35:42,558 INFO] Sentences processed: 130828
[2024-03-08 17:35:42,558 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:35:42,558 INFO] Validation perplexity: 1933.2
[2024-03-08 17:35:42,558 INFO] Validation accuracy: 25.8323
[2024-03-08 17:35:42,558 INFO] Saving checkpoint tg-both/tg_03_step_2800.pt
[2024-03-08 17:35:45,210 INFO] Step 2850/10000; acc: 81.2; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2375; bsz:  566/ 491/48; 5956/5166 tok/s;    182 sec;
[2024-03-08 17:35:47,800 INFO] Step 2900/10000; acc: 81.2; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 11315/9807 tok/s;    185 sec;
[2024-03-08 17:35:50,229 INFO] Step 2950/10000; acc: 83.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2268; bsz:  542/ 471/45; 11162/9700 tok/s;    187 sec;
[2024-03-08 17:35:52,652 INFO] Step 3000/10000; acc: 82.4; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2366; bsz:  585/ 507/47; 12068/10454 tok/s;    190 sec;
[2024-03-08 17:35:54,877 INFO] valid stats calculation
                           took: 2.224334239959717 s.
[2024-03-08 17:35:54,878 INFO] Train perplexity: 23.5468
[2024-03-08 17:35:54,878 INFO] Train accuracy: 44.5849
[2024-03-08 17:35:54,878 INFO] Sentences processed: 140208
[2024-03-08 17:35:54,878 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:35:54,878 INFO] Validation perplexity: 2521.85
[2024-03-08 17:35:54,878 INFO] Validation accuracy: 25.5114
[2024-03-08 17:35:54,878 INFO] Saving checkpoint tg-both/tg_03_step_3000.pt
[2024-03-08 17:35:57,310 INFO] Step 3050/10000; acc: 83.4; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2362; bsz:  562/ 488/47; 6037/5241 tok/s;    194 sec;
[2024-03-08 17:35:59,961 INFO] Step 3100/10000; acc: 84.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2369; bsz:  580/ 500/47; 10943/9430 tok/s;    197 sec;
[2024-03-08 17:36:02,599 INFO] Step 3150/10000; acc: 84.2; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    2267; bsz:  561/ 484/45; 10628/9171 tok/s;    200 sec;
[2024-03-08 17:36:05,074 INFO] Step 3200/10000; acc: 84.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2270; bsz:  559/ 485/45; 11299/9802 tok/s;    202 sec;
[2024-03-08 17:36:07,183 INFO] valid stats calculation
                           took: 2.1087677478790283 s.
[2024-03-08 17:36:07,183 INFO] Train perplexity: 20.0507
[2024-03-08 17:36:07,183 INFO] Train accuracy: 47.029
[2024-03-08 17:36:07,183 INFO] Sentences processed: 149476
[2024-03-08 17:36:07,183 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:36:07,183 INFO] Validation perplexity: 4858.92
[2024-03-08 17:36:07,184 INFO] Validation accuracy: 26.434
[2024-03-08 17:36:07,184 INFO] Saving checkpoint tg-both/tg_03_step_3200.pt
[2024-03-08 17:36:09,654 INFO] Step 3250/10000; acc: 85.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2371; bsz:  583/ 504/47; 6360/5504 tok/s;    207 sec;
[2024-03-08 17:36:12,050 INFO] Step 3300/10000; acc: 85.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2375; bsz:  565/ 492/48; 11796/10274 tok/s;    209 sec;
[2024-03-08 17:36:14,447 INFO] Step 3350/10000; acc: 85.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2382; bsz:  589/ 510/48; 12285/10648 tok/s;    211 sec;
[2024-03-08 17:36:16,987 INFO] Step 3400/10000; acc: 86.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2275; bsz:  563/ 488/46; 11077/9615 tok/s;    214 sec;
[2024-03-08 17:36:19,164 INFO] valid stats calculation
                           took: 2.1765339374542236 s.
[2024-03-08 17:36:19,164 INFO] Train perplexity: 17.2952
[2024-03-08 17:36:19,164 INFO] Train accuracy: 49.3226
[2024-03-08 17:36:19,164 INFO] Sentences processed: 158879
[2024-03-08 17:36:19,164 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:36:19,164 INFO] Validation perplexity: 3933.72
[2024-03-08 17:36:19,164 INFO] Validation accuracy: 26.2736
[2024-03-08 17:36:19,165 INFO] Saving checkpoint tg-both/tg_03_step_3400.pt
[2024-03-08 17:36:21,882 INFO] Step 3450/10000; acc: 86.8; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2381; bsz:  572/ 499/48; 5842/5099 tok/s;    219 sec;
[2024-03-08 17:36:24,453 INFO] Step 3500/10000; acc: 86.8; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2368; bsz:  585/ 506/47; 11383/9849 tok/s;    221 sec;
[2024-03-08 17:36:26,768 INFO] Step 3550/10000; acc: 87.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2246; bsz:  529/ 460/45; 11433/9944 tok/s;    224 sec;
[2024-03-08 17:36:29,201 INFO] Step 3600/10000; acc: 87.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2368; bsz:  587/ 509/47; 12071/10455 tok/s;    226 sec;
[2024-03-08 17:36:31,291 INFO] valid stats calculation
                           took: 2.0894927978515625 s.
[2024-03-08 17:36:31,291 INFO] Train perplexity: 15.1421
[2024-03-08 17:36:31,291 INFO] Train accuracy: 51.4173
[2024-03-08 17:36:31,291 INFO] Sentences processed: 168242
[2024-03-08 17:36:31,291 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:36:31,291 INFO] Validation perplexity: 4931.38
[2024-03-08 17:36:31,291 INFO] Validation accuracy: 26.1532
[2024-03-08 17:36:31,292 INFO] Saving checkpoint tg-both/tg_03_step_3600.pt
[2024-03-08 17:36:33,665 INFO] Step 3650/10000; acc: 88.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2363; bsz:  562/ 488/47; 6290/5468 tok/s;    231 sec;
[2024-03-08 17:36:36,198 INFO] Step 3700/10000; acc: 87.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2365; bsz:  577/ 500/47; 11399/9865 tok/s;    233 sec;
[2024-03-08 17:36:39,310 INFO] Step 3750/10000; acc: 88.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2258; bsz:  555/ 482/45; 8924/7740 tok/s;    236 sec;
[2024-03-08 17:36:42,023 INFO] Step 3800/10000; acc: 88.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2377; bsz:  587/ 513/48; 10819/9461 tok/s;    239 sec;
[2024-03-08 17:36:44,262 INFO] valid stats calculation
                           took: 2.238085985183716 s.
[2024-03-08 17:36:44,262 INFO] Train perplexity: 13.4141
[2024-03-08 17:36:44,262 INFO] Train accuracy: 53.3537
[2024-03-08 17:36:44,262 INFO] Sentences processed: 177605
[2024-03-08 17:36:44,262 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:36:44,262 INFO] Validation perplexity: 4791.63
[2024-03-08 17:36:44,262 INFO] Validation accuracy: 25.4312
[2024-03-08 17:36:44,263 INFO] Saving checkpoint tg-both/tg_03_step_3800.pt
[2024-03-08 17:36:46,574 INFO] Step 3850/10000; acc: 88.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2379; bsz:  565/ 493/48; 6210/5422 tok/s;    244 sec;
[2024-03-08 17:36:48,836 INFO] Step 3900/10000; acc: 88.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2274; bsz:  555/ 478/45; 12279/10578 tok/s;    246 sec;
[2024-03-08 17:36:51,116 INFO] Step 3950/10000; acc: 88.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2376; bsz:  564/ 492/48; 12363/10783 tok/s;    248 sec;
[2024-03-08 17:36:53,365 INFO] Step 4000/10000; acc: 88.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  585/ 512/48; 13009/11377 tok/s;    250 sec;
[2024-03-08 17:36:55,309 INFO] valid stats calculation
                           took: 1.9431960582733154 s.
[2024-03-08 17:36:55,309 INFO] Train perplexity: 12.0218
[2024-03-08 17:36:55,309 INFO] Train accuracy: 55.1055
[2024-03-08 17:36:55,309 INFO] Sentences processed: 187009
[2024-03-08 17:36:55,309 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:36:55,309 INFO] Validation perplexity: 5966.94
[2024-03-08 17:36:55,309 INFO] Validation accuracy: 25.712
[2024-03-08 17:36:55,310 INFO] Saving checkpoint tg-both/tg_03_step_4000.pt
[2024-03-08 17:36:57,647 INFO] Step 4050/10000; acc: 88.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2275; bsz:  569/ 494/46; 6650/5767 tok/s;    255 sec;
[2024-03-08 17:36:59,849 INFO] Step 4100/10000; acc: 89.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2367; bsz:  563/ 489/47; 12779/11104 tok/s;    257 sec;
[2024-03-08 17:37:02,080 INFO] Step 4150/10000; acc: 88.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2263; bsz:  557/ 483/45; 12495/10821 tok/s;    259 sec;
[2024-03-08 17:37:04,241 INFO] Step 4200/10000; acc: 89.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2364; bsz:  572/ 494/47; 13231/11426 tok/s;    261 sec;
[2024-03-08 17:37:06,199 INFO] valid stats calculation
                           took: 1.9580814838409424 s.
[2024-03-08 17:37:06,200 INFO] Train perplexity: 10.885
[2024-03-08 17:37:06,200 INFO] Train accuracy: 56.7097
[2024-03-08 17:37:06,200 INFO] Sentences processed: 196278
[2024-03-08 17:37:06,200 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:37:06,200 INFO] Validation perplexity: 8251.1
[2024-03-08 17:37:06,200 INFO] Validation accuracy: 25.1103
[2024-03-08 17:37:06,200 INFO] Saving checkpoint tg-both/tg_03_step_4200.pt
[2024-03-08 17:37:08,496 INFO] Step 4250/10000; acc: 89.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2367; bsz:  578/ 503/47; 6793/5913 tok/s;    266 sec;
[2024-03-08 17:37:10,719 INFO] Step 4300/10000; acc: 89.4; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2268; bsz:  546/ 473/45; 12284/10645 tok/s;    268 sec;
[2024-03-08 17:37:13,006 INFO] Step 4350/10000; acc: 89.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2373; bsz:  581/ 507/47; 12702/11076 tok/s;    270 sec;
[2024-03-08 17:37:15,234 INFO] Step 4400/10000; acc: 89.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2372; bsz:  565/ 491/47; 12691/11021 tok/s;    272 sec;
[2024-03-08 17:37:17,157 INFO] valid stats calculation
                           took: 1.9229495525360107 s.
[2024-03-08 17:37:17,158 INFO] Train perplexity: 9.92951
[2024-03-08 17:37:17,158 INFO] Train accuracy: 58.1969
[2024-03-08 17:37:17,158 INFO] Sentences processed: 205658
[2024-03-08 17:37:17,158 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:37:17,158 INFO] Validation perplexity: 7737.89
[2024-03-08 17:37:17,158 INFO] Validation accuracy: 26.434
[2024-03-08 17:37:17,158 INFO] Saving checkpoint tg-both/tg_03_step_4400.pt
[2024-03-08 17:37:19,465 INFO] Step 4450/10000; acc: 89.8; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  580/ 500/48; 6859/5905 tok/s;    276 sec;
[2024-03-08 17:37:21,711 INFO] Step 4500/10000; acc: 89.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2281; bsz:  559/ 484/46; 12435/10771 tok/s;    279 sec;
[2024-03-08 17:37:23,976 INFO] Step 4550/10000; acc: 89.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2376; bsz:  589/ 509/48; 12997/11241 tok/s;    281 sec;
[2024-03-08 17:37:26,215 INFO] Step 4600/10000; acc: 90.1; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2277; bsz:  544/ 471/46; 12149/10532 tok/s;    283 sec;
[2024-03-08 17:37:28,203 INFO] valid stats calculation
                           took: 1.9883606433868408 s.
[2024-03-08 17:37:28,204 INFO] Train perplexity: 9.13485
[2024-03-08 17:37:28,204 INFO] Train accuracy: 59.5554
[2024-03-08 17:37:28,204 INFO] Sentences processed: 214967
[2024-03-08 17:37:28,204 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:37:28,204 INFO] Validation perplexity: 7325.92
[2024-03-08 17:37:28,204 INFO] Validation accuracy: 27.0758
[2024-03-08 17:37:28,204 INFO] Saving checkpoint tg-both/tg_03_step_4600.pt
[2024-03-08 17:37:30,516 INFO] Step 4650/10000; acc: 89.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 6808/5904 tok/s;    288 sec;
[2024-03-08 17:37:32,752 INFO] Step 4700/10000; acc: 90.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2260; bsz:  558/ 482/45; 12470/10768 tok/s;    290 sec;
[2024-03-08 17:37:34,927 INFO] Step 4750/10000; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2369; bsz:  581/ 501/47; 13349/11513 tok/s;    292 sec;
[2024-03-08 17:37:37,077 INFO] Step 4800/10000; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2365; bsz:  564/ 489/47; 13111/11378 tok/s;    294 sec;
[2024-03-08 17:37:38,997 INFO] valid stats calculation
                           took: 1.9184908866882324 s.
[2024-03-08 17:37:38,997 INFO] Train perplexity: 8.45039
[2024-03-08 17:37:38,997 INFO] Train accuracy: 60.8344
[2024-03-08 17:37:38,997 INFO] Sentences processed: 224332
[2024-03-08 17:37:38,997 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:37:38,997 INFO] Validation perplexity: 7703.11
[2024-03-08 17:37:38,997 INFO] Validation accuracy: 26.073
[2024-03-08 17:37:38,998 INFO] Saving checkpoint tg-both/tg_03_step_4800.pt
[2024-03-08 17:37:41,260 INFO] Step 4850/10000; acc: 89.5; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2367; bsz:  586/ 507/47; 7001/6061 tok/s;    298 sec;
[2024-03-08 17:37:43,451 INFO] Step 4900/10000; acc: 90.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2267; bsz:  539/ 472/45; 12294/10763 tok/s;    300 sec;
[2024-03-08 17:37:45,694 INFO] Step 4950/10000; acc: 89.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2372; bsz:  582/ 503/47; 12973/11226 tok/s;    303 sec;
[2024-03-08 17:37:47,927 INFO] Step 5000/10000; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2371; bsz:  567/ 494/47; 12702/11055 tok/s;    305 sec;
[2024-03-08 17:37:49,852 INFO] valid stats calculation
                           took: 1.9242744445800781 s.
[2024-03-08 17:37:49,852 INFO] Train perplexity: 7.86808
[2024-03-08 17:37:49,853 INFO] Train accuracy: 61.9982
[2024-03-08 17:37:49,853 INFO] Sentences processed: 233709
[2024-03-08 17:37:49,853 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:37:49,853 INFO] Validation perplexity: 8780.49
[2024-03-08 17:37:49,853 INFO] Validation accuracy: 26.8753
[2024-03-08 17:37:49,853 INFO] Saving checkpoint tg-both/tg_03_step_5000.pt
[2024-03-08 17:37:52,188 INFO] Step 5050/10000; acc: 89.8; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2270; bsz:  560/ 486/45; 6575/5703 tok/s;    309 sec;
[2024-03-08 17:37:54,425 INFO] Step 5100/10000; acc: 89.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2384; bsz:  591/ 513/48; 13213/11460 tok/s;    311 sec;
[2024-03-08 17:37:56,686 INFO] Step 5150/10000; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2378; bsz:  586/ 507/48; 12952/11224 tok/s;    314 sec;
[2024-03-08 17:37:59,081 INFO] Step 5200/10000; acc: 90.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2262; bsz:  557/ 483/45; 11624/10077 tok/s;    316 sec;
[2024-03-08 17:38:01,111 INFO] valid stats calculation
                           took: 2.030153751373291 s.
[2024-03-08 17:38:01,112 INFO] Train perplexity: 7.36403
[2024-03-08 17:38:01,112 INFO] Train accuracy: 63.0794
[2024-03-08 17:38:01,112 INFO] Sentences processed: 243003
[2024-03-08 17:38:01,112 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:38:01,112 INFO] Validation perplexity: 7660.46
[2024-03-08 17:38:01,112 INFO] Validation accuracy: 25.9126
[2024-03-08 17:38:01,112 INFO] Saving checkpoint tg-both/tg_03_step_5200.pt
[2024-03-08 17:38:04,023 INFO] Step 5250/10000; acc: 90.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  565/ 490/47; 5714/4957 tok/s;    321 sec;
[2024-03-08 17:38:06,957 INFO] Step 5300/10000; acc: 90.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  578/ 500/47; 9849/8518 tok/s;    324 sec;
[2024-03-08 17:38:09,746 INFO] Step 5350/10000; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2250; bsz:  552/ 478/45; 9894/8575 tok/s;    327 sec;
[2024-03-08 17:38:12,502 INFO] Step 5400/10000; acc: 90.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  563/ 490/47; 10222/8883 tok/s;    330 sec;
[2024-03-08 17:38:14,656 INFO] valid stats calculation
                           took: 2.1540322303771973 s.
[2024-03-08 17:38:14,657 INFO] Train perplexity: 6.92852
[2024-03-08 17:38:14,657 INFO] Train accuracy: 64.0801
[2024-03-08 17:38:14,657 INFO] Sentences processed: 252353
[2024-03-08 17:38:14,657 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:38:14,657 INFO] Validation perplexity: 12134.3
[2024-03-08 17:38:14,657 INFO] Validation accuracy: 25.7922
[2024-03-08 17:38:14,657 INFO] Saving checkpoint tg-both/tg_03_step_5400.pt
[2024-03-08 17:38:17,640 INFO] Step 5450/10000; acc: 89.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2365; bsz:  587/ 514/47; 5713/5003 tok/s;    335 sec;
[2024-03-08 17:38:20,598 INFO] Step 5500/10000; acc: 89.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2276; bsz:  549/ 477/46; 9281/8065 tok/s;    338 sec;
[2024-03-08 17:38:23,481 INFO] Step 5550/10000; acc: 89.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2370; bsz:  579/ 506/47; 10042/8774 tok/s;    341 sec;
[2024-03-08 17:38:26,379 INFO] Step 5600/10000; acc: 90.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  574/ 498/48; 9916/8603 tok/s;    343 sec;
[2024-03-08 17:38:28,467 INFO] valid stats calculation
                           took: 2.087322235107422 s.
[2024-03-08 17:38:28,467 INFO] Train perplexity: 6.54354
[2024-03-08 17:38:28,467 INFO] Train accuracy: 65.01
[2024-03-08 17:38:28,467 INFO] Sentences processed: 261739
[2024-03-08 17:38:28,467 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:38:28,467 INFO] Validation perplexity: 9942.22
[2024-03-08 17:38:28,467 INFO] Validation accuracy: 25.4312
[2024-03-08 17:38:28,468 INFO] Saving checkpoint tg-both/tg_03_step_5600.pt
[2024-03-08 17:38:31,333 INFO] Step 5650/10000; acc: 90.0; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2381; bsz:  565/ 494/48; 5705/4981 tok/s;    348 sec;
[2024-03-08 17:38:34,281 INFO] Step 5700/10000; acc: 89.3; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2277; bsz:  568/ 492/46; 9628/8342 tok/s;    351 sec;
[2024-03-08 17:38:37,194 INFO] Step 5750/10000; acc: 90.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  565/ 491/48; 9701/8436 tok/s;    354 sec;
[2024-03-08 17:38:40,004 INFO] Step 5800/10000; acc: 90.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2270; bsz:  560/ 484/45; 9968/8612 tok/s;    357 sec;
[2024-03-08 17:38:42,121 INFO] valid stats calculation
                           took: 2.116471767425537 s.
[2024-03-08 17:38:42,121 INFO] Train perplexity: 6.21059
[2024-03-08 17:38:42,121 INFO] Train accuracy: 65.8622
[2024-03-08 17:38:42,121 INFO] Sentences processed: 271044
[2024-03-08 17:38:42,121 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:38:42,121 INFO] Validation perplexity: 9136.7
[2024-03-08 17:38:42,121 INFO] Validation accuracy: 26.1933
[2024-03-08 17:38:42,122 INFO] Saving checkpoint tg-both/tg_03_step_5800.pt
[2024-03-08 17:38:45,119 INFO] Step 5850/10000; acc: 89.9; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2366; bsz:  577/ 496/47; 5637/4853 tok/s;    362 sec;
[2024-03-08 17:38:48,007 INFO] Step 5900/10000; acc: 90.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  563/ 492/47; 9743/8525 tok/s;    365 sec;
[2024-03-08 17:38:50,857 INFO] Step 5950/10000; acc: 89.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2264; bsz:  558/ 482/45; 9785/8463 tok/s;    368 sec;
[2024-03-08 17:38:53,794 INFO] Step 6000/10000; acc: 89.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2368; bsz:  579/ 504/47; 9856/8587 tok/s;    371 sec;
[2024-03-08 17:38:55,894 INFO] valid stats calculation
                           took: 2.0999557971954346 s.
[2024-03-08 17:38:55,894 INFO] Train perplexity: 5.91213
[2024-03-08 17:38:55,894 INFO] Train accuracy: 66.6653
[2024-03-08 17:38:55,895 INFO] Sentences processed: 280408
[2024-03-08 17:38:55,895 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:38:55,895 INFO] Validation perplexity: 10290.4
[2024-03-08 17:38:55,895 INFO] Validation accuracy: 26.5544
[2024-03-08 17:38:55,895 INFO] Saving checkpoint tg-both/tg_03_step_6000.pt
[2024-03-08 17:38:58,862 INFO] Step 6050/10000; acc: 89.5; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2367; bsz:  566/ 491/47; 5580/4846 tok/s;    376 sec;
[2024-03-08 17:39:01,895 INFO] Step 6100/10000; acc: 88.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2273; bsz:  584/ 503/45; 9637/8301 tok/s;    379 sec;
[2024-03-08 17:39:04,765 INFO] Step 6150/10000; acc: 89.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2371; bsz:  564/ 488/47; 9820/8503 tok/s;    382 sec;
[2024-03-08 17:39:07,673 INFO] Step 6200/10000; acc: 89.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2275; bsz:  559/ 483/46; 9603/8300 tok/s;    385 sec;
[2024-03-08 17:39:09,701 INFO] valid stats calculation
                           took: 2.027080774307251 s.
[2024-03-08 17:39:09,701 INFO] Train perplexity: 5.65245
[2024-03-08 17:39:09,701 INFO] Train accuracy: 67.3903
[2024-03-08 17:39:09,701 INFO] Sentences processed: 289694
[2024-03-08 17:39:09,701 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:39:09,701 INFO] Validation perplexity: 8984.89
[2024-03-08 17:39:09,701 INFO] Validation accuracy: 25.3911
[2024-03-08 17:39:09,702 INFO] Saving checkpoint tg-both/tg_03_step_6200.pt
[2024-03-08 17:39:12,499 INFO] Step 6250/10000; acc: 88.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2482; bsz:  589/ 511/50; 6101/5295 tok/s;    390 sec;
[2024-03-08 17:39:15,509 INFO] Step 6300/10000; acc: 88.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2276; bsz:  561/ 486/46; 9324/8078 tok/s;    393 sec;
[2024-03-08 17:39:18,407 INFO] Step 6350/10000; acc: 88.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2377; bsz:  564/ 491/48; 9729/8471 tok/s;    395 sec;
[2024-03-08 17:39:21,311 INFO] Step 6400/10000; acc: 88.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2371; bsz:  579/ 501/47; 9974/8616 tok/s;    398 sec;
[2024-03-08 17:39:23,400 INFO] valid stats calculation
                           took: 2.088548183441162 s.
[2024-03-08 17:39:23,401 INFO] Train perplexity: 5.4198
[2024-03-08 17:39:23,401 INFO] Train accuracy: 68.0596
[2024-03-08 17:39:23,401 INFO] Sentences processed: 299200
[2024-03-08 17:39:23,401 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:39:23,401 INFO] Validation perplexity: 7780.67
[2024-03-08 17:39:23,401 INFO] Validation accuracy: 26.795
[2024-03-08 17:39:23,401 INFO] Saving checkpoint tg-both/tg_03_step_6400.pt
[2024-03-08 17:39:26,733 INFO] Step 6450/10000; acc: 88.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2260; bsz:  559/ 482/45; 5155/4444 tok/s;    404 sec;
[2024-03-08 17:39:29,626 INFO] Step 6500/10000; acc: 88.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2369; bsz:  590/ 513/47; 10205/8863 tok/s;    407 sec;
[2024-03-08 17:39:32,510 INFO] Step 6550/10000; acc: 88.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2365; bsz:  565/ 493/47; 9800/8539 tok/s;    410 sec;
[2024-03-08 17:39:35,401 INFO] Step 6600/10000; acc: 88.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2267; bsz:  558/ 483/45; 9645/8351 tok/s;    412 sec;
[2024-03-08 17:39:37,494 INFO] valid stats calculation
                           took: 2.092420816421509 s.
[2024-03-08 17:39:37,494 INFO] Train perplexity: 5.21442
[2024-03-08 17:39:37,494 INFO] Train accuracy: 68.67
[2024-03-08 17:39:37,494 INFO] Sentences processed: 308461
[2024-03-08 17:39:37,494 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:39:37,494 INFO] Validation perplexity: 9209.48
[2024-03-08 17:39:37,494 INFO] Validation accuracy: 26.2335
[2024-03-08 17:39:37,495 INFO] Saving checkpoint tg-both/tg_03_step_6600.pt
[2024-03-08 17:39:40,416 INFO] Step 6650/10000; acc: 87.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2367; bsz:  587/ 510/47; 5848/5080 tok/s;    417 sec;
[2024-03-08 17:39:43,345 INFO] Step 6700/10000; acc: 88.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2372; bsz:  566/ 491/47; 9662/8382 tok/s;    420 sec;
[2024-03-08 17:39:46,334 INFO] Step 6750/10000; acc: 88.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2257; bsz:  553/ 480/45; 9253/8030 tok/s;    423 sec;
[2024-03-08 17:39:49,264 INFO] Step 6800/10000; acc: 87.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2384; bsz:  587/ 510/48; 10024/8706 tok/s;    426 sec;
[2024-03-08 17:39:51,334 INFO] valid stats calculation
                           took: 2.069783926010132 s.
[2024-03-08 17:39:51,335 INFO] Train perplexity: 5.02799
[2024-03-08 17:39:51,335 INFO] Train accuracy: 69.2424
[2024-03-08 17:39:51,335 INFO] Sentences processed: 317841
[2024-03-08 17:39:51,335 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:39:51,335 INFO] Validation perplexity: 9153.89
[2024-03-08 17:39:51,335 INFO] Validation accuracy: 26.9956
[2024-03-08 17:39:51,335 INFO] Saving checkpoint tg-both/tg_03_step_6800.pt
[2024-03-08 17:39:54,262 INFO] Step 6850/10000; acc: 87.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2277; bsz:  562/ 487/46; 5619/4870 tok/s;    431 sec;
[2024-03-08 17:39:57,152 INFO] Step 6900/10000; acc: 88.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  565/ 490/48; 9774/8484 tok/s;    434 sec;
[2024-03-08 17:40:00,053 INFO] Step 6950/10000; acc: 87.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2372; bsz:  564/ 491/47; 9723/8464 tok/s;    437 sec;
[2024-03-08 17:40:02,979 INFO] Step 7000/10000; acc: 87.5; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2366; bsz:  578/ 500/47; 9875/8543 tok/s;    440 sec;
[2024-03-08 17:40:05,100 INFO] valid stats calculation
                           took: 2.120087146759033 s.
[2024-03-08 17:40:05,100 INFO] Train perplexity: 4.86171
[2024-03-08 17:40:05,100 INFO] Train accuracy: 69.7702
[2024-03-08 17:40:05,100 INFO] Sentences processed: 327231
[2024-03-08 17:40:05,100 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:40:05,100 INFO] Validation perplexity: 9173.49
[2024-03-08 17:40:05,100 INFO] Validation accuracy: 26.5945
[2024-03-08 17:40:05,101 INFO] Saving checkpoint tg-both/tg_03_step_7000.pt
[2024-03-08 17:40:07,911 INFO] Step 7050/10000; acc: 87.4; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2253; bsz:  552/ 477/45; 5594/4838 tok/s;    445 sec;
[2024-03-08 17:40:10,769 INFO] Step 7100/10000; acc: 88.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2364; bsz:  567/ 499/47; 9930/8740 tok/s;    448 sec;
[2024-03-08 17:40:13,730 INFO] Step 7150/10000; acc: 86.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2271; bsz:  567/ 490/45; 9577/8283 tok/s;    451 sec;
[2024-03-08 17:40:16,624 INFO] Step 7200/10000; acc: 87.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2365; bsz:  587/ 512/47; 10133/8851 tok/s;    454 sec;
[2024-03-08 17:40:18,634 INFO] valid stats calculation
                           took: 2.00923490524292 s.
[2024-03-08 17:40:18,634 INFO] Train perplexity: 4.71166
[2024-03-08 17:40:18,635 INFO] Train accuracy: 70.2582
[2024-03-08 17:40:18,635 INFO] Sentences processed: 336484
[2024-03-08 17:40:18,635 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:40:18,635 INFO] Validation perplexity: 8292.85
[2024-03-08 17:40:18,635 INFO] Validation accuracy: 26.7148
[2024-03-08 17:40:18,635 INFO] Saving checkpoint tg-both/tg_03_step_7200.pt
[2024-03-08 17:40:21,473 INFO] Step 7250/10000; acc: 87.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2372; bsz:  575/ 499/47; 5929/5143 tok/s;    459 sec;
[2024-03-08 17:40:24,492 INFO] Step 7300/10000; acc: 87.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2268; bsz:  557/ 482/45; 9220/7985 tok/s;    462 sec;
[2024-03-08 17:40:27,473 INFO] Step 7350/10000; acc: 87.6; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2376; bsz:  564/ 492/48; 9466/8249 tok/s;    465 sec;
[2024-03-08 17:40:30,434 INFO] Step 7400/10000; acc: 86.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2381; bsz:  582/ 506/48; 9828/8548 tok/s;    467 sec;
[2024-03-08 17:40:32,496 INFO] valid stats calculation
                           took: 2.0609655380249023 s.
[2024-03-08 17:40:32,496 INFO] Train perplexity: 4.57428
[2024-03-08 17:40:32,496 INFO] Train accuracy: 70.7181
[2024-03-08 17:40:32,496 INFO] Sentences processed: 345881
[2024-03-08 17:40:32,496 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:40:32,496 INFO] Validation perplexity: 9178.74
[2024-03-08 17:40:32,496 INFO] Validation accuracy: 26.073
[2024-03-08 17:40:32,497 INFO] Saving checkpoint tg-both/tg_03_step_7400.pt
[2024-03-08 17:40:35,457 INFO] Step 7450/10000; acc: 87.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2378; bsz:  565/ 494/48; 5628/4915 tok/s;    472 sec;
[2024-03-08 17:40:38,351 INFO] Step 7500/10000; acc: 86.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2276; bsz:  561/ 484/46; 9697/8364 tok/s;    475 sec;
[2024-03-08 17:40:41,295 INFO] Step 7550/10000; acc: 86.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2371; bsz:  578/ 497/47; 9818/8449 tok/s;    478 sec;
[2024-03-08 17:40:44,194 INFO] Step 7600/10000; acc: 86.8; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2366; bsz:  563/ 490/47; 9713/8458 tok/s;    481 sec;
[2024-03-08 17:40:46,266 INFO] valid stats calculation
                           took: 2.071211814880371 s.
[2024-03-08 17:40:46,266 INFO] Train perplexity: 4.45106
[2024-03-08 17:40:46,266 INFO] Train accuracy: 71.1355
[2024-03-08 17:40:46,266 INFO] Sentences processed: 355272
[2024-03-08 17:40:46,266 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:40:46,266 INFO] Validation perplexity: 9814.88
[2024-03-08 17:40:46,266 INFO] Validation accuracy: 26.4741
[2024-03-08 17:40:46,267 INFO] Saving checkpoint tg-both/tg_03_step_7600.pt
[2024-03-08 17:40:49,107 INFO] Step 7650/10000; acc: 86.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2266; bsz:  559/ 485/45; 5693/4933 tok/s;    486 sec;
[2024-03-08 17:40:52,017 INFO] Step 7700/10000; acc: 85.8; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2264; bsz:  561/ 486/45; 9649/8359 tok/s;    489 sec;
[2024-03-08 17:40:54,879 INFO] Step 7750/10000; acc: 86.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2369; bsz:  566/ 491/47; 9885/8584 tok/s;    492 sec;
[2024-03-08 17:40:57,831 INFO] Step 7800/10000; acc: 85.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2367; bsz:  586/ 506/47; 9917/8565 tok/s;    495 sec;
[2024-03-08 17:40:59,874 INFO] valid stats calculation
                           took: 2.0420501232147217 s.
[2024-03-08 17:40:59,874 INFO] Train perplexity: 4.3409
[2024-03-08 17:40:59,874 INFO] Train accuracy: 71.5146
[2024-03-08 17:40:59,874 INFO] Sentences processed: 364538
[2024-03-08 17:40:59,874 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:40:59,874 INFO] Validation perplexity: 9412.63
[2024-03-08 17:40:59,874 INFO] Validation accuracy: 27.5973
[2024-03-08 17:40:59,875 INFO] Saving checkpoint tg-both/tg_03_step_7800.pt
[2024-03-08 17:41:02,626 INFO] Step 7850/10000; acc: 85.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2372; bsz:  563/ 489/47; 5874/5095 tok/s;    500 sec;
[2024-03-08 17:41:05,695 INFO] Step 7900/10000; acc: 84.9; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    2271; bsz:  579/ 497/45; 9428/8104 tok/s;    503 sec;
[2024-03-08 17:41:08,682 INFO] Step 7950/10000; acc: 85.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2375; bsz:  566/ 491/48; 9471/8216 tok/s;    506 sec;
[2024-03-08 17:41:11,607 INFO] Step 8000/10000; acc: 85.1; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2382; bsz:  582/ 504/48; 9959/8620 tok/s;    509 sec;
[2024-03-08 17:41:13,844 INFO] valid stats calculation
                           took: 2.2372963428497314 s.
[2024-03-08 17:41:13,845 INFO] Train perplexity: 4.24124
[2024-03-08 17:41:13,845 INFO] Train accuracy: 71.8601
[2024-03-08 17:41:13,845 INFO] Sentences processed: 373938
[2024-03-08 17:41:13,845 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:41:13,845 INFO] Validation perplexity: 9265.2
[2024-03-08 17:41:13,845 INFO] Validation accuracy: 26.7148
[2024-03-08 17:41:13,845 INFO] Saving checkpoint tg-both/tg_03_step_8000.pt
[2024-03-08 17:41:16,598 INFO] Step 8050/10000; acc: 84.9; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2274; bsz:  558/ 483/45; 5587/4841 tok/s;    514 sec;
[2024-03-08 17:41:19,462 INFO] Step 8100/10000; acc: 85.0; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    2376; bsz:  562/ 488/48; 9815/8522 tok/s;    516 sec;
[2024-03-08 17:41:22,462 INFO] Step 8150/10000; acc: 84.7; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2272; bsz:  563/ 488/45; 9379/8135 tok/s;    519 sec;
[2024-03-08 17:41:25,329 INFO] Step 8200/10000; acc: 84.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2366; bsz:  569/ 497/47; 9931/8674 tok/s;    522 sec;
[2024-03-08 17:41:27,366 INFO] valid stats calculation
                           took: 2.036179304122925 s.
[2024-03-08 17:41:27,366 INFO] Train perplexity: 4.15115
[2024-03-08 17:41:27,366 INFO] Train accuracy: 72.1747
[2024-03-08 17:41:27,366 INFO] Sentences processed: 383226
[2024-03-08 17:41:27,366 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:41:27,366 INFO] Validation perplexity: 10737.8
[2024-03-08 17:41:27,366 INFO] Validation accuracy: 26.434
[2024-03-08 17:41:27,367 INFO] Saving checkpoint tg-both/tg_03_step_8200.pt
[2024-03-08 17:41:30,003 INFO] Step 8250/10000; acc: 84.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2369; bsz:  590/ 511/47; 6306/5471 tok/s;    527 sec;
[2024-03-08 17:41:32,833 INFO] Step 8300/10000; acc: 84.5; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2242; bsz:  546/ 473/45; 9657/8357 tok/s;    530 sec;
[2024-03-08 17:41:35,714 INFO] Step 8350/10000; acc: 83.7; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2365; bsz:  585/ 508/47; 10157/8810 tok/s;    533 sec;
[2024-03-08 17:41:38,678 INFO] Step 8400/10000; acc: 84.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2367; bsz:  564/ 491/47; 9523/8287 tok/s;    536 sec;
[2024-03-08 17:41:40,672 INFO] valid stats calculation
                           took: 1.9942874908447266 s.
[2024-03-08 17:41:40,673 INFO] Train perplexity: 4.06948
[2024-03-08 17:41:40,673 INFO] Train accuracy: 72.46
[2024-03-08 17:41:40,673 INFO] Sentences processed: 392569
[2024-03-08 17:41:40,673 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:41:40,673 INFO] Validation perplexity: 8704.06
[2024-03-08 17:41:40,673 INFO] Validation accuracy: 26.6747
[2024-03-08 17:41:40,673 INFO] Saving checkpoint tg-both/tg_03_step_8400.pt
[2024-03-08 17:41:43,332 INFO] Step 8450/10000; acc: 83.7; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2372; bsz:  582/ 504/47; 6249/5416 tok/s;    540 sec;
[2024-03-08 17:41:46,394 INFO] Step 8500/10000; acc: 83.3; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2275; bsz:  561/ 487/46; 9165/7947 tok/s;    543 sec;
[2024-03-08 17:41:49,350 INFO] Step 8550/10000; acc: 82.9; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2383; bsz:  569/ 495/48; 9621/8374 tok/s;    546 sec;
[2024-03-08 17:41:52,310 INFO] Step 8600/10000; acc: 82.8; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2381; bsz:  582/ 505/48; 9832/8524 tok/s;    549 sec;
[2024-03-08 17:41:54,329 INFO] valid stats calculation
                           took: 2.0185999870300293 s.
[2024-03-08 17:41:54,329 INFO] Train perplexity: 3.99697
[2024-03-08 17:41:54,329 INFO] Train accuracy: 72.7109
[2024-03-08 17:41:54,329 INFO] Sentences processed: 401980
[2024-03-08 17:41:54,329 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:41:54,329 INFO] Validation perplexity: 9397.74
[2024-03-08 17:41:54,329 INFO] Validation accuracy: 27.0357
[2024-03-08 17:41:54,330 INFO] Saving checkpoint tg-both/tg_03_step_8600.pt
[2024-03-08 17:41:56,963 INFO] Step 8650/10000; acc: 83.0; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 6053/5255 tok/s;    554 sec;
[2024-03-08 17:41:59,897 INFO] Step 8700/10000; acc: 82.3; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2258; bsz:  552/ 479/45; 9418/8160 tok/s;    557 sec;
[2024-03-08 17:42:02,787 INFO] Step 8750/10000; acc: 82.0; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2366; bsz:  566/ 497/47; 9794/8597 tok/s;    560 sec;
[2024-03-08 17:42:05,701 INFO] Step 8800/10000; acc: 80.2; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2271; bsz:  568/ 493/45; 9738/8453 tok/s;    563 sec;
[2024-03-08 17:42:07,685 INFO] valid stats calculation
                           took: 1.9829308986663818 s.
[2024-03-08 17:42:07,685 INFO] Train perplexity: 3.936
[2024-03-08 17:42:07,685 INFO] Train accuracy: 72.9172
[2024-03-08 17:42:07,685 INFO] Sentences processed: 411250
[2024-03-08 17:42:07,685 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:42:07,685 INFO] Validation perplexity: 10030.8
[2024-03-08 17:42:07,685 INFO] Validation accuracy: 26.5945
[2024-03-08 17:42:07,686 INFO] Saving checkpoint tg-both/tg_03_step_8800.pt
[2024-03-08 17:42:10,152 INFO] Step 8850/10000; acc: 81.0; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2364; bsz:  587/ 514/47; 6599/5770 tok/s;    567 sec;
[2024-03-08 17:42:13,021 INFO] Step 8900/10000; acc: 81.2; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2263; bsz:  554/ 478/45; 9656/8328 tok/s;    570 sec;
[2024-03-08 17:42:15,902 INFO] Step 8950/10000; acc: 81.1; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2365; bsz:  561/ 486/47; 9730/8441 tok/s;    573 sec;
[2024-03-08 17:42:18,835 INFO] Step 9000/10000; acc: 80.7; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    2373; bsz:  576/ 500/47; 9812/8527 tok/s;    576 sec;
[2024-03-08 17:42:20,839 INFO] valid stats calculation
                           took: 2.0035593509674072 s.
[2024-03-08 17:42:20,840 INFO] Train perplexity: 3.88187
[2024-03-08 17:42:20,840 INFO] Train accuracy: 73.0972
[2024-03-08 17:42:20,840 INFO] Sentences processed: 420615
[2024-03-08 17:42:20,840 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:42:20,840 INFO] Validation perplexity: 9747.51
[2024-03-08 17:42:20,840 INFO] Validation accuracy: 26.5544
[2024-03-08 17:42:20,841 INFO] Saving checkpoint tg-both/tg_03_step_9000.pt
[2024-03-08 17:42:23,466 INFO] Step 9050/10000; acc: 80.6; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2371; bsz:  565/ 495/47; 6106/5344 tok/s;    581 sec;
[2024-03-08 17:42:26,472 INFO] Step 9100/10000; acc: 80.4; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2376; bsz:  581/ 505/48; 9664/8408 tok/s;    584 sec;
[2024-03-08 17:42:29,411 INFO] Step 9150/10000; acc: 79.4; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2284; bsz:  563/ 486/46; 9585/8276 tok/s;    586 sec;
[2024-03-08 17:42:32,393 INFO] Step 9200/10000; acc: 79.0; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2276; bsz:  561/ 485/46; 9411/8129 tok/s;    589 sec;
[2024-03-08 17:42:34,399 INFO] valid stats calculation
                           took: 2.005502462387085 s.
[2024-03-08 17:42:34,399 INFO] Train perplexity: 3.8354
[2024-03-08 17:42:34,399 INFO] Train accuracy: 73.2438
[2024-03-08 17:42:34,399 INFO] Sentences processed: 429922
[2024-03-08 17:42:34,399 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:42:34,399 INFO] Validation perplexity: 10607.4
[2024-03-08 17:42:34,399 INFO] Validation accuracy: 26.8351
[2024-03-08 17:42:34,400 INFO] Saving checkpoint tg-both/tg_03_step_9200.pt
[2024-03-08 17:42:36,891 INFO] Step 9250/10000; acc: 80.3; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2475; bsz:  583/ 504/50; 6476/5602 tok/s;    594 sec;
[2024-03-08 17:42:39,903 INFO] Step 9300/10000; acc: 78.6; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2271; bsz:  561/ 485/45; 9320/8052 tok/s;    597 sec;
[2024-03-08 17:42:42,844 INFO] Step 9350/10000; acc: 78.7; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2366; bsz:  584/ 506/47; 9923/8606 tok/s;    600 sec;
[2024-03-08 17:42:45,753 INFO] Step 9400/10000; acc: 78.0; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2268; bsz:  543/ 472/45; 9331/8117 tok/s;    603 sec;
[2024-03-08 17:42:47,826 INFO] valid stats calculation
                           took: 2.0726804733276367 s.
[2024-03-08 17:42:47,827 INFO] Train perplexity: 3.79589
[2024-03-08 17:42:47,827 INFO] Train accuracy: 73.3645
[2024-03-08 17:42:47,827 INFO] Sentences processed: 439302
[2024-03-08 17:42:47,827 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:42:47,827 INFO] Validation perplexity: 13362.4
[2024-03-08 17:42:47,827 INFO] Validation accuracy: 25.6318
[2024-03-08 17:42:47,827 INFO] Saving checkpoint tg-both/tg_03_step_9400.pt
[2024-03-08 17:42:50,346 INFO] Step 9450/10000; acc: 77.9; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2362; bsz:  584/ 505/47; 6359/5503 tok/s;    607 sec;
[2024-03-08 17:42:53,364 INFO] Step 9500/10000; acc: 77.8; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2267; bsz:  561/ 484/45; 9288/8012 tok/s;    610 sec;
[2024-03-08 17:42:56,243 INFO] Step 9550/10000; acc: 78.5; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2369; bsz:  564/ 489/47; 9797/8489 tok/s;    613 sec;
[2024-03-08 17:42:59,138 INFO] Step 9600/10000; acc: 78.3; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2372; bsz:  581/ 501/47; 10028/8659 tok/s;    616 sec;
[2024-03-08 17:43:01,162 INFO] valid stats calculation
                           took: 2.023183584213257 s.
[2024-03-08 17:43:01,162 INFO] Train perplexity: 3.76099
[2024-03-08 17:43:01,162 INFO] Train accuracy: 73.4638
[2024-03-08 17:43:01,162 INFO] Sentences processed: 448672
[2024-03-08 17:43:01,162 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:43:01,162 INFO] Validation perplexity: 12237.7
[2024-03-08 17:43:01,162 INFO] Validation accuracy: 26.7549
[2024-03-08 17:43:01,163 INFO] Saving checkpoint tg-both/tg_03_step_9600.pt
[2024-03-08 17:43:03,733 INFO] Step 9650/10000; acc: 77.9; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2269; bsz:  559/ 485/45; 6081/5281 tok/s;    621 sec;
[2024-03-08 17:43:06,667 INFO] Step 9700/10000; acc: 78.1; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2375; bsz:  583/ 504/48; 9932/8597 tok/s;    624 sec;
[2024-03-08 17:43:09,617 INFO] Step 9750/10000; acc: 78.1; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2382; bsz:  565/ 492/48; 9574/8336 tok/s;    627 sec;
[2024-03-08 17:43:12,561 INFO] Step 9800/10000; acc: 76.8; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    2376; bsz:  589/ 511/48; 10003/8677 tok/s;    630 sec;
[2024-03-08 17:43:14,569 INFO] valid stats calculation
                           took: 2.0078346729278564 s.
[2024-03-08 17:43:14,570 INFO] Train perplexity: 3.72942
[2024-03-08 17:43:14,570 INFO] Train accuracy: 73.5515
[2024-03-08 17:43:14,570 INFO] Sentences processed: 458074
[2024-03-08 17:43:14,570 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:43:14,570 INFO] Validation perplexity: 8532.27
[2024-03-08 17:43:14,570 INFO] Validation accuracy: 26.2335
[2024-03-08 17:43:14,570 INFO] Saving checkpoint tg-both/tg_03_step_9800.pt
[2024-03-08 17:43:17,136 INFO] Step 9850/10000; acc: 77.0; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    2280; bsz:  564/ 488/46; 6166/5332 tok/s;    634 sec;
[2024-03-08 17:43:19,983 INFO] Step 9900/10000; acc: 77.2; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    2368; bsz:  569/ 498/47; 9994/8751 tok/s;    637 sec;
[2024-03-08 17:43:22,866 INFO] Step 9950/10000; acc: 76.3; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    2246; bsz:  549/ 475/45; 9527/8239 tok/s;    640 sec;
[2024-03-08 17:43:25,872 INFO] Step 10000/10000; acc: 74.7; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    2368; bsz:  586/ 507/47; 9756/8441 tok/s;    643 sec;
[2024-03-08 17:43:27,862 INFO] valid stats calculation
                           took: 1.9901463985443115 s.
[2024-03-08 17:43:27,863 INFO] Train perplexity: 3.70503
[2024-03-08 17:43:27,863 INFO] Train accuracy: 73.6064
[2024-03-08 17:43:27,863 INFO] Sentences processed: 467336
[2024-03-08 17:43:27,863 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:43:27,863 INFO] Validation perplexity: 10462.3
[2024-03-08 17:43:27,863 INFO] Validation accuracy: 26.5945
[2024-03-08 17:43:27,863 INFO] Saving checkpoint tg-both/tg_03_step_10000.pt
