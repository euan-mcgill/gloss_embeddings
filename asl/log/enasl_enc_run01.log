[2024-03-08 15:38:31,511 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-08 15:38:31,511 INFO] Parsed 2 corpora from -data.
[2024-03-08 15:38:31,511 INFO] Get special vocabs from Transforms: {'src': [], 'tgt': []}.
[2024-03-08 15:38:31,516 INFO] Reading encoder embeddings from en_w2v.txt
[2024-03-08 15:39:06,044 INFO] 	Found 3000000 total vectors in file.
[2024-03-08 15:39:06,044 INFO] After filtering to vectors in vocab:
[2024-03-08 15:39:06,045 INFO] 	* enc: 2268 match, 116 missing, (95.13%)
[2024-03-08 15:39:06,045 INFO] 
Saving encoder embeddings as:
	* enc: tg-enc.enc_embeddings.pt
[2024-03-08 15:39:06,518 INFO] The first 10 tokens of the vocabs are:['<unk>', '<blank>', '<s>', '</s>', '.', 'the', ',', 'i', 'to', 'it']
[2024-03-08 15:39:06,519 INFO] The decoder start token is: <s>
[2024-03-08 15:39:06,519 INFO] Building model...
[2024-03-08 15:39:06,630 INFO] Switching model to float32 for amp/apex_amp
[2024-03-08 15:39:06,631 INFO] Non quantized layer compute is fp32
[2024-03-08 15:39:08,655 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(2384, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(2416, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=2416, bias=True)
)
[2024-03-08 15:39:08,655 INFO] encoder: 4323200
[2024-03-08 15:39:08,655 INFO] decoder: 7293216
[2024-03-08 15:39:08,655 INFO] * number of parameters: 11616416
[2024-03-08 15:39:08,656 INFO] Trainable parameters = {'torch.float32': 11616416, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-08 15:39:08,656 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-08 15:39:08,656 INFO]  * src vocab size = 2384
[2024-03-08 15:39:08,656 INFO]  * tgt vocab size = 2416
[2024-03-08 15:39:08,657 INFO] Starting training on GPU: [0]
[2024-03-08 15:39:08,657 INFO] Start training loop and validate every 200 steps...
[2024-03-08 15:39:08,657 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-08 15:39:13,465 INFO] Step 50/10000; acc: 9.7; ppl: 24720.4; xent: 10.1; lr: 1.00000; sents:    2270; bsz:  565/ 490/45; 5877/5093 tok/s;      5 sec;
[2024-03-08 15:39:16,108 INFO] Step 100/10000; acc: 10.8; ppl: 4006.3; xent: 8.3; lr: 1.00000; sents:    2369; bsz:  590/ 512/47; 11165/9694 tok/s;      7 sec;
[2024-03-08 15:39:18,878 INFO] Step 150/10000; acc: 11.8; ppl: 616.1; xent: 6.4; lr: 1.00000; sents:    2363; bsz:  564/ 491/47; 10175/8873 tok/s;     10 sec;
[2024-03-08 15:39:21,647 INFO] Step 200/10000; acc: 12.1; ppl: 371.3; xent: 5.9; lr: 1.00000; sents:    2365; bsz:  585/ 507/47; 10565/9160 tok/s;     13 sec;
[2024-03-08 15:39:23,652 INFO] valid stats calculation
                           took: 2.0046260356903076 s.
[2024-03-08 15:39:23,652 INFO] Train perplexity: 2160.86
[2024-03-08 15:39:23,652 INFO] Train accuracy: 11.0996
[2024-03-08 15:39:23,653 INFO] Sentences processed: 9367
[2024-03-08 15:39:23,653 INFO] Average bsz:  576/ 500/47
[2024-03-08 15:39:23,653 INFO] Validation perplexity: 446.852
[2024-03-08 15:39:23,653 INFO] Validation accuracy: 12.1139
[2024-03-08 15:39:23,653 INFO] Saving checkpoint tg-enc/tg_01_step_200.pt
[2024-03-08 15:39:26,471 INFO] Step 250/10000; acc: 13.1; ppl: 339.1; xent: 5.8; lr: 1.00000; sents:    2246; bsz:  547/ 475/45; 5674/4922 tok/s;     18 sec;
[2024-03-08 15:39:28,982 INFO] Step 300/10000; acc: 13.3; ppl: 330.8; xent: 5.8; lr: 1.00000; sents:    2372; bsz:  566/ 491/47; 11273/9778 tok/s;     20 sec;
[2024-03-08 15:39:31,906 INFO] Step 350/10000; acc: 14.4; ppl: 307.8; xent: 5.7; lr: 1.00000; sents:    2378; bsz:  568/ 494/48; 9707/8455 tok/s;     23 sec;
[2024-03-08 15:39:34,860 INFO] Step 400/10000; acc: 14.6; ppl: 288.3; xent: 5.7; lr: 1.00000; sents:    2280; bsz:  562/ 487/46; 9515/8252 tok/s;     26 sec;
[2024-03-08 15:39:37,216 INFO] valid stats calculation
                           took: 2.3549835681915283 s.
[2024-03-08 15:39:37,216 INFO] Train perplexity: 836.741
[2024-03-08 15:39:37,216 INFO] Train accuracy: 12.4613
[2024-03-08 15:39:37,216 INFO] Sentences processed: 18643
[2024-03-08 15:39:37,216 INFO] Average bsz:  568/ 494/47
[2024-03-08 15:39:37,216 INFO] Validation perplexity: 395.174
[2024-03-08 15:39:37,216 INFO] Validation accuracy: 13.2772
[2024-03-08 15:39:37,217 INFO] Saving checkpoint tg-enc/tg_01_step_400.pt
[2024-03-08 15:39:40,089 INFO] Step 450/10000; acc: 14.9; ppl: 289.1; xent: 5.7; lr: 1.00000; sents:    2381; bsz:  586/ 509/48; 5608/4871 tok/s;     31 sec;
[2024-03-08 15:39:42,650 INFO] Step 500/10000; acc: 15.3; ppl: 239.0; xent: 5.5; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 11312/9768 tok/s;     34 sec;
[2024-03-08 15:39:45,551 INFO] Step 550/10000; acc: 16.6; ppl: 222.6; xent: 5.4; lr: 1.00000; sents:    2258; bsz:  537/ 467/45; 9257/8058 tok/s;     37 sec;
[2024-03-08 15:39:48,435 INFO] Step 600/10000; acc: 17.7; ppl: 191.1; xent: 5.3; lr: 1.00000; sents:    2366; bsz:  578/ 500/47; 10017/8675 tok/s;     40 sec;
[2024-03-08 15:39:50,442 INFO] valid stats calculation
                           took: 2.0061633586883545 s.
[2024-03-08 15:39:50,442 INFO] Train perplexity: 546.342
[2024-03-08 15:39:50,442 INFO] Train accuracy: 13.6777
[2024-03-08 15:39:50,442 INFO] Sentences processed: 28023
[2024-03-08 15:39:50,442 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:39:50,442 INFO] Validation perplexity: 384.571
[2024-03-08 15:39:50,442 INFO] Validation accuracy: 14.5207
[2024-03-08 15:39:50,443 INFO] Saving checkpoint tg-enc/tg_01_step_600.pt
[2024-03-08 15:39:53,289 INFO] Step 650/10000; acc: 17.8; ppl: 181.4; xent: 5.2; lr: 1.00000; sents:    2367; bsz:  587/ 513/47; 6047/5280 tok/s;     45 sec;
[2024-03-08 15:39:55,768 INFO] Step 700/10000; acc: 20.2; ppl: 157.7; xent: 5.1; lr: 1.00000; sents:    2364; bsz:  568/ 500/47; 11449/10087 tok/s;     47 sec;
[2024-03-08 15:39:58,633 INFO] Step 750/10000; acc: 18.8; ppl: 155.7; xent: 5.0; lr: 1.00000; sents:    2271; bsz:  567/ 490/45; 9893/8550 tok/s;     50 sec;
[2024-03-08 15:40:01,530 INFO] Step 800/10000; acc: 20.1; ppl: 141.2; xent: 4.9; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 9885/8567 tok/s;     53 sec;
[2024-03-08 15:40:03,510 INFO] valid stats calculation
                           took: 1.9801669120788574 s.
[2024-03-08 15:40:03,511 INFO] Train perplexity: 399.893
[2024-03-08 15:40:03,511 INFO] Train accuracy: 15.076
[2024-03-08 15:40:03,511 INFO] Sentences processed: 37390
[2024-03-08 15:40:03,511 INFO] Average bsz:  570/ 495/47
[2024-03-08 15:40:03,511 INFO] Validation perplexity: 258.164
[2024-03-08 15:40:03,511 INFO] Validation accuracy: 20.2567
[2024-03-08 15:40:03,511 INFO] Saving checkpoint tg-enc/tg_01_step_800.pt
[2024-03-08 15:40:06,329 INFO] Step 850/10000; acc: 21.5; ppl: 123.6; xent: 4.8; lr: 1.00000; sents:    2372; bsz:  563/ 490/47; 5868/5104 tok/s;     58 sec;
[2024-03-08 15:40:08,919 INFO] Step 900/10000; acc: 21.6; ppl: 118.1; xent: 4.8; lr: 1.00000; sents:    2268; bsz:  557/ 483/45; 10759/9320 tok/s;     60 sec;
[2024-03-08 15:40:11,913 INFO] Step 950/10000; acc: 22.5; ppl: 105.9; xent: 4.7; lr: 1.00000; sents:    2376; bsz:  581/ 506/48; 9706/8445 tok/s;     63 sec;
[2024-03-08 15:40:14,842 INFO] Step 1000/10000; acc: 23.5; ppl:  97.3; xent: 4.6; lr: 1.00000; sents:    2284; bsz:  563/ 487/46; 9621/8314 tok/s;     66 sec;
[2024-03-08 15:40:16,810 INFO] valid stats calculation
                           took: 1.967249870300293 s.
[2024-03-08 15:40:16,810 INFO] Train perplexity: 309.824
[2024-03-08 15:40:16,810 INFO] Train accuracy: 16.5115
[2024-03-08 15:40:16,810 INFO] Sentences processed: 46690
[2024-03-08 15:40:16,810 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:40:16,810 INFO] Validation perplexity: 262.045
[2024-03-08 15:40:16,810 INFO] Validation accuracy: 21.6606
[2024-03-08 15:40:16,811 INFO] Saving checkpoint tg-enc/tg_01_step_1000.pt
[2024-03-08 15:40:19,756 INFO] Step 1050/10000; acc: 24.2; ppl:  89.4; xent: 4.5; lr: 1.00000; sents:    2376; bsz:  564/ 493/48; 5743/5017 tok/s;     71 sec;
[2024-03-08 15:40:22,188 INFO] Step 1100/10000; acc: 24.5; ppl:  84.1; xent: 4.4; lr: 1.00000; sents:    2375; bsz:  565/ 490/48; 11621/10083 tok/s;     74 sec;
[2024-03-08 15:40:25,018 INFO] Step 1150/10000; acc: 24.8; ppl:  79.1; xent: 4.4; lr: 1.00000; sents:    2271; bsz:  560/ 481/45; 9899/8506 tok/s;     76 sec;
[2024-03-08 15:40:27,953 INFO] Step 1200/10000; acc: 26.6; ppl:  70.6; xent: 4.3; lr: 1.00000; sents:    2366; bsz:  577/ 501/47; 9836/8538 tok/s;     79 sec;
[2024-03-08 15:40:29,948 INFO] valid stats calculation
                           took: 1.9950544834136963 s.
[2024-03-08 15:40:29,949 INFO] Train perplexity: 247.746
[2024-03-08 15:40:29,949 INFO] Train accuracy: 17.9226
[2024-03-08 15:40:29,949 INFO] Sentences processed: 56078
[2024-03-08 15:40:29,949 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:40:29,949 INFO] Validation perplexity: 301.099
[2024-03-08 15:40:29,949 INFO] Validation accuracy: 19.4946
[2024-03-08 15:40:29,949 INFO] Saving checkpoint tg-enc/tg_01_step_1200.pt
[2024-03-08 15:40:32,851 INFO] Step 1250/10000; acc: 26.5; ppl:  66.4; xent: 4.2; lr: 1.00000; sents:    2366; bsz:  584/ 506/47; 5964/5168 tok/s;     84 sec;
[2024-03-08 15:40:35,305 INFO] Step 1300/10000; acc: 27.5; ppl:  58.5; xent: 4.1; lr: 1.00000; sents:    2264; bsz:  562/ 487/45; 11458/9917 tok/s;     87 sec;
[2024-03-08 15:40:38,143 INFO] Step 1350/10000; acc: 29.4; ppl:  50.6; xent: 3.9; lr: 1.00000; sents:    2369; bsz:  566/ 491/47; 9964/8652 tok/s;     89 sec;
[2024-03-08 15:40:40,980 INFO] Step 1400/10000; acc: 29.1; ppl:  49.8; xent: 3.9; lr: 1.00000; sents:    2367; bsz:  579/ 500/47; 10216/8814 tok/s;     92 sec;
[2024-03-08 15:40:42,971 INFO] valid stats calculation
                           took: 1.9909462928771973 s.
[2024-03-08 15:40:42,971 INFO] Train perplexity: 200.165
[2024-03-08 15:40:42,971 INFO] Train accuracy: 19.3854
[2024-03-08 15:40:42,971 INFO] Sentences processed: 65444
[2024-03-08 15:40:42,971 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:40:42,971 INFO] Validation perplexity: 254.965
[2024-03-08 15:40:42,971 INFO] Validation accuracy: 19.5748
[2024-03-08 15:40:42,972 INFO] Saving checkpoint tg-enc/tg_01_step_1400.pt
[2024-03-08 15:40:45,946 INFO] Step 1450/10000; acc: 30.5; ppl:  42.5; xent: 3.7; lr: 1.00000; sents:    2272; bsz:  562/ 485/45; 5658/4879 tok/s;     97 sec;
[2024-03-08 15:40:48,463 INFO] Step 1500/10000; acc: 32.4; ppl:  36.4; xent: 3.6; lr: 1.00000; sents:    2371; bsz:  564/ 490/47; 11206/9726 tok/s;    100 sec;
[2024-03-08 15:40:51,437 INFO] Step 1550/10000; acc: 33.9; ppl:  31.7; xent: 3.5; lr: 1.00000; sents:    2273; bsz:  560/ 486/45; 9414/8174 tok/s;    103 sec;
[2024-03-08 15:40:54,323 INFO] Step 1600/10000; acc: 34.9; ppl:  29.5; xent: 3.4; lr: 1.00000; sents:    2382; bsz:  582/ 504/48; 10087/8733 tok/s;    106 sec;
[2024-03-08 15:40:56,351 INFO] valid stats calculation
                           took: 2.0272867679595947 s.
[2024-03-08 15:40:56,351 INFO] Train perplexity: 160.935
[2024-03-08 15:40:56,351 INFO] Train accuracy: 21.0707
[2024-03-08 15:40:56,351 INFO] Sentences processed: 74742
[2024-03-08 15:40:56,351 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:40:56,351 INFO] Validation perplexity: 223.238
[2024-03-08 15:40:56,351 INFO] Validation accuracy: 26.1532
[2024-03-08 15:40:56,352 INFO] Saving checkpoint tg-enc/tg_01_step_1600.pt
[2024-03-08 15:40:59,318 INFO] Step 1650/10000; acc: 36.7; ppl:  25.2; xent: 3.2; lr: 1.00000; sents:    2376; bsz:  564/ 490/48; 5643/4903 tok/s;    111 sec;
[2024-03-08 15:41:01,778 INFO] Step 1700/10000; acc: 37.1; ppl:  23.5; xent: 3.2; lr: 1.00000; sents:    2376; bsz:  568/ 496/48; 11553/10081 tok/s;    113 sec;
[2024-03-08 15:41:04,695 INFO] Step 1750/10000; acc: 38.0; ppl:  21.7; xent: 3.1; lr: 1.00000; sents:    2368; bsz:  589/ 512/47; 10101/8782 tok/s;    116 sec;
[2024-03-08 15:41:07,628 INFO] Step 1800/10000; acc: 40.2; ppl:  18.1; xent: 2.9; lr: 1.00000; sents:    2270; bsz:  563/ 487/45; 9596/8305 tok/s;    119 sec;
[2024-03-08 15:41:09,621 INFO] valid stats calculation
                           took: 1.9924938678741455 s.
[2024-03-08 15:41:09,622 INFO] Train perplexity: 128.877
[2024-03-08 15:41:09,622 INFO] Train accuracy: 22.9596
[2024-03-08 15:41:09,622 INFO] Sentences processed: 84132
[2024-03-08 15:41:09,622 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:41:09,622 INFO] Validation perplexity: 276.873
[2024-03-08 15:41:09,622 INFO] Validation accuracy: 24.1476
[2024-03-08 15:41:09,622 INFO] Saving checkpoint tg-enc/tg_01_step_1800.pt
[2024-03-08 15:41:12,502 INFO] Step 1850/10000; acc: 42.8; ppl:  15.2; xent: 2.7; lr: 1.00000; sents:    2369; bsz:  566/ 492/47; 5812/5047 tok/s;    124 sec;
[2024-03-08 15:41:14,898 INFO] Step 1900/10000; acc: 44.3; ppl:  14.0; xent: 2.6; lr: 1.00000; sents:    2242; bsz:  547/ 474/45; 11418/9882 tok/s;    126 sec;
[2024-03-08 15:41:17,727 INFO] Step 1950/10000; acc: 44.9; ppl:  13.2; xent: 2.6; lr: 1.00000; sents:    2365; bsz:  585/ 508/47; 10347/8977 tok/s;    129 sec;
[2024-03-08 15:41:20,651 INFO] Step 2000/10000; acc: 47.7; ppl:  10.8; xent: 2.4; lr: 1.00000; sents:    2258; bsz:  553/ 479/45; 9455/8187 tok/s;    132 sec;
[2024-03-08 15:41:22,658 INFO] valid stats calculation
                           took: 2.0059585571289062 s.
[2024-03-08 15:41:22,658 INFO] Train perplexity: 102.864
[2024-03-08 15:41:22,658 INFO] Train accuracy: 25.1311
[2024-03-08 15:41:22,658 INFO] Sentences processed: 93366
[2024-03-08 15:41:22,658 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:41:22,658 INFO] Validation perplexity: 391.062
[2024-03-08 15:41:22,658 INFO] Validation accuracy: 24.3883
[2024-03-08 15:41:22,659 INFO] Saving checkpoint tg-enc/tg_01_step_2000.pt
[2024-03-08 15:41:25,586 INFO] Step 2050/10000; acc: 49.8; ppl:   9.6; xent: 2.3; lr: 1.00000; sents:    2481; bsz:  590/ 514/50; 5982/5208 tok/s;    137 sec;
[2024-03-08 15:41:28,193 INFO] Step 2100/10000; acc: 51.7; ppl:   8.3; xent: 2.1; lr: 1.00000; sents:    2275; bsz:  562/ 487/46; 10779/9347 tok/s;    140 sec;
[2024-03-08 15:41:30,995 INFO] Step 2150/10000; acc: 53.4; ppl:   7.5; xent: 2.0; lr: 1.00000; sents:    2383; bsz:  567/ 495/48; 10124/8829 tok/s;    142 sec;
[2024-03-08 15:41:33,937 INFO] Step 2200/10000; acc: 55.6; ppl:   6.6; xent: 1.9; lr: 1.00000; sents:    2267; bsz:  555/ 481/45; 9429/8168 tok/s;    145 sec;
[2024-03-08 15:41:35,923 INFO] valid stats calculation
                           took: 1.9847359657287598 s.
[2024-03-08 15:41:35,923 INFO] Train perplexity: 81.501
[2024-03-08 15:41:35,923 INFO] Train accuracy: 27.6273
[2024-03-08 15:41:35,923 INFO] Sentences processed: 102772
[2024-03-08 15:41:35,923 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:41:35,923 INFO] Validation perplexity: 626.974
[2024-03-08 15:41:35,923 INFO] Validation accuracy: 24.7894
[2024-03-08 15:41:35,924 INFO] Saving checkpoint tg-enc/tg_01_step_2200.pt
[2024-03-08 15:41:38,881 INFO] Step 2250/10000; acc: 56.5; ppl:   6.2; xent: 1.8; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 5852/5056 tok/s;    150 sec;
[2024-03-08 15:41:41,512 INFO] Step 2300/10000; acc: 58.3; ppl:   5.5; xent: 1.7; lr: 1.00000; sents:    2275; bsz:  567/ 492/46; 10782/9342 tok/s;    153 sec;
[2024-03-08 15:41:44,249 INFO] Step 2350/10000; acc: 59.8; ppl:   5.2; xent: 1.6; lr: 1.00000; sents:    2463; bsz:  586/ 519/49; 10706/9479 tok/s;    156 sec;
[2024-03-08 15:41:47,206 INFO] Step 2400/10000; acc: 62.5; ppl:   4.5; xent: 1.5; lr: 1.00000; sents:    2271; bsz:  568/ 493/45; 9611/8343 tok/s;    159 sec;
[2024-03-08 15:41:49,229 INFO] valid stats calculation
                           took: 2.022516965866089 s.
[2024-03-08 15:41:49,229 INFO] Train perplexity: 64.7166
[2024-03-08 15:41:49,229 INFO] Train accuracy: 30.2997
[2024-03-08 15:41:49,229 INFO] Sentences processed: 112156
[2024-03-08 15:41:49,229 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:41:49,229 INFO] Validation perplexity: 880.797
[2024-03-08 15:41:49,229 INFO] Validation accuracy: 23.3454
[2024-03-08 15:41:49,230 INFO] Saving checkpoint tg-enc/tg_01_step_2400.pt
[2024-03-08 15:41:52,174 INFO] Step 2450/10000; acc: 64.0; ppl:   4.2; xent: 1.4; lr: 1.00000; sents:    2260; bsz:  555/ 480/45; 5590/4836 tok/s;    164 sec;
[2024-03-08 15:41:54,719 INFO] Step 2500/10000; acc: 65.4; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    2367; bsz:  571/ 492/47; 11219/9671 tok/s;    166 sec;
[2024-03-08 15:41:57,314 INFO] Step 2550/10000; acc: 67.7; ppl:   3.5; xent: 1.2; lr: 1.00000; sents:    2365; bsz:  562/ 489/47; 10820/9422 tok/s;    169 sec;
[2024-03-08 15:42:00,296 INFO] Step 2600/10000; acc: 68.0; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    2373; bsz:  582/ 507/47; 9755/8499 tok/s;    172 sec;
[2024-03-08 15:42:02,295 INFO] valid stats calculation
                           took: 1.9986357688903809 s.
[2024-03-08 15:42:02,296 INFO] Train perplexity: 51.9901
[2024-03-08 15:42:02,296 INFO] Train accuracy: 33.0592
[2024-03-08 15:42:02,296 INFO] Sentences processed: 121521
[2024-03-08 15:42:02,296 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:42:02,296 INFO] Validation perplexity: 1146.65
[2024-03-08 15:42:02,296 INFO] Validation accuracy: 25.2306
[2024-03-08 15:42:02,296 INFO] Saving checkpoint tg-enc/tg_01_step_2600.pt
[2024-03-08 15:42:05,323 INFO] Step 2650/10000; acc: 70.3; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    2275; bsz:  562/ 486/46; 5594/4830 tok/s;    177 sec;
[2024-03-08 15:42:08,129 INFO] Step 2700/10000; acc: 71.3; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    2375; bsz:  565/ 494/48; 10066/8809 tok/s;    179 sec;
[2024-03-08 15:42:10,773 INFO] Step 2750/10000; acc: 72.5; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    2381; bsz:  579/ 499/48; 10954/9444 tok/s;    182 sec;
[2024-03-08 15:42:13,721 INFO] Step 2800/10000; acc: 73.8; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    2276; bsz:  548/ 477/46; 9302/8092 tok/s;    185 sec;
[2024-03-08 15:42:15,722 INFO] valid stats calculation
                           took: 2.001497745513916 s.
[2024-03-08 15:42:15,723 INFO] Train perplexity: 42.3701
[2024-03-08 15:42:15,723 INFO] Train accuracy: 35.8106
[2024-03-08 15:42:15,723 INFO] Sentences processed: 130828
[2024-03-08 15:42:15,723 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:42:15,723 INFO] Validation perplexity: 1620.92
[2024-03-08 15:42:15,723 INFO] Validation accuracy: 25.8724
[2024-03-08 15:42:15,723 INFO] Saving checkpoint tg-enc/tg_01_step_2800.pt
[2024-03-08 15:42:18,663 INFO] Step 2850/10000; acc: 74.6; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2375; bsz:  579/ 499/48; 5858/5044 tok/s;    190 sec;
[2024-03-08 15:42:21,492 INFO] Step 2900/10000; acc: 75.1; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 10357/8977 tok/s;    193 sec;
[2024-03-08 15:42:24,041 INFO] Step 2950/10000; acc: 76.9; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2366; bsz:  564/ 489/47; 11060/9604 tok/s;    195 sec;
[2024-03-08 15:42:27,019 INFO] Step 3000/10000; acc: 77.1; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 9459/8200 tok/s;    198 sec;
[2024-03-08 15:42:29,018 INFO] valid stats calculation
                           took: 1.9986822605133057 s.
[2024-03-08 15:42:29,019 INFO] Train perplexity: 34.9658
[2024-03-08 15:42:29,019 INFO] Train accuracy: 38.4973
[2024-03-08 15:42:29,019 INFO] Sentences processed: 140208
[2024-03-08 15:42:29,019 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:42:29,019 INFO] Validation perplexity: 1799.72
[2024-03-08 15:42:29,019 INFO] Validation accuracy: 27.0357
[2024-03-08 15:42:29,019 INFO] Saving checkpoint tg-enc/tg_01_step_3000.pt
[2024-03-08 15:42:31,906 INFO] Step 3050/10000; acc: 78.9; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2362; bsz:  562/ 488/47; 5753/4994 tok/s;    203 sec;
[2024-03-08 15:42:34,776 INFO] Step 3100/10000; acc: 78.7; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2267; bsz:  577/ 495/45; 10061/8622 tok/s;    206 sec;
[2024-03-08 15:42:37,261 INFO] Step 3150/10000; acc: 79.8; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2369; bsz:  563/ 489/47; 11342/9843 tok/s;    209 sec;
[2024-03-08 15:42:40,195 INFO] Step 3200/10000; acc: 80.4; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2372; bsz:  566/ 494/47; 9645/8416 tok/s;    212 sec;
[2024-03-08 15:42:42,188 INFO] valid stats calculation
                           took: 1.992884874343872 s.
[2024-03-08 15:42:42,189 INFO] Train perplexity: 29.3411
[2024-03-08 15:42:42,189 INFO] Train accuracy: 41.0441
[2024-03-08 15:42:42,189 INFO] Sentences processed: 149578
[2024-03-08 15:42:42,189 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:42:42,189 INFO] Validation perplexity: 2070.19
[2024-03-08 15:42:42,189 INFO] Validation accuracy: 26.3939
[2024-03-08 15:42:42,189 INFO] Saving checkpoint tg-enc/tg_01_step_3200.pt
[2024-03-08 15:42:45,295 INFO] Step 3250/10000; acc: 80.6; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2269; bsz:  576/ 495/45; 5645/4857 tok/s;    217 sec;
[2024-03-08 15:42:48,081 INFO] Step 3300/10000; acc: 82.3; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2375; bsz:  565/ 492/48; 10145/8836 tok/s;    219 sec;
[2024-03-08 15:42:50,708 INFO] Step 3350/10000; acc: 81.6; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2382; bsz:  589/ 510/48; 11206/9713 tok/s;    222 sec;
[2024-03-08 15:42:53,679 INFO] Step 3400/10000; acc: 82.9; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2376; bsz:  569/ 497/48; 9582/8368 tok/s;    225 sec;
[2024-03-08 15:42:55,669 INFO] valid stats calculation
                           took: 1.989797830581665 s.
[2024-03-08 15:42:55,670 INFO] Train perplexity: 24.9357
[2024-03-08 15:42:55,670 INFO] Train accuracy: 43.4668
[2024-03-08 15:42:55,670 INFO] Sentences processed: 158980
[2024-03-08 15:42:55,670 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:42:55,670 INFO] Validation perplexity: 3128.29
[2024-03-08 15:42:55,670 INFO] Validation accuracy: 26.1532
[2024-03-08 15:42:55,671 INFO] Saving checkpoint tg-enc/tg_01_step_3400.pt
[2024-03-08 15:42:58,673 INFO] Step 3450/10000; acc: 83.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2280; bsz:  565/ 490/46; 5659/4909 tok/s;    230 sec;
[2024-03-08 15:43:01,599 INFO] Step 3500/10000; acc: 83.7; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2247; bsz:  550/ 477/45; 9392/8144 tok/s;    233 sec;
[2024-03-08 15:43:04,159 INFO] Step 3550/10000; acc: 84.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2367; bsz:  586/ 506/47; 11437/9876 tok/s;    236 sec;
[2024-03-08 15:43:07,028 INFO] Step 3600/10000; acc: 85.0; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2368; bsz:  567/ 493/47; 9879/8597 tok/s;    238 sec;
[2024-03-08 15:43:09,021 INFO] valid stats calculation
                           took: 1.9923884868621826 s.
[2024-03-08 15:43:09,021 INFO] Train perplexity: 21.5241
[2024-03-08 15:43:09,021 INFO] Train accuracy: 45.7154
[2024-03-08 15:43:09,021 INFO] Sentences processed: 168242
[2024-03-08 15:43:09,021 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:43:09,022 INFO] Validation perplexity: 4528.37
[2024-03-08 15:43:09,022 INFO] Validation accuracy: 25.8724
[2024-03-08 15:43:09,022 INFO] Saving checkpoint tg-enc/tg_01_step_3600.pt
[2024-03-08 15:43:11,965 INFO] Step 3650/10000; acc: 85.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2249; bsz:  551/ 478/45; 5581/4845 tok/s;    243 sec;
[2024-03-08 15:43:14,914 INFO] Step 3700/10000; acc: 85.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2365; bsz:  578/ 500/47; 9796/8471 tok/s;    246 sec;
[2024-03-08 15:43:17,363 INFO] Step 3750/10000; acc: 86.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2372; bsz:  566/ 492/47; 11552/10042 tok/s;    249 sec;
[2024-03-08 15:43:20,333 INFO] Step 3800/10000; acc: 86.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2274; bsz:  563/ 490/45; 9475/8240 tok/s;    252 sec;
[2024-03-08 15:43:22,360 INFO] valid stats calculation
                           took: 2.026078939437866 s.
[2024-03-08 15:43:22,360 INFO] Train perplexity: 18.8059
[2024-03-08 15:43:22,360 INFO] Train accuracy: 47.824
[2024-03-08 15:43:22,360 INFO] Sentences processed: 177502
[2024-03-08 15:43:22,361 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:43:22,361 INFO] Validation perplexity: 4649.52
[2024-03-08 15:43:22,361 INFO] Validation accuracy: 25.712
[2024-03-08 15:43:22,361 INFO] Saving checkpoint tg-enc/tg_01_step_3800.pt
[2024-03-08 15:43:25,333 INFO] Step 3850/10000; acc: 87.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2482; bsz:  589/ 517/50; 5892/5172 tok/s;    257 sec;
[2024-03-08 15:43:28,276 INFO] Step 3900/10000; acc: 87.3; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2274; bsz:  555/ 478/45; 9435/8128 tok/s;    260 sec;
[2024-03-08 15:43:30,699 INFO] Step 3950/10000; acc: 87.2; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2376; bsz:  583/ 509/48; 12038/10497 tok/s;    262 sec;
[2024-03-08 15:43:33,624 INFO] Step 4000/10000; acc: 87.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2278; bsz:  548/ 473/46; 9365/8095 tok/s;    265 sec;
[2024-03-08 15:43:35,641 INFO] valid stats calculation
                           took: 2.0170648097991943 s.
[2024-03-08 15:43:35,642 INFO] Train perplexity: 16.5984
[2024-03-08 15:43:35,642 INFO] Train accuracy: 49.7995
[2024-03-08 15:43:35,642 INFO] Sentences processed: 186912
[2024-03-08 15:43:35,642 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:43:35,642 INFO] Validation perplexity: 5985.67
[2024-03-08 15:43:35,642 INFO] Validation accuracy: 25.2708
[2024-03-08 15:43:35,643 INFO] Saving checkpoint tg-enc/tg_01_step_4000.pt
[2024-03-08 15:43:38,644 INFO] Step 4050/10000; acc: 87.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2372; bsz:  587/ 515/47; 5849/5131 tok/s;    270 sec;
[2024-03-08 15:43:41,583 INFO] Step 4100/10000; acc: 88.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2367; bsz:  563/ 489/47; 9573/8319 tok/s;    273 sec;
[2024-03-08 15:43:44,137 INFO] Step 4150/10000; acc: 88.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2367; bsz:  576/ 496/47; 11268/9709 tok/s;    275 sec;
[2024-03-08 15:43:46,974 INFO] Step 4200/10000; acc: 88.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2260; bsz:  554/ 481/45; 9759/8472 tok/s;    278 sec;
[2024-03-08 15:43:48,959 INFO] valid stats calculation
                           took: 1.9842925071716309 s.
[2024-03-08 15:43:48,959 INFO] Train perplexity: 14.7984
[2024-03-08 15:43:48,959 INFO] Train accuracy: 51.6361
[2024-03-08 15:43:48,959 INFO] Sentences processed: 196278
[2024-03-08 15:43:48,959 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:43:48,959 INFO] Validation perplexity: 7074.26
[2024-03-08 15:43:48,959 INFO] Validation accuracy: 26.4741
[2024-03-08 15:43:48,960 INFO] Saving checkpoint tg-enc/tg_01_step_4200.pt
[2024-03-08 15:43:51,869 INFO] Step 4250/10000; acc: 88.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2268; bsz:  558/ 481/45; 5697/4918 tok/s;    283 sec;
[2024-03-08 15:43:54,799 INFO] Step 4300/10000; acc: 89.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2464; bsz:  586/ 516/49; 9996/8806 tok/s;    286 sec;
[2024-03-08 15:43:57,420 INFO] Step 4350/10000; acc: 89.5; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2276; bsz:  562/ 486/46; 10718/9266 tok/s;    289 sec;
[2024-03-08 15:44:00,340 INFO] Step 4400/10000; acc: 89.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2372; bsz:  565/ 491/47; 9681/8407 tok/s;    292 sec;
[2024-03-08 15:44:02,376 INFO] valid stats calculation
                           took: 2.0349998474121094 s.
[2024-03-08 15:44:02,376 INFO] Train perplexity: 13.3175
[2024-03-08 15:44:02,376 INFO] Train accuracy: 53.3447
[2024-03-08 15:44:02,376 INFO] Sentences processed: 205658
[2024-03-08 15:44:02,376 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:44:02,376 INFO] Validation perplexity: 7042.39
[2024-03-08 15:44:02,376 INFO] Validation accuracy: 26.1532
[2024-03-08 15:44:02,377 INFO] Saving checkpoint tg-enc/tg_01_step_4400.pt
[2024-03-08 15:44:05,484 INFO] Step 4450/10000; acc: 89.3; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2274; bsz:  578/ 496/45; 5620/4823 tok/s;    297 sec;
[2024-03-08 15:44:08,400 INFO] Step 4500/10000; acc: 89.5; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2382; bsz:  561/ 487/48; 9619/8359 tok/s;    300 sec;
[2024-03-08 15:44:10,954 INFO] Step 4550/10000; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  567/ 491/48; 11103/9618 tok/s;    302 sec;
[2024-03-08 15:44:13,835 INFO] Step 4600/10000; acc: 89.8; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  586/ 508/48; 10181/8823 tok/s;    305 sec;
[2024-03-08 15:44:15,797 INFO] valid stats calculation
                           took: 1.9624502658843994 s.
[2024-03-08 15:44:15,798 INFO] Train perplexity: 12.0824
[2024-03-08 15:44:15,798 INFO] Train accuracy: 54.9296
[2024-03-08 15:44:15,798 INFO] Sentences processed: 215065
[2024-03-08 15:44:15,798 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:44:15,798 INFO] Validation perplexity: 7442.26
[2024-03-08 15:44:15,798 INFO] Validation accuracy: 27.3165
[2024-03-08 15:44:15,798 INFO] Saving checkpoint tg-enc/tg_01_step_4600.pt
[2024-03-08 15:44:18,966 INFO] Step 4650/10000; acc: 89.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2273; bsz:  564/ 489/45; 5500/4764 tok/s;    310 sec;
[2024-03-08 15:44:21,889 INFO] Step 4700/10000; acc: 90.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  563/ 489/47; 9628/8370 tok/s;    313 sec;
[2024-03-08 15:44:24,466 INFO] Step 4750/10000; acc: 90.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  579/ 499/47; 11239/9689 tok/s;    316 sec;
[2024-03-08 15:44:27,215 INFO] Step 4800/10000; acc: 89.9; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 10189/8787 tok/s;    319 sec;
[2024-03-08 15:44:29,198 INFO] valid stats calculation
                           took: 1.98295259475708 s.
[2024-03-08 15:44:29,199 INFO] Train perplexity: 11.0552
[2024-03-08 15:44:29,199 INFO] Train accuracy: 56.3785
[2024-03-08 15:44:29,199 INFO] Sentences processed: 224332
[2024-03-08 15:44:29,199 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:44:29,199 INFO] Validation perplexity: 8546.22
[2024-03-08 15:44:29,199 INFO] Validation accuracy: 27.1159
[2024-03-08 15:44:29,199 INFO] Saving checkpoint tg-enc/tg_01_step_4800.pt
[2024-03-08 15:44:32,174 INFO] Step 4850/10000; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2267; bsz:  560/ 486/45; 5649/4900 tok/s;    324 sec;
[2024-03-08 15:44:35,008 INFO] Step 4900/10000; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  564/ 493/47; 9952/8692 tok/s;    326 sec;
[2024-03-08 15:44:37,785 INFO] Step 4950/10000; acc: 90.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  582/ 503/47; 10476/9065 tok/s;    329 sec;
[2024-03-08 15:44:40,515 INFO] Step 5000/10000; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2257; bsz:  556/ 481/45; 10191/8813 tok/s;    332 sec;
[2024-03-08 15:44:42,523 INFO] valid stats calculation
                           took: 2.007218599319458 s.
[2024-03-08 15:44:42,523 INFO] Train perplexity: 10.1795
[2024-03-08 15:44:42,523 INFO] Train accuracy: 57.733
[2024-03-08 15:44:42,523 INFO] Sentences processed: 233595
[2024-03-08 15:44:42,523 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:44:42,523 INFO] Validation perplexity: 8993.06
[2024-03-08 15:44:42,523 INFO] Validation accuracy: 27.4769
[2024-03-08 15:44:42,524 INFO] Saving checkpoint tg-enc/tg_01_step_5000.pt
[2024-03-08 15:44:45,513 INFO] Step 5050/10000; acc: 90.5; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2384; bsz:  592/ 514/48; 5924/5140 tok/s;    337 sec;
[2024-03-08 15:44:48,442 INFO] Step 5100/10000; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2384; bsz:  570/ 497/48; 9735/8494 tok/s;    340 sec;
[2024-03-08 15:44:51,216 INFO] Step 5150/10000; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2378; bsz:  586/ 507/48; 10554/9145 tok/s;    343 sec;
[2024-03-08 15:44:53,828 INFO] Step 5200/10000; acc: 91.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  570/ 496/48; 10918/9499 tok/s;    345 sec;
[2024-03-08 15:44:55,829 INFO] valid stats calculation
                           took: 2.0000009536743164 s.
[2024-03-08 15:44:55,829 INFO] Train perplexity: 9.41005
[2024-03-08 15:44:55,829 INFO] Train accuracy: 59.0295
[2024-03-08 15:44:55,829 INFO] Sentences processed: 243122
[2024-03-08 15:44:55,829 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:44:55,829 INFO] Validation perplexity: 8776.02
[2024-03-08 15:44:55,829 INFO] Validation accuracy: 28.199
[2024-03-08 15:44:55,830 INFO] Saving checkpoint tg-enc/tg_01_step_5200.pt
[2024-03-08 15:44:58,740 INFO] Step 5250/10000; acc: 91.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2247; bsz:  551/ 476/45; 5611/4849 tok/s;    350 sec;
[2024-03-08 15:45:01,659 INFO] Step 5300/10000; acc: 91.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2253; bsz:  552/ 479/45; 9462/8202 tok/s;    353 sec;
[2024-03-08 15:45:04,407 INFO] Step 5350/10000; acc: 91.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2364; bsz:  562/ 489/47; 10226/8899 tok/s;    356 sec;
[2024-03-08 15:45:07,002 INFO] Step 5400/10000; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  579/ 500/47; 11155/9633 tok/s;    358 sec;
[2024-03-08 15:45:08,980 INFO] valid stats calculation
                           took: 1.9782979488372803 s.
[2024-03-08 15:45:08,981 INFO] Train perplexity: 8.77035
[2024-03-08 15:45:08,981 INFO] Train accuracy: 60.1974
[2024-03-08 15:45:08,981 INFO] Sentences processed: 252353
[2024-03-08 15:45:08,981 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:45:08,981 INFO] Validation perplexity: 8693.14
[2024-03-08 15:45:08,981 INFO] Validation accuracy: 27.1961
[2024-03-08 15:45:08,981 INFO] Saving checkpoint tg-enc/tg_01_step_5400.pt
[2024-03-08 15:45:11,979 INFO] Step 5450/10000; acc: 90.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2269; bsz:  567/ 493/45; 5700/4951 tok/s;    363 sec;
[2024-03-08 15:45:14,861 INFO] Step 5500/10000; acc: 91.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2468; bsz:  588/ 519/49; 10200/9004 tok/s;    366 sec;
[2024-03-08 15:45:17,781 INFO] Step 5550/10000; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2274; bsz:  560/ 485/45; 9590/8311 tok/s;    369 sec;
[2024-03-08 15:45:20,281 INFO] Step 5600/10000; acc: 91.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  574/ 498/48; 11490/9968 tok/s;    372 sec;
[2024-03-08 15:45:22,250 INFO] valid stats calculation
                           took: 1.968675136566162 s.
[2024-03-08 15:45:22,251 INFO] Train perplexity: 8.20008
[2024-03-08 15:45:22,251 INFO] Train accuracy: 61.3088
[2024-03-08 15:45:22,251 INFO] Sentences processed: 261739
[2024-03-08 15:45:22,251 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:45:22,251 INFO] Validation perplexity: 10979.1
[2024-03-08 15:45:22,251 INFO] Validation accuracy: 26.795
[2024-03-08 15:45:22,251 INFO] Saving checkpoint tg-enc/tg_01_step_5600.pt
[2024-03-08 15:45:25,167 INFO] Step 5650/10000; acc: 91.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  565/ 494/48; 5785/5051 tok/s;    377 sec;
[2024-03-08 15:45:28,165 INFO] Step 5700/10000; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2277; bsz:  568/ 492/46; 9469/8203 tok/s;    380 sec;
[2024-03-08 15:45:31,048 INFO] Step 5750/10000; acc: 91.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  565/ 491/48; 9803/8525 tok/s;    382 sec;
[2024-03-08 15:45:33,570 INFO] Step 5800/10000; acc: 91.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  579/ 502/47; 11480/9951 tok/s;    385 sec;
[2024-03-08 15:45:35,592 INFO] valid stats calculation
                           took: 2.021660804748535 s.
[2024-03-08 15:45:35,593 INFO] Train perplexity: 7.70605
[2024-03-08 15:45:35,593 INFO] Train accuracy: 62.3396
[2024-03-08 15:45:35,593 INFO] Sentences processed: 271146
[2024-03-08 15:45:35,593 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:45:35,593 INFO] Validation perplexity: 12125.9
[2024-03-08 15:45:35,593 INFO] Validation accuracy: 26.2335
[2024-03-08 15:45:35,593 INFO] Saving checkpoint tg-enc/tg_01_step_5800.pt
[2024-03-08 15:45:38,533 INFO] Step 5850/10000; acc: 91.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2264; bsz:  558/ 478/45; 5618/4819 tok/s;    390 sec;
[2024-03-08 15:45:41,408 INFO] Step 5900/10000; acc: 91.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2266; bsz:  559/ 483/45; 9720/8399 tok/s;    393 sec;
[2024-03-08 15:45:44,294 INFO] Step 5950/10000; acc: 91.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2364; bsz:  575/ 503/47; 9968/8709 tok/s;    396 sec;
[2024-03-08 15:45:46,795 INFO] Step 6000/10000; acc: 91.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2368; bsz:  565/ 493/47; 11294/9862 tok/s;    398 sec;
[2024-03-08 15:45:48,768 INFO] valid stats calculation
                           took: 1.9715423583984375 s.
[2024-03-08 15:45:48,768 INFO] Train perplexity: 7.27401
[2024-03-08 15:45:48,768 INFO] Train accuracy: 63.2967
[2024-03-08 15:45:48,768 INFO] Sentences processed: 280408
[2024-03-08 15:45:48,768 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:45:48,768 INFO] Validation perplexity: 13841.7
[2024-03-08 15:45:48,768 INFO] Validation accuracy: 26.1532
[2024-03-08 15:45:48,769 INFO] Saving checkpoint tg-enc/tg_01_step_6000.pt
[2024-03-08 15:45:51,773 INFO] Step 6050/10000; acc: 91.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  585/ 506/47; 5880/5082 tok/s;    403 sec;
[2024-03-08 15:45:54,678 INFO] Step 6100/10000; acc: 91.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2273; bsz:  545/ 474/45; 9387/8167 tok/s;    406 sec;
[2024-03-08 15:45:57,643 INFO] Step 6150/10000; acc: 91.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2371; bsz:  583/ 503/47; 9835/8475 tok/s;    409 sec;
[2024-03-08 15:46:00,148 INFO] Step 6200/10000; acc: 91.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  560/ 485/48; 11169/9685 tok/s;    411 sec;
[2024-03-08 15:46:02,215 INFO] valid stats calculation
                           took: 2.0663092136383057 s.
[2024-03-08 15:46:02,215 INFO] Train perplexity: 6.89062
[2024-03-08 15:46:02,215 INFO] Train accuracy: 64.1966
[2024-03-08 15:46:02,215 INFO] Sentences processed: 289794
[2024-03-08 15:46:02,215 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:46:02,215 INFO] Validation perplexity: 12737.1
[2024-03-08 15:46:02,215 INFO] Validation accuracy: 27.2363
[2024-03-08 15:46:02,216 INFO] Saving checkpoint tg-enc/tg_01_step_6200.pt
[2024-03-08 15:46:05,301 INFO] Step 6250/10000; acc: 91.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2282; bsz:  586/ 505/46; 5689/4902 tok/s;    417 sec;
[2024-03-08 15:46:08,196 INFO] Step 6300/10000; acc: 92.1; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  563/ 490/48; 9720/8458 tok/s;    420 sec;
[2024-03-08 15:46:11,156 INFO] Step 6350/10000; acc: 91.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2274; bsz:  560/ 484/45; 9459/8174 tok/s;    422 sec;
[2024-03-08 15:46:13,734 INFO] Step 6400/10000; acc: 91.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2474; bsz:  583/ 508/49; 11314/9846 tok/s;    425 sec;
[2024-03-08 15:46:15,695 INFO] valid stats calculation
                           took: 1.9611966609954834 s.
[2024-03-08 15:46:15,696 INFO] Train perplexity: 6.5446
[2024-03-08 15:46:15,696 INFO] Train accuracy: 65.0573
[2024-03-08 15:46:15,696 INFO] Sentences processed: 299200
[2024-03-08 15:46:15,696 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:46:15,696 INFO] Validation perplexity: 14032.6
[2024-03-08 15:46:15,696 INFO] Validation accuracy: 27.0357
[2024-03-08 15:46:15,696 INFO] Saving checkpoint tg-enc/tg_01_step_6400.pt
[2024-03-08 15:46:18,671 INFO] Step 6450/10000; acc: 91.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2260; bsz:  559/ 482/45; 5661/4880 tok/s;    430 sec;
[2024-03-08 15:46:21,658 INFO] Step 6500/10000; acc: 91.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2273; bsz:  565/ 490/45; 9461/8195 tok/s;    433 sec;
[2024-03-08 15:46:24,537 INFO] Step 6550/10000; acc: 91.2; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2461; bsz:  590/ 516/49; 10256/8957 tok/s;    436 sec;
[2024-03-08 15:46:27,132 INFO] Step 6600/10000; acc: 91.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2267; bsz:  558/ 483/45; 10746/9304 tok/s;    438 sec;
[2024-03-08 15:46:29,118 INFO] valid stats calculation
                           took: 1.9854955673217773 s.
[2024-03-08 15:46:29,118 INFO] Train perplexity: 6.23804
[2024-03-08 15:46:29,118 INFO] Train accuracy: 65.8556
[2024-03-08 15:46:29,118 INFO] Sentences processed: 308461
[2024-03-08 15:46:29,118 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:46:29,118 INFO] Validation perplexity: 11209.3
[2024-03-08 15:46:29,118 INFO] Validation accuracy: 27.5973
[2024-03-08 15:46:29,119 INFO] Saving checkpoint tg-enc/tg_01_step_6600.pt
[2024-03-08 15:46:32,106 INFO] Step 6650/10000; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  587/ 510/47; 5896/5122 tok/s;    443 sec;
[2024-03-08 15:46:35,065 INFO] Step 6700/10000; acc: 91.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  566/ 491/47; 9563/8297 tok/s;    446 sec;
[2024-03-08 15:46:38,113 INFO] Step 6750/10000; acc: 91.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2257; bsz:  553/ 480/45; 9072/7873 tok/s;    449 sec;
[2024-03-08 15:46:40,840 INFO] Step 6800/10000; acc: 90.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2384; bsz:  587/ 510/48; 10771/9355 tok/s;    452 sec;
[2024-03-08 15:46:42,892 INFO] valid stats calculation
                           took: 2.051438808441162 s.
[2024-03-08 15:46:42,892 INFO] Train perplexity: 5.96423
[2024-03-08 15:46:42,893 INFO] Train accuracy: 66.5974
[2024-03-08 15:46:42,893 INFO] Sentences processed: 317841
[2024-03-08 15:46:42,893 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:46:42,893 INFO] Validation perplexity: 12864.2
[2024-03-08 15:46:42,893 INFO] Validation accuracy: 27.156
[2024-03-08 15:46:42,893 INFO] Saving checkpoint tg-enc/tg_01_step_6800.pt
[2024-03-08 15:46:45,847 INFO] Step 6850/10000; acc: 91.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2277; bsz:  542/ 471/46; 5417/4706 tok/s;    457 sec;
[2024-03-08 15:46:48,809 INFO] Step 6900/10000; acc: 91.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  584/ 506/48; 9862/8542 tok/s;    460 sec;
[2024-03-08 15:46:51,702 INFO] Step 6950/10000; acc: 91.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2258; bsz:  553/ 478/45; 9559/8271 tok/s;    463 sec;
[2024-03-08 15:46:54,403 INFO] Step 7000/10000; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  563/ 490/47; 10417/9067 tok/s;    466 sec;
[2024-03-08 15:46:56,442 INFO] valid stats calculation
                           took: 2.0384857654571533 s.
[2024-03-08 15:46:56,442 INFO] Train perplexity: 5.72218
[2024-03-08 15:46:56,443 INFO] Train accuracy: 67.2853
[2024-03-08 15:46:56,443 INFO] Sentences processed: 327117
[2024-03-08 15:46:56,443 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:46:56,443 INFO] Validation perplexity: 13373.8
[2024-03-08 15:46:56,443 INFO] Validation accuracy: 26.5544
[2024-03-08 15:46:56,443 INFO] Saving checkpoint tg-enc/tg_01_step_7000.pt
[2024-03-08 15:46:59,424 INFO] Step 7050/10000; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  578/ 500/47; 5755/4978 tok/s;    471 sec;
[2024-03-08 15:47:02,368 INFO] Step 7100/10000; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2364; bsz:  587/ 513/47; 9974/8715 tok/s;    474 sec;
[2024-03-08 15:47:05,312 INFO] Step 7150/10000; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  567/ 499/47; 9639/8472 tok/s;    477 sec;
[2024-03-08 15:47:08,091 INFO] Step 7200/10000; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2269; bsz:  567/ 491/45; 10193/8824 tok/s;    479 sec;
[2024-03-08 15:47:10,122 INFO] valid stats calculation
                           took: 2.0301434993743896 s.
[2024-03-08 15:47:10,122 INFO] Train perplexity: 5.4987
[2024-03-08 15:47:10,122 INFO] Train accuracy: 67.9389
[2024-03-08 15:47:10,122 INFO] Sentences processed: 336484
[2024-03-08 15:47:10,122 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:47:10,122 INFO] Validation perplexity: 17289.1
[2024-03-08 15:47:10,122 INFO] Validation accuracy: 25.9126
[2024-03-08 15:47:10,123 INFO] Saving checkpoint tg-enc/tg_01_step_7200.pt
[2024-03-08 15:47:13,036 INFO] Step 7250/10000; acc: 90.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  575/ 499/47; 5814/5044 tok/s;    484 sec;
[2024-03-08 15:47:15,967 INFO] Step 7300/10000; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2268; bsz:  557/ 482/45; 9493/8222 tok/s;    487 sec;
[2024-03-08 15:47:18,913 INFO] Step 7350/10000; acc: 90.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  564/ 492/48; 9581/8349 tok/s;    490 sec;
[2024-03-08 15:47:21,667 INFO] Step 7400/10000; acc: 90.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  566/ 495/48; 10271/8983 tok/s;    493 sec;
[2024-03-08 15:47:23,711 INFO] valid stats calculation
                           took: 2.043997049331665 s.
[2024-03-08 15:47:23,712 INFO] Train perplexity: 5.29841
[2024-03-08 15:47:23,712 INFO] Train accuracy: 68.5456
[2024-03-08 15:47:23,712 INFO] Sentences processed: 345881
[2024-03-08 15:47:23,712 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:47:23,712 INFO] Validation perplexity: 11048.5
[2024-03-08 15:47:23,712 INFO] Validation accuracy: 27.3566
[2024-03-08 15:47:23,712 INFO] Saving checkpoint tg-enc/tg_01_step_7400.pt
[2024-03-08 15:47:26,834 INFO] Step 7450/10000; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2279; bsz:  562/ 485/46; 5440/4694 tok/s;    498 sec;
[2024-03-08 15:47:29,788 INFO] Step 7500/10000; acc: 90.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  581/ 504/48; 9830/8535 tok/s;    501 sec;
[2024-03-08 15:47:32,735 INFO] Step 7550/10000; acc: 90.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2371; bsz:  578/ 497/47; 9803/8436 tok/s;    504 sec;
[2024-03-08 15:47:35,492 INFO] Step 7600/10000; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2266; bsz:  545/ 473/45; 9895/8573 tok/s;    507 sec;
[2024-03-08 15:47:37,527 INFO] valid stats calculation
                           took: 2.0347399711608887 s.
[2024-03-08 15:47:37,527 INFO] Train perplexity: 5.11645
[2024-03-08 15:47:37,527 INFO] Train accuracy: 69.1217
[2024-03-08 15:47:37,527 INFO] Sentences processed: 355172
[2024-03-08 15:47:37,528 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:47:37,528 INFO] Validation perplexity: 16409.7
[2024-03-08 15:47:37,528 INFO] Validation accuracy: 27.0357
[2024-03-08 15:47:37,528 INFO] Saving checkpoint tg-enc/tg_01_step_7600.pt
[2024-03-08 15:47:40,504 INFO] Step 7650/10000; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  577/ 503/47; 5757/5014 tok/s;    512 sec;
[2024-03-08 15:47:43,302 INFO] Step 7700/10000; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2364; bsz:  563/ 489/47; 10065/8749 tok/s;    515 sec;
[2024-03-08 15:47:46,195 INFO] Step 7750/10000; acc: 90.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2368; bsz:  585/ 506/47; 10115/8750 tok/s;    518 sec;
[2024-03-08 15:47:49,090 INFO] Step 7800/10000; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2268; bsz:  565/ 488/45; 9753/8427 tok/s;    520 sec;
[2024-03-08 15:47:51,138 INFO] valid stats calculation
                           took: 2.048480987548828 s.
[2024-03-08 15:47:51,139 INFO] Train perplexity: 4.9472
[2024-03-08 15:47:51,139 INFO] Train accuracy: 69.6721
[2024-03-08 15:47:51,139 INFO] Sentences processed: 364538
[2024-03-08 15:47:51,139 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:47:51,139 INFO] Validation perplexity: 16655.7
[2024-03-08 15:47:51,139 INFO] Validation accuracy: 27.0758
[2024-03-08 15:47:51,139 INFO] Saving checkpoint tg-enc/tg_01_step_7800.pt
[2024-03-08 15:47:54,159 INFO] Step 7850/10000; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2272; bsz:  561/ 484/45; 5535/4774 tok/s;    526 sec;
[2024-03-08 15:47:57,075 INFO] Step 7900/10000; acc: 90.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2471; bsz:  583/ 506/49; 9996/8674 tok/s;    528 sec;
[2024-03-08 15:48:00,066 INFO] Step 7950/10000; acc: 89.4; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2275; bsz:  564/ 487/46; 9422/8140 tok/s;    531 sec;
[2024-03-08 15:48:02,825 INFO] Step 8000/10000; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2382; bsz:  582/ 504/48; 10557/9137 tok/s;    534 sec;
[2024-03-08 15:48:04,888 INFO] valid stats calculation
                           took: 2.061384916305542 s.
[2024-03-08 15:48:04,888 INFO] Train perplexity: 4.79423
[2024-03-08 15:48:04,888 INFO] Train accuracy: 70.1788
[2024-03-08 15:48:04,888 INFO] Sentences processed: 373938
[2024-03-08 15:48:04,888 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:48:04,888 INFO] Validation perplexity: 12551.4
[2024-03-08 15:48:04,888 INFO] Validation accuracy: 27.1961
[2024-03-08 15:48:04,889 INFO] Saving checkpoint tg-enc/tg_01_step_8000.pt
[2024-03-08 15:48:07,834 INFO] Step 8050/10000; acc: 90.1; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2376; bsz:  561/ 490/48; 5602/4889 tok/s;    539 sec;
[2024-03-08 15:48:10,754 INFO] Step 8100/10000; acc: 89.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2274; bsz:  559/ 482/45; 9570/8252 tok/s;    542 sec;
[2024-03-08 15:48:13,772 INFO] Step 8150/10000; acc: 89.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2272; bsz:  563/ 488/45; 9322/8085 tok/s;    545 sec;
[2024-03-08 15:48:16,579 INFO] Step 8200/10000; acc: 89.9; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2462; bsz:  595/ 520/49; 10598/9273 tok/s;    548 sec;
[2024-03-08 15:48:18,649 INFO] valid stats calculation
                           took: 2.0702106952667236 s.
[2024-03-08 15:48:18,650 INFO] Train perplexity: 4.65451
[2024-03-08 15:48:18,650 INFO] Train accuracy: 70.6592
[2024-03-08 15:48:18,650 INFO] Sentences processed: 383322
[2024-03-08 15:48:18,650 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:48:18,650 INFO] Validation perplexity: 14786.8
[2024-03-08 15:48:18,650 INFO] Validation accuracy: 27.0357
[2024-03-08 15:48:18,650 INFO] Saving checkpoint tg-enc/tg_01_step_8200.pt
[2024-03-08 15:48:21,641 INFO] Step 8250/10000; acc: 89.5; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2273; bsz:  564/ 488/45; 5571/4822 tok/s;    553 sec;
[2024-03-08 15:48:24,560 INFO] Step 8300/10000; acc: 89.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2363; bsz:  584/ 507/47; 10012/8681 tok/s;    556 sec;
[2024-03-08 15:48:27,349 INFO] Step 8350/10000; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2244; bsz:  525/ 455/45; 9409/8162 tok/s;    559 sec;
[2024-03-08 15:48:30,322 INFO] Step 8400/10000; acc: 88.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2367; bsz:  587/ 510/47; 9869/8572 tok/s;    562 sec;
[2024-03-08 15:48:32,443 INFO] valid stats calculation
                           took: 2.1197423934936523 s.
[2024-03-08 15:48:32,443 INFO] Train perplexity: 4.52768
[2024-03-08 15:48:32,443 INFO] Train accuracy: 71.1039
[2024-03-08 15:48:32,443 INFO] Sentences processed: 392569
[2024-03-08 15:48:32,443 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:48:32,443 INFO] Validation perplexity: 17073.6
[2024-03-08 15:48:32,443 INFO] Validation accuracy: 26.9956
[2024-03-08 15:48:32,444 INFO] Saving checkpoint tg-enc/tg_01_step_8400.pt
[2024-03-08 15:48:35,488 INFO] Step 8450/10000; acc: 88.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2268; bsz:  557/ 481/45; 5390/4658 tok/s;    567 sec;
[2024-03-08 15:48:38,425 INFO] Step 8500/10000; acc: 88.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2482; bsz:  592/ 517/50; 10087/8804 tok/s;    570 sec;
[2024-03-08 15:48:41,291 INFO] Step 8550/10000; acc: 88.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2280; bsz:  562/ 488/46; 9812/8506 tok/s;    573 sec;
[2024-03-08 15:48:44,274 INFO] Step 8600/10000; acc: 88.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2267; bsz:  555/ 481/45; 9307/8067 tok/s;    576 sec;
[2024-03-08 15:48:46,303 INFO] valid stats calculation
                           took: 2.0292882919311523 s.
[2024-03-08 15:48:46,304 INFO] Train perplexity: 4.41318
[2024-03-08 15:48:46,304 INFO] Train accuracy: 71.509
[2024-03-08 15:48:46,304 INFO] Sentences processed: 401866
[2024-03-08 15:48:46,304 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:48:46,304 INFO] Validation perplexity: 18338.9
[2024-03-08 15:48:46,304 INFO] Validation accuracy: 26.3137
[2024-03-08 15:48:46,305 INFO] Saving checkpoint tg-enc/tg_01_step_8600.pt
[2024-03-08 15:48:49,150 INFO] Step 8650/10000; acc: 88.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 5936/5129 tok/s;    580 sec;
[2024-03-08 15:48:52,060 INFO] Step 8700/10000; acc: 88.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2372; bsz:  564/ 491/47; 9691/8437 tok/s;    583 sec;
[2024-03-08 15:48:55,040 INFO] Step 8750/10000; acc: 88.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2366; bsz:  586/ 512/47; 9828/8587 tok/s;    586 sec;
[2024-03-08 15:48:57,922 INFO] Step 8800/10000; acc: 88.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2367; bsz:  568/ 500/47; 9854/8668 tok/s;    589 sec;
[2024-03-08 15:49:00,067 INFO] valid stats calculation
                           took: 2.144507884979248 s.
[2024-03-08 15:49:00,068 INFO] Train perplexity: 4.30598
[2024-03-08 15:49:00,068 INFO] Train accuracy: 71.8952
[2024-03-08 15:49:00,068 INFO] Sentences processed: 411346
[2024-03-08 15:49:00,068 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:49:00,068 INFO] Validation perplexity: 16728.1
[2024-03-08 15:49:00,068 INFO] Validation accuracy: 27.4769
[2024-03-08 15:49:00,068 INFO] Saving checkpoint tg-enc/tg_01_step_8800.pt
[2024-03-08 15:49:02,865 INFO] Step 8850/10000; acc: 87.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2268; bsz:  567/ 492/45; 5738/4974 tok/s;    594 sec;
[2024-03-08 15:49:05,723 INFO] Step 8900/10000; acc: 88.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2367; bsz:  560/ 486/47; 9801/8498 tok/s;    597 sec;
[2024-03-08 15:49:08,601 INFO] Step 8950/10000; acc: 88.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2261; bsz:  555/ 479/45; 9637/8317 tok/s;    600 sec;
[2024-03-08 15:49:11,551 INFO] Step 9000/10000; acc: 87.8; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2373; bsz:  576/ 500/47; 9755/8478 tok/s;    603 sec;
[2024-03-08 15:49:13,665 INFO] valid stats calculation
                           took: 2.1136136054992676 s.
[2024-03-08 15:49:13,665 INFO] Train perplexity: 4.21064
[2024-03-08 15:49:13,665 INFO] Train accuracy: 72.2447
[2024-03-08 15:49:13,665 INFO] Sentences processed: 420615
[2024-03-08 15:49:13,666 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:49:13,666 INFO] Validation perplexity: 19836.3
[2024-03-08 15:49:13,666 INFO] Validation accuracy: 27.1961
[2024-03-08 15:49:13,666 INFO] Saving checkpoint tg-enc/tg_01_step_9000.pt
[2024-03-08 15:49:16,458 INFO] Step 9050/10000; acc: 87.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2371; bsz:  565/ 495/47; 5762/5043 tok/s;    608 sec;
[2024-03-08 15:49:19,539 INFO] Step 9100/10000; acc: 87.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2279; bsz:  562/ 486/46; 9129/7892 tok/s;    611 sec;
[2024-03-08 15:49:22,545 INFO] Step 9150/10000; acc: 87.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2381; bsz:  582/ 506/48; 9678/8410 tok/s;    614 sec;
[2024-03-08 15:49:25,490 INFO] Step 9200/10000; acc: 87.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2376; bsz:  578/ 498/48; 9816/8457 tok/s;    617 sec;
[2024-03-08 15:49:27,553 INFO] valid stats calculation
                           took: 2.0635218620300293 s.
[2024-03-08 15:49:27,554 INFO] Train perplexity: 4.12192
[2024-03-08 15:49:27,554 INFO] Train accuracy: 72.5732
[2024-03-08 15:49:27,554 INFO] Sentences processed: 430022
[2024-03-08 15:49:27,554 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:49:27,554 INFO] Validation perplexity: 18215.8
[2024-03-08 15:49:27,554 INFO] Validation accuracy: 26.3939
[2024-03-08 15:49:27,555 INFO] Saving checkpoint tg-enc/tg_01_step_9200.pt
[2024-03-08 15:49:30,250 INFO] Step 9250/10000; acc: 86.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2275; bsz:  548/ 477/46; 5760/5013 tok/s;    622 sec;
[2024-03-08 15:49:33,187 INFO] Step 9300/10000; acc: 87.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2371; bsz:  579/ 499/47; 9852/8487 tok/s;    625 sec;
[2024-03-08 15:49:36,078 INFO] Step 9350/10000; acc: 86.1; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2366; bsz:  584/ 506/47; 10096/8756 tok/s;    627 sec;
[2024-03-08 15:49:38,984 INFO] Step 9400/10000; acc: 86.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2268; bsz:  543/ 472/45; 9342/8126 tok/s;    630 sec;
[2024-03-08 15:49:40,988 INFO] valid stats calculation
                           took: 2.0036191940307617 s.
[2024-03-08 15:49:40,988 INFO] Train perplexity: 4.04235
[2024-03-08 15:49:40,988 INFO] Train accuracy: 72.8668
[2024-03-08 15:49:40,988 INFO] Sentences processed: 439302
[2024-03-08 15:49:40,988 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:49:40,988 INFO] Validation perplexity: 21120
[2024-03-08 15:49:40,988 INFO] Validation accuracy: 27.6374
[2024-03-08 15:49:40,989 INFO] Saving checkpoint tg-enc/tg_01_step_9400.pt
[2024-03-08 15:49:43,497 INFO] Step 9450/10000; acc: 86.8; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2362; bsz:  584/ 505/47; 6471/5600 tok/s;    635 sec;
[2024-03-08 15:49:46,336 INFO] Step 9500/10000; acc: 86.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2369; bsz:  563/ 489/47; 9922/8607 tok/s;    638 sec;
[2024-03-08 15:49:49,224 INFO] Step 9550/10000; acc: 86.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2367; bsz:  580/ 500/47; 10036/8661 tok/s;    641 sec;
[2024-03-08 15:49:52,200 INFO] Step 9600/10000; acc: 86.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2272; bsz:  562/ 485/45; 9447/8144 tok/s;    644 sec;
[2024-03-08 15:49:54,247 INFO] valid stats calculation
                           took: 2.0461480617523193 s.
[2024-03-08 15:49:54,247 INFO] Train perplexity: 3.96704
[2024-03-08 15:49:54,247 INFO] Train accuracy: 73.1537
[2024-03-08 15:49:54,247 INFO] Sentences processed: 448672
[2024-03-08 15:49:54,247 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:49:54,247 INFO] Validation perplexity: 18374.1
[2024-03-08 15:49:54,247 INFO] Validation accuracy: 26.9555
[2024-03-08 15:49:54,248 INFO] Saving checkpoint tg-enc/tg_01_step_9600.pt
[2024-03-08 15:49:56,830 INFO] Step 9650/10000; acc: 86.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2269; bsz:  559/ 485/45; 6036/5242 tok/s;    648 sec;
[2024-03-08 15:49:59,779 INFO] Step 9700/10000; acc: 86.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2375; bsz:  566/ 493/48; 9596/8354 tok/s;    651 sec;
[2024-03-08 15:50:02,731 INFO] Step 9750/10000; acc: 86.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2382; bsz:  582/ 503/48; 9854/8530 tok/s;    654 sec;
[2024-03-08 15:50:05,676 INFO] Step 9800/10000; acc: 86.4; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2376; bsz:  569/ 495/48; 9651/8406 tok/s;    657 sec;
[2024-03-08 15:50:07,677 INFO] valid stats calculation
                           took: 2.000458002090454 s.
[2024-03-08 15:50:07,678 INFO] Train perplexity: 3.89644
[2024-03-08 15:50:07,678 INFO] Train accuracy: 73.4252
[2024-03-08 15:50:07,678 INFO] Sentences processed: 458074
[2024-03-08 15:50:07,678 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:50:07,678 INFO] Validation perplexity: 18072.9
[2024-03-08 15:50:07,678 INFO] Validation accuracy: 27.4368
[2024-03-08 15:50:07,678 INFO] Saving checkpoint tg-enc/tg_01_step_9800.pt
[2024-03-08 15:50:10,091 INFO] Step 9850/10000; acc: 85.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2376; bsz:  590/ 513/48; 6679/5806 tok/s;    661 sec;
[2024-03-08 15:50:12,426 INFO] Step 9900/10000; acc: 85.3; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    2272; bsz:  564/ 489/45; 12073/10474 tok/s;    664 sec;
[2024-03-08 15:50:14,593 INFO] Step 9950/10000; acc: 86.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 13031/11306 tok/s;    666 sec;
[2024-03-08 15:50:16,806 INFO] Step 10000/10000; acc: 84.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2248; bsz:  571/ 493/45; 12905/11130 tok/s;    668 sec;
[2024-03-08 15:50:18,761 INFO] valid stats calculation
                           took: 1.9546599388122559 s.
[2024-03-08 15:50:18,761 INFO] Train perplexity: 3.83297
[2024-03-08 15:50:18,762 INFO] Train accuracy: 73.6659
[2024-03-08 15:50:18,762 INFO] Sentences processed: 467336
[2024-03-08 15:50:18,762 INFO] Average bsz:  569/ 494/47
[2024-03-08 15:50:18,762 INFO] Validation perplexity: 15633.7
[2024-03-08 15:50:18,762 INFO] Validation accuracy: 26.434
[2024-03-08 15:50:18,762 INFO] Saving checkpoint tg-enc/tg_01_step_10000.pt
