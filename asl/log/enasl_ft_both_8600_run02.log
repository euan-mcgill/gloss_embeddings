[2024-03-13 10:09:22,858 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-13 10:09:22,858 INFO] Parsed 2 corpora from -data.
[2024-03-13 10:09:22,858 INFO] Loading checkpoint from tg-pt-both/models/tg-pt-both_03_step_8600.pt
[2024-03-13 10:09:22,928 INFO] Building model...
[2024-03-13 10:09:22,984 INFO] Switching model to float32 for amp/apex_amp
[2024-03-13 10:09:22,984 INFO] Non quantized layer compute is fp32
[2024-03-13 10:09:25,303 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-13 10:09:25,304 INFO] encoder: 8952800
[2024-03-13 10:09:25,304 INFO] decoder: 16687344
[2024-03-13 10:09:25,304 INFO] * number of parameters: 25640144
[2024-03-13 10:09:25,304 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 10:09:25,304 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 10:09:25,304 INFO]  * src vocab size = 17816
[2024-03-13 10:09:25,304 INFO]  * tgt vocab size = 14144
[2024-03-13 10:09:25,306 INFO] Starting training on GPU: [0]
[2024-03-13 10:09:25,306 INFO] Start training loop and validate every 200 steps...
[2024-03-13 10:09:25,306 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-13 10:09:29,043 INFO] Saving checkpoint tg-ft-both/tg-ft-both_13600_02_step_8601.pt
[2024-03-13 10:25:00,843 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-13 10:25:00,843 INFO] Parsed 2 corpora from -data.
[2024-03-13 10:25:00,843 INFO] Loading checkpoint from tg-pt-both/models/tg-pt-both_03_step_8600.pt
[2024-03-13 10:25:00,910 INFO] Building model...
[2024-03-13 10:25:00,965 INFO] Switching model to float32 for amp/apex_amp
[2024-03-13 10:25:00,965 INFO] Non quantized layer compute is fp32
[2024-03-13 10:25:03,345 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-13 10:25:03,346 INFO] encoder: 8952800
[2024-03-13 10:25:03,346 INFO] decoder: 16687344
[2024-03-13 10:25:03,346 INFO] * number of parameters: 25640144
[2024-03-13 10:25:03,346 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 10:25:03,346 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 10:25:03,346 INFO]  * src vocab size = 17816
[2024-03-13 10:25:03,346 INFO]  * tgt vocab size = 14144
[2024-03-13 10:25:03,347 INFO] Starting training on GPU: [0]
[2024-03-13 10:25:03,347 INFO] Start training loop and validate every 200 steps...
[2024-03-13 10:25:03,347 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-13 10:25:09,327 INFO] Step 8650/13600; acc: 10.0; ppl: 1551588.0; xent: 14.3; lr: 1.00000; sents:    2270; bsz:  565/ 490/45; 4726/4095 tok/s;      6 sec;
[2024-03-13 10:25:12,416 INFO] Step 8700/13600; acc: 9.5; ppl: 74240.3; xent: 11.2; lr: 1.00000; sents:    2369; bsz:  569/ 496/47; 9205/8029 tok/s;      9 sec;
[2024-03-13 10:25:16,029 INFO] Step 8750/13600; acc: 10.7; ppl: 19773.2; xent: 9.9; lr: 1.00000; sents:    2363; bsz:  585/ 508/47; 8099/7030 tok/s;     13 sec;
[2024-03-13 10:25:19,559 INFO] Step 8800/13600; acc: 9.1; ppl: 35548.0; xent: 10.5; lr: 1.00000; sents:    2365; bsz:  563/ 489/47; 7972/6925 tok/s;     16 sec;
[2024-03-13 10:25:23,320 INFO] valid stats calculation
                           took: 3.7613279819488525 s.
[2024-03-13 10:25:23,321 INFO] Train perplexity: 93478.4
[2024-03-13 10:25:23,321 INFO] Train accuracy: 9.82576
[2024-03-13 10:25:23,321 INFO] Sentences processed: 9367
[2024-03-13 10:25:23,321 INFO] Average bsz:  570/ 496/47
[2024-03-13 10:25:23,321 INFO] Validation perplexity: 12858.5
[2024-03-13 10:25:23,321 INFO] Validation accuracy: 8.70437
[2024-03-13 10:25:23,322 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_8800.pt
[2024-03-13 10:25:26,016 INFO] Step 8850/13600; acc: 10.5; ppl: 8573.1; xent: 9.1; lr: 1.00000; sents:    2246; bsz:  570/ 493/45; 4412/3820 tok/s;     23 sec;
[2024-03-13 10:25:29,041 INFO] Step 8900/13600; acc: 11.3; ppl: 14080.6; xent: 9.6; lr: 1.00000; sents:    2372; bsz:  566/ 491/47; 9355/8115 tok/s;     26 sec;
[2024-03-13 10:25:32,652 INFO] Step 8950/13600; acc: 9.9; ppl: 21864.8; xent: 10.0; lr: 1.00000; sents:    2378; bsz:  568/ 494/48; 7859/6845 tok/s;     29 sec;
[2024-03-13 10:25:36,356 INFO] Step 9000/13600; acc: 8.9; ppl: 17711.9; xent: 9.8; lr: 1.00000; sents:    2280; bsz:  581/ 502/46; 7839/6783 tok/s;     33 sec;
[2024-03-13 10:25:39,797 INFO] valid stats calculation
                           took: 3.440739393234253 s.
[2024-03-13 10:25:39,797 INFO] Train perplexity: 37107.6
[2024-03-13 10:25:39,797 INFO] Train accuracy: 9.98481
[2024-03-13 10:25:39,797 INFO] Sentences processed: 18643
[2024-03-13 10:25:39,797 INFO] Average bsz:  571/ 495/47
[2024-03-13 10:25:39,797 INFO] Validation perplexity: 3350.6
[2024-03-13 10:25:39,797 INFO] Validation accuracy: 10.5897
[2024-03-13 10:25:39,798 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_9000.pt
[2024-03-13 10:25:42,444 INFO] Step 9050/13600; acc: 12.0; ppl: 4446.8; xent: 8.4; lr: 1.00000; sents:    2381; bsz:  568/ 495/48; 4665/4062 tok/s;     39 sec;
[2024-03-13 10:25:45,292 INFO] Step 9100/13600; acc: 11.1; ppl: 4524.0; xent: 8.4; lr: 1.00000; sents:    2261; bsz:  552/ 477/45; 9690/8373 tok/s;     42 sec;
[2024-03-13 10:25:48,988 INFO] Step 9150/13600; acc: 9.0; ppl: 10502.0; xent: 9.3; lr: 1.00000; sents:    2486; bsz:  591/ 514/50; 7995/6961 tok/s;     46 sec;
[2024-03-13 10:25:52,534 INFO] Step 9200/13600; acc: 9.2; ppl: 3224.5; xent: 8.1; lr: 1.00000; sents:    2252; bsz:  551/ 477/45; 7773/6722 tok/s;     49 sec;
[2024-03-13 10:25:55,979 INFO] valid stats calculation
                           took: 3.445077657699585 s.
[2024-03-13 10:25:55,979 INFO] Train perplexity: 19322.7
[2024-03-13 10:25:55,979 INFO] Train accuracy: 10.093
[2024-03-13 10:25:55,979 INFO] Sentences processed: 28023
[2024-03-13 10:25:55,980 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:25:55,980 INFO] Validation perplexity: 3450.2
[2024-03-13 10:25:55,980 INFO] Validation accuracy: 11.7529
[2024-03-13 10:25:55,981 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_9200.pt
[2024-03-13 10:25:58,879 INFO] Step 9250/13600; acc: 11.0; ppl: 3775.1; xent: 8.2; lr: 1.00000; sents:    2367; bsz:  587/ 513/47; 4626/4038 tok/s;     56 sec;
[2024-03-13 10:26:01,522 INFO] Step 9300/13600; acc: 9.2; ppl: 8799.4; xent: 9.1; lr: 1.00000; sents:    2268; bsz:  567/ 491/45; 10733/9297 tok/s;     58 sec;
[2024-03-13 10:26:05,100 INFO] Step 9350/13600; acc: 9.2; ppl: 7735.2; xent: 9.0; lr: 1.00000; sents:    2367; bsz:  567/ 499/47; 7927/6968 tok/s;     62 sec;
[2024-03-13 10:26:08,687 INFO] Step 9400/13600; acc: 11.1; ppl: 8807.5; xent: 9.1; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 7980/6917 tok/s;     65 sec;
[2024-03-13 10:26:12,248 INFO] valid stats calculation
                           took: 3.559910774230957 s.
[2024-03-13 10:26:12,248 INFO] Train perplexity: 14881.4
[2024-03-13 10:26:12,248 INFO] Train accuracy: 10.107
[2024-03-13 10:26:12,248 INFO] Sentences processed: 37390
[2024-03-13 10:26:12,248 INFO] Average bsz:  570/ 495/47
[2024-03-13 10:26:12,248 INFO] Validation perplexity: 2252.07
[2024-03-13 10:26:12,248 INFO] Validation accuracy: 13.3975
[2024-03-13 10:26:12,249 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_9400.pt
[2024-03-13 10:26:15,326 INFO] Step 9450/13600; acc: 8.3; ppl: 8029.6; xent: 9.0; lr: 1.00000; sents:    2372; bsz:  563/ 490/47; 4242/3690 tok/s;     72 sec;
[2024-03-13 10:26:17,756 INFO] Step 9500/13600; acc: 9.6; ppl: 2994.3; xent: 8.0; lr: 1.00000; sents:    2268; bsz:  557/ 483/45; 11465/9930 tok/s;     74 sec;
[2024-03-13 10:26:20,266 INFO] Step 9550/13600; acc: 9.0; ppl: 4350.1; xent: 8.4; lr: 1.00000; sents:    2279; bsz:  563/ 487/46; 11214/9695 tok/s;     77 sec;
[2024-03-13 10:26:24,019 INFO] Step 9600/13600; acc: 9.4; ppl: 27281.3; xent: 10.2; lr: 1.00000; sents:    2478; bsz:  584/ 514/50; 7788/6850 tok/s;     81 sec;
[2024-03-13 10:26:28,584 INFO] valid stats calculation
                           took: 4.563267230987549 s.
[2024-03-13 10:26:28,584 INFO] Train perplexity: 12967.2
[2024-03-13 10:26:28,584 INFO] Train accuracy: 9.90515
[2024-03-13 10:26:28,584 INFO] Sentences processed: 46787
[2024-03-13 10:26:28,584 INFO] Average bsz:  569/ 495/47
[2024-03-13 10:26:28,584 INFO] Validation perplexity: 4098.57
[2024-03-13 10:26:28,584 INFO] Validation accuracy: 8.50381
[2024-03-13 10:26:28,586 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_9600.pt
[2024-03-13 10:26:31,258 INFO] Step 9650/13600; acc: 8.4; ppl: 35457.0; xent: 10.5; lr: 1.00000; sents:    2279; bsz:  562/ 485/46; 3881/3351 tok/s;     88 sec;
[2024-03-13 10:26:34,038 INFO] Step 9700/13600; acc: 9.9; ppl: 8478.3; xent: 9.0; lr: 1.00000; sents:    2375; bsz:  565/ 490/48; 10171/8824 tok/s;     91 sec;
[2024-03-13 10:26:36,569 INFO] Step 9750/13600; acc: 8.3; ppl: 59286.7; xent: 11.0; lr: 1.00000; sents:    2271; bsz:  574/ 492/45; 11343/9715 tok/s;     93 sec;
[2024-03-13 10:26:39,551 INFO] Step 9800/13600; acc: 9.0; ppl: 4140.3; xent: 8.3; lr: 1.00000; sents:    2366; bsz:  563/ 491/47; 9447/8230 tok/s;     96 sec;
[2024-03-13 10:26:43,919 INFO] valid stats calculation
                           took: 4.366670846939087 s.
[2024-03-13 10:26:43,919 INFO] Train perplexity: 13487.7
[2024-03-13 10:26:43,919 INFO] Train accuracy: 9.74388
[2024-03-13 10:26:43,919 INFO] Sentences processed: 56078
[2024-03-13 10:26:43,919 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:26:43,919 INFO] Validation perplexity: 3897.86
[2024-03-13 10:26:43,919 INFO] Validation accuracy: 10.5897
[2024-03-13 10:26:43,921 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_9800.pt
[2024-03-13 10:26:46,603 INFO] Step 9850/13600; acc: 5.8; ppl: 47759.1; xent: 10.8; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 4001/3478 tok/s;    103 sec;
[2024-03-13 10:26:49,142 INFO] Step 9900/13600; acc: 8.4; ppl: 911721.7; xent: 13.7; lr: 1.00000; sents:    2264; bsz:  562/ 487/45; 11060/9585 tok/s;    106 sec;
[2024-03-13 10:26:51,656 INFO] Step 9950/13600; acc: 9.4; ppl: 7885.1; xent: 9.0; lr: 1.00000; sents:    2369; bsz:  586/ 507/47; 11659/10082 tok/s;    108 sec;
[2024-03-13 10:26:54,080 INFO] Step 10000/13600; acc: 10.1; ppl: 4553.7; xent: 8.4; lr: 1.00000; sents:    2367; bsz:  579/ 500/47; 11957/10316 tok/s;    111 sec;
[2024-03-13 10:26:58,060 INFO] valid stats calculation
                           took: 3.980478525161743 s.
[2024-03-13 10:26:58,061 INFO] Train perplexity: 15423.1
[2024-03-13 10:26:58,061 INFO] Train accuracy: 9.55686
[2024-03-13 10:26:58,061 INFO] Sentences processed: 65444
[2024-03-13 10:26:58,061 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:26:58,061 INFO] Validation perplexity: 61880.4
[2024-03-13 10:26:58,061 INFO] Validation accuracy: 11.5925
[2024-03-13 10:26:58,062 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_10000.pt
[2024-03-13 10:27:00,878 INFO] Step 10050/13600; acc: 10.7; ppl: 6932.5; xent: 8.8; lr: 1.00000; sents:    2272; bsz:  562/ 485/45; 4134/3564 tok/s;    118 sec;
[2024-03-13 10:27:03,484 INFO] Step 10100/13600; acc: 11.3; ppl: 3183.7; xent: 8.1; lr: 1.00000; sents:    2371; bsz:  564/ 490/47; 10826/9396 tok/s;    120 sec;
[2024-03-13 10:27:06,070 INFO] Step 10150/13600; acc: 7.9; ppl: 31447.9; xent: 10.4; lr: 1.00000; sents:    2375; bsz:  566/ 493/48; 10952/9534 tok/s;    123 sec;
[2024-03-13 10:27:08,971 INFO] Step 10200/13600; acc: 9.7; ppl: 18358.6; xent: 9.8; lr: 1.00000; sents:    2280; bsz:  576/ 497/46; 9925/8570 tok/s;    126 sec;
[2024-03-13 10:27:13,449 INFO] valid stats calculation
                           took: 4.478160619735718 s.
[2024-03-13 10:27:13,450 INFO] Train perplexity: 14734.3
[2024-03-13 10:27:13,450 INFO] Train accuracy: 9.59848
[2024-03-13 10:27:13,450 INFO] Sentences processed: 74742
[2024-03-13 10:27:13,450 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:27:13,450 INFO] Validation perplexity: 2136.93
[2024-03-13 10:27:13,450 INFO] Validation accuracy: 12.5953
[2024-03-13 10:27:13,451 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_10200.pt
[2024-03-13 10:27:16,382 INFO] Step 10250/13600; acc: 9.7; ppl: 11526.2; xent: 9.4; lr: 1.00000; sents:    2376; bsz:  564/ 490/48; 3803/3304 tok/s;    133 sec;
[2024-03-13 10:27:18,885 INFO] Step 10300/13600; acc: 8.2; ppl: 13756.3; xent: 9.5; lr: 1.00000; sents:    2280; bsz:  563/ 487/46; 11252/9727 tok/s;    136 sec;
[2024-03-13 10:27:21,335 INFO] Step 10350/13600; acc: 8.7; ppl: 64931.6; xent: 11.1; lr: 1.00000; sents:    2464; bsz:  595/ 521/49; 12136/10644 tok/s;    138 sec;
[2024-03-13 10:27:23,774 INFO] Step 10400/13600; acc: 8.1; ppl: 5111.2; xent: 8.5; lr: 1.00000; sents:    2270; bsz:  563/ 487/45; 11540/9987 tok/s;    140 sec;
[2024-03-13 10:27:27,519 INFO] valid stats calculation
                           took: 3.7442374229431152 s.
[2024-03-13 10:27:27,520 INFO] Train perplexity: 14820.6
[2024-03-13 10:27:27,520 INFO] Train accuracy: 9.49543
[2024-03-13 10:27:27,520 INFO] Sentences processed: 84132
[2024-03-13 10:27:27,520 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:27:27,520 INFO] Validation perplexity: 1786.29
[2024-03-13 10:27:27,520 INFO] Validation accuracy: 13.2772
[2024-03-13 10:27:27,521 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_10400.pt
[2024-03-13 10:27:30,369 INFO] Step 10450/13600; acc: 9.6; ppl: 5304.0; xent: 8.6; lr: 1.00000; sents:    2248; bsz:  550/ 476/45; 4170/3607 tok/s;    147 sec;
[2024-03-13 10:27:33,173 INFO] Step 10500/13600; acc: 8.4; ppl: 7980.3; xent: 9.0; lr: 1.00000; sents:    2363; bsz:  564/ 490/47; 10054/8736 tok/s;    150 sec;
[2024-03-13 10:27:36,081 INFO] Step 10550/13600; acc: 9.5; ppl: 33531.3; xent: 10.4; lr: 1.00000; sents:    2365; bsz:  585/ 508/47; 10064/8732 tok/s;    153 sec;
[2024-03-13 10:27:38,595 INFO] Step 10600/13600; acc: 10.6; ppl: 3021.8; xent: 8.0; lr: 1.00000; sents:    2367; bsz:  579/ 502/47; 11521/9980 tok/s;    155 sec;
[2024-03-13 10:27:42,718 INFO] valid stats calculation
                           took: 4.122642755508423 s.
[2024-03-13 10:27:42,719 INFO] Train perplexity: 13965
[2024-03-13 10:27:42,719 INFO] Train accuracy: 9.49798
[2024-03-13 10:27:42,719 INFO] Sentences processed: 93475
[2024-03-13 10:27:42,719 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:27:42,719 INFO] Validation perplexity: 2523.28
[2024-03-13 10:27:42,719 INFO] Validation accuracy: 13.4376
[2024-03-13 10:27:42,721 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_10600.pt
[2024-03-13 10:27:45,514 INFO] Step 10650/13600; acc: 10.6; ppl: 3506.8; xent: 8.2; lr: 1.00000; sents:    2268; bsz:  558/ 484/45; 4032/3496 tok/s;    162 sec;
[2024-03-13 10:27:48,314 INFO] Step 10700/13600; acc: 11.0; ppl: 74934.4; xent: 11.2; lr: 1.00000; sents:    2379; bsz:  568/ 494/48; 10144/8832 tok/s;    165 sec;
[2024-03-13 10:27:50,843 INFO] Step 10750/13600; acc: 9.5; ppl: 6325.2; xent: 8.8; lr: 1.00000; sents:    2383; bsz:  567/ 495/48; 11215/9780 tok/s;    167 sec;
[2024-03-13 10:27:53,817 INFO] Step 10800/13600; acc: 9.5; ppl: 8899.2; xent: 9.1; lr: 1.00000; sents:    2267; bsz:  570/ 491/45; 9593/8264 tok/s;    170 sec;
[2024-03-13 10:27:57,891 INFO] valid stats calculation
                           took: 4.073923110961914 s.
[2024-03-13 10:27:57,891 INFO] Train perplexity: 13678.2
[2024-03-13 10:27:57,891 INFO] Train accuracy: 9.55648
[2024-03-13 10:27:57,891 INFO] Sentences processed: 102772
[2024-03-13 10:27:57,892 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:27:57,892 INFO] Validation perplexity: 4976.02
[2024-03-13 10:27:57,892 INFO] Validation accuracy: 7.1801
[2024-03-13 10:27:57,893 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_10800.pt
[2024-03-13 10:28:00,935 INFO] Step 10850/13600; acc: 10.6; ppl: 5403.4; xent: 8.6; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 3956/3436 tok/s;    178 sec;
[2024-03-13 10:28:03,836 INFO] Step 10900/13600; acc: 9.8; ppl: 7278.7; xent: 8.9; lr: 1.00000; sents:    2372; bsz:  586/ 513/47; 10104/8846 tok/s;    180 sec;
[2024-03-13 10:28:07,600 INFO] Step 10950/13600; acc: 9.1; ppl: 7352.9; xent: 8.9; lr: 1.00000; sents:    2366; bsz:  567/ 497/47; 7532/6603 tok/s;    184 sec;
[2024-03-13 10:28:11,452 INFO] Step 11000/13600; acc: 9.4; ppl: 4268.4; xent: 8.4; lr: 1.00000; sents:    2271; bsz:  568/ 493/45; 7378/6405 tok/s;    188 sec;
[2024-03-13 10:28:15,885 INFO] valid stats calculation
                           took: 4.431149244308472 s.
[2024-03-13 10:28:15,885 INFO] Train perplexity: 12753.1
[2024-03-13 10:28:15,885 INFO] Train accuracy: 9.56939
[2024-03-13 10:28:15,885 INFO] Sentences processed: 112156
[2024-03-13 10:28:15,885 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:28:15,885 INFO] Validation perplexity: 1453.23
[2024-03-13 10:28:15,885 INFO] Validation accuracy: 11.1111
[2024-03-13 10:28:15,886 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_11000.pt
[2024-03-13 10:28:18,427 INFO] Step 11050/13600; acc: 11.1; ppl: 3351.4; xent: 8.1; lr: 1.00000; sents:    2364; bsz:  561/ 487/47; 4019/3493 tok/s;    195 sec;
[2024-03-13 10:28:20,923 INFO] Step 11100/13600; acc: 10.7; ppl: 3088.3; xent: 8.0; lr: 1.00000; sents:    2263; bsz:  554/ 478/45; 11098/9577 tok/s;    198 sec;
[2024-03-13 10:28:23,351 INFO] Step 11150/13600; acc: 11.2; ppl: 2681.1; xent: 7.9; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 11807/10221 tok/s;    200 sec;
[2024-03-13 10:28:25,990 INFO] Step 11200/13600; acc: 9.8; ppl: 15308.0; xent: 9.6; lr: 1.00000; sents:    2373; bsz:  567/ 495/47; 10736/9388 tok/s;    203 sec;
[2024-03-13 10:28:30,073 INFO] valid stats calculation
                           took: 4.08210825920105 s.
[2024-03-13 10:28:30,073 INFO] Train perplexity: 11791.8
[2024-03-13 10:28:30,073 INFO] Train accuracy: 9.65433
[2024-03-13 10:28:30,073 INFO] Sentences processed: 121521
[2024-03-13 10:28:30,073 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:28:30,073 INFO] Validation perplexity: 6374.47
[2024-03-13 10:28:30,073 INFO] Validation accuracy: 12.1139
[2024-03-13 10:28:30,075 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_11200.pt
[2024-03-13 10:28:32,885 INFO] Step 11250/13600; acc: 9.4; ppl: 3040.4; xent: 8.0; lr: 1.00000; sents:    2275; bsz:  578/ 497/46; 4189/3604 tok/s;    210 sec;
[2024-03-13 10:28:35,497 INFO] Step 11300/13600; acc: 10.8; ppl: 2470.7; xent: 7.8; lr: 1.00000; sents:    2375; bsz:  565/ 494/48; 10818/9467 tok/s;    212 sec;
[2024-03-13 10:28:38,308 INFO] Step 11350/13600; acc: 8.5; ppl: 6391.2; xent: 8.8; lr: 1.00000; sents:    2381; bsz:  566/ 491/48; 10069/8735 tok/s;    215 sec;
[2024-03-13 10:28:41,031 INFO] Step 11400/13600; acc: 9.6; ppl: 3653.4; xent: 8.2; lr: 1.00000; sents:    2376; bsz:  578/ 498/48; 10618/9153 tok/s;    218 sec;
[2024-03-13 10:28:44,954 INFO] valid stats calculation
                           took: 3.9222781658172607 s.
[2024-03-13 10:28:44,954 INFO] Train perplexity: 10838.7
[2024-03-13 10:28:44,954 INFO] Train accuracy: 9.64858
[2024-03-13 10:28:44,954 INFO] Sentences processed: 130928
[2024-03-13 10:28:44,954 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:28:44,954 INFO] Validation perplexity: 120492
[2024-03-13 10:28:44,954 INFO] Validation accuracy: 7.94224
[2024-03-13 10:28:44,955 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_11400.pt
[2024-03-13 10:28:47,762 INFO] Step 11450/13600; acc: 11.5; ppl: 5531.3; xent: 8.6; lr: 1.00000; sents:    2275; bsz:  562/ 485/46; 4176/3605 tok/s;    224 sec;
[2024-03-13 10:28:50,187 INFO] Step 11500/13600; acc: 11.7; ppl: 1848.3; xent: 7.5; lr: 1.00000; sents:    2371; bsz:  566/ 491/47; 11665/10123 tok/s;    227 sec;
[2024-03-13 10:28:52,596 INFO] Step 11550/13600; acc: 9.5; ppl: 22227.1; xent: 10.0; lr: 1.00000; sents:    2366; bsz:  584/ 506/47; 12122/10512 tok/s;    229 sec;
[2024-03-13 10:28:55,401 INFO] Step 11600/13600; acc: 9.7; ppl: 9103.9; xent: 9.1; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 10043/8707 tok/s;    232 sec;
[2024-03-13 10:28:59,377 INFO] valid stats calculation
                           took: 3.975217580795288 s.
[2024-03-13 10:28:59,377 INFO] Train perplexity: 10508.7
[2024-03-13 10:28:59,377 INFO] Train accuracy: 9.71089
[2024-03-13 10:28:59,377 INFO] Sentences processed: 140208
[2024-03-13 10:28:59,377 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:28:59,377 INFO] Validation perplexity: 13619.2
[2024-03-13 10:28:59,378 INFO] Validation accuracy: 7.501
[2024-03-13 10:28:59,379 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_11600.pt
[2024-03-13 10:29:02,157 INFO] Step 11650/13600; acc: 9.1; ppl: 12977.8; xent: 9.5; lr: 1.00000; sents:    2362; bsz:  579/ 499/47; 4283/3693 tok/s;    239 sec;
[2024-03-13 10:29:04,918 INFO] Step 11700/13600; acc: 8.3; ppl: 3463.0; xent: 8.1; lr: 1.00000; sents:    2267; bsz:  561/ 484/45; 10160/8765 tok/s;    242 sec;
[2024-03-13 10:29:07,365 INFO] Step 11750/13600; acc: 11.4; ppl: 1978.6; xent: 7.6; lr: 1.00000; sents:    2369; bsz:  563/ 489/47; 11514/9992 tok/s;    244 sec;
[2024-03-13 10:29:10,020 INFO] Step 11800/13600; acc: 10.6; ppl: 3149.6; xent: 8.1; lr: 1.00000; sents:    2270; bsz:  559/ 485/45; 10533/9138 tok/s;    247 sec;
[2024-03-13 10:29:14,281 INFO] valid stats calculation
                           took: 4.260417461395264 s.
[2024-03-13 10:29:14,281 INFO] Train perplexity: 9916.28
[2024-03-13 10:29:14,281 INFO] Train accuracy: 9.71937
[2024-03-13 10:29:14,281 INFO] Sentences processed: 149476
[2024-03-13 10:29:14,281 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:29:14,281 INFO] Validation perplexity: 2655.44
[2024-03-13 10:29:14,282 INFO] Validation accuracy: 12.7156
[2024-03-13 10:29:14,283 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_11800.pt
[2024-03-13 10:29:17,203 INFO] Step 11850/13600; acc: 10.6; ppl: 14019.8; xent: 9.5; lr: 1.00000; sents:    2371; bsz:  566/ 493/47; 3938/3432 tok/s;    254 sec;
[2024-03-13 10:29:19,898 INFO] Step 11900/13600; acc: 9.2; ppl: 445965.4; xent: 13.0; lr: 1.00000; sents:    2375; bsz:  582/ 503/48; 10800/9343 tok/s;    257 sec;
[2024-03-13 10:29:22,935 INFO] Step 11950/13600; acc: 8.5; ppl: 8806.5; xent: 9.1; lr: 1.00000; sents:    2382; bsz:  589/ 510/48; 9695/8404 tok/s;    260 sec;
[2024-03-13 10:29:25,784 INFO] Step 12000/13600; acc: 10.4; ppl: 7749.3; xent: 9.0; lr: 1.00000; sents:    2376; bsz:  569/ 497/48; 9990/8725 tok/s;    262 sec;
[2024-03-13 10:29:29,642 INFO] valid stats calculation
                           took: 3.8572092056274414 s.
[2024-03-13 10:29:29,642 INFO] Train perplexity: 10494.5
[2024-03-13 10:29:29,642 INFO] Train accuracy: 9.71574
[2024-03-13 10:29:29,642 INFO] Sentences processed: 158980
[2024-03-13 10:29:29,642 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:29:29,643 INFO] Validation perplexity: 2588.78
[2024-03-13 10:29:29,643 INFO] Validation accuracy: 7.01966
[2024-03-13 10:29:29,644 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_12000.pt
[2024-03-13 10:29:32,377 INFO] Step 12050/13600; acc: 10.2; ppl: 13346.1; xent: 9.5; lr: 1.00000; sents:    2280; bsz:  565/ 490/46; 4286/3718 tok/s;    269 sec;
[2024-03-13 10:29:34,919 INFO] Step 12100/13600; acc: 8.8; ppl: 8670.4; xent: 9.1; lr: 1.00000; sents:    2368; bsz:  585/ 506/47; 11517/9965 tok/s;    272 sec;
[2024-03-13 10:29:37,616 INFO] Step 12150/13600; acc: 10.6; ppl: 3013.9; xent: 8.0; lr: 1.00000; sents:    2246; bsz:  529/ 460/45; 9816/8537 tok/s;    274 sec;
[2024-03-13 10:29:40,450 INFO] Step 12200/13600; acc: 8.1; ppl: 13345.5; xent: 9.5; lr: 1.00000; sents:    2368; bsz:  587/ 509/47; 10360/8973 tok/s;    277 sec;
[2024-03-13 10:29:44,319 INFO] valid stats calculation
                           took: 3.8683154582977295 s.
[2024-03-13 10:29:44,319 INFO] Train perplexity: 10368.1
[2024-03-13 10:29:44,319 INFO] Train accuracy: 9.69741
[2024-03-13 10:29:44,319 INFO] Sentences processed: 168242
[2024-03-13 10:29:44,319 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:29:44,319 INFO] Validation perplexity: 1748.38
[2024-03-13 10:29:44,319 INFO] Validation accuracy: 12.515
[2024-03-13 10:29:44,321 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_12200.pt
[2024-03-13 10:29:47,043 INFO] Step 12250/13600; acc: 9.8; ppl: 5036.7; xent: 8.5; lr: 1.00000; sents:    2363; bsz:  576/ 498/47; 4372/3775 tok/s;    284 sec;
[2024-03-13 10:29:50,146 INFO] Step 12300/13600; acc: 10.5; ppl: 16493.1; xent: 9.7; lr: 1.00000; sents:    2251; bsz:  552/ 480/45; 8898/7736 tok/s;    287 sec;
[2024-03-13 10:29:52,609 INFO] Step 12350/13600; acc: 10.3; ppl: 2501.8; xent: 7.8; lr: 1.00000; sents:    2372; bsz:  566/ 492/47; 11489/9987 tok/s;    289 sec;
[2024-03-13 10:29:55,270 INFO] Step 12400/13600; acc: 10.1; ppl: 4302.1; xent: 8.4; lr: 1.00000; sents:    2274; bsz:  563/ 490/45; 10577/9198 tok/s;    292 sec;
[2024-03-13 10:29:59,579 INFO] valid stats calculation
                           took: 4.308180332183838 s.
[2024-03-13 10:29:59,580 INFO] Train perplexity: 10024
[2024-03-13 10:29:59,580 INFO] Train accuracy: 9.72375
[2024-03-13 10:29:59,580 INFO] Sentences processed: 177502
[2024-03-13 10:29:59,580 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:29:59,580 INFO] Validation perplexity: 2572.33
[2024-03-13 10:29:59,580 INFO] Validation accuracy: 11.7128
[2024-03-13 10:29:59,581 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_12400.pt
[2024-03-13 10:30:02,566 INFO] Step 12450/13600; acc: 11.0; ppl: 4343.1; xent: 8.4; lr: 1.00000; sents:    2375; bsz:  563/ 491/48; 3858/3364 tok/s;    299 sec;
[2024-03-13 10:30:05,534 INFO] Step 12500/13600; acc: 10.2; ppl: 3908.1; xent: 8.3; lr: 1.00000; sents:    2381; bsz:  582/ 505/48; 9801/8505 tok/s;    302 sec;
[2024-03-13 10:30:08,258 INFO] Step 12550/13600; acc: 12.3; ppl: 1818.4; xent: 7.5; lr: 1.00000; sents:    2376; bsz:  564/ 492/48; 10350/9027 tok/s;    305 sec;
[2024-03-13 10:30:10,883 INFO] Step 12600/13600; acc: 9.4; ppl: 6139.0; xent: 8.7; lr: 1.00000; sents:    2278; bsz:  587/ 509/46; 11180/9691 tok/s;    308 sec;
[2024-03-13 10:30:14,957 INFO] valid stats calculation
                           took: 4.072617053985596 s.
[2024-03-13 10:30:14,957 INFO] Train perplexity: 9535.3
[2024-03-13 10:30:14,957 INFO] Train accuracy: 9.77488
[2024-03-13 10:30:14,957 INFO] Sentences processed: 186912
[2024-03-13 10:30:14,957 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:30:14,957 INFO] Validation perplexity: 116663
[2024-03-13 10:30:14,957 INFO] Validation accuracy: 4.09146
[2024-03-13 10:30:14,959 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_12600.pt
[2024-03-13 10:30:17,913 INFO] Step 12650/13600; acc: 10.4; ppl: 5624.4; xent: 8.6; lr: 1.00000; sents:    2372; bsz:  568/ 497/47; 4037/3533 tok/s;    315 sec;
[2024-03-13 10:30:20,753 INFO] Step 12700/13600; acc: 11.2; ppl: 2005.8; xent: 7.6; lr: 1.00000; sents:    2367; bsz:  578/ 498/47; 10168/8765 tok/s;    317 sec;
[2024-03-13 10:30:23,140 INFO] Step 12750/13600; acc: 9.7; ppl: 4204.7; xent: 8.3; lr: 1.00000; sents:    2263; bsz:  542/ 474/45; 11369/9930 tok/s;    320 sec;
[2024-03-13 10:30:25,478 INFO] Step 12800/13600; acc: 10.7; ppl: 1711.8; xent: 7.4; lr: 1.00000; sents:    2364; bsz:  572/ 494/47; 12225/10557 tok/s;    322 sec;
[2024-03-13 10:30:29,202 INFO] valid stats calculation
                           took: 3.7232048511505127 s.
[2024-03-13 10:30:29,203 INFO] Train perplexity: 9026.53
[2024-03-13 10:30:29,203 INFO] Train accuracy: 9.80805
[2024-03-13 10:30:29,203 INFO] Sentences processed: 196278
[2024-03-13 10:30:29,203 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:30:29,203 INFO] Validation perplexity: 2136.82
[2024-03-13 10:30:29,203 INFO] Validation accuracy: 11.4721
[2024-03-13 10:30:29,205 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_12800.pt
[2024-03-13 10:30:32,201 INFO] Step 12850/13600; acc: 9.5; ppl: 2038.2; xent: 7.6; lr: 1.00000; sents:    2268; bsz:  558/ 481/45; 4148/3581 tok/s;    329 sec;
[2024-03-13 10:30:35,057 INFO] Step 12900/13600; acc: 11.5; ppl: 6348.9; xent: 8.8; lr: 1.00000; sents:    2464; bsz:  586/ 516/49; 10257/9036 tok/s;    332 sec;
[2024-03-13 10:30:37,782 INFO] Step 12950/13600; acc: 8.9; ppl: 2455.6; xent: 7.8; lr: 1.00000; sents:    2276; bsz:  562/ 486/46; 10308/8911 tok/s;    334 sec;
[2024-03-13 10:30:40,552 INFO] Step 13000/13600; acc: 10.0; ppl: 3214.9; xent: 8.1; lr: 1.00000; sents:    2271; bsz:  564/ 489/45; 10187/8822 tok/s;    337 sec;
[2024-03-13 10:30:44,413 INFO] valid stats calculation
                           took: 3.860261917114258 s.
[2024-03-13 10:30:44,413 INFO] Train perplexity: 8613.53
[2024-03-13 10:30:44,414 INFO] Train accuracy: 9.81732
[2024-03-13 10:30:44,414 INFO] Sentences processed: 205557
[2024-03-13 10:30:44,414 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:30:44,414 INFO] Validation perplexity: 6063.48
[2024-03-13 10:30:44,414 INFO] Validation accuracy: 9.62696
[2024-03-13 10:30:44,416 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_13000.pt
[2024-03-13 10:30:47,013 INFO] Step 13050/13600; acc: 9.7; ppl: 7352.8; xent: 8.9; lr: 1.00000; sents:    2375; bsz:  563/ 488/48; 4360/3780 tok/s;    344 sec;
[2024-03-13 10:30:49,637 INFO] Step 13100/13600; acc: 10.5; ppl: 3453.8; xent: 8.1; lr: 1.00000; sents:    2382; bsz:  577/ 497/48; 10990/9479 tok/s;    346 sec;
[2024-03-13 10:30:52,341 INFO] Step 13150/13600; acc: 12.3; ppl: 2322.8; xent: 7.8; lr: 1.00000; sents:    2376; bsz:  567/ 491/48; 10491/9088 tok/s;    349 sec;
[2024-03-13 10:30:55,231 INFO] Step 13200/13600; acc: 10.3; ppl: 6044.7; xent: 8.7; lr: 1.00000; sents:    2277; bsz:  586/ 506/46; 10131/8754 tok/s;    352 sec;
[2024-03-13 10:30:59,251 INFO] valid stats calculation
                           took: 4.019206523895264 s.
[2024-03-13 10:30:59,251 INFO] Train perplexity: 8360.43
[2024-03-13 10:30:59,251 INFO] Train accuracy: 9.8546
[2024-03-13 10:30:59,251 INFO] Sentences processed: 214967
[2024-03-13 10:30:59,251 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:30:59,251 INFO] Validation perplexity: 16350.8
[2024-03-13 10:30:59,251 INFO] Validation accuracy: 10.1484
[2024-03-13 10:30:59,253 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_13200.pt
[2024-03-13 10:31:02,114 INFO] Step 13250/13600; acc: 9.7; ppl: 3119.6; xent: 8.0; lr: 1.00000; sents:    2371; bsz:  565/ 491/47; 4106/3567 tok/s;    359 sec;
[2024-03-13 10:31:04,688 INFO] Step 13300/13600; acc: 11.5; ppl: 2536.4; xent: 7.8; lr: 1.00000; sents:    2366; bsz:  579/ 500/47; 11250/9707 tok/s;    361 sec;
[2024-03-13 10:31:07,145 INFO] Step 13350/13600; acc: 10.2; ppl: 2920.3; xent: 8.0; lr: 1.00000; sents:    2366; bsz:  563/ 489/47; 11456/9950 tok/s;    364 sec;
[2024-03-13 10:31:09,907 INFO] Step 13400/13600; acc: 10.1; ppl: 2896.2; xent: 8.0; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 10141/8745 tok/s;    367 sec;
[2024-03-13 10:31:14,167 INFO] valid stats calculation
                           took: 4.260026693344116 s.
[2024-03-13 10:31:14,168 INFO] Train perplexity: 7996.99
[2024-03-13 10:31:14,168 INFO] Train accuracy: 9.87624
[2024-03-13 10:31:14,168 INFO] Sentences processed: 224332
[2024-03-13 10:31:14,168 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:31:14,168 INFO] Validation perplexity: 5038.6
[2024-03-13 10:31:14,168 INFO] Validation accuracy: 15.002
[2024-03-13 10:31:14,169 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_13400.pt
[2024-03-13 10:31:16,583 INFO] Step 13450/13600; acc: 9.1; ppl: 4425.3; xent: 8.4; lr: 1.00000; sents:    2267; bsz:  560/ 486/45; 4196/3640 tok/s;    373 sec;
[2024-03-13 10:31:18,884 INFO] Step 13500/13600; acc: 9.8; ppl: 3227.9; xent: 8.1; lr: 1.00000; sents:    2367; bsz:  582/ 504/47; 12645/10944 tok/s;    376 sec;
[2024-03-13 10:31:21,187 INFO] Step 13550/13600; acc: 10.7; ppl: 2889.9; xent: 8.0; lr: 1.00000; sents:    2372; bsz:  564/ 492/47; 12243/10693 tok/s;    378 sec;
[2024-03-13 10:31:23,510 INFO] Step 13600/13600; acc: 10.8; ppl: 4564.6; xent: 8.4; lr: 1.00000; sents:    2371; bsz:  567/ 494/47; 12214/10630 tok/s;    380 sec;
[2024-03-13 10:31:26,854 INFO] valid stats calculation
                           took: 3.343665599822998 s.
[2024-03-13 10:31:26,854 INFO] Train perplexity: 7754.11
[2024-03-13 10:31:26,854 INFO] Train accuracy: 9.88614
[2024-03-13 10:31:26,854 INFO] Sentences processed: 233709
[2024-03-13 10:31:26,854 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:31:26,854 INFO] Validation perplexity: 2009.7
[2024-03-13 10:31:26,855 INFO] Validation accuracy: 9.14561
[2024-03-13 10:31:26,856 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_13600.pt
[2024-03-13 11:26:32,385 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-13 11:26:32,385 INFO] Parsed 2 corpora from -data.
[2024-03-13 11:26:32,385 INFO] Loading checkpoint from tg-pt-both/models/tg-pt-both_03_step_8600.pt
[2024-03-13 11:26:32,456 INFO] Building model...
[2024-03-13 11:26:32,512 INFO] Switching model to float32 for amp/apex_amp
[2024-03-13 11:26:32,512 INFO] Non quantized layer compute is fp32
[2024-03-13 11:26:34,307 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-13 11:26:34,308 INFO] encoder: 8952800
[2024-03-13 11:26:34,308 INFO] decoder: 16687344
[2024-03-13 11:26:34,308 INFO] * number of parameters: 25640144
[2024-03-13 11:26:34,308 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 11:26:34,308 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 11:26:34,308 INFO]  * src vocab size = 17816
[2024-03-13 11:26:34,308 INFO]  * tgt vocab size = 14144
[2024-03-13 11:26:34,310 INFO] Starting training on GPU: [0]
[2024-03-13 11:26:34,310 INFO] Start training loop and validate every 200 steps...
[2024-03-13 11:26:34,310 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-13 11:26:40,067 INFO] Step 8650/13600; acc: 9.8; ppl: 8334210.4; xent: 15.9; lr: 1.00000; sents:    2366; bsz:  569/ 497/47; 4945/4318 tok/s;      6 sec;
[2024-03-13 11:26:42,380 INFO] Step 8700/13600; acc: 8.7; ppl: 98318.8; xent: 11.5; lr: 1.00000; sents:    2369; bsz:  590/ 512/47; 12746/11060 tok/s;      8 sec;
[2024-03-13 11:26:44,716 INFO] Step 8750/13600; acc: 9.8; ppl: 35293.7; xent: 10.5; lr: 1.00000; sents:    2267; bsz:  560/ 485/45; 11990/10380 tok/s;     10 sec;
[2024-03-13 11:26:46,966 INFO] Step 8800/13600; acc: 10.1; ppl: 23296.4; xent: 10.1; lr: 1.00000; sents:    2365; bsz:  563/ 489/47; 12500/10858 tok/s;     13 sec;
[2024-03-13 11:26:50,307 INFO] valid stats calculation
                           took: 3.3405892848968506 s.
[2024-03-13 11:26:50,308 INFO] Train perplexity: 163416
[2024-03-13 11:26:50,308 INFO] Train accuracy: 9.57757
[2024-03-13 11:26:50,308 INFO] Sentences processed: 9367
[2024-03-13 11:26:50,308 INFO] Average bsz:  570/ 496/47
[2024-03-13 11:26:50,308 INFO] Validation perplexity: 233434
[2024-03-13 11:26:50,308 INFO] Validation accuracy: 12.7156
[2024-03-13 11:26:50,309 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_8800.pt
[2024-03-13 11:26:52,752 INFO] Step 8850/13600; acc: 10.0; ppl: 53367.3; xent: 10.9; lr: 1.00000; sents:    2246; bsz:  547/ 473/45; 4724/4092 tok/s;     18 sec;
[2024-03-13 11:26:55,110 INFO] Step 8900/13600; acc: 8.5; ppl: 67802.3; xent: 11.1; lr: 1.00000; sents:    2372; bsz:  589/ 511/47; 12492/10831 tok/s;     21 sec;
[2024-03-13 11:26:57,497 INFO] Step 8950/13600; acc: 9.2; ppl: 41912.6; xent: 10.6; lr: 1.00000; sents:    2275; bsz:  561/ 487/46; 11759/10201 tok/s;     23 sec;
[2024-03-13 11:26:59,846 INFO] Step 9000/13600; acc: 9.9; ppl: 12955.7; xent: 9.5; lr: 1.00000; sents:    2383; bsz:  587/ 510/48; 12494/10853 tok/s;     26 sec;
[2024-03-13 11:27:03,168 INFO] valid stats calculation
                           took: 3.3211846351623535 s.
[2024-03-13 11:27:03,168 INFO] Train perplexity: 77946.8
[2024-03-13 11:27:03,168 INFO] Train accuracy: 9.49531
[2024-03-13 11:27:03,168 INFO] Sentences processed: 18643
[2024-03-13 11:27:03,168 INFO] Average bsz:  571/ 495/47
[2024-03-13 11:27:03,168 INFO] Validation perplexity: 1836.92
[2024-03-13 11:27:03,168 INFO] Validation accuracy: 13.2371
[2024-03-13 11:27:03,170 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_9000.pt
[2024-03-13 11:27:05,607 INFO] Step 9050/13600; acc: 10.6; ppl: 7543.9; xent: 8.9; lr: 1.00000; sents:    2381; bsz:  568/ 495/48; 4930/4293 tok/s;     31 sec;
[2024-03-13 11:27:07,939 INFO] Step 9100/13600; acc: 10.2; ppl: 12991.2; xent: 9.5; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 12080/10489 tok/s;     34 sec;
[2024-03-13 11:27:10,275 INFO] Step 9150/13600; acc: 9.8; ppl: 5385.2; xent: 8.6; lr: 1.00000; sents:    2258; bsz:  553/ 478/45; 11836/10243 tok/s;     36 sec;
[2024-03-13 11:27:12,631 INFO] Step 9200/13600; acc: 8.5; ppl: 8029.6; xent: 9.0; lr: 1.00000; sents:    2366; bsz:  578/ 500/47; 12264/10621 tok/s;     38 sec;
[2024-03-13 11:27:15,953 INFO] valid stats calculation
                           took: 3.3212225437164307 s.
[2024-03-13 11:27:15,953 INFO] Train perplexity: 36799.8
[2024-03-13 11:27:15,953 INFO] Train accuracy: 9.58713
[2024-03-13 11:27:15,953 INFO] Sentences processed: 28023
[2024-03-13 11:27:15,953 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:27:15,953 INFO] Validation perplexity: 8341.36
[2024-03-13 11:27:15,953 INFO] Validation accuracy: 9.06538
[2024-03-13 11:27:15,954 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_9200.pt
[2024-03-13 11:27:18,368 INFO] Step 9250/13600; acc: 9.4; ppl: 7804.0; xent: 9.0; lr: 1.00000; sents:    2367; bsz:  567/ 499/47; 4944/4349 tok/s;     44 sec;
[2024-03-13 11:27:20,670 INFO] Step 9300/13600; acc: 8.8; ppl: 4282.3; xent: 8.4; lr: 1.00000; sents:    2364; bsz:  587/ 514/47; 12758/11155 tok/s;     46 sec;
[2024-03-13 11:27:23,040 INFO] Step 9350/13600; acc: 9.2; ppl: 6686.1; xent: 8.8; lr: 1.00000; sents:    2271; bsz:  567/ 490/45; 11957/10334 tok/s;     49 sec;
[2024-03-13 11:27:25,357 INFO] Step 9400/13600; acc: 7.1; ppl: 7164.3; xent: 8.9; lr: 1.00000; sents:    2261; bsz:  554/ 479/45; 11960/10331 tok/s;     51 sec;
[2024-03-13 11:27:28,729 INFO] valid stats calculation
                           took: 3.3717594146728516 s.
[2024-03-13 11:27:28,730 INFO] Train perplexity: 23646.7
[2024-03-13 11:27:28,730 INFO] Train accuracy: 9.34496
[2024-03-13 11:27:28,730 INFO] Sentences processed: 37286
[2024-03-13 11:27:28,730 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:27:28,730 INFO] Validation perplexity: 6478.74
[2024-03-13 11:27:28,730 INFO] Validation accuracy: 8.34336
[2024-03-13 11:27:28,731 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_9400.pt
[2024-03-13 11:27:31,183 INFO] Step 9450/13600; acc: 8.1; ppl: 6382.8; xent: 8.8; lr: 1.00000; sents:    2476; bsz:  582/ 508/50; 4993/4356 tok/s;     57 sec;
[2024-03-13 11:27:33,563 INFO] Step 9500/13600; acc: 7.5; ppl: 10313.4; xent: 9.2; lr: 1.00000; sents:    2268; bsz:  557/ 483/45; 11707/10140 tok/s;     59 sec;
[2024-03-13 11:27:35,983 INFO] Step 9550/13600; acc: 8.1; ppl: 475276.1; xent: 13.1; lr: 1.00000; sents:    2376; bsz:  565/ 495/48; 11684/10230 tok/s;     62 sec;
[2024-03-13 11:27:38,346 INFO] Step 9600/13600; acc: 7.9; ppl: 19742.0; xent: 9.9; lr: 1.00000; sents:    2381; bsz:  582/ 506/48; 12311/10698 tok/s;     64 sec;
[2024-03-13 11:27:41,669 INFO] valid stats calculation
                           took: 3.322721004486084 s.
[2024-03-13 11:27:41,670 INFO] Train perplexity: 24446.5
[2024-03-13 11:27:41,670 INFO] Train accuracy: 9.05483
[2024-03-13 11:27:41,670 INFO] Sentences processed: 46787
[2024-03-13 11:27:41,670 INFO] Average bsz:  569/ 495/47
[2024-03-13 11:27:41,670 INFO] Validation perplexity: 2369.64
[2024-03-13 11:27:41,670 INFO] Validation accuracy: 12.6755
[2024-03-13 11:27:41,671 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_9600.pt
[2024-03-13 11:27:44,131 INFO] Step 9650/13600; acc: 9.5; ppl: 10896.4; xent: 9.3; lr: 1.00000; sents:    2279; bsz:  562/ 485/46; 4856/4193 tok/s;     70 sec;
[2024-03-13 11:27:46,460 INFO] Step 9700/13600; acc: 11.5; ppl: 97471.3; xent: 11.5; lr: 1.00000; sents:    2275; bsz:  561/ 484/46; 12056/10402 tok/s;     72 sec;
[2024-03-13 11:27:48,737 INFO] Step 9750/13600; acc: 10.6; ppl: 11366.5; xent: 9.3; lr: 1.00000; sents:    2371; bsz:  564/ 488/47; 12387/10704 tok/s;     74 sec;
[2024-03-13 11:27:51,103 INFO] Step 9800/13600; acc: 9.8; ppl: 72839.5; xent: 11.2; lr: 1.00000; sents:    2366; bsz:  577/ 501/47; 12200/10590 tok/s;     77 sec;
[2024-03-13 11:27:54,432 INFO] valid stats calculation
                           took: 3.328914165496826 s.
[2024-03-13 11:27:54,433 INFO] Train perplexity: 25395.7
[2024-03-13 11:27:54,433 INFO] Train accuracy: 9.26663
[2024-03-13 11:27:54,433 INFO] Sentences processed: 56078
[2024-03-13 11:27:54,433 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:27:54,433 INFO] Validation perplexity: 184413
[2024-03-13 11:27:54,433 INFO] Validation accuracy: 10.8303
[2024-03-13 11:27:54,434 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_9800.pt
[2024-03-13 11:27:56,807 INFO] Step 9850/13600; acc: 8.1; ppl: 6248.0; xent: 8.7; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 4945/4299 tok/s;     82 sec;
[2024-03-13 11:27:59,197 INFO] Step 9900/13600; acc: 8.8; ppl: 8118.5; xent: 9.0; lr: 1.00000; sents:    2264; bsz:  582/ 502/45; 12185/10515 tok/s;     85 sec;
[2024-03-13 11:28:01,468 INFO] Step 9950/13600; acc: 9.2; ppl: 8145.4; xent: 9.0; lr: 1.00000; sents:    2369; bsz:  566/ 491/47; 12456/10816 tok/s;     87 sec;
[2024-03-13 11:28:03,738 INFO] Step 10000/13600; acc: 8.3; ppl: 9330.6; xent: 9.1; lr: 1.00000; sents:    2367; bsz:  563/ 488/47; 12402/10748 tok/s;     89 sec;
[2024-03-13 11:28:07,070 INFO] valid stats calculation
                           took: 3.332127332687378 s.
[2024-03-13 11:28:07,071 INFO] Train perplexity: 21491.8
[2024-03-13 11:28:07,071 INFO] Train accuracy: 9.16957
[2024-03-13 11:28:07,071 INFO] Sentences processed: 65444
[2024-03-13 11:28:07,071 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:28:07,071 INFO] Validation perplexity: 128092
[2024-03-13 11:28:07,071 INFO] Validation accuracy: 11.0309
[2024-03-13 11:28:07,072 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_10000.pt
[2024-03-13 11:28:09,587 INFO] Step 10050/13600; acc: 10.4; ppl: 13884.0; xent: 9.5; lr: 1.00000; sents:    2272; bsz:  578/ 497/45; 4945/4245 tok/s;     95 sec;
[2024-03-13 11:28:11,937 INFO] Step 10100/13600; acc: 7.7; ppl: 164571.1; xent: 12.0; lr: 1.00000; sents:    2371; bsz:  564/ 490/47; 12006/10421 tok/s;     98 sec;
[2024-03-13 11:28:14,301 INFO] Step 10150/13600; acc: 9.4; ppl: 5749.5; xent: 8.7; lr: 1.00000; sents:    2375; bsz:  583/ 505/48; 12333/10675 tok/s;    100 sec;
[2024-03-13 11:28:16,644 INFO] Step 10200/13600; acc: 12.2; ppl: 5195.4; xent: 8.6; lr: 1.00000; sents:    2280; bsz:  543/ 474/46; 11587/10126 tok/s;    102 sec;
[2024-03-13 11:28:19,995 INFO] valid stats calculation
                           took: 3.3506977558135986 s.
[2024-03-13 11:28:19,995 INFO] Train perplexity: 20743.8
[2024-03-13 11:28:19,995 INFO] Train accuracy: 9.26086
[2024-03-13 11:28:19,995 INFO] Sentences processed: 74742
[2024-03-13 11:28:19,995 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:28:19,996 INFO] Validation perplexity: 2089.94
[2024-03-13 11:28:19,996 INFO] Validation accuracy: 11.2314
[2024-03-13 11:28:19,997 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_10200.pt
[2024-03-13 11:28:22,446 INFO] Step 10250/13600; acc: 9.8; ppl: 3404.2; xent: 8.1; lr: 1.00000; sents:    2376; bsz:  580/ 501/48; 4996/4316 tok/s;    108 sec;
[2024-03-13 11:28:24,804 INFO] Step 10300/13600; acc: 9.6; ppl: 7199.3; xent: 8.9; lr: 1.00000; sents:    2376; bsz:  589/ 510/48; 12486/10822 tok/s;    110 sec;
[2024-03-13 11:28:27,173 INFO] Step 10350/13600; acc: 11.1; ppl: 2680.5; xent: 7.9; lr: 1.00000; sents:    2272; bsz:  543/ 474/45; 11456/10008 tok/s;    113 sec;
[2024-03-13 11:28:29,506 INFO] Step 10400/13600; acc: 11.3; ppl: 3994.1; xent: 8.3; lr: 1.00000; sents:    2366; bsz:  589/ 511/47; 12625/10953 tok/s;    115 sec;
[2024-03-13 11:28:32,836 INFO] valid stats calculation
                           took: 3.32916259765625 s.
[2024-03-13 11:28:32,836 INFO] Train perplexity: 17273
[2024-03-13 11:28:32,836 INFO] Train accuracy: 9.39492
[2024-03-13 11:28:32,836 INFO] Sentences processed: 84132
[2024-03-13 11:28:32,836 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:28:32,836 INFO] Validation perplexity: 1633.59
[2024-03-13 11:28:32,836 INFO] Validation accuracy: 14.6009
[2024-03-13 11:28:32,838 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_10400.pt
[2024-03-13 11:28:35,325 INFO] Step 10450/13600; acc: 9.9; ppl: 4509.1; xent: 8.4; lr: 1.00000; sents:    2369; bsz:  587/ 508/47; 5044/4363 tok/s;    121 sec;
[2024-03-13 11:28:37,643 INFO] Step 10500/13600; acc: 11.0; ppl: 2637.7; xent: 7.9; lr: 1.00000; sents:    2242; bsz:  548/ 475/45; 11815/10245 tok/s;    123 sec;
[2024-03-13 11:28:39,951 INFO] Step 10550/13600; acc: 11.0; ppl: 1559.9; xent: 7.4; lr: 1.00000; sents:    2365; bsz:  564/ 490/47; 12224/10629 tok/s;    126 sec;
[2024-03-13 11:28:42,340 INFO] Step 10600/13600; acc: 10.2; ppl: 3685.2; xent: 8.2; lr: 1.00000; sents:    2367; bsz:  579/ 502/47; 12127/10505 tok/s;    128 sec;
[2024-03-13 11:28:45,683 INFO] valid stats calculation
                           took: 3.3428738117218018 s.
[2024-03-13 11:28:45,683 INFO] Train perplexity: 14448.3
[2024-03-13 11:28:45,684 INFO] Train accuracy: 9.50567
[2024-03-13 11:28:45,684 INFO] Sentences processed: 93475
[2024-03-13 11:28:45,684 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:28:45,684 INFO] Validation perplexity: 4064.27
[2024-03-13 11:28:45,684 INFO] Validation accuracy: 6.33775
[2024-03-13 11:28:45,685 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_10600.pt
[2024-03-13 11:28:48,134 INFO] Step 10650/13600; acc: 10.6; ppl: 3366.4; xent: 8.1; lr: 1.00000; sents:    2268; bsz:  539/ 468/45; 4654/4039 tok/s;    134 sec;
[2024-03-13 11:28:50,518 INFO] Step 10700/13600; acc: 9.5; ppl: 11454.7; xent: 9.3; lr: 1.00000; sents:    2379; bsz:  587/ 510/48; 12304/10700 tok/s;    136 sec;
[2024-03-13 11:28:52,900 INFO] Step 10750/13600; acc: 10.7; ppl: 3383.8; xent: 8.1; lr: 1.00000; sents:    2383; bsz:  583/ 507/48; 12244/10641 tok/s;    139 sec;
[2024-03-13 11:28:55,230 INFO] Step 10800/13600; acc: 9.9; ppl: 2784.0; xent: 7.9; lr: 1.00000; sents:    2267; bsz:  555/ 479/45; 11901/10286 tok/s;    141 sec;
[2024-03-13 11:28:58,573 INFO] valid stats calculation
                           took: 3.34259295463562 s.
[2024-03-13 11:28:58,573 INFO] Train perplexity: 12982
[2024-03-13 11:28:58,573 INFO] Train accuracy: 9.56485
[2024-03-13 11:28:58,573 INFO] Sentences processed: 102772
[2024-03-13 11:28:58,573 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:28:58,573 INFO] Validation perplexity: 1957.75
[2024-03-13 11:28:58,573 INFO] Validation accuracy: 13.9992
[2024-03-13 11:28:58,575 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_10800.pt
[2024-03-13 11:29:00,986 INFO] Step 10850/13600; acc: 11.6; ppl: 1737.0; xent: 7.5; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 4891/4249 tok/s;    147 sec;
[2024-03-13 11:29:03,343 INFO] Step 10900/13600; acc: 9.8; ppl: 10611.0; xent: 9.3; lr: 1.00000; sents:    2372; bsz:  566/ 496/47; 12015/10527 tok/s;    149 sec;
[2024-03-13 11:29:05,773 INFO] Step 10950/13600; acc: 8.6; ppl: 6838.3; xent: 8.8; lr: 1.00000; sents:    2270; bsz:  587/ 508/45; 12082/10448 tok/s;    151 sec;
[2024-03-13 11:29:08,070 INFO] Step 11000/13600; acc: 11.0; ppl: 2558.0; xent: 7.8; lr: 1.00000; sents:    2367; bsz:  568/ 500/47; 12369/10881 tok/s;    154 sec;
[2024-03-13 11:29:11,411 INFO] valid stats calculation
                           took: 3.340815782546997 s.
[2024-03-13 11:29:11,411 INFO] Train perplexity: 11821.7
[2024-03-13 11:29:11,411 INFO] Train accuracy: 9.6215
[2024-03-13 11:29:11,411 INFO] Sentences processed: 112156
[2024-03-13 11:29:11,411 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:29:11,411 INFO] Validation perplexity: 1904.42
[2024-03-13 11:29:11,412 INFO] Validation accuracy: 12.5552
[2024-03-13 11:29:11,413 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_11000.pt
[2024-03-13 11:29:13,762 INFO] Step 11050/13600; acc: 9.2; ppl: 7867.2; xent: 9.0; lr: 1.00000; sents:    2364; bsz:  561/ 487/47; 4925/4280 tok/s;    159 sec;
[2024-03-13 11:29:16,124 INFO] Step 11100/13600; acc: 11.0; ppl: 10910.0; xent: 9.3; lr: 1.00000; sents:    2367; bsz:  572/ 493/47; 12104/10439 tok/s;    162 sec;
[2024-03-13 11:29:18,456 INFO] Step 11150/13600; acc: 10.3; ppl: 7744.5; xent: 9.0; lr: 1.00000; sents:    2261; bsz:  556/ 481/45; 11910/10317 tok/s;    164 sec;
[2024-03-13 11:29:20,827 INFO] Step 11200/13600; acc: 10.5; ppl: 3533.9; xent: 8.2; lr: 1.00000; sents:    2276; bsz:  563/ 487/46; 11876/10265 tok/s;    167 sec;
[2024-03-13 11:29:24,187 INFO] valid stats calculation
                           took: 3.3604745864868164 s.
[2024-03-13 11:29:24,188 INFO] Train perplexity: 11357.1
[2024-03-13 11:29:24,188 INFO] Train accuracy: 9.67099
[2024-03-13 11:29:24,188 INFO] Sentences processed: 121424
[2024-03-13 11:29:24,188 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:29:24,188 INFO] Validation perplexity: 1944.1
[2024-03-13 11:29:24,188 INFO] Validation accuracy: 11.0309
[2024-03-13 11:29:24,189 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_11200.pt
[2024-03-13 11:29:26,715 INFO] Step 11250/13600; acc: 8.8; ppl: 3342.2; xent: 8.1; lr: 1.00000; sents:    2372; bsz:  566/ 495/47; 4804/4204 tok/s;    172 sec;
[2024-03-13 11:29:29,150 INFO] Step 11300/13600; acc: 8.4; ppl: 6259.9; xent: 8.7; lr: 1.00000; sents:    2375; bsz:  580/ 505/48; 11921/10376 tok/s;    175 sec;
[2024-03-13 11:29:31,419 INFO] Step 11350/13600; acc: 10.0; ppl: 6017.3; xent: 8.7; lr: 1.00000; sents:    2381; bsz:  566/ 491/48; 12472/10820 tok/s;    177 sec;
[2024-03-13 11:29:33,731 INFO] Step 11400/13600; acc: 10.6; ppl: 3905.3; xent: 8.3; lr: 1.00000; sents:    2376; bsz:  578/ 498/48; 12504/10778 tok/s;    179 sec;
[2024-03-13 11:29:37,064 INFO] valid stats calculation
                           took: 3.3319828510284424 s.
[2024-03-13 11:29:37,064 INFO] Train perplexity: 10660.7
[2024-03-13 11:29:37,064 INFO] Train accuracy: 9.65437
[2024-03-13 11:29:37,064 INFO] Sentences processed: 130928
[2024-03-13 11:29:37,064 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:29:37,064 INFO] Validation perplexity: 4122.14
[2024-03-13 11:29:37,064 INFO] Validation accuracy: 7.05977
[2024-03-13 11:29:37,066 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_11400.pt
[2024-03-13 11:29:39,568 INFO] Step 11450/13600; acc: 10.9; ppl: 8191.1; xent: 9.0; lr: 1.00000; sents:    2275; bsz:  562/ 485/46; 4816/4158 tok/s;    185 sec;
[2024-03-13 11:29:41,990 INFO] Step 11500/13600; acc: 10.9; ppl: 6034.2; xent: 8.7; lr: 1.00000; sents:    2273; bsz:  565/ 489/45; 11668/10096 tok/s;    188 sec;
[2024-03-13 11:29:44,272 INFO] Step 11550/13600; acc: 11.2; ppl: 3883.1; xent: 8.3; lr: 1.00000; sents:    2464; bsz:  584/ 508/49; 12811/11141 tok/s;    190 sec;
[2024-03-13 11:29:46,635 INFO] Step 11600/13600; acc: 10.8; ppl: 3856.2; xent: 8.3; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 11923/10336 tok/s;    192 sec;
[2024-03-13 11:29:49,973 INFO] valid stats calculation
                           took: 3.3374319076538086 s.
[2024-03-13 11:29:49,973 INFO] Train perplexity: 10163.1
[2024-03-13 11:29:49,973 INFO] Train accuracy: 9.74025
[2024-03-13 11:29:49,973 INFO] Sentences processed: 140208
[2024-03-13 11:29:49,973 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:29:49,973 INFO] Validation perplexity: 2240.81
[2024-03-13 11:29:49,973 INFO] Validation accuracy: 12.8359
[2024-03-13 11:29:49,974 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_11600.pt
[2024-03-13 11:29:52,349 INFO] Step 11650/13600; acc: 10.3; ppl: 2507.1; xent: 7.8; lr: 1.00000; sents:    2362; bsz:  579/ 499/47; 5063/4365 tok/s;    198 sec;
[2024-03-13 11:29:54,609 INFO] Step 11700/13600; acc: 10.5; ppl: 4849.6; xent: 8.5; lr: 1.00000; sents:    2369; bsz:  564/ 489/47; 12478/10826 tok/s;    200 sec;
[2024-03-13 11:29:56,944 INFO] Step 11750/13600; acc: 11.8; ppl: 1140.1; xent: 7.0; lr: 1.00000; sents:    2267; bsz:  561/ 484/45; 12006/10361 tok/s;    203 sec;
[2024-03-13 11:29:59,301 INFO] Step 11800/13600; acc: 9.8; ppl: 2814.0; xent: 7.9; lr: 1.00000; sents:    2270; bsz:  559/ 485/45; 11864/10292 tok/s;    205 sec;
[2024-03-13 11:30:02,630 INFO] valid stats calculation
                           took: 3.329228162765503 s.
[2024-03-13 11:30:02,631 INFO] Train perplexity: 9318.21
[2024-03-13 11:30:02,631 INFO] Train accuracy: 9.79415
[2024-03-13 11:30:02,631 INFO] Sentences processed: 149476
[2024-03-13 11:30:02,631 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:30:02,631 INFO] Validation perplexity: 16745
[2024-03-13 11:30:02,631 INFO] Validation accuracy: 7.34055
[2024-03-13 11:30:02,632 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_11800.pt
[2024-03-13 11:30:05,091 INFO] Step 11850/13600; acc: 9.9; ppl: 42620.0; xent: 10.7; lr: 1.00000; sents:    2371; bsz:  566/ 493/47; 4886/4258 tok/s;    211 sec;
[2024-03-13 11:30:07,438 INFO] Step 11900/13600; acc: 9.3; ppl: 2910.3; xent: 8.0; lr: 1.00000; sents:    2375; bsz:  582/ 503/48; 12398/10726 tok/s;    213 sec;
[2024-03-13 11:30:09,801 INFO] Step 11950/13600; acc: 9.3; ppl: 8560.3; xent: 9.1; lr: 1.00000; sents:    2279; bsz:  561/ 487/46; 11879/10305 tok/s;    215 sec;
[2024-03-13 11:30:12,102 INFO] Step 12000/13600; acc: 9.7; ppl: 5078.4; xent: 8.5; lr: 1.00000; sents:    2479; bsz:  597/ 521/50; 12971/11315 tok/s;    218 sec;
[2024-03-13 11:30:15,444 INFO] valid stats calculation
                           took: 3.3417038917541504 s.
[2024-03-13 11:30:15,444 INFO] Train perplexity: 9264.64
[2024-03-13 11:30:15,444 INFO] Train accuracy: 9.77951
[2024-03-13 11:30:15,445 INFO] Sentences processed: 158980
[2024-03-13 11:30:15,445 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:30:15,445 INFO] Validation perplexity: 4865.15
[2024-03-13 11:30:15,445 INFO] Validation accuracy: 9.70718
[2024-03-13 11:30:15,446 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_12000.pt
[2024-03-13 11:30:17,934 INFO] Step 12050/13600; acc: 10.2; ppl: 2265.4; xent: 7.7; lr: 1.00000; sents:    2280; bsz:  565/ 490/46; 4846/4204 tok/s;    224 sec;
[2024-03-13 11:30:20,260 INFO] Step 12100/13600; acc: 11.4; ppl: 2517.4; xent: 7.8; lr: 1.00000; sents:    2247; bsz:  550/ 477/45; 11812/10243 tok/s;    226 sec;
[2024-03-13 11:30:22,550 INFO] Step 12150/13600; acc: 10.3; ppl: 2203.8; xent: 7.7; lr: 1.00000; sents:    2367; bsz:  565/ 490/47; 12342/10707 tok/s;    228 sec;
[2024-03-13 11:30:24,887 INFO] Step 12200/13600; acc: 9.7; ppl: 6382.9; xent: 8.8; lr: 1.00000; sents:    2368; bsz:  587/ 509/47; 12565/10883 tok/s;    231 sec;
[2024-03-13 11:30:28,210 INFO] valid stats calculation
                           took: 3.322932481765747 s.
[2024-03-13 11:30:28,210 INFO] Train perplexity: 8707.57
[2024-03-13 11:30:28,210 INFO] Train accuracy: 9.81306
[2024-03-13 11:30:28,210 INFO] Sentences processed: 168242
[2024-03-13 11:30:28,211 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:30:28,211 INFO] Validation perplexity: 99567
[2024-03-13 11:30:28,211 INFO] Validation accuracy: 8.4637
[2024-03-13 11:30:28,212 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_12200.pt
[2024-03-13 11:30:30,613 INFO] Step 12250/13600; acc: 10.3; ppl: 6151.8; xent: 8.7; lr: 1.00000; sents:    2249; bsz:  551/ 478/45; 4811/4177 tok/s;    236 sec;
[2024-03-13 11:30:32,882 INFO] Step 12300/13600; acc: 10.3; ppl: 3678.5; xent: 8.2; lr: 1.00000; sents:    2365; bsz:  561/ 486/47; 12361/10712 tok/s;    239 sec;
[2024-03-13 11:30:35,223 INFO] Step 12350/13600; acc: 9.1; ppl: 11681.5; xent: 9.4; lr: 1.00000; sents:    2372; bsz:  582/ 505/47; 12441/10790 tok/s;    241 sec;
[2024-03-13 11:30:37,617 INFO] Step 12400/13600; acc: 11.6; ppl: 4584.0; xent: 8.4; lr: 1.00000; sents:    2274; bsz:  563/ 490/45; 11758/10225 tok/s;    243 sec;
[2024-03-13 11:30:40,970 INFO] valid stats calculation
                           took: 3.3520164489746094 s.
[2024-03-13 11:30:40,970 INFO] Train perplexity: 8535.06
[2024-03-13 11:30:40,970 INFO] Train accuracy: 9.83927
[2024-03-13 11:30:40,970 INFO] Sentences processed: 177502
[2024-03-13 11:30:40,970 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:30:40,970 INFO] Validation perplexity: 1524.31
[2024-03-13 11:30:40,970 INFO] Validation accuracy: 15.363
[2024-03-13 11:30:40,972 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_12400.pt
[2024-03-13 11:30:43,425 INFO] Step 12450/13600; acc: 9.3; ppl: 12533.0; xent: 9.4; lr: 1.00000; sents:    2375; bsz:  563/ 491/48; 4846/4226 tok/s;    249 sec;
[2024-03-13 11:30:45,754 INFO] Step 12500/13600; acc: 10.1; ppl: 5219.8; xent: 8.6; lr: 1.00000; sents:    2381; bsz:  582/ 505/48; 12488/10836 tok/s;    251 sec;
[2024-03-13 11:30:48,119 INFO] Step 12550/13600; acc: 10.9; ppl: 2378.3; xent: 7.8; lr: 1.00000; sents:    2376; bsz:  583/ 509/48; 12335/10757 tok/s;    254 sec;
[2024-03-13 11:30:50,509 INFO] Step 12600/13600; acc: 11.8; ppl: 2212.1; xent: 7.7; lr: 1.00000; sents:    2278; bsz:  568/ 492/46; 11874/10292 tok/s;    256 sec;
[2024-03-13 11:30:53,843 INFO] valid stats calculation
                           took: 3.333169937133789 s.
[2024-03-13 11:30:53,844 INFO] Train perplexity: 8243.4
[2024-03-13 11:30:53,844 INFO] Train accuracy: 9.87455
[2024-03-13 11:30:53,844 INFO] Sentences processed: 186912
[2024-03-13 11:30:53,844 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:30:53,844 INFO] Validation perplexity: 2660.8
[2024-03-13 11:30:53,844 INFO] Validation accuracy: 9.66707
[2024-03-13 11:30:53,845 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_12600.pt
[2024-03-13 11:30:56,285 INFO] Step 12650/13600; acc: 10.5; ppl: 3439.5; xent: 8.1; lr: 1.00000; sents:    2372; bsz:  568/ 497/47; 4913/4300 tok/s;    262 sec;
[2024-03-13 11:30:58,699 INFO] Step 12700/13600; acc: 8.8; ppl: 4169.1; xent: 8.3; lr: 1.00000; sents:    2367; bsz:  578/ 498/47; 11966/10314 tok/s;    264 sec;
[2024-03-13 11:31:01,011 INFO] Step 12750/13600; acc: 12.4; ppl: 941.9; xent: 6.8; lr: 1.00000; sents:    2263; bsz:  556/ 481/45; 12030/10401 tok/s;    267 sec;
[2024-03-13 11:31:03,257 INFO] Step 12800/13600; acc: 13.0; ppl: 2509.1; xent: 7.8; lr: 1.00000; sents:    2364; bsz:  558/ 487/47; 12426/10836 tok/s;    269 sec;
[2024-03-13 11:31:06,596 INFO] valid stats calculation
                           took: 3.339446783065796 s.
[2024-03-13 11:31:06,597 INFO] Train perplexity: 7780.77
[2024-03-13 11:31:06,597 INFO] Train accuracy: 9.93565
[2024-03-13 11:31:06,597 INFO] Sentences processed: 196278
[2024-03-13 11:31:06,597 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:31:06,597 INFO] Validation perplexity: 7752.47
[2024-03-13 11:31:06,597 INFO] Validation accuracy: 11.2314
[2024-03-13 11:31:06,598 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_12800.pt
[2024-03-13 11:31:09,089 INFO] Step 12850/13600; acc: 11.0; ppl: 3851.5; xent: 8.3; lr: 1.00000; sents:    2367; bsz:  578/ 503/47; 4956/4314 tok/s;    275 sec;
[2024-03-13 11:31:11,464 INFO] Step 12900/13600; acc: 8.7; ppl: 18005.4; xent: 9.8; lr: 1.00000; sents:    2365; bsz:  565/ 494/47; 11906/10408 tok/s;    277 sec;
[2024-03-13 11:31:13,840 INFO] Step 12950/13600; acc: 10.7; ppl: 4984.7; xent: 8.5; lr: 1.00000; sents:    2276; bsz:  562/ 486/46; 11819/10218 tok/s;    280 sec;
[2024-03-13 11:31:16,194 INFO] Step 13000/13600; acc: 10.2; ppl: 6020.0; xent: 8.7; lr: 1.00000; sents:    2372; bsz:  565/ 491/47; 12013/10432 tok/s;    282 sec;
[2024-03-13 11:31:19,523 INFO] valid stats calculation
                           took: 3.3288557529449463 s.
[2024-03-13 11:31:19,523 INFO] Train perplexity: 7730.54
[2024-03-13 11:31:19,523 INFO] Train accuracy: 9.94592
[2024-03-13 11:31:19,523 INFO] Sentences processed: 205658
[2024-03-13 11:31:19,523 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:31:19,523 INFO] Validation perplexity: 913878
[2024-03-13 11:31:19,523 INFO] Validation accuracy: 5.5355
[2024-03-13 11:31:19,525 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_13000.pt
[2024-03-13 11:31:22,015 INFO] Step 13050/13600; acc: 9.9; ppl: 5627.2; xent: 8.6; lr: 1.00000; sents:    2375; bsz:  580/ 500/48; 4985/4292 tok/s;    288 sec;
[2024-03-13 11:31:24,379 INFO] Step 13100/13600; acc: 12.1; ppl: 2120.3; xent: 7.7; lr: 1.00000; sents:    2281; bsz:  559/ 484/46; 11812/10232 tok/s;    290 sec;
[2024-03-13 11:31:26,790 INFO] Step 13150/13600; acc: 10.8; ppl: 2835.4; xent: 7.9; lr: 1.00000; sents:    2276; bsz:  565/ 488/46; 11721/10134 tok/s;    292 sec;
[2024-03-13 11:31:29,112 INFO] Step 13200/13600; acc: 10.6; ppl: 4124.5; xent: 8.3; lr: 1.00000; sents:    2377; bsz:  567/ 492/48; 12217/10594 tok/s;    295 sec;
[2024-03-13 11:31:32,454 INFO] valid stats calculation
                           took: 3.3409950733184814 s.
[2024-03-13 11:31:32,454 INFO] Train perplexity: 7465.6
[2024-03-13 11:31:32,454 INFO] Train accuracy: 9.98549
[2024-03-13 11:31:32,454 INFO] Sentences processed: 214967
[2024-03-13 11:31:32,454 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:31:32,454 INFO] Validation perplexity: 2603.89
[2024-03-13 11:31:32,454 INFO] Validation accuracy: 13.4777
[2024-03-13 11:31:32,456 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_13200.pt
[2024-03-13 11:31:34,923 INFO] Step 13250/13600; acc: 12.3; ppl: 1205.5; xent: 7.1; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 5039/4370 tok/s;    301 sec;
[2024-03-13 11:31:37,189 INFO] Step 13300/13600; acc: 11.8; ppl: 1924.4; xent: 7.6; lr: 1.00000; sents:    2366; bsz:  563/ 489/47; 12419/10796 tok/s;    303 sec;
[2024-03-13 11:31:39,505 INFO] Step 13350/13600; acc: 10.8; ppl: 4407.0; xent: 8.4; lr: 1.00000; sents:    2263; bsz:  560/ 483/45; 12085/10428 tok/s;    305 sec;
[2024-03-13 11:31:41,766 INFO] Step 13400/13600; acc: 9.1; ppl: 6161.2; xent: 8.7; lr: 1.00000; sents:    2365; bsz:  580/ 500/47; 12822/11047 tok/s;    307 sec;
[2024-03-13 11:31:45,102 INFO] valid stats calculation
                           took: 3.3356919288635254 s.
[2024-03-13 11:31:45,102 INFO] Train perplexity: 7166.2
[2024-03-13 11:31:45,102 INFO] Train accuracy: 10.0274
[2024-03-13 11:31:45,102 INFO] Sentences processed: 224332
[2024-03-13 11:31:45,102 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:31:45,102 INFO] Validation perplexity: 4509.54
[2024-03-13 11:31:45,102 INFO] Validation accuracy: 6.77898
[2024-03-13 11:31:45,104 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_13400.pt
[2024-03-13 11:31:47,517 INFO] Step 13450/13600; acc: 11.2; ppl: 2437.8; xent: 7.8; lr: 1.00000; sents:    2367; bsz:  586/ 507/47; 5091/4408 tok/s;    313 sec;
[2024-03-13 11:31:49,827 INFO] Step 13500/13600; acc: 9.8; ppl: 2857.2; xent: 8.0; lr: 1.00000; sents:    2267; bsz:  557/ 483/45; 12049/10448 tok/s;    316 sec;
[2024-03-13 11:31:52,151 INFO] Step 13550/13600; acc: 11.3; ppl: 8472.8; xent: 9.0; lr: 1.00000; sents:    2372; bsz:  564/ 492/47; 12138/10600 tok/s;    318 sec;
[2024-03-13 11:31:54,517 INFO] Step 13600/13600; acc: 13.2; ppl: 1035.5; xent: 6.9; lr: 1.00000; sents:    2371; bsz:  590/ 510/47; 12464/10785 tok/s;    320 sec;
[2024-03-13 11:31:57,843 INFO] valid stats calculation
                           took: 3.325686454772949 s.
[2024-03-13 11:31:57,843 INFO] Train perplexity: 6896.4
[2024-03-13 11:31:57,843 INFO] Train accuracy: 10.083
[2024-03-13 11:31:57,843 INFO] Sentences processed: 233709
[2024-03-13 11:31:57,843 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:31:57,843 INFO] Validation perplexity: 1878.67
[2024-03-13 11:31:57,843 INFO] Validation accuracy: 13.3173
[2024-03-13 11:31:57,845 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_02_step_13600.pt
