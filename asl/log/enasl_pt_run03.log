[2024-03-11 10:18:40,002 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-11 10:18:40,002 INFO] Parsed 2 corpora from -data.
[2024-03-11 10:18:40,002 INFO] Get special vocabs from Transforms: {'src': [], 'tgt': []}.
[2024-03-11 10:18:40,038 INFO] The first 10 tokens of the vocabs are:['<unk>', '<blank>', '<s>', '</s>', '.', 'the', ',', 'of', 'to', 'is']
[2024-03-11 10:18:40,038 INFO] The decoder start token is: <s>
[2024-03-11 10:18:40,038 INFO] Building model...
[2024-03-11 10:18:40,275 INFO] Switching model to float32 for amp/apex_amp
[2024-03-11 10:18:40,275 INFO] Non quantized layer compute is fp32
[2024-03-11 10:18:42,853 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(500, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(1000, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-11 10:18:42,854 INFO] encoder: 12916000
[2024-03-11 10:18:42,854 INFO] decoder: 19916144
[2024-03-11 10:18:42,854 INFO] * number of parameters: 32832144
[2024-03-11 10:18:42,854 INFO] Trainable parameters = {'torch.float32': 32832144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-11 10:18:42,854 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-11 10:18:42,854 INFO]  * src vocab size = 17816
[2024-03-11 10:18:42,854 INFO]  * tgt vocab size = 14144
[2024-03-11 10:18:42,855 INFO] Starting training on GPU: [0]
[2024-03-11 10:18:42,855 INFO] Start training loop and validate every 200 steps...
[2024-03-11 10:18:42,855 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-11 10:19:00,751 INFO] Step 50/10000; acc: 5.4; ppl: 63935.8; xent: 11.1; lr: 1.00000; sents:    3163; bsz:  866/ 755/63; 2420/2110 tok/s;     18 sec;
[2024-03-11 10:19:02,644 INFO] Step 100/10000; acc: 6.5; ppl: 13138.0; xent: 9.5; lr: 1.00000; sents:    3200; bsz:  714/ 618/64; 18869/16335 tok/s;     20 sec;
[2024-03-11 10:19:04,927 INFO] Step 150/10000; acc: 6.0; ppl: 3191.4; xent: 8.1; lr: 1.00000; sents:    3200; bsz:  918/ 797/64; 20098/17463 tok/s;     22 sec;
[2024-03-11 10:19:06,313 INFO] Step 200/10000; acc: 7.5; ppl: 1504.5; xent: 7.3; lr: 1.00000; sents:    3200; bsz:  815/ 714/64; 29433/25783 tok/s;     23 sec;
[2024-03-11 10:19:09,947 INFO] valid stats calculation
                           took: 3.6335837841033936 s.
[2024-03-11 10:19:09,947 INFO] Train perplexity: 7862.62
[2024-03-11 10:19:09,947 INFO] Train accuracy: 6.31005
[2024-03-11 10:19:09,947 INFO] Sentences processed: 12763
[2024-03-11 10:19:09,947 INFO] Average bsz:  828/ 721/64
[2024-03-11 10:19:09,947 INFO] Validation perplexity: 12125.7
[2024-03-11 10:19:09,947 INFO] Validation accuracy: 0.120337
[2024-03-11 10:19:09,949 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_200.pt
[2024-03-11 10:19:12,316 INFO] Step 250/10000; acc: 8.1; ppl: 940.5; xent: 6.8; lr: 1.00000; sents:    3200; bsz:  946/ 812/64; 7879/6759 tok/s;     29 sec;
[2024-03-11 10:19:14,439 INFO] Step 300/10000; acc: 9.1; ppl: 790.4; xent: 6.7; lr: 1.00000; sents:    3200; bsz:  840/ 753/64; 19792/17734 tok/s;     32 sec;
[2024-03-11 10:19:16,475 INFO] Step 350/10000; acc: 11.6; ppl: 641.2; xent: 6.5; lr: 1.00000; sents:    3200; bsz:  813/ 695/64; 19968/17064 tok/s;     34 sec;
[2024-03-11 10:19:18,307 INFO] Step 400/10000; acc: 12.4; ppl: 597.6; xent: 6.4; lr: 1.00000; sents:    3200; bsz:  835/ 738/64; 22797/20142 tok/s;     35 sec;
[2024-03-11 10:19:21,892 INFO] valid stats calculation
                           took: 3.5844006538391113 s.
[2024-03-11 10:19:21,893 INFO] Train perplexity: 2353.2
[2024-03-11 10:19:21,893 INFO] Train accuracy: 8.30027
[2024-03-11 10:19:21,893 INFO] Sentences processed: 25563
[2024-03-11 10:19:21,893 INFO] Average bsz:  843/ 735/64
[2024-03-11 10:19:21,893 INFO] Validation perplexity: 7184.9
[2024-03-11 10:19:21,893 INFO] Validation accuracy: 4.65303
[2024-03-11 10:19:21,894 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_400.pt
[2024-03-11 10:19:24,338 INFO] Step 450/10000; acc: 11.6; ppl: 540.4; xent: 6.3; lr: 1.00000; sents:    3200; bsz:  936/ 814/64; 7758/6752 tok/s;     41 sec;
[2024-03-11 10:19:26,524 INFO] Step 500/10000; acc: 13.8; ppl: 445.6; xent: 6.1; lr: 1.00000; sents:    3200; bsz:  873/ 755/64; 19973/17273 tok/s;     44 sec;
[2024-03-11 10:19:28,662 INFO] Step 550/10000; acc: 16.6; ppl: 352.9; xent: 5.9; lr: 1.00000; sents:    3200; bsz:  859/ 752/64; 20093/17596 tok/s;     46 sec;
[2024-03-11 10:19:30,845 INFO] Step 600/10000; acc: 17.9; ppl: 324.6; xent: 5.8; lr: 1.00000; sents:    3200; bsz:  878/ 769/64; 20114/17612 tok/s;     48 sec;
[2024-03-11 10:19:34,512 INFO] valid stats calculation
                           took: 3.6668901443481445 s.
[2024-03-11 10:19:34,512 INFO] Train perplexity: 1288.42
[2024-03-11 10:19:34,512 INFO] Train accuracy: 10.5796
[2024-03-11 10:19:34,513 INFO] Sentences processed: 38363
[2024-03-11 10:19:34,513 INFO] Average bsz:  858/ 748/64
[2024-03-11 10:19:34,513 INFO] Validation perplexity: 16765.9
[2024-03-11 10:19:34,513 INFO] Validation accuracy: 5.09426
[2024-03-11 10:19:34,514 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_600.pt
[2024-03-11 10:19:36,478 INFO] Step 650/10000; acc: 20.3; ppl: 289.4; xent: 5.7; lr: 1.00000; sents:    3200; bsz:  870/ 735/64; 7725/6525 tok/s;     54 sec;
[2024-03-11 10:19:38,714 INFO] Step 700/10000; acc: 25.1; ppl: 194.2; xent: 5.3; lr: 1.00000; sents:    3200; bsz:  861/ 784/64; 19271/17550 tok/s;     56 sec;
[2024-03-11 10:19:40,827 INFO] Step 750/10000; acc: 31.5; ppl: 140.7; xent: 4.9; lr: 1.00000; sents:    3200; bsz:  870/ 751/64; 20592/17772 tok/s;     58 sec;
[2024-03-11 10:19:42,926 INFO] Step 800/10000; acc: 40.0; ppl:  76.9; xent: 4.3; lr: 1.00000; sents:    3200; bsz:  817/ 732/64; 19455/17443 tok/s;     60 sec;
[2024-03-11 10:19:46,477 INFO] valid stats calculation
                           took: 3.550553560256958 s.
[2024-03-11 10:19:46,478 INFO] Train perplexity: 760.733
[2024-03-11 10:19:46,478 INFO] Train accuracy: 15.2422
[2024-03-11 10:19:46,478 INFO] Sentences processed: 51163
[2024-03-11 10:19:46,478 INFO] Average bsz:  857/ 748/64
[2024-03-11 10:19:46,478 INFO] Validation perplexity: 40847.8
[2024-03-11 10:19:46,478 INFO] Validation accuracy: 5.65584
[2024-03-11 10:19:46,479 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_800.pt
[2024-03-11 10:19:47,871 INFO] Step 850/10000; acc: 46.0; ppl:  50.1; xent: 3.9; lr: 1.00000; sents:    3200; bsz:  893/ 771/64; 9035/7792 tok/s;     65 sec;
[2024-03-11 10:19:49,017 INFO] Step 900/10000; acc: 54.3; ppl:  26.3; xent: 3.3; lr: 1.00000; sents:    3200; bsz:  838/ 721/64; 36603/31472 tok/s;     66 sec;
[2024-03-11 10:19:50,279 INFO] Step 950/10000; acc: 58.9; ppl:  17.7; xent: 2.9; lr: 1.00000; sents:    3200; bsz:  896/ 805/64; 35487/31905 tok/s;     67 sec;
[2024-03-11 10:19:51,424 INFO] Step 1000/10000; acc: 62.4; ppl:  14.7; xent: 2.7; lr: 1.00000; sents:    3200; bsz:  847/ 736/64; 36990/32127 tok/s;     69 sec;
[2024-03-11 10:19:54,964 INFO] valid stats calculation
                           took: 3.5387918949127197 s.
[2024-03-11 10:19:54,964 INFO] Train perplexity: 379.062
[2024-03-11 10:19:54,964 INFO] Train accuracy: 23.3563
[2024-03-11 10:19:54,964 INFO] Sentences processed: 63963
[2024-03-11 10:19:54,964 INFO] Average bsz:  859/ 750/64
[2024-03-11 10:19:54,964 INFO] Validation perplexity: 407407
[2024-03-11 10:19:54,964 INFO] Validation accuracy: 7.74168
[2024-03-11 10:19:54,966 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_1000.pt
[2024-03-11 10:19:56,332 INFO] Step 1050/10000; acc: 65.4; ppl:  11.4; xent: 2.4; lr: 1.00000; sents:    3200; bsz:  943/ 813/64; 9612/8283 tok/s;     73 sec;
[2024-03-11 10:19:57,520 INFO] Step 1100/10000; acc: 70.4; ppl:   7.8; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  884/ 783/64; 37227/32971 tok/s;     75 sec;
[2024-03-11 10:19:58,755 INFO] Step 1150/10000; acc: 72.8; ppl:   6.5; xent: 1.9; lr: 1.00000; sents:    3200; bsz:  936/ 824/64; 37888/33359 tok/s;     76 sec;
[2024-03-11 10:19:59,935 INFO] Step 1200/10000; acc: 73.7; ppl:   6.2; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  887/ 778/64; 37603/32994 tok/s;     77 sec;
[2024-03-11 10:20:03,550 INFO] valid stats calculation
                           took: 3.614285469055176 s.
[2024-03-11 10:20:03,550 INFO] Train perplexity: 191.342
[2024-03-11 10:20:03,550 INFO] Train accuracy: 31.6518
[2024-03-11 10:20:03,550 INFO] Sentences processed: 76763
[2024-03-11 10:20:03,550 INFO] Average bsz:  868/ 759/64
[2024-03-11 10:20:03,550 INFO] Validation perplexity: 749588
[2024-03-11 10:20:03,550 INFO] Validation accuracy: 7.94224
[2024-03-11 10:20:03,552 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_1200.pt
[2024-03-11 10:20:04,847 INFO] Step 1250/10000; acc: 75.3; ppl:   5.5; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  838/ 730/64; 8534/7429 tok/s;     82 sec;
[2024-03-11 10:20:06,004 INFO] Step 1300/10000; acc: 76.0; ppl:   5.4; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  852/ 746/64; 36878/32263 tok/s;     83 sec;
[2024-03-11 10:20:07,225 INFO] Step 1350/10000; acc: 75.2; ppl:   5.8; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  936/ 804/64; 38298/32904 tok/s;     84 sec;
[2024-03-11 10:20:08,503 INFO] Step 1400/10000; acc: 78.7; ppl:   4.3; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  891/ 768/64; 34865/30054 tok/s;     86 sec;
[2024-03-11 10:20:11,933 INFO] valid stats calculation
                           took: 3.429037094116211 s.
[2024-03-11 10:20:11,933 INFO] Train perplexity: 114.092
[2024-03-11 10:20:11,933 INFO] Train accuracy: 38.0534
[2024-03-11 10:20:11,933 INFO] Sentences processed: 89563
[2024-03-11 10:20:11,933 INFO] Average bsz:  870/ 759/64
[2024-03-11 10:20:11,933 INFO] Validation perplexity: 3.01531e+06
[2024-03-11 10:20:11,933 INFO] Validation accuracy: 7.26033
[2024-03-11 10:20:11,935 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_1400.pt
[2024-03-11 10:20:14,163 INFO] Step 1450/10000; acc: 78.9; ppl:   4.4; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  831/ 727/64; 7339/6424 tok/s;     91 sec;
[2024-03-11 10:20:16,020 INFO] Step 1500/10000; acc: 78.3; ppl:   4.7; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  891/ 770/64; 24004/20737 tok/s;     93 sec;
[2024-03-11 10:20:17,094 INFO] Step 1550/10000; acc: 79.9; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  771/ 672/64; 35906/31310 tok/s;     94 sec;
[2024-03-11 10:20:18,227 INFO] Step 1600/10000; acc: 80.2; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  842/ 732/64; 37176/32309 tok/s;     95 sec;
[2024-03-11 10:20:21,754 INFO] valid stats calculation
                           took: 3.5262069702148438 s.
[2024-03-11 10:20:21,754 INFO] Train perplexity: 76.8874
[2024-03-11 10:20:21,754 INFO] Train accuracy: 43.0065
[2024-03-11 10:20:21,754 INFO] Sentences processed: 102363
[2024-03-11 10:20:21,754 INFO] Average bsz:  865/ 755/64
[2024-03-11 10:20:21,754 INFO] Validation perplexity: 5.67818e+06
[2024-03-11 10:20:21,754 INFO] Validation accuracy: 8.02246
[2024-03-11 10:20:21,756 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_1600.pt
[2024-03-11 10:20:24,047 INFO] Step 1650/10000; acc: 81.2; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  838/ 741/64; 7203/6369 tok/s;    101 sec;
[2024-03-11 10:20:26,080 INFO] Step 1700/10000; acc: 81.5; ppl:   3.5; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  815/ 706/64; 20061/17375 tok/s;    103 sec;
[2024-03-11 10:20:27,446 INFO] Step 1750/10000; acc: 82.4; ppl:   3.5; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  929/ 807/64; 34021/29529 tok/s;    105 sec;
[2024-03-11 10:20:28,676 INFO] Step 1800/10000; acc: 81.7; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  936/ 805/64; 38017/32719 tok/s;    106 sec;
[2024-03-11 10:20:32,232 INFO] valid stats calculation
                           took: 3.5553207397460938 s.
[2024-03-11 10:20:32,233 INFO] Train perplexity: 54.4683
[2024-03-11 10:20:32,233 INFO] Train accuracy: 47.3546
[2024-03-11 10:20:32,233 INFO] Sentences processed: 115163
[2024-03-11 10:20:32,233 INFO] Average bsz:  867/ 756/64
[2024-03-11 10:20:32,233 INFO] Validation perplexity: 4.97557e+06
[2024-03-11 10:20:32,233 INFO] Validation accuracy: 7.26033
[2024-03-11 10:20:32,235 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_1800.pt
[2024-03-11 10:20:34,563 INFO] Step 1850/10000; acc: 83.3; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  887/ 767/64; 7534/6514 tok/s;    112 sec;
[2024-03-11 10:20:36,747 INFO] Step 1900/10000; acc: 83.3; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  899/ 785/64; 20574/17966 tok/s;    114 sec;
[2024-03-11 10:20:38,588 INFO] Step 1950/10000; acc: 82.7; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  925/ 789/64; 25143/21438 tok/s;    116 sec;
[2024-03-11 10:20:39,792 INFO] Step 2000/10000; acc: 82.8; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  940/ 805/64; 39018/33413 tok/s;    117 sec;
[2024-03-11 10:20:43,387 INFO] valid stats calculation
                           took: 3.5948052406311035 s.
[2024-03-11 10:20:43,388 INFO] Train perplexity: 40.6804
[2024-03-11 10:20:43,388 INFO] Train accuracy: 51.0505
[2024-03-11 10:20:43,388 INFO] Sentences processed: 127963
[2024-03-11 10:20:43,388 INFO] Average bsz:  872/ 759/64
[2024-03-11 10:20:43,388 INFO] Validation perplexity: 5.60824e+06
[2024-03-11 10:20:43,388 INFO] Validation accuracy: 8.22302
[2024-03-11 10:20:43,389 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_2000.pt
[2024-03-11 10:20:45,775 INFO] Step 2050/10000; acc: 82.5; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  934/ 800/64; 7809/6689 tok/s;    123 sec;
[2024-03-11 10:20:47,777 INFO] Step 2100/10000; acc: 84.6; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  785/ 702/64; 19609/17519 tok/s;    125 sec;
[2024-03-11 10:20:49,873 INFO] Step 2150/10000; acc: 84.1; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  856/ 761/64; 20415/18150 tok/s;    127 sec;
[2024-03-11 10:20:51,186 INFO] Step 2200/10000; acc: 85.2; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  948/ 818/64; 36134/31160 tok/s;    128 sec;
[2024-03-11 10:20:54,750 INFO] valid stats calculation
                           took: 3.5635600090026855 s.
[2024-03-11 10:20:54,750 INFO] Train perplexity: 31.9854
[2024-03-11 10:20:54,750 INFO] Train accuracy: 54.092
[2024-03-11 10:20:54,750 INFO] Sentences processed: 140763
[2024-03-11 10:20:54,751 INFO] Average bsz:  872/ 760/64
[2024-03-11 10:20:54,751 INFO] Validation perplexity: 1.37539e+07
[2024-03-11 10:20:54,751 INFO] Validation accuracy: 8.22302
[2024-03-11 10:20:54,752 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_2200.pt
[2024-03-11 10:20:57,093 INFO] Step 2250/10000; acc: 84.9; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  906/ 781/64; 7672/6614 tok/s;    134 sec;
[2024-03-11 10:20:59,237 INFO] Step 2300/10000; acc: 85.0; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  890/ 776/64; 20740/18084 tok/s;    136 sec;
[2024-03-11 10:21:01,284 INFO] Step 2350/10000; acc: 83.8; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  810/ 690/64; 19777/16867 tok/s;    138 sec;
[2024-03-11 10:21:02,865 INFO] Step 2400/10000; acc: 85.4; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  835/ 709/64; 26397/22429 tok/s;    140 sec;
[2024-03-11 10:21:06,519 INFO] valid stats calculation
                           took: 3.653721570968628 s.
[2024-03-11 10:21:06,520 INFO] Train perplexity: 26.302
[2024-03-11 10:21:06,520 INFO] Train accuracy: 56.5861
[2024-03-11 10:21:06,520 INFO] Sentences processed: 153563
[2024-03-11 10:21:06,520 INFO] Average bsz:  871/ 758/64
[2024-03-11 10:21:06,520 INFO] Validation perplexity: 1.55878e+07
[2024-03-11 10:21:06,520 INFO] Validation accuracy: 8.30325
[2024-03-11 10:21:06,522 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_2400.pt
[2024-03-11 10:21:08,823 INFO] Step 2450/10000; acc: 85.5; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  905/ 784/64; 7596/6580 tok/s;    146 sec;
[2024-03-11 10:21:10,716 INFO] Step 2500/10000; acc: 84.8; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  768/ 668/64; 20286/17646 tok/s;    148 sec;
[2024-03-11 10:21:12,945 INFO] Step 2550/10000; acc: 85.9; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  943/ 808/64; 21169/18124 tok/s;    150 sec;
[2024-03-11 10:21:15,097 INFO] Step 2600/10000; acc: 87.0; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  900/ 794/64; 20925/18455 tok/s;    152 sec;
[2024-03-11 10:21:18,738 INFO] valid stats calculation
                           took: 3.640479803085327 s.
[2024-03-11 10:21:18,738 INFO] Train perplexity: 22.0339
[2024-03-11 10:21:18,738 INFO] Train accuracy: 58.8496
[2024-03-11 10:21:18,738 INFO] Sentences processed: 166363
[2024-03-11 10:21:18,738 INFO] Average bsz:  872/ 759/64
[2024-03-11 10:21:18,738 INFO] Validation perplexity: 2.94801e+07
[2024-03-11 10:21:18,738 INFO] Validation accuracy: 7.94224
[2024-03-11 10:21:18,740 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_2600.pt
[2024-03-11 10:21:20,773 INFO] Step 2650/10000; acc: 87.8; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  824/ 726/64; 7261/6391 tok/s;    158 sec;
[2024-03-11 10:21:22,876 INFO] Step 2700/10000; acc: 86.1; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  858/ 749/64; 20385/17799 tok/s;    160 sec;
[2024-03-11 10:21:25,091 INFO] Step 2750/10000; acc: 86.8; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  879/ 765/64; 19855/17283 tok/s;    162 sec;
[2024-03-11 10:21:27,036 INFO] Step 2800/10000; acc: 87.1; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  792/ 696/64; 20375/17898 tok/s;    164 sec;
[2024-03-11 10:21:30,653 INFO] valid stats calculation
                           took: 3.616645574569702 s.
[2024-03-11 10:21:30,653 INFO] Train perplexity: 18.9269
[2024-03-11 10:21:30,653 INFO] Train accuracy: 60.7958
[2024-03-11 10:21:30,653 INFO] Sentences processed: 179163
[2024-03-11 10:21:30,653 INFO] Average bsz:  870/ 757/64
[2024-03-11 10:21:30,653 INFO] Validation perplexity: 5.14309e+07
[2024-03-11 10:21:30,653 INFO] Validation accuracy: 8.38347
[2024-03-11 10:21:30,655 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_2800.pt
[2024-03-11 10:21:32,383 INFO] Step 2850/10000; acc: 86.9; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  859/ 742/64; 8036/6935 tok/s;    170 sec;
[2024-03-11 10:21:34,604 INFO] Step 2900/10000; acc: 87.6; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  881/ 771/64; 19820/17343 tok/s;    172 sec;
[2024-03-11 10:21:36,797 INFO] Step 2950/10000; acc: 87.6; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  916/ 784/64; 20899/17879 tok/s;    174 sec;
[2024-03-11 10:21:38,844 INFO] Step 3000/10000; acc: 88.0; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  803/ 707/64; 19615/17265 tok/s;    176 sec;
[2024-03-11 10:21:42,357 INFO] valid stats calculation
                           took: 3.512896776199341 s.
[2024-03-11 10:21:42,357 INFO] Train perplexity: 16.5027
[2024-03-11 10:21:42,357 INFO] Train accuracy: 62.5637
[2024-03-11 10:21:42,357 INFO] Sentences processed: 191963
[2024-03-11 10:21:42,357 INFO] Average bsz:  869/ 757/64
[2024-03-11 10:21:42,357 INFO] Validation perplexity: 5.53716e+07
[2024-03-11 10:21:42,358 INFO] Validation accuracy: 9.70718
[2024-03-11 10:21:42,359 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_3000.pt
[2024-03-11 10:21:43,763 INFO] Step 3050/10000; acc: 86.8; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  896/ 766/64; 9110/7788 tok/s;    181 sec;
[2024-03-11 10:21:45,759 INFO] Step 3100/10000; acc: 86.9; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  897/ 743/64; 22465/18615 tok/s;    183 sec;
[2024-03-11 10:21:47,771 INFO] Step 3150/10000; acc: 88.1; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  795/ 698/64; 19756/17338 tok/s;    185 sec;
[2024-03-11 10:21:49,911 INFO] Step 3200/10000; acc: 88.7; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  819/ 729/64; 19145/17048 tok/s;    187 sec;
[2024-03-11 10:21:53,457 INFO] valid stats calculation
                           took: 3.546393394470215 s.
[2024-03-11 10:21:53,458 INFO] Train perplexity: 14.666
[2024-03-11 10:21:53,458 INFO] Train accuracy: 64.0861
[2024-03-11 10:21:53,458 INFO] Sentences processed: 204763
[2024-03-11 10:21:53,458 INFO] Average bsz:  868/ 755/64
[2024-03-11 10:21:53,458 INFO] Validation perplexity: 3.94761e+07
[2024-03-11 10:21:53,458 INFO] Validation accuracy: 9.22583
[2024-03-11 10:21:53,459 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_3200.pt
[2024-03-11 10:21:54,874 INFO] Step 3250/10000; acc: 88.5; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  922/ 819/64; 9284/8247 tok/s;    192 sec;
[2024-03-11 10:21:56,580 INFO] Step 3300/10000; acc: 88.7; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  941/ 820/64; 27589/24060 tok/s;    194 sec;
[2024-03-11 10:21:58,684 INFO] Step 3350/10000; acc: 89.6; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  863/ 756/64; 20499/17975 tok/s;    196 sec;
[2024-03-11 10:22:00,837 INFO] Step 3400/10000; acc: 89.2; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  840/ 732/64; 19501/17002 tok/s;    198 sec;
[2024-03-11 10:22:04,317 INFO] valid stats calculation
                           took: 3.4796621799468994 s.
[2024-03-11 10:22:04,318 INFO] Train perplexity: 13.0254
[2024-03-11 10:22:04,318 INFO] Train accuracy: 65.6004
[2024-03-11 10:22:04,318 INFO] Sentences processed: 217563
[2024-03-11 10:22:04,318 INFO] Average bsz:  869/ 757/64
[2024-03-11 10:22:04,318 INFO] Validation perplexity: 5.16168e+07
[2024-03-11 10:22:04,318 INFO] Validation accuracy: 8.4637
[2024-03-11 10:22:04,319 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_3400.pt
[2024-03-11 10:22:05,635 INFO] Step 3450/10000; acc: 89.8; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  850/ 765/64; 8858/7971 tok/s;    203 sec;
[2024-03-11 10:22:06,837 INFO] Step 3500/10000; acc: 89.3; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  863/ 751/64; 35901/31232 tok/s;    204 sec;
[2024-03-11 10:22:08,923 INFO] Step 3550/10000; acc: 88.1; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  897/ 786/64; 21509/18838 tok/s;    206 sec;
[2024-03-11 10:22:11,172 INFO] Step 3600/10000; acc: 88.5; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  886/ 799/64; 19699/17771 tok/s;    208 sec;
[2024-03-11 10:22:14,549 INFO] valid stats calculation
                           took: 3.3765389919281006 s.
[2024-03-11 10:22:14,549 INFO] Train perplexity: 11.7679
[2024-03-11 10:22:14,549 INFO] Train accuracy: 66.9254
[2024-03-11 10:22:14,549 INFO] Sentences processed: 230363
[2024-03-11 10:22:14,549 INFO] Average bsz:  870/ 758/64
[2024-03-11 10:22:14,549 INFO] Validation perplexity: 7.67671e+07
[2024-03-11 10:22:14,549 INFO] Validation accuracy: 8.18291
[2024-03-11 10:22:14,551 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_3600.pt
[2024-03-11 10:22:15,886 INFO] Step 3650/10000; acc: 89.1; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  874/ 748/64; 9272/7933 tok/s;    213 sec;
[2024-03-11 10:22:17,055 INFO] Step 3700/10000; acc: 88.5; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  884/ 754/64; 37846/32265 tok/s;    214 sec;
[2024-03-11 10:22:18,572 INFO] Step 3750/10000; acc: 89.1; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  855/ 751/64; 28179/24756 tok/s;    216 sec;
[2024-03-11 10:22:20,608 INFO] Step 3800/10000; acc: 90.1; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  832/ 711/64; 20430/17452 tok/s;    218 sec;
[2024-03-11 10:22:24,011 INFO] valid stats calculation
                           took: 3.4023361206054688 s.
[2024-03-11 10:22:24,011 INFO] Train perplexity: 10.7692
[2024-03-11 10:22:24,011 INFO] Train accuracy: 68.0732
[2024-03-11 10:22:24,011 INFO] Sentences processed: 243163
[2024-03-11 10:22:24,011 INFO] Average bsz:  869/ 757/64
[2024-03-11 10:22:24,011 INFO] Validation perplexity: 1.18586e+08
[2024-03-11 10:22:24,011 INFO] Validation accuracy: 8.90493
[2024-03-11 10:22:24,013 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_3800.pt
[2024-03-11 10:22:25,720 INFO] Step 3850/10000; acc: 90.0; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  823/ 716/64; 8050/6999 tok/s;    223 sec;
[2024-03-11 10:22:26,917 INFO] Step 3900/10000; acc: 90.1; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  915/ 797/64; 38255/33333 tok/s;    224 sec;
[2024-03-11 10:22:28,086 INFO] Step 3950/10000; acc: 89.1; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  831/ 731/64; 35514/31246 tok/s;    225 sec;
[2024-03-11 10:22:29,901 INFO] Step 4000/10000; acc: 89.4; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  923/ 804/64; 25430/22146 tok/s;    227 sec;
[2024-03-11 10:22:33,318 INFO] valid stats calculation
                           took: 3.4159293174743652 s.
[2024-03-11 10:22:33,318 INFO] Train perplexity: 9.90823
[2024-03-11 10:22:33,318 INFO] Train accuracy: 69.1599
[2024-03-11 10:22:33,318 INFO] Sentences processed: 255963
[2024-03-11 10:22:33,318 INFO] Average bsz:  869/ 757/64
[2024-03-11 10:22:33,318 INFO] Validation perplexity: 1.17513e+08
[2024-03-11 10:22:33,318 INFO] Validation accuracy: 7.501
[2024-03-11 10:22:33,320 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_4000.pt
[2024-03-11 10:22:35,527 INFO] Step 4050/10000; acc: 89.5; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  797/ 699/64; 7087/6211 tok/s;    233 sec;
[2024-03-11 10:22:37,001 INFO] Step 4100/10000; acc: 89.8; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  913/ 831/64; 30973/28190 tok/s;    234 sec;
[2024-03-11 10:22:38,197 INFO] Step 4150/10000; acc: 89.4; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  897/ 771/64; 37529/32236 tok/s;    235 sec;
[2024-03-11 10:22:39,399 INFO] Step 4200/10000; acc: 89.8; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  858/ 734/64; 35690/30559 tok/s;    237 sec;
[2024-03-11 10:22:42,939 INFO] valid stats calculation
                           took: 3.539644241333008 s.
[2024-03-11 10:22:42,939 INFO] Train perplexity: 9.18574
[2024-03-11 10:22:42,939 INFO] Train accuracy: 70.1356
[2024-03-11 10:22:42,939 INFO] Sentences processed: 268763
[2024-03-11 10:22:42,939 INFO] Average bsz:  869/ 757/64
[2024-03-11 10:22:42,939 INFO] Validation perplexity: 2.23069e+08
[2024-03-11 10:22:42,939 INFO] Validation accuracy: 8.30325
[2024-03-11 10:22:42,941 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_4200.pt
[2024-03-11 10:22:45,114 INFO] Step 4250/10000; acc: 90.6; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  806/ 727/64; 7055/6359 tok/s;    242 sec;
[2024-03-11 10:22:46,832 INFO] Step 4300/10000; acc: 89.5; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  828/ 728/64; 24098/21193 tok/s;    244 sec;
[2024-03-11 10:22:47,965 INFO] Step 4350/10000; acc: 90.4; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  858/ 736/64; 37862/32492 tok/s;    245 sec;
[2024-03-11 10:22:49,026 INFO] Step 4400/10000; acc: 91.3; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  720/ 641/64; 33919/30224 tok/s;    246 sec;
[2024-03-11 10:22:52,497 INFO] valid stats calculation
                           took: 3.4699654579162598 s.
[2024-03-11 10:22:52,497 INFO] Train perplexity: 8.59285
[2024-03-11 10:22:52,497 INFO] Train accuracy: 71.0009
[2024-03-11 10:22:52,497 INFO] Sentences processed: 281563
[2024-03-11 10:22:52,497 INFO] Average bsz:  866/ 755/64
[2024-03-11 10:22:52,497 INFO] Validation perplexity: 1.72482e+08
[2024-03-11 10:22:52,497 INFO] Validation accuracy: 8.70437
[2024-03-11 10:22:52,499 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_4400.pt
[2024-03-11 10:22:54,819 INFO] Step 4450/10000; acc: 90.4; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  858/ 743/64; 7409/6413 tok/s;    252 sec;
[2024-03-11 10:22:56,981 INFO] Step 4500/10000; acc: 90.5; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  913/ 771/64; 21121/17842 tok/s;    254 sec;
[2024-03-11 10:22:58,483 INFO] Step 4550/10000; acc: 90.5; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  864/ 742/64; 28755/24705 tok/s;    256 sec;
[2024-03-11 10:22:59,496 INFO] Step 4600/10000; acc: 91.3; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  755/ 650/64; 37291/32086 tok/s;    257 sec;
[2024-03-11 10:23:03,035 INFO] valid stats calculation
                           took: 3.5393223762512207 s.
[2024-03-11 10:23:03,036 INFO] Train perplexity: 8.06422
[2024-03-11 10:23:03,036 INFO] Train accuracy: 71.825
[2024-03-11 10:23:03,036 INFO] Sentences processed: 294363
[2024-03-11 10:23:03,036 INFO] Average bsz:  865/ 754/64
[2024-03-11 10:23:03,036 INFO] Validation perplexity: 1.78961e+08
[2024-03-11 10:23:03,036 INFO] Validation accuracy: 8.22302
[2024-03-11 10:23:03,038 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_4600.pt
[2024-03-11 10:23:05,304 INFO] Step 4650/10000; acc: 90.6; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  838/ 748/64; 7217/6438 tok/s;    262 sec;
[2024-03-11 10:23:07,609 INFO] Step 4700/10000; acc: 90.2; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  918/ 786/64; 19907/17060 tok/s;    265 sec;
[2024-03-11 10:23:09,820 INFO] Step 4750/10000; acc: 90.8; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  908/ 790/64; 20529/17865 tok/s;    267 sec;
[2024-03-11 10:23:10,983 INFO] Step 4800/10000; acc: 91.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  847/ 748/64; 36421/32132 tok/s;    268 sec;
[2024-03-11 10:23:14,654 INFO] valid stats calculation
                           took: 3.6704676151275635 s.
[2024-03-11 10:23:14,655 INFO] Train perplexity: 7.58512
[2024-03-11 10:23:14,655 INFO] Train accuracy: 72.6258
[2024-03-11 10:23:14,655 INFO] Sentences processed: 307163
[2024-03-11 10:23:14,655 INFO] Average bsz:  866/ 754/64
[2024-03-11 10:23:14,655 INFO] Validation perplexity: 2.16176e+08
[2024-03-11 10:23:14,655 INFO] Validation accuracy: 8.1428
[2024-03-11 10:23:14,656 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_4800.pt
[2024-03-11 10:23:16,968 INFO] Step 4850/10000; acc: 91.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  855/ 745/64; 7144/6221 tok/s;    274 sec;
[2024-03-11 10:23:19,083 INFO] Step 4900/10000; acc: 91.0; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  868/ 745/64; 20517/17614 tok/s;    276 sec;
[2024-03-11 10:23:21,034 INFO] Step 4950/10000; acc: 91.4; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  776/ 674/64; 19885/17274 tok/s;    278 sec;
[2024-03-11 10:23:22,672 INFO] Step 5000/10000; acc: 90.7; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  888/ 765/64; 27104/23348 tok/s;    280 sec;
[2024-03-11 10:23:26,299 INFO] valid stats calculation
                           took: 3.6262106895446777 s.
[2024-03-11 10:23:26,299 INFO] Train perplexity: 7.18256
[2024-03-11 10:23:26,299 INFO] Train accuracy: 73.3426
[2024-03-11 10:23:26,299 INFO] Sentences processed: 319963
[2024-03-11 10:23:26,299 INFO] Average bsz:  865/ 753/64
[2024-03-11 10:23:26,299 INFO] Validation perplexity: 2.22585e+08
[2024-03-11 10:23:26,299 INFO] Validation accuracy: 7.86201
[2024-03-11 10:23:26,301 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_5000.pt
[2024-03-11 10:23:28,583 INFO] Step 5050/10000; acc: 91.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  901/ 779/64; 7622/6586 tok/s;    286 sec;
[2024-03-11 10:23:30,754 INFO] Step 5100/10000; acc: 91.1; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  854/ 762/64; 19668/17545 tok/s;    288 sec;
[2024-03-11 10:23:32,789 INFO] Step 5150/10000; acc: 91.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  819/ 721/64; 20133/17710 tok/s;    290 sec;
[2024-03-11 10:23:34,980 INFO] Step 5200/10000; acc: 91.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  930/ 800/64; 21215/18255 tok/s;    292 sec;
[2024-03-11 10:23:38,585 INFO] valid stats calculation
                           took: 3.604631185531616 s.
[2024-03-11 10:23:38,586 INFO] Train perplexity: 6.80892
[2024-03-11 10:23:38,586 INFO] Train accuracy: 74.0371
[2024-03-11 10:23:38,586 INFO] Sentences processed: 332763
[2024-03-11 10:23:38,586 INFO] Average bsz:  866/ 754/64
[2024-03-11 10:23:38,586 INFO] Validation perplexity: 3.12609e+08
[2024-03-11 10:23:38,586 INFO] Validation accuracy: 8.1428
[2024-03-11 10:23:38,587 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_5200.pt
[2024-03-11 10:23:40,808 INFO] Step 5250/10000; acc: 91.7; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  850/ 729/64; 7292/6257 tok/s;    298 sec;
[2024-03-11 10:23:42,802 INFO] Step 5300/10000; acc: 91.6; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  790/ 690/64; 19814/17313 tok/s;    300 sec;
[2024-03-11 10:23:44,856 INFO] Step 5350/10000; acc: 92.1; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  837/ 749/64; 20375/18225 tok/s;    302 sec;
[2024-03-11 10:23:47,009 INFO] Step 5400/10000; acc: 91.6; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  838/ 714/64; 19473/16590 tok/s;    304 sec;
[2024-03-11 10:23:50,582 INFO] valid stats calculation
                           took: 3.5727150440216064 s.
[2024-03-11 10:23:50,582 INFO] Train perplexity: 6.48506
[2024-03-11 10:23:50,583 INFO] Train accuracy: 74.6659
[2024-03-11 10:23:50,583 INFO] Sentences processed: 345563
[2024-03-11 10:23:50,583 INFO] Average bsz:  864/ 753/64
[2024-03-11 10:23:50,583 INFO] Validation perplexity: 4.43687e+08
[2024-03-11 10:23:50,583 INFO] Validation accuracy: 8.86482
[2024-03-11 10:23:50,584 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_5400.pt
[2024-03-11 10:23:52,318 INFO] Step 5450/10000; acc: 92.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  847/ 766/64; 7981/7212 tok/s;    309 sec;
[2024-03-11 10:23:54,555 INFO] Step 5500/10000; acc: 91.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  946/ 826/64; 21142/18452 tok/s;    312 sec;
[2024-03-11 10:23:56,572 INFO] Step 5550/10000; acc: 90.4; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  827/ 699/64; 20502/17325 tok/s;    314 sec;
[2024-03-11 10:23:58,693 INFO] Step 5600/10000; acc: 90.7; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  887/ 764/64; 20916/18022 tok/s;    316 sec;
[2024-03-11 10:24:02,195 INFO] valid stats calculation
                           took: 3.5018386840820312 s.
[2024-03-11 10:24:02,195 INFO] Train perplexity: 6.19347
[2024-03-11 10:24:02,195 INFO] Train accuracy: 75.2696
[2024-03-11 10:24:02,195 INFO] Sentences processed: 358363
[2024-03-11 10:24:02,196 INFO] Average bsz:  865/ 753/64
[2024-03-11 10:24:02,196 INFO] Validation perplexity: 3.71638e+08
[2024-03-11 10:24:02,196 INFO] Validation accuracy: 8.82471
[2024-03-11 10:24:02,197 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_5600.pt
[2024-03-11 10:24:03,577 INFO] Step 5650/10000; acc: 91.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  868/ 777/64; 8889/7954 tok/s;    321 sec;
[2024-03-11 10:24:05,626 INFO] Step 5700/10000; acc: 91.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  905/ 775/64; 22087/18926 tok/s;    323 sec;
[2024-03-11 10:24:07,775 INFO] Step 5750/10000; acc: 91.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  876/ 771/64; 20373/17931 tok/s;    325 sec;
[2024-03-11 10:24:10,072 INFO] Step 5800/10000; acc: 91.2; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  938/ 837/64; 20424/18221 tok/s;    327 sec;
[2024-03-11 10:24:13,616 INFO] valid stats calculation
                           took: 3.542987108230591 s.
[2024-03-11 10:24:13,616 INFO] Train perplexity: 5.92517
[2024-03-11 10:24:13,616 INFO] Train accuracy: 75.8492
[2024-03-11 10:24:13,616 INFO] Sentences processed: 371163
[2024-03-11 10:24:13,616 INFO] Average bsz:  866/ 754/64
[2024-03-11 10:24:13,616 INFO] Validation perplexity: 4.18738e+08
[2024-03-11 10:24:13,616 INFO] Validation accuracy: 8.94505
[2024-03-11 10:24:13,618 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_5800.pt
[2024-03-11 10:24:14,951 INFO] Step 5850/10000; acc: 91.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  868/ 767/64; 8895/7859 tok/s;    332 sec;
[2024-03-11 10:24:16,597 INFO] Step 5900/10000; acc: 91.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  867/ 754/64; 26323/22919 tok/s;    334 sec;
[2024-03-11 10:24:18,617 INFO] Step 5950/10000; acc: 92.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  817/ 712/64; 20216/17638 tok/s;    336 sec;
[2024-03-11 10:24:20,698 INFO] Step 6000/10000; acc: 92.1; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  852/ 736/64; 20484/17692 tok/s;    338 sec;
[2024-03-11 10:24:24,140 INFO] valid stats calculation
                           took: 3.4423036575317383 s.
[2024-03-11 10:24:24,141 INFO] Train perplexity: 5.69263
[2024-03-11 10:24:24,141 INFO] Train accuracy: 76.3752
[2024-03-11 10:24:24,141 INFO] Sentences processed: 383963
[2024-03-11 10:24:24,141 INFO] Average bsz:  865/ 754/64
[2024-03-11 10:24:24,141 INFO] Validation perplexity: 4.23742e+08
[2024-03-11 10:24:24,141 INFO] Validation accuracy: 8.94505
[2024-03-11 10:24:24,142 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_6000.pt
[2024-03-11 10:24:25,458 INFO] Step 6050/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  852/ 737/64; 8955/7739 tok/s;    343 sec;
[2024-03-11 10:24:26,603 INFO] Step 6100/10000; acc: 92.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  812/ 714/64; 35421/31168 tok/s;    344 sec;
[2024-03-11 10:24:28,260 INFO] Step 6150/10000; acc: 92.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  756/ 671/64; 22838/20258 tok/s;    345 sec;
[2024-03-11 10:24:30,256 INFO] Step 6200/10000; acc: 92.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  836/ 727/64; 20940/18224 tok/s;    347 sec;
[2024-03-11 10:24:33,687 INFO] valid stats calculation
                           took: 3.4308347702026367 s.
[2024-03-11 10:24:33,687 INFO] Train perplexity: 5.48466
[2024-03-11 10:24:33,688 INFO] Train accuracy: 76.8628
[2024-03-11 10:24:33,688 INFO] Sentences processed: 396763
[2024-03-11 10:24:33,688 INFO] Average bsz:  864/ 753/64
[2024-03-11 10:24:33,688 INFO] Validation perplexity: 3.55069e+08
[2024-03-11 10:24:33,688 INFO] Validation accuracy: 9.22583
[2024-03-11 10:24:33,689 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_6200.pt
[2024-03-11 10:24:35,048 INFO] Step 6250/10000; acc: 91.1; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  908/ 791/64; 9473/8249 tok/s;    352 sec;
[2024-03-11 10:24:36,370 INFO] Step 6300/10000; acc: 92.0; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  828/ 732/64; 31336/27686 tok/s;    354 sec;
[2024-03-11 10:24:37,561 INFO] Step 6350/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  832/ 717/64; 34947/30109 tok/s;    355 sec;
[2024-03-11 10:24:39,662 INFO] Step 6400/10000; acc: 91.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  858/ 755/64; 20410/17956 tok/s;    357 sec;
[2024-03-11 10:24:43,097 INFO] valid stats calculation
                           took: 3.4340734481811523 s.
[2024-03-11 10:24:43,097 INFO] Train perplexity: 5.2953
[2024-03-11 10:24:43,097 INFO] Train accuracy: 77.3273
[2024-03-11 10:24:43,097 INFO] Sentences processed: 409563
[2024-03-11 10:24:43,097 INFO] Average bsz:  863/ 752/64
[2024-03-11 10:24:43,097 INFO] Validation perplexity: 8.37334e+08
[2024-03-11 10:24:43,097 INFO] Validation accuracy: 9.14561
[2024-03-11 10:24:43,099 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_6400.pt
[2024-03-11 10:24:45,063 INFO] Step 6450/10000; acc: 92.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  799/ 701/64; 7396/6487 tok/s;    362 sec;
[2024-03-11 10:24:46,205 INFO] Step 6500/10000; acc: 92.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  852/ 736/64; 37304/32227 tok/s;    363 sec;
[2024-03-11 10:24:47,370 INFO] Step 6550/10000; acc: 92.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  869/ 745/64; 37336/32002 tok/s;    365 sec;
[2024-03-11 10:24:48,905 INFO] Step 6600/10000; acc: 92.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  925/ 798/64; 30148/25984 tok/s;    366 sec;
[2024-03-11 10:24:52,387 INFO] valid stats calculation
                           took: 3.481890916824341 s.
[2024-03-11 10:24:52,387 INFO] Train perplexity: 5.11678
[2024-03-11 10:24:52,387 INFO] Train accuracy: 77.7804
[2024-03-11 10:24:52,387 INFO] Sentences processed: 422363
[2024-03-11 10:24:52,387 INFO] Average bsz:  863/ 752/64
[2024-03-11 10:24:52,387 INFO] Validation perplexity: 7.03017e+08
[2024-03-11 10:24:52,387 INFO] Validation accuracy: 8.62415
[2024-03-11 10:24:52,389 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_6600.pt
[2024-03-11 10:24:54,834 INFO] Step 6650/10000; acc: 92.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  924/ 827/64; 7791/6972 tok/s;    372 sec;
[2024-03-11 10:24:56,143 INFO] Step 6700/10000; acc: 92.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  849/ 747/64; 32454/28541 tok/s;    373 sec;
[2024-03-11 10:24:57,302 INFO] Step 6750/10000; acc: 91.9; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  858/ 748/64; 37017/32292 tok/s;    374 sec;
[2024-03-11 10:24:58,470 INFO] Step 6800/10000; acc: 92.1; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  839/ 722/64; 35914/30903 tok/s;    376 sec;
[2024-03-11 10:25:01,998 INFO] valid stats calculation
                           took: 3.5280282497406006 s.
[2024-03-11 10:25:01,998 INFO] Train perplexity: 4.95157
[2024-03-11 10:25:01,998 INFO] Train accuracy: 78.2172
[2024-03-11 10:25:01,998 INFO] Sentences processed: 435163
[2024-03-11 10:25:01,998 INFO] Average bsz:  864/ 752/64
[2024-03-11 10:25:01,999 INFO] Validation perplexity: 7.99798e+08
[2024-03-11 10:25:01,999 INFO] Validation accuracy: 8.86482
[2024-03-11 10:25:02,000 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_6800.pt
[2024-03-11 10:25:04,319 INFO] Step 6850/10000; acc: 92.0; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  862/ 758/64; 7369/6482 tok/s;    381 sec;
[2024-03-11 10:25:06,218 INFO] Step 6900/10000; acc: 91.7; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  928/ 796/64; 24441/20968 tok/s;    383 sec;
[2024-03-11 10:25:07,356 INFO] Step 6950/10000; acc: 92.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  850/ 730/64; 37344/32068 tok/s;    385 sec;
[2024-03-11 10:25:08,577 INFO] Step 7000/10000; acc: 91.6; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  900/ 794/64; 36855/32504 tok/s;    386 sec;
[2024-03-11 10:25:12,062 INFO] valid stats calculation
                           took: 3.484421730041504 s.
[2024-03-11 10:25:12,062 INFO] Train perplexity: 4.80347
[2024-03-11 10:25:12,062 INFO] Train accuracy: 78.6148
[2024-03-11 10:25:12,062 INFO] Sentences processed: 447963
[2024-03-11 10:25:12,062 INFO] Average bsz:  864/ 753/64
[2024-03-11 10:25:12,062 INFO] Validation perplexity: 2.00439e+09
[2024-03-11 10:25:12,062 INFO] Validation accuracy: 7.42078
[2024-03-11 10:25:12,064 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_7000.pt
[2024-03-11 10:25:14,361 INFO] Step 7050/10000; acc: 92.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  878/ 757/64; 7591/6540 tok/s;    392 sec;
[2024-03-11 10:25:16,424 INFO] Step 7100/10000; acc: 92.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  845/ 727/64; 20480/17633 tok/s;    394 sec;
[2024-03-11 10:25:17,876 INFO] Step 7150/10000; acc: 92.1; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  851/ 742/64; 29319/25555 tok/s;    395 sec;
[2024-03-11 10:25:19,064 INFO] Step 7200/10000; acc: 92.0; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  899/ 778/64; 37845/32764 tok/s;    396 sec;
[2024-03-11 10:25:22,767 INFO] valid stats calculation
                           took: 3.7028982639312744 s.
[2024-03-11 10:25:22,768 INFO] Train perplexity: 4.66894
[2024-03-11 10:25:22,768 INFO] Train accuracy: 78.9913
[2024-03-11 10:25:22,768 INFO] Sentences processed: 460763
[2024-03-11 10:25:22,768 INFO] Average bsz:  864/ 753/64
[2024-03-11 10:25:22,768 INFO] Validation perplexity: 1.19015e+09
[2024-03-11 10:25:22,768 INFO] Validation accuracy: 8.62415
[2024-03-11 10:25:22,769 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_7200.pt
[2024-03-11 10:25:25,088 INFO] Step 7250/10000; acc: 92.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  846/ 743/64; 7023/6169 tok/s;    402 sec;
[2024-03-11 10:25:27,394 INFO] Step 7300/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  940/ 811/64; 20369/17584 tok/s;    405 sec;
[2024-03-11 10:25:29,259 INFO] Step 7350/10000; acc: 92.1; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  837/ 712/64; 22454/19099 tok/s;    406 sec;
[2024-03-11 10:25:30,458 INFO] Step 7400/10000; acc: 92.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  904/ 778/64; 37717/32430 tok/s;    408 sec;
[2024-03-11 10:25:34,034 INFO] valid stats calculation
                           took: 3.5753962993621826 s.
[2024-03-11 10:25:34,035 INFO] Train perplexity: 4.54304
[2024-03-11 10:25:34,035 INFO] Train accuracy: 79.3547
[2024-03-11 10:25:34,035 INFO] Sentences processed: 473563
[2024-03-11 10:25:34,035 INFO] Average bsz:  865/ 753/64
[2024-03-11 10:25:34,035 INFO] Validation perplexity: 8.86726e+08
[2024-03-11 10:25:34,035 INFO] Validation accuracy: 8.94505
[2024-03-11 10:25:34,036 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_7400.pt
[2024-03-11 10:25:36,274 INFO] Step 7450/10000; acc: 92.4; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  839/ 712/64; 7212/6120 tok/s;    413 sec;
[2024-03-11 10:25:38,407 INFO] Step 7500/10000; acc: 92.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  858/ 756/64; 20107/17723 tok/s;    416 sec;
[2024-03-11 10:25:40,462 INFO] Step 7550/10000; acc: 92.8; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  822/ 716/64; 20001/17437 tok/s;    418 sec;
[2024-03-11 10:25:41,868 INFO] Step 7600/10000; acc: 92.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  778/ 670/64; 27674/23810 tok/s;    419 sec;
[2024-03-11 10:25:45,499 INFO] valid stats calculation
                           took: 3.630180835723877 s.
[2024-03-11 10:25:45,499 INFO] Train perplexity: 4.4309
[2024-03-11 10:25:45,499 INFO] Train accuracy: 79.6847
[2024-03-11 10:25:45,499 INFO] Sentences processed: 486363
[2024-03-11 10:25:45,499 INFO] Average bsz:  864/ 752/64
[2024-03-11 10:25:45,499 INFO] Validation perplexity: 2.15009e+09
[2024-03-11 10:25:45,499 INFO] Validation accuracy: 9.34617
[2024-03-11 10:25:45,501 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_7600.pt
[2024-03-11 10:25:47,828 INFO] Step 7650/10000; acc: 91.7; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  933/ 787/64; 7828/6604 tok/s;    425 sec;
[2024-03-11 10:25:50,093 INFO] Step 7700/10000; acc: 92.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  920/ 799/64; 20320/17641 tok/s;    427 sec;
[2024-03-11 10:25:52,411 INFO] Step 7750/10000; acc: 92.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  943/ 850/64; 20352/18346 tok/s;    430 sec;
[2024-03-11 10:25:54,322 INFO] Step 7800/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  968/ 849/64; 25322/22209 tok/s;    431 sec;
[2024-03-11 10:25:57,938 INFO] valid stats calculation
                           took: 3.6155917644500732 s.
[2024-03-11 10:25:57,938 INFO] Train perplexity: 4.31147
[2024-03-11 10:25:57,938 INFO] Train accuracy: 80.0414
[2024-03-11 10:25:57,938 INFO] Sentences processed: 499163
[2024-03-11 10:25:57,938 INFO] Average bsz:  866/ 754/64
[2024-03-11 10:25:57,938 INFO] Validation perplexity: 1.42764e+09
[2024-03-11 10:25:57,938 INFO] Validation accuracy: 8.18291
[2024-03-11 10:25:57,940 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_7800.pt
[2024-03-11 10:26:00,164 INFO] Step 7850/10000; acc: 92.8; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  823/ 719/64; 7045/6158 tok/s;    437 sec;
[2024-03-11 10:26:02,366 INFO] Step 7900/10000; acc: 92.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  865/ 771/64; 19644/17506 tok/s;    440 sec;
[2024-03-11 10:26:04,640 INFO] Step 7950/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  927/ 812/64; 20381/17847 tok/s;    442 sec;
[2024-03-11 10:26:06,713 INFO] Step 8000/10000; acc: 92.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  906/ 809/64; 21859/19512 tok/s;    444 sec;
[2024-03-11 10:26:10,369 INFO] valid stats calculation
                           took: 3.6558151245117188 s.
[2024-03-11 10:26:10,370 INFO] Train perplexity: 4.20491
[2024-03-11 10:26:10,370 INFO] Train accuracy: 80.3673
[2024-03-11 10:26:10,370 INFO] Sentences processed: 511963
[2024-03-11 10:26:10,370 INFO] Average bsz:  866/ 754/64
[2024-03-11 10:26:10,370 INFO] Validation perplexity: 1.23042e+09
[2024-03-11 10:26:10,370 INFO] Validation accuracy: 8.86482
[2024-03-11 10:26:10,371 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_8000.pt
[2024-03-11 10:26:12,697 INFO] Step 8050/10000; acc: 92.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  899/ 775/64; 7509/6476 tok/s;    450 sec;
[2024-03-11 10:26:14,764 INFO] Step 8100/10000; acc: 92.4; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  841/ 720/64; 20342/17418 tok/s;    452 sec;
[2024-03-11 10:26:16,833 INFO] Step 8150/10000; acc: 93.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  851/ 733/64; 20572/17722 tok/s;    454 sec;
[2024-03-11 10:26:18,963 INFO] Step 8200/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  861/ 741/64; 20227/17396 tok/s;    456 sec;
[2024-03-11 10:26:22,596 INFO] valid stats calculation
                           took: 3.6333515644073486 s.
[2024-03-11 10:26:22,597 INFO] Train perplexity: 4.11224
[2024-03-11 10:26:22,597 INFO] Train accuracy: 80.6625
[2024-03-11 10:26:22,597 INFO] Sentences processed: 524763
[2024-03-11 10:26:22,597 INFO] Average bsz:  866/ 754/64
[2024-03-11 10:26:22,597 INFO] Validation perplexity: 9.45302e+08
[2024-03-11 10:26:22,597 INFO] Validation accuracy: 8.10269
[2024-03-11 10:26:22,598 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_8200.pt
[2024-03-11 10:26:24,842 INFO] Step 8250/10000; acc: 93.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  841/ 735/64; 7152/6248 tok/s;    462 sec;
[2024-03-11 10:26:26,951 INFO] Step 8300/10000; acc: 93.2; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  856/ 748/64; 20306/17726 tok/s;    464 sec;
[2024-03-11 10:26:29,093 INFO] Step 8350/10000; acc: 93.0; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  842/ 742/64; 19664/17312 tok/s;    466 sec;
[2024-03-11 10:26:31,334 INFO] Step 8400/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  884/ 784/64; 19719/17497 tok/s;    468 sec;
[2024-03-11 10:26:34,847 INFO] valid stats calculation
                           took: 3.512789249420166 s.
[2024-03-11 10:26:34,848 INFO] Train perplexity: 4.02092
[2024-03-11 10:26:34,848 INFO] Train accuracy: 80.9572
[2024-03-11 10:26:34,848 INFO] Sentences processed: 537563
[2024-03-11 10:26:34,848 INFO] Average bsz:  866/ 754/64
[2024-03-11 10:26:34,848 INFO] Validation perplexity: 1.50956e+09
[2024-03-11 10:26:34,848 INFO] Validation accuracy: 8.7846
[2024-03-11 10:26:34,849 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_8400.pt
[2024-03-11 10:26:36,839 INFO] Step 8450/10000; acc: 92.4; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  895/ 748/64; 8127/6790 tok/s;    474 sec;
[2024-03-11 10:26:38,827 INFO] Step 8500/10000; acc: 93.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  774/ 687/64; 19479/17283 tok/s;    476 sec;
[2024-03-11 10:26:40,983 INFO] Step 8550/10000; acc: 93.2; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  845/ 737/64; 19594/17100 tok/s;    478 sec;
[2024-03-11 10:26:43,205 INFO] Step 8600/10000; acc: 93.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  909/ 772/64; 20454/17385 tok/s;    480 sec;
[2024-03-11 10:26:46,710 INFO] valid stats calculation
                           took: 3.5044660568237305 s.
[2024-03-11 10:26:46,710 INFO] Train perplexity: 3.93644
[2024-03-11 10:26:46,710 INFO] Train accuracy: 81.2348
[2024-03-11 10:26:46,710 INFO] Sentences processed: 550363
[2024-03-11 10:26:46,710 INFO] Average bsz:  865/ 754/64
[2024-03-11 10:26:46,710 INFO] Validation perplexity: 2.43461e+09
[2024-03-11 10:26:46,710 INFO] Validation accuracy: 9.22583
[2024-03-11 10:26:46,712 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_8600.pt
[2024-03-11 10:26:47,993 INFO] Step 8650/10000; acc: 94.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  774/ 697/64; 8087/7277 tok/s;    485 sec;
[2024-03-11 10:26:49,944 INFO] Step 8700/10000; acc: 93.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  751/ 672/64; 19258/17234 tok/s;    487 sec;
[2024-03-11 10:26:52,106 INFO] Step 8750/10000; acc: 93.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  855/ 750/64; 19781/17354 tok/s;    489 sec;
[2024-03-11 10:26:54,235 INFO] Step 8800/10000; acc: 93.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  838/ 739/64; 19687/17361 tok/s;    491 sec;
[2024-03-11 10:26:57,705 INFO] valid stats calculation
                           took: 3.469682455062866 s.
[2024-03-11 10:26:57,706 INFO] Train perplexity: 3.85722
[2024-03-11 10:26:57,706 INFO] Train accuracy: 81.4974
[2024-03-11 10:26:57,706 INFO] Sentences processed: 563163
[2024-03-11 10:26:57,706 INFO] Average bsz:  864/ 753/64
[2024-03-11 10:26:57,706 INFO] Validation perplexity: 1.8674e+09
[2024-03-11 10:26:57,706 INFO] Validation accuracy: 8.22302
[2024-03-11 10:26:57,707 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_8800.pt
[2024-03-11 10:26:59,043 INFO] Step 8850/10000; acc: 93.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  899/ 752/64; 9346/7824 tok/s;    496 sec;
[2024-03-11 10:27:00,700 INFO] Step 8900/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  896/ 779/64; 27025/23521 tok/s;    498 sec;
[2024-03-11 10:27:02,988 INFO] Step 8950/10000; acc: 93.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  969/ 845/64; 21180/18473 tok/s;    500 sec;
[2024-03-11 10:27:05,082 INFO] Step 9000/10000; acc: 93.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  837/ 747/64; 19989/17844 tok/s;    502 sec;
[2024-03-11 10:27:08,676 INFO] valid stats calculation
                           took: 3.594186544418335 s.
[2024-03-11 10:27:08,677 INFO] Train perplexity: 3.78143
[2024-03-11 10:27:08,677 INFO] Train accuracy: 81.7622
[2024-03-11 10:27:08,677 INFO] Sentences processed: 575963
[2024-03-11 10:27:08,677 INFO] Average bsz:  865/ 753/64
[2024-03-11 10:27:08,677 INFO] Validation perplexity: 2.11034e+09
[2024-03-11 10:27:08,677 INFO] Validation accuracy: 8.42359
[2024-03-11 10:27:08,678 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_9000.pt
[2024-03-11 10:27:10,077 INFO] Step 9050/10000; acc: 92.8; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  895/ 791/64; 8961/7919 tok/s;    507 sec;
[2024-03-11 10:27:11,407 INFO] Step 9100/10000; acc: 92.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  937/ 810/64; 35227/30447 tok/s;    509 sec;
[2024-03-11 10:27:13,299 INFO] Step 9150/10000; acc: 93.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  822/ 714/64; 21723/18884 tok/s;    510 sec;
[2024-03-11 10:27:15,305 INFO] Step 9200/10000; acc: 93.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  768/ 692/64; 19141/17259 tok/s;    512 sec;
[2024-03-11 10:27:18,962 INFO] valid stats calculation
                           took: 3.6567444801330566 s.
[2024-03-11 10:27:18,963 INFO] Train perplexity: 3.71097
[2024-03-11 10:27:18,963 INFO] Train accuracy: 82.0102
[2024-03-11 10:27:18,963 INFO] Sentences processed: 588763
[2024-03-11 10:27:18,963 INFO] Average bsz:  865/ 753/64
[2024-03-11 10:27:18,963 INFO] Validation perplexity: 1.60183e+09
[2024-03-11 10:27:18,963 INFO] Validation accuracy: 8.42359
[2024-03-11 10:27:18,964 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_9200.pt
[2024-03-11 10:27:20,277 INFO] Step 9250/10000; acc: 93.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  794/ 698/64; 7981/7020 tok/s;    517 sec;
[2024-03-11 10:27:21,518 INFO] Step 9300/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  905/ 799/64; 36459/32184 tok/s;    519 sec;
[2024-03-11 10:27:22,865 INFO] Step 9350/10000; acc: 93.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  869/ 757/64; 32278/28116 tok/s;    520 sec;
[2024-03-11 10:27:25,160 INFO] Step 9400/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  961/ 834/64; 20930/18169 tok/s;    522 sec;
[2024-03-11 10:27:28,756 INFO] valid stats calculation
                           took: 3.594888687133789 s.
[2024-03-11 10:27:28,756 INFO] Train perplexity: 3.64609
[2024-03-11 10:27:28,756 INFO] Train accuracy: 82.2459
[2024-03-11 10:27:28,756 INFO] Sentences processed: 601563
[2024-03-11 10:27:28,756 INFO] Average bsz:  865/ 754/64
[2024-03-11 10:27:28,756 INFO] Validation perplexity: 1.85061e+09
[2024-03-11 10:27:28,756 INFO] Validation accuracy: 8.98516
[2024-03-11 10:27:28,758 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_9400.pt
[2024-03-11 10:27:30,492 INFO] Step 9450/10000; acc: 92.6; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  909/ 783/64; 8527/7344 tok/s;    528 sec;
[2024-03-11 10:27:31,686 INFO] Step 9500/10000; acc: 93.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  842/ 758/64; 35297/31783 tok/s;    529 sec;
[2024-03-11 10:27:32,799 INFO] Step 9550/10000; acc: 93.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  774/ 671/64; 34799/30155 tok/s;    530 sec;
[2024-03-11 10:27:34,466 INFO] Step 9600/10000; acc: 93.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  775/ 684/64; 23251/20501 tok/s;    532 sec;
[2024-03-11 10:27:37,893 INFO] valid stats calculation
                           took: 3.4268436431884766 s.
[2024-03-11 10:27:37,894 INFO] Train perplexity: 3.58569
[2024-03-11 10:27:37,894 INFO] Train accuracy: 82.4689
[2024-03-11 10:27:37,894 INFO] Sentences processed: 614363
[2024-03-11 10:27:37,894 INFO] Average bsz:  864/ 753/64
[2024-03-11 10:27:37,894 INFO] Validation perplexity: 1.93637e+09
[2024-03-11 10:27:37,894 INFO] Validation accuracy: 8.4637
[2024-03-11 10:27:37,895 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_9600.pt
[2024-03-11 10:27:40,033 INFO] Step 9650/10000; acc: 94.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  754/ 654/64; 6772/5872 tok/s;    537 sec;
[2024-03-11 10:27:41,413 INFO] Step 9700/10000; acc: 93.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  831/ 724/64; 30095/26246 tok/s;    539 sec;
[2024-03-11 10:27:42,605 INFO] Step 9750/10000; acc: 93.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  902/ 777/64; 37871/32619 tok/s;    540 sec;
[2024-03-11 10:27:43,878 INFO] Step 9800/10000; acc: 93.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  941/ 807/64; 36957/31683 tok/s;    541 sec;
[2024-03-11 10:27:47,371 INFO] valid stats calculation
                           took: 3.4922420978546143 s.
[2024-03-11 10:27:47,371 INFO] Train perplexity: 3.52529
[2024-03-11 10:27:47,371 INFO] Train accuracy: 82.6907
[2024-03-11 10:27:47,371 INFO] Sentences processed: 627163
[2024-03-11 10:27:47,371 INFO] Average bsz:  864/ 753/64
[2024-03-11 10:27:47,371 INFO] Validation perplexity: 1.95517e+09
[2024-03-11 10:27:47,371 INFO] Validation accuracy: 8.94505
[2024-03-11 10:27:47,373 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_9800.pt
[2024-03-11 10:27:49,671 INFO] Step 9850/10000; acc: 93.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  875/ 762/64; 7552/6574 tok/s;    547 sec;
[2024-03-11 10:27:51,552 INFO] Step 9900/10000; acc: 93.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  862/ 758/64; 22929/20145 tok/s;    549 sec;
[2024-03-11 10:27:52,821 INFO] Step 9950/10000; acc: 92.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  936/ 824/64; 36903/32479 tok/s;    550 sec;
[2024-03-11 10:27:54,060 INFO] Step 10000/10000; acc: 93.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  922/ 805/64; 37207/32504 tok/s;    551 sec;
[2024-03-11 10:27:57,556 INFO] valid stats calculation
                           took: 3.4956321716308594 s.
[2024-03-11 10:27:57,556 INFO] Train perplexity: 3.46798
[2024-03-11 10:27:57,556 INFO] Train accuracy: 82.9077
[2024-03-11 10:27:57,556 INFO] Sentences processed: 639963
[2024-03-11 10:27:57,556 INFO] Average bsz:  865/ 754/64
[2024-03-11 10:27:57,556 INFO] Validation perplexity: 2.47237e+09
[2024-03-11 10:27:57,556 INFO] Validation accuracy: 8.58404
[2024-03-11 10:27:57,558 INFO] Saving checkpoint tg-pretrain/tg-pretrain_03_step_10000.pt
