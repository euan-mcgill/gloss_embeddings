[2024-03-11 14:50:55,221 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-11 14:50:55,221 INFO] Parsed 2 corpora from -data.
[2024-03-11 14:50:55,221 INFO] Loading checkpoint from tg-pretrain/models/tg-pretrain_02_step_4600.pt
[2024-03-11 15:03:37,323 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-11 15:03:37,323 INFO] Parsed 2 corpora from -data.
[2024-03-11 15:03:37,323 INFO] Loading checkpoint from tg-pretrain/models/tg-pretrain_03_step_4600.pt
[2024-03-11 15:03:37,411 INFO] Building model...
[2024-03-11 15:03:37,471 INFO] Switching model to float32 for amp/apex_amp
[2024-03-11 15:03:37,471 INFO] Non quantized layer compute is fp32
[2024-03-11 15:03:39,357 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(500, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(1000, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-11 15:03:39,358 INFO] encoder: 12916000
[2024-03-11 15:03:39,359 INFO] decoder: 19916144
[2024-03-11 15:03:39,359 INFO] * number of parameters: 32832144
[2024-03-11 15:03:39,359 INFO] Trainable parameters = {'torch.float32': 32832144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-11 15:03:39,359 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-11 15:03:39,359 INFO]  * src vocab size = 17816
[2024-03-11 15:03:39,359 INFO]  * tgt vocab size = 14144
[2024-03-11 15:03:39,360 INFO] Starting training on GPU: [0]
[2024-03-11 15:03:39,361 INFO] Start training loop and validate every 200 steps...
[2024-03-11 15:03:39,361 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-11 15:03:46,509 INFO] Step 4650/ 9600; acc: 9.8; ppl: 226581.2; xent: 12.3; lr: 1.00000; sents:    2366; bsz:  569/ 497/47; 3983/3478 tok/s;      7 sec;
[2024-03-11 15:03:49,512 INFO] Step 4700/ 9600; acc: 9.8; ppl: 24237.4; xent: 10.1; lr: 1.00000; sents:    2369; bsz:  590/ 512/47; 9818/8520 tok/s;     10 sec;
[2024-03-11 15:03:52,215 INFO] Step 4750/ 9600; acc: 9.4; ppl: 11749.4; xent: 9.4; lr: 1.00000; sents:    2267; bsz:  560/ 485/45; 10359/8968 tok/s;     13 sec;
[2024-03-11 15:03:54,693 INFO] Step 4800/ 9600; acc: 7.7; ppl: 5998.3; xent: 8.7; lr: 1.00000; sents:    2365; bsz:  585/ 507/47; 11805/10235 tok/s;     15 sec;
[2024-03-11 15:03:58,250 INFO] valid stats calculation
                           took: 3.555669069290161 s.
[2024-03-11 15:03:58,250 INFO] Train perplexity: 24876.8
[2024-03-11 15:03:58,251 INFO] Train accuracy: 9.17633
[2024-03-11 15:03:58,251 INFO] Sentences processed: 9367
[2024-03-11 15:03:58,251 INFO] Average bsz:  576/ 500/47
[2024-03-11 15:03:58,251 INFO] Validation perplexity: 13959.2
[2024-03-11 15:03:58,251 INFO] Validation accuracy: 1.56438
[2024-03-11 15:03:58,252 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_4800.pt
[2024-03-11 15:04:00,726 INFO] Step 4850/ 9600; acc: 9.0; ppl: 6521.3; xent: 8.8; lr: 1.00000; sents:    2367; bsz:  564/ 491/47; 4679/4070 tok/s;     21 sec;
[2024-03-11 15:04:03,102 INFO] Step 4900/ 9600; acc: 9.7; ppl: 4621.2; xent: 8.4; lr: 1.00000; sents:    2251; bsz:  549/ 475/45; 11556/9993 tok/s;     24 sec;
[2024-03-11 15:04:05,467 INFO] Step 4950/ 9600; acc: 12.4; ppl: 1880.4; xent: 7.5; lr: 1.00000; sents:    2378; bsz:  568/ 494/48; 11998/10451 tok/s;     26 sec;
[2024-03-11 15:04:07,855 INFO] Step 5000/ 9600; acc: 16.0; ppl: 455.7; xent: 6.1; lr: 1.00000; sents:    2280; bsz:  562/ 487/46; 11771/10208 tok/s;     28 sec;
[2024-03-11 15:04:11,144 INFO] valid stats calculation
                           took: 3.288302183151245 s.
[2024-03-11 15:04:11,144 INFO] Train perplexity: 7597.88
[2024-03-11 15:04:11,144 INFO] Train accuracy: 10.4716
[2024-03-11 15:04:11,144 INFO] Sentences processed: 18643
[2024-03-11 15:04:11,144 INFO] Average bsz:  568/ 494/47
[2024-03-11 15:04:11,144 INFO] Validation perplexity: 672.041
[2024-03-11 15:04:11,144 INFO] Validation accuracy: 11.7529
[2024-03-11 15:04:11,146 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_5000.pt
[2024-03-11 15:04:13,672 INFO] Step 5050/ 9600; acc: 18.4; ppl: 255.6; xent: 5.5; lr: 1.00000; sents:    2381; bsz:  586/ 509/48; 5042/4380 tok/s;     34 sec;
[2024-03-11 15:04:16,036 INFO] Step 5100/ 9600; acc: 22.0; ppl: 148.8; xent: 5.0; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 12248/10577 tok/s;     37 sec;
[2024-03-11 15:04:18,361 INFO] Step 5150/ 9600; acc: 25.5; ppl:  96.7; xent: 4.6; lr: 1.00000; sents:    2372; bsz:  564/ 491/47; 12126/10568 tok/s;     39 sec;
[2024-03-11 15:04:20,704 INFO] Step 5200/ 9600; acc: 27.8; ppl:  73.5; xent: 4.3; lr: 1.00000; sents:    2252; bsz:  551/ 477/45; 11762/10172 tok/s;     41 sec;
[2024-03-11 15:04:23,994 INFO] valid stats calculation
                           took: 3.289175033569336 s.
[2024-03-11 15:04:23,994 INFO] Train perplexity: 1953.09
[2024-03-11 15:04:23,994 INFO] Train accuracy: 14.7604
[2024-03-11 15:04:23,994 INFO] Sentences processed: 28023
[2024-03-11 15:04:23,994 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:04:23,994 INFO] Validation perplexity: 301.024
[2024-03-11 15:04:23,994 INFO] Validation accuracy: 20.3369
[2024-03-11 15:04:23,995 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_5200.pt
[2024-03-11 15:04:26,504 INFO] Step 5250/ 9600; acc: 30.6; ppl:  56.3; xent: 4.0; lr: 1.00000; sents:    2271; bsz:  567/ 491/45; 4887/4230 tok/s;     47 sec;
[2024-03-11 15:04:28,768 INFO] Step 5300/ 9600; acc: 32.4; ppl:  43.6; xent: 3.8; lr: 1.00000; sents:    2364; bsz:  567/ 499/47; 12534/11032 tok/s;     49 sec;
[2024-03-11 15:04:31,110 INFO] Step 5350/ 9600; acc: 34.7; ppl:  34.2; xent: 3.5; lr: 1.00000; sents:    2367; bsz:  587/ 512/47; 12535/10939 tok/s;     52 sec;
[2024-03-11 15:04:33,461 INFO] Step 5400/ 9600; acc: 37.7; ppl:  26.6; xent: 3.3; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 12177/10554 tok/s;     54 sec;
[2024-03-11 15:04:36,763 INFO] valid stats calculation
                           took: 3.3016843795776367 s.
[2024-03-11 15:04:36,763 INFO] Train perplexity: 725.879
[2024-03-11 15:04:36,764 INFO] Train accuracy: 19.5748
[2024-03-11 15:04:36,764 INFO] Sentences processed: 37390
[2024-03-11 15:04:36,764 INFO] Average bsz:  570/ 495/47
[2024-03-11 15:04:36,764 INFO] Validation perplexity: 270.745
[2024-03-11 15:04:36,764 INFO] Validation accuracy: 24.5888
[2024-03-11 15:04:36,765 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_5400.pt
[2024-03-11 15:04:39,202 INFO] Step 5450/ 9600; acc: 40.0; ppl:  21.2; xent: 3.1; lr: 1.00000; sents:    2372; bsz:  563/ 490/47; 4905/4266 tok/s;     60 sec;
[2024-03-11 15:04:41,569 INFO] Step 5500/ 9600; acc: 41.6; ppl:  18.3; xent: 2.9; lr: 1.00000; sents:    2268; bsz:  557/ 483/45; 11771/10195 tok/s;     62 sec;
[2024-03-11 15:04:43,989 INFO] Step 5550/ 9600; acc: 44.2; ppl:  15.1; xent: 2.7; lr: 1.00000; sents:    2376; bsz:  581/ 506/48; 12011/10451 tok/s;     65 sec;
[2024-03-11 15:04:46,310 INFO] Step 5600/ 9600; acc: 45.9; ppl:  12.5; xent: 2.5; lr: 1.00000; sents:    2284; bsz:  547/ 475/46; 11791/10247 tok/s;     67 sec;
[2024-03-11 15:04:49,594 INFO] valid stats calculation
                           took: 3.2840535640716553 s.
[2024-03-11 15:04:49,595 INFO] Train perplexity: 343.348
[2024-03-11 15:04:49,595 INFO] Train accuracy: 24.1881
[2024-03-11 15:04:49,595 INFO] Sentences processed: 46690
[2024-03-11 15:04:49,595 INFO] Average bsz:  568/ 494/47
[2024-03-11 15:04:49,595 INFO] Validation perplexity: 313.23
[2024-03-11 15:04:49,595 INFO] Validation accuracy: 26.3137
[2024-03-11 15:04:49,596 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_5600.pt
[2024-03-11 15:04:52,131 INFO] Step 5650/ 9600; acc: 48.1; ppl:  10.8; xent: 2.4; lr: 1.00000; sents:    2376; bsz:  581/ 505/48; 4989/4334 tok/s;     73 sec;
[2024-03-11 15:04:54,468 INFO] Step 5700/ 9600; acc: 49.3; ppl:   9.9; xent: 2.3; lr: 1.00000; sents:    2275; bsz:  561/ 484/46; 12009/10362 tok/s;     75 sec;
[2024-03-11 15:04:56,765 INFO] Step 5750/ 9600; acc: 51.9; ppl:   8.1; xent: 2.1; lr: 1.00000; sents:    2371; bsz:  564/ 488/47; 12288/10618 tok/s;     77 sec;
[2024-03-11 15:04:59,135 INFO] Step 5800/ 9600; acc: 53.6; ppl:   7.4; xent: 2.0; lr: 1.00000; sents:    2366; bsz:  577/ 501/47; 12176/10570 tok/s;     80 sec;
[2024-03-11 15:05:02,431 INFO] valid stats calculation
                           took: 3.2959537506103516 s.
[2024-03-11 15:05:02,432 INFO] Train perplexity: 186.916
[2024-03-11 15:05:02,432 INFO] Train accuracy: 28.6167
[2024-03-11 15:05:02,432 INFO] Sentences processed: 56078
[2024-03-11 15:05:02,432 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:05:02,432 INFO] Validation perplexity: 367.029
[2024-03-11 15:05:02,432 INFO] Validation accuracy: 27.5973
[2024-03-11 15:05:02,433 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_5800.pt
[2024-03-11 15:05:04,875 INFO] Step 5850/ 9600; acc: 54.9; ppl:   6.7; xent: 1.9; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 4915/4273 tok/s;     86 sec;
[2024-03-11 15:05:07,211 INFO] Step 5900/ 9600; acc: 56.7; ppl:   6.2; xent: 1.8; lr: 1.00000; sents:    2364; bsz:  584/ 506/47; 12499/10823 tok/s;     88 sec;
[2024-03-11 15:05:09,591 INFO] Step 5950/ 9600; acc: 58.2; ppl:   5.6; xent: 1.7; lr: 1.00000; sents:    2269; bsz:  564/ 488/45; 11851/10255 tok/s;     90 sec;
[2024-03-11 15:05:11,895 INFO] Step 6000/ 9600; acc: 60.5; ppl:   4.9; xent: 1.6; lr: 1.00000; sents:    2367; bsz:  563/ 488/47; 12221/10591 tok/s;     93 sec;
[2024-03-11 15:05:15,179 INFO] valid stats calculation
                           took: 3.2838377952575684 s.
[2024-03-11 15:05:15,179 INFO] Train perplexity: 113.969
[2024-03-11 15:05:15,179 INFO] Train accuracy: 32.7497
[2024-03-11 15:05:15,179 INFO] Sentences processed: 65444
[2024-03-11 15:05:15,179 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:05:15,179 INFO] Validation perplexity: 600.506
[2024-03-11 15:05:15,179 INFO] Validation accuracy: 27.3967
[2024-03-11 15:05:15,181 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_6000.pt
[2024-03-11 15:05:17,736 INFO] Step 6050/ 9600; acc: 60.9; ppl:   4.9; xent: 1.6; lr: 1.00000; sents:    2272; bsz:  578/ 497/45; 4952/4251 tok/s;     98 sec;
[2024-03-11 15:05:20,087 INFO] Step 6100/ 9600; acc: 63.8; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    2371; bsz:  564/ 490/47; 11998/10414 tok/s;    101 sec;
[2024-03-11 15:05:22,447 INFO] Step 6150/ 9600; acc: 65.2; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    2375; bsz:  583/ 505/48; 12351/10690 tok/s;    103 sec;
[2024-03-11 15:05:24,816 INFO] Step 6200/ 9600; acc: 66.7; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    2280; bsz:  559/ 486/46; 11802/10250 tok/s;    105 sec;
[2024-03-11 15:05:28,112 INFO] valid stats calculation
                           took: 3.295025587081909 s.
[2024-03-11 15:05:28,112 INFO] Train perplexity: 75.1829
[2024-03-11 15:05:28,112 INFO] Train accuracy: 36.6749
[2024-03-11 15:05:28,112 INFO] Sentences processed: 74742
[2024-03-11 15:05:28,112 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:05:28,112 INFO] Validation perplexity: 634.998
[2024-03-11 15:05:28,112 INFO] Validation accuracy: 28.2792
[2024-03-11 15:05:28,113 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_6200.pt
[2024-03-11 15:05:30,580 INFO] Step 6250/ 9600; acc: 68.4; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    2376; bsz:  564/ 490/48; 4890/4249 tok/s;    111 sec;
[2024-03-11 15:05:32,954 INFO] Step 6300/ 9600; acc: 67.9; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    2376; bsz:  589/ 510/48; 12400/10747 tok/s;    114 sec;
[2024-03-11 15:05:35,295 INFO] Step 6350/ 9600; acc: 70.7; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    2368; bsz:  569/ 498/47; 12152/10639 tok/s;    116 sec;
[2024-03-11 15:05:37,639 INFO] Step 6400/ 9600; acc: 71.6; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    2270; bsz:  563/ 487/45; 12007/10391 tok/s;    118 sec;
[2024-03-11 15:05:40,936 INFO] valid stats calculation
                           took: 3.2958178520202637 s.
[2024-03-11 15:05:40,936 INFO] Train perplexity: 52.6959
[2024-03-11 15:05:40,936 INFO] Train accuracy: 40.3528
[2024-03-11 15:05:40,936 INFO] Sentences processed: 84132
[2024-03-11 15:05:40,936 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:05:40,936 INFO] Validation perplexity: 994
[2024-03-11 15:05:40,936 INFO] Validation accuracy: 28.0385
[2024-03-11 15:05:40,938 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_6400.pt
[2024-03-11 15:05:43,381 INFO] Step 6450/ 9600; acc: 73.3; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    2369; bsz:  566/ 492/47; 4933/4284 tok/s;    124 sec;
[2024-03-11 15:05:45,726 INFO] Step 6500/ 9600; acc: 73.1; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    2242; bsz:  568/ 491/45; 12121/10469 tok/s;    126 sec;
[2024-03-11 15:05:48,011 INFO] Step 6550/ 9600; acc: 75.5; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2365; bsz:  564/ 490/47; 12344/10733 tok/s;    129 sec;
[2024-03-11 15:05:50,355 INFO] Step 6600/ 9600; acc: 75.8; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2367; bsz:  579/ 502/47; 12354/10702 tok/s;    131 sec;
[2024-03-11 15:05:53,656 INFO] valid stats calculation
                           took: 3.300030469894409 s.
[2024-03-11 15:05:53,656 INFO] Train perplexity: 38.9102
[2024-03-11 15:05:53,656 INFO] Train accuracy: 43.759
[2024-03-11 15:05:53,656 INFO] Sentences processed: 93475
[2024-03-11 15:05:53,656 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:05:53,656 INFO] Validation perplexity: 1303.39
[2024-03-11 15:05:53,656 INFO] Validation accuracy: 27.1961
[2024-03-11 15:05:53,658 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_6600.pt
[2024-03-11 15:05:56,166 INFO] Step 6650/ 9600; acc: 77.3; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2268; bsz:  539/ 468/45; 4641/4028 tok/s;    137 sec;
[2024-03-11 15:05:58,577 INFO] Step 6700/ 9600; acc: 77.6; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2379; bsz:  587/ 510/48; 12166/10580 tok/s;    139 sec;
[2024-03-11 15:06:00,966 INFO] Step 6750/ 9600; acc: 78.5; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    2274; bsz:  558/ 483/45; 11674/10117 tok/s;    142 sec;
[2024-03-11 15:06:03,318 INFO] Step 6800/ 9600; acc: 79.3; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2376; bsz:  580/ 503/48; 12331/10690 tok/s;    144 sec;
[2024-03-11 15:06:06,602 INFO] valid stats calculation
                           took: 3.2834227085113525 s.
[2024-03-11 15:06:06,602 INFO] Train perplexity: 29.9614
[2024-03-11 15:06:06,602 INFO] Train accuracy: 46.873
[2024-03-11 15:06:06,602 INFO] Sentences processed: 102772
[2024-03-11 15:06:06,602 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:06:06,602 INFO] Validation perplexity: 1541.88
[2024-03-11 15:06:06,602 INFO] Validation accuracy: 28.7204
[2024-03-11 15:06:06,604 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_6800.pt
[2024-03-11 15:06:09,070 INFO] Step 6850/ 9600; acc: 80.5; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 4895/4252 tok/s;    150 sec;
[2024-03-11 15:06:11,477 INFO] Step 6900/ 9600; acc: 80.5; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2275; bsz:  567/ 492/46; 11786/10212 tok/s;    152 sec;
[2024-03-11 15:06:13,869 INFO] Step 6950/ 9600; acc: 80.8; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2367; bsz:  586/ 512/47; 12256/10713 tok/s;    155 sec;
[2024-03-11 15:06:16,199 INFO] Step 7000/ 9600; acc: 82.3; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2367; bsz:  568/ 500/47; 12193/10726 tok/s;    157 sec;
[2024-03-11 15:06:19,494 INFO] valid stats calculation
                           took: 3.294914484024048 s.
[2024-03-11 15:06:19,495 INFO] Train perplexity: 23.816
[2024-03-11 15:06:19,495 INFO] Train accuracy: 49.7423
[2024-03-11 15:06:19,495 INFO] Sentences processed: 112156
[2024-03-11 15:06:19,495 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:06:19,495 INFO] Validation perplexity: 2117.21
[2024-03-11 15:06:19,495 INFO] Validation accuracy: 28.5199
[2024-03-11 15:06:19,496 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_7000.pt
[2024-03-11 15:06:22,002 INFO] Step 7050/ 9600; acc: 83.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2260; bsz:  555/ 480/45; 4786/4140 tok/s;    163 sec;
[2024-03-11 15:06:24,336 INFO] Step 7100/ 9600; acc: 83.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2367; bsz:  571/ 492/47; 12230/10543 tok/s;    165 sec;
[2024-03-11 15:06:26,643 INFO] Step 7150/ 9600; acc: 83.9; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2365; bsz:  562/ 489/47; 12172/10599 tok/s;    167 sec;
[2024-03-11 15:06:29,047 INFO] Step 7200/ 9600; acc: 84.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2373; bsz:  582/ 507/47; 12102/10544 tok/s;    170 sec;
[2024-03-11 15:06:32,337 INFO] valid stats calculation
                           took: 3.289548397064209 s.
[2024-03-11 15:06:32,338 INFO] Train perplexity: 19.4986
[2024-03-11 15:06:32,338 INFO] Train accuracy: 52.3508
[2024-03-11 15:06:32,338 INFO] Sentences processed: 121521
[2024-03-11 15:06:32,338 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:06:32,338 INFO] Validation perplexity: 2517.6
[2024-03-11 15:06:32,338 INFO] Validation accuracy: 28.8809
[2024-03-11 15:06:32,339 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_7200.pt
[2024-03-11 15:06:34,880 INFO] Step 7250/ 9600; acc: 85.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2275; bsz:  547/ 475/46; 4688/4070 tok/s;    176 sec;
[2024-03-11 15:06:37,321 INFO] Step 7300/ 9600; acc: 85.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2375; bsz:  580/ 505/48; 11888/10347 tok/s;    178 sec;
[2024-03-11 15:06:39,684 INFO] Step 7350/ 9600; acc: 86.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2281; bsz:  563/ 486/46; 11909/10289 tok/s;    180 sec;
[2024-03-11 15:06:41,937 INFO] Step 7400/ 9600; acc: 86.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2476; bsz:  582/ 503/50; 12910/11173 tok/s;    183 sec;
[2024-03-11 15:06:45,227 INFO] valid stats calculation
                           took: 3.2902233600616455 s.
[2024-03-11 15:06:45,228 INFO] Train perplexity: 16.3409
[2024-03-11 15:06:45,228 INFO] Train accuracy: 54.7395
[2024-03-11 15:06:45,228 INFO] Sentences processed: 130928
[2024-03-11 15:06:45,228 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:06:45,228 INFO] Validation perplexity: 3389.35
[2024-03-11 15:06:45,228 INFO] Validation accuracy: 27.7176
[2024-03-11 15:06:45,229 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_7400.pt
[2024-03-11 15:06:47,743 INFO] Step 7450/ 9600; acc: 86.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2275; bsz:  562/ 485/46; 4841/4180 tok/s;    188 sec;
[2024-03-11 15:06:50,058 INFO] Step 7500/ 9600; acc: 87.0; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2371; bsz:  566/ 491/47; 12219/10604 tok/s;    191 sec;
[2024-03-11 15:06:52,406 INFO] Step 7550/ 9600; acc: 87.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2366; bsz:  584/ 506/47; 12436/10784 tok/s;    193 sec;
[2024-03-11 15:06:54,759 INFO] Step 7600/ 9600; acc: 87.0; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 11976/10382 tok/s;    195 sec;
[2024-03-11 15:06:58,052 INFO] valid stats calculation
                           took: 3.292382001876831 s.
[2024-03-11 15:06:58,052 INFO] Train perplexity: 13.9768
[2024-03-11 15:06:58,052 INFO] Train accuracy: 56.8914
[2024-03-11 15:06:58,052 INFO] Sentences processed: 140208
[2024-03-11 15:06:58,052 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:06:58,052 INFO] Validation perplexity: 3818.03
[2024-03-11 15:06:58,052 INFO] Validation accuracy: 29.1617
[2024-03-11 15:06:58,054 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_7600.pt
[2024-03-11 15:07:00,468 INFO] Step 7650/ 9600; acc: 88.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2362; bsz:  562/ 488/47; 4925/4275 tok/s;    201 sec;
[2024-03-11 15:07:02,827 INFO] Step 7700/ 9600; acc: 88.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2267; bsz:  577/ 495/45; 12239/10489 tok/s;    203 sec;
[2024-03-11 15:07:05,108 INFO] Step 7750/ 9600; acc: 88.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2369; bsz:  563/ 489/47; 12356/10723 tok/s;    206 sec;
[2024-03-11 15:07:07,480 INFO] Step 7800/ 9600; acc: 89.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2270; bsz:  559/ 485/45; 11789/10227 tok/s;    208 sec;
[2024-03-11 15:07:10,771 INFO] valid stats calculation
                           took: 3.290910243988037 s.
[2024-03-11 15:07:10,771 INFO] Train perplexity: 12.1714
[2024-03-11 15:07:10,771 INFO] Train accuracy: 58.8375
[2024-03-11 15:07:10,771 INFO] Sentences processed: 149476
[2024-03-11 15:07:10,771 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:07:10,772 INFO] Validation perplexity: 4310.03
[2024-03-11 15:07:10,772 INFO] Validation accuracy: 27.3566
[2024-03-11 15:07:10,773 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_7800.pt
[2024-03-11 15:07:13,266 INFO] Step 7850/ 9600; acc: 88.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2371; bsz:  566/ 493/47; 4889/4260 tok/s;    214 sec;
[2024-03-11 15:07:15,616 INFO] Step 7900/ 9600; acc: 89.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  582/ 503/48; 12383/10712 tok/s;    216 sec;
[2024-03-11 15:07:17,975 INFO] Step 7950/ 9600; acc: 89.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2382; bsz:  589/ 510/48; 12483/10821 tok/s;    219 sec;
[2024-03-11 15:07:20,311 INFO] Step 8000/ 9600; acc: 89.3; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2376; bsz:  569/ 497/48; 12186/10642 tok/s;    221 sec;
[2024-03-11 15:07:23,594 INFO] valid stats calculation
                           took: 3.2824690341949463 s.
[2024-03-11 15:07:23,594 INFO] Train perplexity: 10.7199
[2024-03-11 15:07:23,595 INFO] Train accuracy: 60.6489
[2024-03-11 15:07:23,595 INFO] Sentences processed: 158980
[2024-03-11 15:07:23,595 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:07:23,595 INFO] Validation perplexity: 5194.83
[2024-03-11 15:07:23,595 INFO] Validation accuracy: 28.2792
[2024-03-11 15:07:23,596 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_8000.pt
[2024-03-11 15:07:26,162 INFO] Step 8050/ 9600; acc: 89.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2280; bsz:  565/ 490/46; 4830/4190 tok/s;    227 sec;
[2024-03-11 15:07:28,517 INFO] Step 8100/ 9600; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2247; bsz:  550/ 477/45; 11672/10122 tok/s;    229 sec;
[2024-03-11 15:07:30,897 INFO] Step 8150/ 9600; acc: 90.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  586/ 506/47; 12301/10622 tok/s;    232 sec;
[2024-03-11 15:07:33,206 INFO] Step 8200/ 9600; acc: 90.5; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2368; bsz:  567/ 493/47; 12271/10679 tok/s;    234 sec;
[2024-03-11 15:07:36,499 INFO] valid stats calculation
                           took: 3.2920660972595215 s.
[2024-03-11 15:07:36,499 INFO] Train perplexity: 9.57885
[2024-03-11 15:07:36,499 INFO] Train accuracy: 62.287
[2024-03-11 15:07:36,499 INFO] Sentences processed: 168242
[2024-03-11 15:07:36,499 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:07:36,500 INFO] Validation perplexity: 7581.17
[2024-03-11 15:07:36,500 INFO] Validation accuracy: 28.7605
[2024-03-11 15:07:36,501 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_8200.pt
[2024-03-11 15:07:38,968 INFO] Step 8250/ 9600; acc: 91.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2249; bsz:  551/ 478/45; 4782/4152 tok/s;    240 sec;
[2024-03-11 15:07:41,308 INFO] Step 8300/ 9600; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2365; bsz:  578/ 500/47; 12345/10675 tok/s;    242 sec;
[2024-03-11 15:07:43,628 INFO] Step 8350/ 9600; acc: 90.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  566/ 492/47; 12188/10595 tok/s;    244 sec;
[2024-03-11 15:07:45,983 INFO] Step 8400/ 9600; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  569/ 497/48; 12077/10562 tok/s;    247 sec;
[2024-03-11 15:07:49,286 INFO] valid stats calculation
                           took: 3.3028109073638916 s.
[2024-03-11 15:07:49,287 INFO] Train perplexity: 8.65184
[2024-03-11 15:07:49,287 INFO] Train accuracy: 63.7852
[2024-03-11 15:07:49,287 INFO] Sentences processed: 177605
[2024-03-11 15:07:49,287 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:07:49,287 INFO] Validation perplexity: 7605.66
[2024-03-11 15:07:49,287 INFO] Validation accuracy: 28.1588
[2024-03-11 15:07:49,288 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_8400.pt
[2024-03-11 15:07:51,893 INFO] Step 8450/ 9600; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2272; bsz:  574/ 498/45; 4856/4213 tok/s;    253 sec;
[2024-03-11 15:07:54,219 INFO] Step 8500/ 9600; acc: 91.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  565/ 490/48; 12140/10527 tok/s;    255 sec;
[2024-03-11 15:07:56,624 INFO] Step 8550/ 9600; acc: 91.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2277; bsz:  566/ 489/46; 11763/10169 tok/s;    257 sec;
[2024-03-11 15:07:58,972 INFO] Step 8600/ 9600; acc: 92.2; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  565/ 493/48; 12042/10503 tok/s;    260 sec;
[2024-03-11 15:08:02,265 INFO] valid stats calculation
                           took: 3.2926626205444336 s.
[2024-03-11 15:08:02,266 INFO] Train perplexity: 7.88436
[2024-03-11 15:08:02,266 INFO] Train accuracy: 65.1678
[2024-03-11 15:08:02,266 INFO] Sentences processed: 186912
[2024-03-11 15:08:02,266 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:08:02,266 INFO] Validation perplexity: 5481.51
[2024-03-11 15:08:02,266 INFO] Validation accuracy: 27.7978
[2024-03-11 15:08:02,267 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_8600.pt
[2024-03-11 15:08:04,793 INFO] Step 8650/ 9600; acc: 92.1; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  587/ 515/47; 5045/4425 tok/s;    265 sec;
[2024-03-11 15:08:07,177 INFO] Step 8700/ 9600; acc: 92.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  563/ 489/47; 11802/10256 tok/s;    268 sec;
[2024-03-11 15:08:09,560 INFO] Step 8750/ 9600; acc: 92.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2263; bsz:  571/ 490/45; 11983/10278 tok/s;    270 sec;
[2024-03-11 15:08:11,826 INFO] Step 8800/ 9600; acc: 92.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2364; bsz:  558/ 487/47; 12318/10742 tok/s;    272 sec;
[2024-03-11 15:08:15,142 INFO] valid stats calculation
                           took: 3.315768003463745 s.
[2024-03-11 15:08:15,142 INFO] Train perplexity: 7.23665
[2024-03-11 15:08:15,142 INFO] Train accuracy: 66.4649
[2024-03-11 15:08:15,142 INFO] Sentences processed: 196278
[2024-03-11 15:08:15,142 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:08:15,142 INFO] Validation perplexity: 7636.85
[2024-03-11 15:08:15,142 INFO] Validation accuracy: 29.1617
[2024-03-11 15:08:15,144 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_8800.pt
[2024-03-11 15:08:17,700 INFO] Step 8850/ 9600; acc: 92.2; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  563/ 492/47; 4797/4188 tok/s;    278 sec;
[2024-03-11 15:08:20,085 INFO] Step 8900/ 9600; acc: 92.2; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2268; bsz:  576/ 496/45; 12069/10397 tok/s;    281 sec;
[2024-03-11 15:08:22,519 INFO] Step 8950/ 9600; acc: 92.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2373; bsz:  566/ 495/47; 11629/10172 tok/s;    283 sec;
[2024-03-11 15:08:24,984 INFO] Step 9000/ 9600; acc: 92.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2271; bsz:  564/ 489/45; 11449/9916 tok/s;    286 sec;
[2024-03-11 15:08:28,277 INFO] valid stats calculation
                           took: 3.292492389678955 s.
[2024-03-11 15:08:28,277 INFO] Train perplexity: 6.69394
[2024-03-11 15:08:28,277 INFO] Train accuracy: 67.6432
[2024-03-11 15:08:28,277 INFO] Sentences processed: 205557
[2024-03-11 15:08:28,277 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:08:28,277 INFO] Validation perplexity: 10115.5
[2024-03-11 15:08:28,277 INFO] Validation accuracy: 28.4797
[2024-03-11 15:08:28,279 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_9000.pt
[2024-03-11 15:08:30,762 INFO] Step 9050/ 9600; acc: 92.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  579/ 498/48; 5011/4313 tok/s;    291 sec;
[2024-03-11 15:08:33,033 INFO] Step 9100/ 9600; acc: 92.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2382; bsz:  561/ 487/48; 12352/10733 tok/s;    294 sec;
[2024-03-11 15:08:35,420 INFO] Step 9150/ 9600; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2276; bsz:  565/ 488/46; 11836/10233 tok/s;    296 sec;
[2024-03-11 15:08:37,720 INFO] Step 9200/ 9600; acc: 93.2; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2475; bsz:  589/ 511/50; 12793/11107 tok/s;    298 sec;
[2024-03-11 15:08:41,053 INFO] valid stats calculation
                           took: 3.3329451084136963 s.
[2024-03-11 15:08:41,054 INFO] Train perplexity: 6.22789
[2024-03-11 15:08:41,054 INFO] Train accuracy: 68.7457
[2024-03-11 15:08:41,054 INFO] Sentences processed: 215065
[2024-03-11 15:08:41,054 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:08:41,054 INFO] Validation perplexity: 8919.98
[2024-03-11 15:08:41,054 INFO] Validation accuracy: 28.5199
[2024-03-11 15:08:41,056 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_9200.pt
[2024-03-11 15:08:43,627 INFO] Step 9250/ 9600; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2273; bsz:  564/ 489/45; 4778/4139 tok/s;    304 sec;
[2024-03-11 15:08:46,001 INFO] Step 9300/ 9600; acc: 93.3; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2260; bsz:  558/ 482/45; 11743/10141 tok/s;    307 sec;
[2024-03-11 15:08:48,302 INFO] Step 9350/ 9600; acc: 93.6; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2369; bsz:  581/ 501/47; 12622/10886 tok/s;    309 sec;
[2024-03-11 15:08:50,576 INFO] Step 9400/ 9600; acc: 93.6; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2365; bsz:  564/ 489/47; 12395/10756 tok/s;    311 sec;
[2024-03-11 15:08:53,928 INFO] valid stats calculation
                           took: 3.3514955043792725 s.
[2024-03-11 15:08:53,929 INFO] Train perplexity: 5.82913
[2024-03-11 15:08:53,929 INFO] Train accuracy: 69.7633
[2024-03-11 15:08:53,929 INFO] Sentences processed: 224332
[2024-03-11 15:08:53,929 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:08:53,929 INFO] Validation perplexity: 8824.71
[2024-03-11 15:08:53,929 INFO] Validation accuracy: 27.6374
[2024-03-11 15:08:53,930 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_9400.pt
[2024-03-11 15:08:56,425 INFO] Step 9450/ 9600; acc: 93.6; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  586/ 507/47; 5007/4335 tok/s;    317 sec;
[2024-03-11 15:08:58,774 INFO] Step 9500/ 9600; acc: 93.5; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2267; bsz:  557/ 483/45; 11847/10273 tok/s;    319 sec;
[2024-03-11 15:09:01,128 INFO] Step 9550/ 9600; acc: 93.7; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2372; bsz:  564/ 492/47; 11978/10461 tok/s;    322 sec;
[2024-03-11 15:09:03,589 INFO] Step 9600/ 9600; acc: 93.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2257; bsz:  556/ 481/45; 11306/9777 tok/s;    324 sec;
[2024-03-11 15:09:06,891 INFO] valid stats calculation
                           took: 3.301892042160034 s.
[2024-03-11 15:09:06,892 INFO] Train perplexity: 5.48245
[2024-03-11 15:09:06,892 INFO] Train accuracy: 70.7142
[2024-03-11 15:09:06,892 INFO] Sentences processed: 233595
[2024-03-11 15:09:06,892 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:09:06,892 INFO] Validation perplexity: 10990.5
[2024-03-11 15:09:06,892 INFO] Validation accuracy: 28.56
[2024-03-11 15:09:06,893 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_01_step_9600.pt
