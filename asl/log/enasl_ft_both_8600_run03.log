[2024-03-13 10:09:31,121 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-13 10:09:31,121 INFO] Parsed 2 corpora from -data.
[2024-03-13 10:09:31,121 INFO] Loading checkpoint from tg-pt-both/models/tg-pt-both_03_step_8600.pt
[2024-03-13 10:09:31,189 INFO] Building model...
[2024-03-13 10:09:31,245 INFO] Switching model to float32 for amp/apex_amp
[2024-03-13 10:09:31,245 INFO] Non quantized layer compute is fp32
[2024-03-13 10:09:33,259 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-13 10:09:33,260 INFO] encoder: 8952800
[2024-03-13 10:09:33,260 INFO] decoder: 16687344
[2024-03-13 10:09:33,260 INFO] * number of parameters: 25640144
[2024-03-13 10:09:33,260 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 10:09:33,260 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 10:09:33,260 INFO]  * src vocab size = 17816
[2024-03-13 10:09:33,260 INFO]  * tgt vocab size = 14144
[2024-03-13 10:09:33,262 INFO] Starting training on GPU: [0]
[2024-03-13 10:09:33,262 INFO] Start training loop and validate every 200 steps...
[2024-03-13 10:09:33,262 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-13 10:09:37,098 INFO] Saving checkpoint tg-ft-both/tg-ft-both_13600_03_step_8601.pt
[2024-03-13 10:31:30,014 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-13 10:31:30,014 INFO] Parsed 2 corpora from -data.
[2024-03-13 10:31:30,015 INFO] Loading checkpoint from tg-pt-both/models/tg-pt-both_03_step_8600.pt
[2024-03-13 10:31:30,081 INFO] Building model...
[2024-03-13 10:31:30,137 INFO] Switching model to float32 for amp/apex_amp
[2024-03-13 10:31:30,137 INFO] Non quantized layer compute is fp32
[2024-03-13 10:31:31,903 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-13 10:31:31,903 INFO] encoder: 8952800
[2024-03-13 10:31:31,903 INFO] decoder: 16687344
[2024-03-13 10:31:31,903 INFO] * number of parameters: 25640144
[2024-03-13 10:31:31,904 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 10:31:31,904 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 10:31:31,904 INFO]  * src vocab size = 17816
[2024-03-13 10:31:31,904 INFO]  * tgt vocab size = 14144
[2024-03-13 10:31:31,905 INFO] Starting training on GPU: [0]
[2024-03-13 10:31:31,905 INFO] Start training loop and validate every 200 steps...
[2024-03-13 10:31:31,905 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-13 10:31:37,692 INFO] Step 8650/13600; acc: 9.7; ppl: 5348867.6; xent: 15.5; lr: 1.00000; sents:    2270; bsz:  565/ 490/45; 4884/4232 tok/s;      6 sec;
[2024-03-13 10:31:39,992 INFO] Step 8700/13600; acc: 9.8; ppl: 132025.1; xent: 11.8; lr: 1.00000; sents:    2369; bsz:  590/ 512/47; 12833/11143 tok/s;      8 sec;
[2024-03-13 10:31:42,269 INFO] Step 8750/13600; acc: 9.4; ppl: 1173172.8; xent: 14.0; lr: 1.00000; sents:    2363; bsz:  564/ 491/47; 12377/10793 tok/s;     10 sec;
[2024-03-13 10:31:44,509 INFO] Step 8800/13600; acc: 9.0; ppl: 56993.8; xent: 11.0; lr: 1.00000; sents:    2365; bsz:  563/ 489/47; 12556/10907 tok/s;     13 sec;
[2024-03-13 10:31:47,817 INFO] valid stats calculation
                           took: 3.3070907592773438 s.
[2024-03-13 10:31:47,817 INFO] Train perplexity: 460307
[2024-03-13 10:31:47,817 INFO] Train accuracy: 9.46255
[2024-03-13 10:31:47,817 INFO] Sentences processed: 9367
[2024-03-13 10:31:47,817 INFO] Average bsz:  570/ 496/47
[2024-03-13 10:31:47,817 INFO] Validation perplexity: 65653.2
[2024-03-13 10:31:47,817 INFO] Validation accuracy: 6.57842
[2024-03-13 10:31:47,819 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_8800.pt
[2024-03-13 10:31:50,298 INFO] Step 8850/13600; acc: 7.2; ppl: 41665.1; xent: 10.6; lr: 1.00000; sents:    2246; bsz:  570/ 493/45; 4922/4261 tok/s;     18 sec;
[2024-03-13 10:31:52,619 INFO] Step 8900/13600; acc: 9.3; ppl: 15562.6; xent: 9.7; lr: 1.00000; sents:    2372; bsz:  566/ 491/47; 12192/10576 tok/s;     21 sec;
[2024-03-13 10:31:55,001 INFO] Step 8950/13600; acc: 9.3; ppl: 9119.2; xent: 9.1; lr: 1.00000; sents:    2378; bsz:  586/ 509/48; 12297/10691 tok/s;     23 sec;
[2024-03-13 10:31:57,375 INFO] Step 9000/13600; acc: 9.6; ppl: 18192.1; xent: 9.8; lr: 1.00000; sents:    2280; bsz:  562/ 488/46; 11847/10269 tok/s;     25 sec;
[2024-03-13 10:32:00,689 INFO] valid stats calculation
                           took: 3.313961982727051 s.
[2024-03-13 10:32:00,690 INFO] Train perplexity: 91116.4
[2024-03-13 10:32:00,690 INFO] Train accuracy: 9.16628
[2024-03-13 10:32:00,690 INFO] Sentences processed: 18643
[2024-03-13 10:32:00,690 INFO] Average bsz:  571/ 495/47
[2024-03-13 10:32:00,690 INFO] Validation perplexity: 2031.8
[2024-03-13 10:32:00,690 INFO] Validation accuracy: 10.9507
[2024-03-13 10:32:00,691 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_9000.pt
[2024-03-13 10:32:03,117 INFO] Step 9050/13600; acc: 10.6; ppl: 18516.1; xent: 9.8; lr: 1.00000; sents:    2381; bsz:  568/ 495/48; 4947/4307 tok/s;     31 sec;
[2024-03-13 10:32:05,470 INFO] Step 9100/13600; acc: 10.0; ppl: 6267.3; xent: 8.7; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 12306/10627 tok/s;     34 sec;
[2024-03-13 10:32:07,779 INFO] Step 9150/13600; acc: 10.1; ppl: 12768.4; xent: 9.5; lr: 1.00000; sents:    2372; bsz:  564/ 491/47; 12208/10638 tok/s;     36 sec;
[2024-03-13 10:32:10,105 INFO] Step 9200/13600; acc: 8.2; ppl: 133615.6; xent: 11.8; lr: 1.00000; sents:    2252; bsz:  551/ 477/45; 11851/10249 tok/s;     38 sec;
[2024-03-13 10:32:13,415 INFO] valid stats calculation
                           took: 3.3090407848358154 s.
[2024-03-13 10:32:13,415 INFO] Train perplexity: 55762.8
[2024-03-13 10:32:13,415 INFO] Train accuracy: 9.35493
[2024-03-13 10:32:13,415 INFO] Sentences processed: 28023
[2024-03-13 10:32:13,415 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:32:13,415 INFO] Validation perplexity: 15622.5
[2024-03-13 10:32:13,415 INFO] Validation accuracy: 3.00842
[2024-03-13 10:32:13,416 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_9200.pt
[2024-03-13 10:32:15,823 INFO] Step 9250/13600; acc: 8.7; ppl: 38268.4; xent: 10.6; lr: 1.00000; sents:    2367; bsz:  567/ 499/47; 4961/4364 tok/s;     44 sec;
[2024-03-13 10:32:18,126 INFO] Step 9300/13600; acc: 8.3; ppl: 16025.3; xent: 9.7; lr: 1.00000; sents:    2364; bsz:  587/ 514/47; 12753/11151 tok/s;     46 sec;
[2024-03-13 10:32:20,494 INFO] Step 9350/13600; acc: 9.5; ppl: 22941.0; xent: 10.0; lr: 1.00000; sents:    2271; bsz:  567/ 490/45; 11968/10343 tok/s;     49 sec;
[2024-03-13 10:32:22,801 INFO] Step 9400/13600; acc: 9.7; ppl: 12034.6; xent: 9.4; lr: 1.00000; sents:    2365; bsz:  561/ 487/47; 12150/10544 tok/s;     51 sec;
[2024-03-13 10:32:26,123 INFO] valid stats calculation
                           took: 3.321235179901123 s.
[2024-03-13 10:32:26,123 INFO] Train perplexity: 43260.6
[2024-03-13 10:32:26,123 INFO] Train accuracy: 9.27186
[2024-03-13 10:32:26,123 INFO] Sentences processed: 37390
[2024-03-13 10:32:26,123 INFO] Average bsz:  569/ 495/47
[2024-03-13 10:32:26,124 INFO] Validation perplexity: 19330.2
[2024-03-13 10:32:26,124 INFO] Validation accuracy: 6.73887
[2024-03-13 10:32:26,125 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_9400.pt
[2024-03-13 10:32:28,606 INFO] Step 9450/13600; acc: 10.0; ppl: 31658.9; xent: 10.4; lr: 1.00000; sents:    2269; bsz:  569/ 491/45; 4899/4233 tok/s;     57 sec;
[2024-03-13 10:32:30,952 INFO] Step 9500/13600; acc: 10.4; ppl: 7065.3; xent: 8.9; lr: 1.00000; sents:    2371; bsz:  563/ 491/47; 12009/10459 tok/s;     59 sec;
[2024-03-13 10:32:33,377 INFO] Step 9550/13600; acc: 10.1; ppl: 4490.9; xent: 8.4; lr: 1.00000; sents:    2376; bsz:  581/ 506/48; 11988/10431 tok/s;     61 sec;
[2024-03-13 10:32:35,743 INFO] Step 9600/13600; acc: 11.3; ppl: 2160.0; xent: 7.7; lr: 1.00000; sents:    2381; bsz:  566/ 495/48; 11964/10461 tok/s;     64 sec;
[2024-03-13 10:32:39,062 INFO] valid stats calculation
                           took: 3.318760871887207 s.
[2024-03-13 10:32:39,062 INFO] Train perplexity: 29852.9
[2024-03-13 10:32:39,063 INFO] Train accuracy: 9.50848
[2024-03-13 10:32:39,063 INFO] Sentences processed: 46787
[2024-03-13 10:32:39,063 INFO] Average bsz:  569/ 495/47
[2024-03-13 10:32:39,063 INFO] Validation perplexity: 2030.66
[2024-03-13 10:32:39,063 INFO] Validation accuracy: 12.5552
[2024-03-13 10:32:39,064 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_9600.pt
[2024-03-13 10:32:41,528 INFO] Step 9650/13600; acc: 10.6; ppl: 3149.0; xent: 8.1; lr: 1.00000; sents:    2279; bsz:  562/ 485/46; 4856/4192 tok/s;     70 sec;
[2024-03-13 10:32:43,809 INFO] Step 9700/13600; acc: 10.8; ppl: 2579.6; xent: 7.9; lr: 1.00000; sents:    2375; bsz:  565/ 490/48; 12395/10754 tok/s;     72 sec;
[2024-03-13 10:32:46,150 INFO] Step 9750/13600; acc: 8.9; ppl: 8151.4; xent: 9.0; lr: 1.00000; sents:    2371; bsz:  579/ 498/47; 12357/10638 tok/s;     74 sec;
[2024-03-13 10:32:48,507 INFO] Step 9800/13600; acc: 9.9; ppl: 23549.5; xent: 10.1; lr: 1.00000; sents:    2266; bsz:  559/ 484/45; 11857/10278 tok/s;     77 sec;
[2024-03-13 10:32:51,820 INFO] valid stats calculation
                           took: 3.3127336502075195 s.
[2024-03-13 10:32:51,821 INFO] Train perplexity: 23074.8
[2024-03-13 10:32:51,821 INFO] Train accuracy: 9.59559
[2024-03-13 10:32:51,821 INFO] Sentences processed: 56078
[2024-03-13 10:32:51,821 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:32:51,821 INFO] Validation perplexity: 6079.32
[2024-03-13 10:32:51,821 INFO] Validation accuracy: 11.9535
[2024-03-13 10:32:51,822 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_9800.pt
[2024-03-13 10:32:54,189 INFO] Step 9850/13600; acc: 8.0; ppl: 6864.0; xent: 8.8; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 4965/4316 tok/s;     82 sec;
[2024-03-13 10:32:56,577 INFO] Step 9900/13600; acc: 8.5; ppl: 8916.9; xent: 9.1; lr: 1.00000; sents:    2264; bsz:  582/ 502/45; 12191/10520 tok/s;     85 sec;
[2024-03-13 10:32:58,838 INFO] Step 9950/13600; acc: 9.8; ppl: 3342.6; xent: 8.1; lr: 1.00000; sents:    2369; bsz:  566/ 491/47; 12513/10866 tok/s;     87 sec;
[2024-03-13 10:33:01,103 INFO] Step 10000/13600; acc: 8.9; ppl: 5626.1; xent: 8.6; lr: 1.00000; sents:    2367; bsz:  563/ 488/47; 12429/10772 tok/s;     89 sec;
[2024-03-13 10:33:04,408 INFO] valid stats calculation
                           took: 3.305210590362549 s.
[2024-03-13 10:33:04,409 INFO] Train perplexity: 18968
[2024-03-13 10:33:04,409 INFO] Train accuracy: 9.483
[2024-03-13 10:33:04,409 INFO] Sentences processed: 65444
[2024-03-13 10:33:04,409 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:33:04,409 INFO] Validation perplexity: 5387.23
[2024-03-13 10:33:04,409 INFO] Validation accuracy: 7.05977
[2024-03-13 10:33:04,410 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_10000.pt
[2024-03-13 10:33:06,930 INFO] Step 10050/13600; acc: 6.6; ppl: 17205.5; xent: 9.8; lr: 1.00000; sents:    2272; bsz:  578/ 497/45; 4964/4262 tok/s;     95 sec;
[2024-03-13 10:33:09,282 INFO] Step 10100/13600; acc: 9.5; ppl: 46251.3; xent: 10.7; lr: 1.00000; sents:    2371; bsz:  564/ 490/47; 11990/10407 tok/s;     97 sec;
[2024-03-13 10:33:11,654 INFO] Step 10150/13600; acc: 7.6; ppl: 22281.1; xent: 10.0; lr: 1.00000; sents:    2273; bsz:  560/ 486/45; 11802/10248 tok/s;    100 sec;
[2024-03-13 10:33:13,992 INFO] Step 10200/13600; acc: 8.4; ppl: 15345.7; xent: 9.6; lr: 1.00000; sents:    2382; bsz:  582/ 504/48; 12453/10782 tok/s;    102 sec;
[2024-03-13 10:33:17,304 INFO] valid stats calculation
                           took: 3.3119547367095947 s.
[2024-03-13 10:33:17,304 INFO] Train perplexity: 19404.3
[2024-03-13 10:33:17,305 INFO] Train accuracy: 9.30234
[2024-03-13 10:33:17,305 INFO] Sentences processed: 74742
[2024-03-13 10:33:17,305 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:33:17,305 INFO] Validation perplexity: 5.72369e+07
[2024-03-13 10:33:17,305 INFO] Validation accuracy: 13.1568
[2024-03-13 10:33:17,306 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_10200.pt
[2024-03-13 10:33:19,720 INFO] Step 10250/13600; acc: 9.8; ppl: 20228.0; xent: 9.9; lr: 1.00000; sents:    2376; bsz:  564/ 490/48; 4920/4276 tok/s;    108 sec;
[2024-03-13 10:33:22,079 INFO] Step 10300/13600; acc: 8.8; ppl: 6588.2; xent: 8.8; lr: 1.00000; sents:    2376; bsz:  589/ 510/48; 12477/10814 tok/s;    110 sec;
[2024-03-13 10:33:24,449 INFO] Step 10350/13600; acc: 10.9; ppl: 3461.8; xent: 8.1; lr: 1.00000; sents:    2272; bsz:  543/ 474/45; 11455/10007 tok/s;    113 sec;
[2024-03-13 10:33:26,779 INFO] Step 10400/13600; acc: 8.3; ppl: 5845.0; xent: 8.7; lr: 1.00000; sents:    2366; bsz:  589/ 511/47; 12638/10965 tok/s;    115 sec;
[2024-03-13 10:33:30,093 INFO] valid stats calculation
                           took: 3.312755823135376 s.
[2024-03-13 10:33:30,093 INFO] Train perplexity: 17378.6
[2024-03-13 10:33:30,093 INFO] Train accuracy: 9.31734
[2024-03-13 10:33:30,093 INFO] Sentences processed: 84132
[2024-03-13 10:33:30,093 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:33:30,093 INFO] Validation perplexity: 1838.42
[2024-03-13 10:33:30,093 INFO] Validation accuracy: 8.06258
[2024-03-13 10:33:30,094 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_10400.pt
[2024-03-13 10:33:32,488 INFO] Step 10450/13600; acc: 9.6; ppl: 7660.5; xent: 8.9; lr: 1.00000; sents:    2369; bsz:  566/ 492/47; 4962/4309 tok/s;    121 sec;
[2024-03-13 10:33:34,815 INFO] Step 10500/13600; acc: 9.9; ppl: 21284.8; xent: 10.0; lr: 1.00000; sents:    2242; bsz:  568/ 491/45; 12211/10546 tok/s;    123 sec;
[2024-03-13 10:33:37,083 INFO] Step 10550/13600; acc: 9.7; ppl: 3140.6; xent: 8.1; lr: 1.00000; sents:    2365; bsz:  564/ 490/47; 12441/10817 tok/s;    125 sec;
[2024-03-13 10:33:39,416 INFO] Step 10600/13600; acc: 9.8; ppl: 16549.5; xent: 9.7; lr: 1.00000; sents:    2258; bsz:  553/ 479/45; 11853/10263 tok/s;    128 sec;
[2024-03-13 10:33:42,727 INFO] valid stats calculation
                           took: 3.3109707832336426 s.
[2024-03-13 10:33:42,727 INFO] Train perplexity: 16381.8
[2024-03-13 10:33:42,728 INFO] Train accuracy: 9.3606
[2024-03-13 10:33:42,728 INFO] Sentences processed: 93366
[2024-03-13 10:33:42,728 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:33:42,728 INFO] Validation perplexity: 3212.66
[2024-03-13 10:33:42,728 INFO] Validation accuracy: 12.9563
[2024-03-13 10:33:42,729 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_10600.pt
[2024-03-13 10:33:45,158 INFO] Step 10650/13600; acc: 11.0; ppl: 1746.2; xent: 7.5; lr: 1.00000; sents:    2377; bsz:  566/ 491/48; 4925/4276 tok/s;    133 sec;
[2024-03-13 10:33:47,550 INFO] Step 10700/13600; acc: 10.2; ppl: 3938.1; xent: 8.3; lr: 1.00000; sents:    2379; bsz:  587/ 510/48; 12261/10663 tok/s;    136 sec;
[2024-03-13 10:33:49,901 INFO] Step 10750/13600; acc: 8.0; ppl: 6574.3; xent: 8.8; lr: 1.00000; sents:    2383; bsz:  583/ 507/48; 12405/10781 tok/s;    138 sec;
[2024-03-13 10:33:52,230 INFO] Step 10800/13600; acc: 11.1; ppl: 4080.8; xent: 8.3; lr: 1.00000; sents:    2267; bsz:  539/ 469/45; 11573/10059 tok/s;    140 sec;
[2024-03-13 10:33:55,544 INFO] valid stats calculation
                           took: 3.3136305809020996 s.
[2024-03-13 10:33:55,545 INFO] Train perplexity: 14307.4
[2024-03-13 10:33:55,545 INFO] Train accuracy: 9.42223
[2024-03-13 10:33:55,545 INFO] Sentences processed: 102772
[2024-03-13 10:33:55,545 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:33:55,545 INFO] Validation perplexity: 5971.84
[2024-03-13 10:33:55,545 INFO] Validation accuracy: 8.58404
[2024-03-13 10:33:55,546 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_10800.pt
[2024-03-13 10:33:58,000 INFO] Step 10850/13600; acc: 9.6; ppl: 2622.0; xent: 7.9; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 5014/4332 tok/s;    146 sec;
[2024-03-13 10:34:00,386 INFO] Step 10900/13600; acc: 9.3; ppl: 3041.3; xent: 8.0; lr: 1.00000; sents:    2372; bsz:  586/ 513/47; 12287/10757 tok/s;    148 sec;
[2024-03-13 10:34:02,812 INFO] Step 10950/13600; acc: 10.0; ppl: 4324.7; xent: 8.4; lr: 1.00000; sents:    2270; bsz:  567/ 491/45; 11690/10112 tok/s;    151 sec;
[2024-03-13 10:34:05,139 INFO] Step 11000/13600; acc: 11.1; ppl: 3513.5; xent: 8.2; lr: 1.00000; sents:    2367; bsz:  568/ 500/47; 12207/10739 tok/s;    153 sec;
[2024-03-13 10:34:08,464 INFO] valid stats calculation
                           took: 3.3236591815948486 s.
[2024-03-13 10:34:08,464 INFO] Train perplexity: 12644.1
[2024-03-13 10:34:08,464 INFO] Train accuracy: 9.47184
[2024-03-13 10:34:08,464 INFO] Sentences processed: 112156
[2024-03-13 10:34:08,464 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:34:08,464 INFO] Validation perplexity: 3296.86
[2024-03-13 10:34:08,464 INFO] Validation accuracy: 8.70437
[2024-03-13 10:34:08,465 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_11000.pt
[2024-03-13 10:34:10,841 INFO] Step 11050/13600; acc: 11.3; ppl: 3415.8; xent: 8.1; lr: 1.00000; sents:    2364; bsz:  573/ 494/47; 5025/4331 tok/s;    159 sec;
[2024-03-13 10:34:13,209 INFO] Step 11100/13600; acc: 10.1; ppl: 4352.3; xent: 8.4; lr: 1.00000; sents:    2263; bsz:  553/ 479/45; 11685/10109 tok/s;    161 sec;
[2024-03-13 10:34:15,486 INFO] Step 11150/13600; acc: 11.9; ppl: 1187.1; xent: 7.1; lr: 1.00000; sents:    2365; bsz:  562/ 489/47; 12336/10742 tok/s;    164 sec;
[2024-03-13 10:34:17,884 INFO] Step 11200/13600; acc: 12.0; ppl: 5622.4; xent: 8.6; lr: 1.00000; sents:    2373; bsz:  582/ 507/47; 12132/10569 tok/s;    166 sec;
[2024-03-13 10:34:21,199 INFO] valid stats calculation
                           took: 3.314692258834839 s.
[2024-03-13 10:34:21,199 INFO] Train perplexity: 11371.9
[2024-03-13 10:34:21,199 INFO] Train accuracy: 9.61509
[2024-03-13 10:34:21,199 INFO] Sentences processed: 121521
[2024-03-13 10:34:21,199 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:34:21,199 INFO] Validation perplexity: 5097.24
[2024-03-13 10:34:21,199 INFO] Validation accuracy: 11.8331
[2024-03-13 10:34:21,201 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_11200.pt
[2024-03-13 10:34:23,693 INFO] Step 11250/13600; acc: 10.7; ppl: 2854.0; xent: 8.0; lr: 1.00000; sents:    2275; bsz:  547/ 475/46; 4708/4087 tok/s;    172 sec;
[2024-03-13 10:34:26,128 INFO] Step 11300/13600; acc: 11.7; ppl: 1860.1; xent: 7.5; lr: 1.00000; sents:    2375; bsz:  580/ 505/48; 11919/10374 tok/s;    174 sec;
[2024-03-13 10:34:28,438 INFO] Step 11350/13600; acc: 11.3; ppl: 1621.3; xent: 7.4; lr: 1.00000; sents:    2381; bsz:  579/ 499/48; 12534/10805 tok/s;    177 sec;
[2024-03-13 10:34:30,783 INFO] Step 11400/13600; acc: 12.5; ppl: 738.3; xent: 6.6; lr: 1.00000; sents:    2276; bsz:  548/ 477/46; 11694/10174 tok/s;    179 sec;
[2024-03-13 10:34:34,098 INFO] valid stats calculation
                           took: 3.3144679069519043 s.
[2024-03-13 10:34:34,098 INFO] Train perplexity: 9894.28
[2024-03-13 10:34:34,098 INFO] Train accuracy: 9.751
[2024-03-13 10:34:34,098 INFO] Sentences processed: 130828
[2024-03-13 10:34:34,098 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:34:34,098 INFO] Validation perplexity: 3681.47
[2024-03-13 10:34:34,098 INFO] Validation accuracy: 9.14561
[2024-03-13 10:34:34,100 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_11400.pt
[2024-03-13 10:34:36,522 INFO] Step 11450/13600; acc: 11.4; ppl: 1824.5; xent: 7.5; lr: 1.00000; sents:    2375; bsz:  579/ 499/48; 5045/4344 tok/s;    185 sec;
[2024-03-13 10:34:38,901 INFO] Step 11500/13600; acc: 9.3; ppl: 3107.1; xent: 8.0; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 12317/10675 tok/s;    187 sec;
[2024-03-13 10:34:41,189 INFO] Step 11550/13600; acc: 12.3; ppl: 2464.4; xent: 7.8; lr: 1.00000; sents:    2366; bsz:  564/ 489/47; 12316/10694 tok/s;    189 sec;
[2024-03-13 10:34:43,549 INFO] Step 11600/13600; acc: 12.2; ppl: 1503.7; xent: 7.3; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 11939/10350 tok/s;    192 sec;
[2024-03-13 10:34:46,862 INFO] valid stats calculation
                           took: 3.3129355907440186 s.
[2024-03-13 10:34:46,863 INFO] Train perplexity: 8932.01
[2024-03-13 10:34:46,863 INFO] Train accuracy: 9.85588
[2024-03-13 10:34:46,863 INFO] Sentences processed: 140208
[2024-03-13 10:34:46,863 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:34:46,863 INFO] Validation perplexity: 2043.02
[2024-03-13 10:34:46,863 INFO] Validation accuracy: 16.2856
[2024-03-13 10:34:46,864 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_11600.pt
[2024-03-13 10:34:49,288 INFO] Step 11650/13600; acc: 12.1; ppl: 2748.0; xent: 7.9; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 4878/4206 tok/s;    197 sec;
[2024-03-13 10:34:51,547 INFO] Step 11700/13600; acc: 10.3; ppl: 4653.5; xent: 8.4; lr: 1.00000; sents:    2367; bsz:  563/ 488/47; 12460/10813 tok/s;    200 sec;
[2024-03-13 10:34:53,854 INFO] Step 11750/13600; acc: 9.7; ppl: 1605.3; xent: 7.4; lr: 1.00000; sents:    2369; bsz:  580/ 501/47; 12587/10859 tok/s;    202 sec;
[2024-03-13 10:34:56,205 INFO] Step 11800/13600; acc: 8.7; ppl: 2053.8; xent: 7.6; lr: 1.00000; sents:    2372; bsz:  583/ 504/47; 12394/10724 tok/s;    204 sec;
[2024-03-13 10:34:59,505 INFO] valid stats calculation
                           took: 3.2999095916748047 s.
[2024-03-13 10:34:59,506 INFO] Train perplexity: 8255.77
[2024-03-13 10:34:59,506 INFO] Train accuracy: 9.87735
[2024-03-13 10:34:59,506 INFO] Sentences processed: 149578
[2024-03-13 10:34:59,506 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:34:59,506 INFO] Validation perplexity: 4051.92
[2024-03-13 10:34:59,506 INFO] Validation accuracy: 11.6727
[2024-03-13 10:34:59,507 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_11800.pt
[2024-03-13 10:35:02,011 INFO] Step 11850/13600; acc: 10.3; ppl: 4867.5; xent: 8.5; lr: 1.00000; sents:    2269; bsz:  559/ 485/45; 4813/4176 tok/s;    210 sec;
[2024-03-13 10:35:04,344 INFO] Step 11900/13600; acc: 9.4; ppl: 4919.2; xent: 8.5; lr: 1.00000; sents:    2375; bsz:  565/ 492/48; 12119/10556 tok/s;    212 sec;
[2024-03-13 10:35:06,679 INFO] Step 11950/13600; acc: 9.6; ppl: 3273.8; xent: 8.1; lr: 1.00000; sents:    2382; bsz:  568/ 496/48; 12167/10627 tok/s;    215 sec;
[2024-03-13 10:35:09,053 INFO] Step 12000/13600; acc: 10.4; ppl: 4231.5; xent: 8.4; lr: 1.00000; sents:    2376; bsz:  590/ 511/48; 12422/10766 tok/s;    217 sec;
[2024-03-13 10:35:12,363 INFO] valid stats calculation
                           took: 3.309448003768921 s.
[2024-03-13 10:35:12,364 INFO] Train perplexity: 7939.55
[2024-03-13 10:35:12,364 INFO] Train accuracy: 9.88049
[2024-03-13 10:35:12,364 INFO] Sentences processed: 158980
[2024-03-13 10:35:12,364 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:35:12,364 INFO] Validation perplexity: 9301.87
[2024-03-13 10:35:12,364 INFO] Validation accuracy: 11.1512
[2024-03-13 10:35:12,365 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_12000.pt
[2024-03-13 10:35:14,877 INFO] Step 12050/13600; acc: 8.7; ppl: 2755.7; xent: 7.9; lr: 1.00000; sents:    2280; bsz:  565/ 490/46; 4852/4210 tok/s;    223 sec;
[2024-03-13 10:35:17,229 INFO] Step 12100/13600; acc: 8.1; ppl: 4384.8; xent: 8.4; lr: 1.00000; sents:    2368; bsz:  565/ 491/47; 12008/10438 tok/s;    225 sec;
[2024-03-13 10:35:19,595 INFO] Step 12150/13600; acc: 8.6; ppl: 7842.8; xent: 9.0; lr: 1.00000; sents:    2246; bsz:  570/ 491/45; 12055/10383 tok/s;    228 sec;
[2024-03-13 10:35:21,890 INFO] Step 12200/13600; acc: 10.7; ppl: 3242.6; xent: 8.1; lr: 1.00000; sents:    2368; bsz:  567/ 493/47; 12345/10743 tok/s;    230 sec;
[2024-03-13 10:35:25,222 INFO] valid stats calculation
                           took: 3.331541061401367 s.
[2024-03-13 10:35:25,223 INFO] Train perplexity: 7663.56
[2024-03-13 10:35:25,223 INFO] Train accuracy: 9.83376
[2024-03-13 10:35:25,223 INFO] Sentences processed: 168242
[2024-03-13 10:35:25,223 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:35:25,223 INFO] Validation perplexity: 1934.91
[2024-03-13 10:35:25,223 INFO] Validation accuracy: 9.22583
[2024-03-13 10:35:25,224 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_12200.pt
[2024-03-13 10:35:27,626 INFO] Step 12250/13600; acc: 9.2; ppl: 6657.4; xent: 8.8; lr: 1.00000; sents:    2363; bsz:  576/ 498/47; 5026/4340 tok/s;    236 sec;
[2024-03-13 10:35:29,942 INFO] Step 12300/13600; acc: 9.4; ppl: 5738.1; xent: 8.7; lr: 1.00000; sents:    2251; bsz:  552/ 480/45; 11920/10363 tok/s;    238 sec;
[2024-03-13 10:35:32,239 INFO] Step 12350/13600; acc: 9.8; ppl: 2127.5; xent: 7.7; lr: 1.00000; sents:    2372; bsz:  566/ 492/47; 12315/10705 tok/s;    240 sec;
[2024-03-13 10:35:34,640 INFO] Step 12400/13600; acc: 10.5; ppl: 3492.9; xent: 8.2; lr: 1.00000; sents:    2274; bsz:  563/ 490/45; 11723/10195 tok/s;    243 sec;
[2024-03-13 10:35:37,961 INFO] valid stats calculation
                           took: 3.3209404945373535 s.
[2024-03-13 10:35:37,962 INFO] Train perplexity: 7417.62
[2024-03-13 10:35:37,962 INFO] Train accuracy: 9.82824
[2024-03-13 10:35:37,962 INFO] Sentences processed: 177502
[2024-03-13 10:35:37,962 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:35:37,962 INFO] Validation perplexity: 3471.87
[2024-03-13 10:35:37,962 INFO] Validation accuracy: 13.3975
[2024-03-13 10:35:37,963 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_12400.pt
[2024-03-13 10:35:40,425 INFO] Step 12450/13600; acc: 9.9; ppl: 3182.3; xent: 8.1; lr: 1.00000; sents:    2375; bsz:  580/ 506/48; 5011/4372 tok/s;    249 sec;
[2024-03-13 10:35:42,708 INFO] Step 12500/13600; acc: 12.0; ppl: 1952.8; xent: 7.6; lr: 1.00000; sents:    2381; bsz:  565/ 490/48; 12370/10726 tok/s;    251 sec;
[2024-03-13 10:35:45,070 INFO] Step 12550/13600; acc: 10.5; ppl: 3001.6; xent: 8.0; lr: 1.00000; sents:    2277; bsz:  566/ 489/46; 11978/10355 tok/s;    253 sec;
[2024-03-13 10:35:47,344 INFO] Step 12600/13600; acc: 10.1; ppl: 2649.0; xent: 7.9; lr: 1.00000; sents:    2474; bsz:  583/ 514/49; 12823/11310 tok/s;    255 sec;
[2024-03-13 10:35:50,649 INFO] valid stats calculation
                           took: 3.3045907020568848 s.
[2024-03-13 10:35:50,649 INFO] Train perplexity: 7041.95
[2024-03-13 10:35:50,650 INFO] Train accuracy: 9.86813
[2024-03-13 10:35:50,650 INFO] Sentences processed: 187009
[2024-03-13 10:35:50,650 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:35:50,650 INFO] Validation perplexity: 1536.98
[2024-03-13 10:35:50,650 INFO] Validation accuracy: 11.1913
[2024-03-13 10:35:50,651 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_12600.pt
[2024-03-13 10:35:53,117 INFO] Step 12650/13600; acc: 10.2; ppl: 3596.9; xent: 8.2; lr: 1.00000; sents:    2275; bsz:  569/ 494/46; 4933/4278 tok/s;    261 sec;
[2024-03-13 10:35:55,438 INFO] Step 12700/13600; acc: 10.7; ppl: 1607.4; xent: 7.4; lr: 1.00000; sents:    2367; bsz:  578/ 498/47; 12441/10723 tok/s;    264 sec;
[2024-03-13 10:35:57,738 INFO] Step 12750/13600; acc: 11.4; ppl: 4404.9; xent: 8.4; lr: 1.00000; sents:    2263; bsz:  542/ 474/45; 11796/10303 tok/s;    266 sec;
[2024-03-13 10:35:59,984 INFO] Step 12800/13600; acc: 11.5; ppl: 3727.2; xent: 8.2; lr: 1.00000; sents:    2364; bsz:  572/ 494/47; 12727/10990 tok/s;    268 sec;
[2024-03-13 10:36:03,330 INFO] valid stats calculation
                           took: 3.344855546951294 s.
[2024-03-13 10:36:03,330 INFO] Train perplexity: 6774.87
[2024-03-13 10:36:03,330 INFO] Train accuracy: 9.91853
[2024-03-13 10:36:03,330 INFO] Sentences processed: 196278
[2024-03-13 10:36:03,330 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:36:03,330 INFO] Validation perplexity: 6710.12
[2024-03-13 10:36:03,330 INFO] Validation accuracy: 6.69876
[2024-03-13 10:36:03,331 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_12800.pt
[2024-03-13 10:36:05,736 INFO] Step 12850/13600; acc: 10.6; ppl: 1743.0; xent: 7.5; lr: 1.00000; sents:    2268; bsz:  558/ 481/45; 4848/4185 tok/s;    274 sec;
[2024-03-13 10:36:08,073 INFO] Step 12900/13600; acc: 9.9; ppl: 5486.2; xent: 8.6; lr: 1.00000; sents:    2367; bsz:  566/ 495/47; 12122/10593 tok/s;    276 sec;
[2024-03-13 10:36:10,444 INFO] Step 12950/13600; acc: 9.6; ppl: 3076.4; xent: 8.0; lr: 1.00000; sents:    2373; bsz:  581/ 507/47; 12255/10686 tok/s;    279 sec;
[2024-03-13 10:36:12,810 INFO] Step 13000/13600; acc: 10.7; ppl: 2455.4; xent: 7.8; lr: 1.00000; sents:    2372; bsz:  585/ 503/47; 12354/10638 tok/s;    281 sec;
[2024-03-13 10:36:16,125 INFO] valid stats calculation
                           took: 3.314697504043579 s.
[2024-03-13 10:36:16,126 INFO] Train perplexity: 6519.65
[2024-03-13 10:36:16,126 INFO] Train accuracy: 9.93082
[2024-03-13 10:36:16,126 INFO] Sentences processed: 205658
[2024-03-13 10:36:16,126 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:36:16,126 INFO] Validation perplexity: 24734.2
[2024-03-13 10:36:16,126 INFO] Validation accuracy: 7.86201
[2024-03-13 10:36:16,127 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_13000.pt
[2024-03-13 10:36:18,547 INFO] Step 13050/13600; acc: 10.2; ppl: 3600.2; xent: 8.2; lr: 1.00000; sents:    2274; bsz:  543/ 474/45; 4734/4129 tok/s;    287 sec;
[2024-03-13 10:36:20,828 INFO] Step 13100/13600; acc: 10.5; ppl: 2714.9; xent: 7.9; lr: 1.00000; sents:    2382; bsz:  577/ 497/48; 12643/10905 tok/s;    289 sec;
[2024-03-13 10:36:23,175 INFO] Step 13150/13600; acc: 11.7; ppl: 3838.2; xent: 8.3; lr: 1.00000; sents:    2376; bsz:  589/ 509/48; 12538/10844 tok/s;    291 sec;
[2024-03-13 10:36:25,493 INFO] Step 13200/13600; acc: 12.4; ppl: 882.3; xent: 6.8; lr: 1.00000; sents:    2277; bsz:  544/ 471/46; 11732/10170 tok/s;    294 sec;
[2024-03-13 10:36:28,807 INFO] valid stats calculation
                           took: 3.313237190246582 s.
[2024-03-13 10:36:28,807 INFO] Train perplexity: 6248.42
[2024-03-13 10:36:28,807 INFO] Train accuracy: 9.98466
[2024-03-13 10:36:28,807 INFO] Sentences processed: 214967
[2024-03-13 10:36:28,807 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:36:28,807 INFO] Validation perplexity: 1690.41
[2024-03-13 10:36:28,807 INFO] Validation accuracy: 15.8845
[2024-03-13 10:36:28,809 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_13200.pt
[2024-03-13 10:36:31,268 INFO] Step 13250/13600; acc: 9.6; ppl: 1968.6; xent: 7.6; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 5070/4397 tok/s;    299 sec;
[2024-03-13 10:36:33,532 INFO] Step 13300/13600; acc: 10.7; ppl: 1230.3; xent: 7.1; lr: 1.00000; sents:    2366; bsz:  563/ 489/47; 12430/10806 tok/s;    302 sec;
[2024-03-13 10:36:35,847 INFO] Step 13350/13600; acc: 10.6; ppl: 2428.7; xent: 7.8; lr: 1.00000; sents:    2263; bsz:  560/ 483/45; 12088/10430 tok/s;    304 sec;
[2024-03-13 10:36:38,101 INFO] Step 13400/13600; acc: 11.5; ppl: 1785.3; xent: 7.5; lr: 1.00000; sents:    2365; bsz:  580/ 500/47; 12863/11082 tok/s;    306 sec;
[2024-03-13 10:36:41,417 INFO] valid stats calculation
                           took: 3.314911365509033 s.
[2024-03-13 10:36:41,417 INFO] Train perplexity: 5931.89
[2024-03-13 10:36:41,417 INFO] Train accuracy: 10.0102
[2024-03-13 10:36:41,417 INFO] Sentences processed: 224332
[2024-03-13 10:36:41,417 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:36:41,417 INFO] Validation perplexity: 3627.5
[2024-03-13 10:36:41,417 INFO] Validation accuracy: 7.70156
[2024-03-13 10:36:41,419 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_13400.pt
[2024-03-13 10:36:43,795 INFO] Step 13450/13600; acc: 11.2; ppl: 1556.3; xent: 7.4; lr: 1.00000; sents:    2367; bsz:  566/ 494/47; 4971/4342 tok/s;    312 sec;
[2024-03-13 10:36:46,120 INFO] Step 13500/13600; acc: 9.8; ppl: 2404.2; xent: 7.8; lr: 1.00000; sents:    2267; bsz:  576/ 495/45; 12388/10648 tok/s;    314 sec;
[2024-03-13 10:36:48,434 INFO] Step 13550/13600; acc: 9.5; ppl: 3060.0; xent: 8.0; lr: 1.00000; sents:    2372; bsz:  564/ 492/47; 12186/10642 tok/s;    317 sec;
[2024-03-13 10:36:50,759 INFO] Step 13600/13600; acc: 11.0; ppl: 2523.0; xent: 7.8; lr: 1.00000; sents:    2371; bsz:  567/ 494/47; 12205/10622 tok/s;    319 sec;
[2024-03-13 10:36:54,144 INFO] valid stats calculation
                           took: 3.3852593898773193 s.
[2024-03-13 10:36:54,145 INFO] Train perplexity: 5712.93
[2024-03-13 10:36:54,145 INFO] Train accuracy: 10.025
[2024-03-13 10:36:54,145 INFO] Sentences processed: 233709
[2024-03-13 10:36:54,145 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:36:54,145 INFO] Validation perplexity: 1906.39
[2024-03-13 10:36:54,145 INFO] Validation accuracy: 15.2427
[2024-03-13 10:36:54,146 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_13600.pt
[2024-03-13 11:32:01,082 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-13 11:32:01,083 INFO] Parsed 2 corpora from -data.
[2024-03-13 11:32:01,083 INFO] Loading checkpoint from tg-pt-both/models/tg-pt-both_03_step_8600.pt
[2024-03-13 11:32:01,154 INFO] Building model...
[2024-03-13 11:32:01,210 INFO] Switching model to float32 for amp/apex_amp
[2024-03-13 11:32:01,210 INFO] Non quantized layer compute is fp32
[2024-03-13 11:32:03,002 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-13 11:32:03,002 INFO] encoder: 8952800
[2024-03-13 11:32:03,002 INFO] decoder: 16687344
[2024-03-13 11:32:03,002 INFO] * number of parameters: 25640144
[2024-03-13 11:32:03,002 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 11:32:03,002 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 11:32:03,002 INFO]  * src vocab size = 17816
[2024-03-13 11:32:03,002 INFO]  * tgt vocab size = 14144
[2024-03-13 11:32:03,004 INFO] Starting training on GPU: [0]
[2024-03-13 11:32:03,004 INFO] Start training loop and validate every 200 steps...
[2024-03-13 11:32:03,004 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-13 11:32:08,860 INFO] Step 8650/13600; acc: 10.1; ppl: 3282390.3; xent: 15.0; lr: 1.00000; sents:    2270; bsz:  565/ 490/45; 4826/4182 tok/s;      6 sec;
[2024-03-13 11:32:11,180 INFO] Step 8700/13600; acc: 8.7; ppl: 197768.1; xent: 12.2; lr: 1.00000; sents:    2369; bsz:  569/ 496/47; 12255/10690 tok/s;      8 sec;
[2024-03-13 11:32:13,517 INFO] Step 8750/13600; acc: 8.9; ppl: 102078.2; xent: 11.5; lr: 1.00000; sents:    2363; bsz:  585/ 508/47; 12523/10870 tok/s;     11 sec;
[2024-03-13 11:32:15,818 INFO] Step 8800/13600; acc: 9.3; ppl: 64051.7; xent: 11.1; lr: 1.00000; sents:    2365; bsz:  585/ 507/47; 12708/11018 tok/s;     13 sec;
[2024-03-13 11:32:19,164 INFO] valid stats calculation
                           took: 3.345048666000366 s.
[2024-03-13 11:32:19,164 INFO] Train perplexity: 249894
[2024-03-13 11:32:19,164 INFO] Train accuracy: 9.2533
[2024-03-13 11:32:19,164 INFO] Sentences processed: 9367
[2024-03-13 11:32:19,164 INFO] Average bsz:  576/ 500/47
[2024-03-13 11:32:19,165 INFO] Validation perplexity: 4585.46
[2024-03-13 11:32:19,165 INFO] Validation accuracy: 9.82752
[2024-03-13 11:32:19,166 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_8800.pt
[2024-03-13 11:32:21,592 INFO] Step 8850/13600; acc: 10.9; ppl: 18797.2; xent: 9.8; lr: 1.00000; sents:    2367; bsz:  564/ 491/47; 4888/4252 tok/s;     19 sec;
[2024-03-13 11:32:23,961 INFO] Step 8900/13600; acc: 9.9; ppl: 10201.5; xent: 9.2; lr: 1.00000; sents:    2251; bsz:  549/ 475/45; 11593/10025 tok/s;     21 sec;
[2024-03-13 11:32:26,321 INFO] Step 8950/13600; acc: 11.2; ppl: 14459.7; xent: 9.6; lr: 1.00000; sents:    2378; bsz:  568/ 494/48; 12023/10472 tok/s;     23 sec;
[2024-03-13 11:32:28,686 INFO] Step 9000/13600; acc: 9.6; ppl: 13095.3; xent: 9.5; lr: 1.00000; sents:    2384; bsz:  587/ 510/48; 12415/10784 tok/s;     26 sec;
[2024-03-13 11:32:32,003 INFO] valid stats calculation
                           took: 3.316124439239502 s.
[2024-03-13 11:32:32,003 INFO] Train perplexity: 59452.2
[2024-03-13 11:32:32,003 INFO] Train accuracy: 9.83173
[2024-03-13 11:32:32,003 INFO] Sentences processed: 18747
[2024-03-13 11:32:32,003 INFO] Average bsz:  572/ 496/47
[2024-03-13 11:32:32,003 INFO] Validation perplexity: 10724.5
[2024-03-13 11:32:32,004 INFO] Validation accuracy: 2.56719
[2024-03-13 11:32:32,005 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_9000.pt
[2024-03-13 11:32:34,498 INFO] Step 9050/13600; acc: 9.9; ppl: 4945.0; xent: 8.5; lr: 1.00000; sents:    2277; bsz:  561/ 487/46; 4830/4189 tok/s;     31 sec;
[2024-03-13 11:32:36,835 INFO] Step 9100/13600; acc: 10.5; ppl: 3661.0; xent: 8.2; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 12052/10465 tok/s;     34 sec;
[2024-03-13 11:32:39,179 INFO] Step 9150/13600; acc: 8.6; ppl: 6136.0; xent: 8.7; lr: 1.00000; sents:    2372; bsz:  580/ 502/47; 12362/10713 tok/s;     36 sec;
[2024-03-13 11:32:41,525 INFO] Step 9200/13600; acc: 9.8; ppl: 4930.5; xent: 8.5; lr: 1.00000; sents:    2252; bsz:  551/ 477/45; 11748/10159 tok/s;     39 sec;
[2024-03-13 11:32:44,845 INFO] valid stats calculation
                           took: 3.3191440105438232 s.
[2024-03-13 11:32:44,845 INFO] Train perplexity: 25999.2
[2024-03-13 11:32:44,845 INFO] Train accuracy: 9.78558
[2024-03-13 11:32:44,845 INFO] Sentences processed: 28023
[2024-03-13 11:32:44,846 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:32:44,846 INFO] Validation perplexity: 1812.92
[2024-03-13 11:32:44,846 INFO] Validation accuracy: 11.1111
[2024-03-13 11:32:44,847 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_9200.pt
[2024-03-13 11:32:47,314 INFO] Step 9250/13600; acc: 11.6; ppl: 4004.4; xent: 8.3; lr: 1.00000; sents:    2367; bsz:  587/ 513/47; 5071/4427 tok/s;     44 sec;
[2024-03-13 11:32:49,663 INFO] Step 9300/13600; acc: 9.1; ppl: 5156.9; xent: 8.5; lr: 1.00000; sents:    2268; bsz:  567/ 491/45; 12073/10458 tok/s;     47 sec;
[2024-03-13 11:32:51,987 INFO] Step 9350/13600; acc: 9.5; ppl: 3225.1; xent: 8.1; lr: 1.00000; sents:    2367; bsz:  567/ 499/47; 12205/10727 tok/s;     49 sec;
[2024-03-13 11:32:54,323 INFO] Step 9400/13600; acc: 11.6; ppl: 1874.2; xent: 7.5; lr: 1.00000; sents:    2365; bsz:  561/ 487/47; 12005/10418 tok/s;     51 sec;
[2024-03-13 11:32:57,653 INFO] valid stats calculation
                           took: 3.3300998210906982 s.
[2024-03-13 11:32:57,654 INFO] Train perplexity: 15539.5
[2024-03-13 11:32:57,654 INFO] Train accuracy: 9.95489
[2024-03-13 11:32:57,654 INFO] Sentences processed: 37390
[2024-03-13 11:32:57,654 INFO] Average bsz:  569/ 495/47
[2024-03-13 11:32:57,654 INFO] Validation perplexity: 2926.01
[2024-03-13 11:32:57,654 INFO] Validation accuracy: 10.5897
[2024-03-13 11:32:57,655 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_9400.pt
[2024-03-13 11:33:00,154 INFO] Step 9450/13600; acc: 10.6; ppl: 7091.9; xent: 8.9; lr: 1.00000; sents:    2269; bsz:  569/ 491/45; 4877/4214 tok/s;     57 sec;
[2024-03-13 11:33:02,518 INFO] Step 9500/13600; acc: 9.1; ppl: 5500.7; xent: 8.6; lr: 1.00000; sents:    2371; bsz:  563/ 491/47; 11916/10378 tok/s;     60 sec;
[2024-03-13 11:33:04,956 INFO] Step 9550/13600; acc: 11.4; ppl: 2884.2; xent: 8.0; lr: 1.00000; sents:    2376; bsz:  581/ 506/48; 11925/10376 tok/s;     62 sec;
[2024-03-13 11:33:07,305 INFO] Step 9600/13600; acc: 10.2; ppl: 41110.1; xent: 10.6; lr: 1.00000; sents:    2284; bsz:  563/ 487/46; 11995/10366 tok/s;     64 sec;
[2024-03-13 11:33:10,625 INFO] valid stats calculation
                           took: 3.319916009902954 s.
[2024-03-13 11:33:10,626 INFO] Train perplexity: 13662.6
[2024-03-13 11:33:10,626 INFO] Train accuracy: 10.0276
[2024-03-13 11:33:10,626 INFO] Sentences processed: 46690
[2024-03-13 11:33:10,626 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:33:10,626 INFO] Validation perplexity: 2882.04
[2024-03-13 11:33:10,626 INFO] Validation accuracy: 6.53831
[2024-03-13 11:33:10,627 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_9600.pt
[2024-03-13 11:33:13,136 INFO] Step 9650/13600; acc: 10.6; ppl: 9046.2; xent: 9.1; lr: 1.00000; sents:    2376; bsz:  564/ 493/48; 4840/4228 tok/s;     70 sec;
[2024-03-13 11:33:15,445 INFO] Step 9700/13600; acc: 8.4; ppl: 14097.7; xent: 9.6; lr: 1.00000; sents:    2375; bsz:  579/ 498/48; 12536/10787 tok/s;     72 sec;
[2024-03-13 11:33:17,785 INFO] Step 9750/13600; acc: 10.2; ppl: 3674.5; xent: 8.2; lr: 1.00000; sents:    2371; bsz:  565/ 491/47; 12076/10482 tok/s;     75 sec;
[2024-03-13 11:33:20,154 INFO] Step 9800/13600; acc: 10.4; ppl: 4623.1; xent: 8.4; lr: 1.00000; sents:    2266; bsz:  559/ 484/45; 11794/10223 tok/s;     77 sec;
[2024-03-13 11:33:23,488 INFO] valid stats calculation
                           took: 3.3334877490997314 s.
[2024-03-13 11:33:23,489 INFO] Train perplexity: 12185.1
[2024-03-13 11:33:23,489 INFO] Train accuracy: 10.0035
[2024-03-13 11:33:23,489 INFO] Sentences processed: 56078
[2024-03-13 11:33:23,489 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:33:23,489 INFO] Validation perplexity: 8977.96
[2024-03-13 11:33:23,489 INFO] Validation accuracy: 3.36943
[2024-03-13 11:33:23,490 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_9800.pt
[2024-03-13 11:33:25,914 INFO] Step 9850/13600; acc: 8.4; ppl: 4481.2; xent: 8.4; lr: 1.00000; sents:    2366; bsz:  584/ 506/47; 5071/4395 tok/s;     83 sec;
[2024-03-13 11:33:28,180 INFO] Step 9900/13600; acc: 8.0; ppl: 5905.7; xent: 8.7; lr: 1.00000; sents:    2364; bsz:  564/ 490/47; 12448/10811 tok/s;     85 sec;
[2024-03-13 11:33:30,540 INFO] Step 9950/13600; acc: 8.8; ppl: 11428.9; xent: 9.3; lr: 1.00000; sents:    2269; bsz:  564/ 488/45; 11951/10342 tok/s;     88 sec;
[2024-03-13 11:33:32,839 INFO] Step 10000/13600; acc: 6.5; ppl: 27585.2; xent: 10.2; lr: 1.00000; sents:    2367; bsz:  579/ 500/47; 12601/10872 tok/s;     90 sec;
[2024-03-13 11:33:36,158 INFO] valid stats calculation
                           took: 3.3180992603302 s.
[2024-03-13 11:33:36,158 INFO] Train perplexity: 11766.4
[2024-03-13 11:33:36,158 INFO] Train accuracy: 9.70571
[2024-03-13 11:33:36,158 INFO] Sentences processed: 65444
[2024-03-13 11:33:36,158 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:33:36,158 INFO] Validation perplexity: 2639.92
[2024-03-13 11:33:36,158 INFO] Validation accuracy: 8.50381
[2024-03-13 11:33:36,160 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_10000.pt
[2024-03-13 11:33:38,604 INFO] Step 10050/13600; acc: 10.7; ppl: 3701.0; xent: 8.2; lr: 1.00000; sents:    2372; bsz:  564/ 489/47; 4894/4243 tok/s;     96 sec;
[2024-03-13 11:33:41,033 INFO] Step 10100/13600; acc: 11.1; ppl: 1396.7; xent: 7.2; lr: 1.00000; sents:    2271; bsz:  562/ 485/45; 11566/9982 tok/s;     98 sec;
[2024-03-13 11:33:43,409 INFO] Step 10150/13600; acc: 10.8; ppl: 2049.3; xent: 7.6; lr: 1.00000; sents:    2375; bsz:  583/ 505/48; 12272/10622 tok/s;    100 sec;
[2024-03-13 11:33:45,756 INFO] Step 10200/13600; acc: 10.7; ppl: 1960.5; xent: 7.6; lr: 1.00000; sents:    2280; bsz:  543/ 474/46; 11571/10111 tok/s;    103 sec;
[2024-03-13 11:33:49,141 INFO] valid stats calculation
                           took: 3.3847365379333496 s.
[2024-03-13 11:33:49,141 INFO] Train perplexity: 9528.56
[2024-03-13 11:33:49,141 INFO] Train accuracy: 9.84442
[2024-03-13 11:33:49,141 INFO] Sentences processed: 74742
[2024-03-13 11:33:49,141 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:33:49,141 INFO] Validation perplexity: 2506.5
[2024-03-13 11:33:49,141 INFO] Validation accuracy: 3.40955
[2024-03-13 11:33:49,143 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_10200.pt
[2024-03-13 11:33:51,611 INFO] Step 10250/13600; acc: 8.5; ppl: 5910.4; xent: 8.7; lr: 1.00000; sents:    2376; bsz:  580/ 501/48; 4950/4277 tok/s;    109 sec;
[2024-03-13 11:33:53,965 INFO] Step 10300/13600; acc: 8.4; ppl: 16998.9; xent: 9.7; lr: 1.00000; sents:    2376; bsz:  568/ 496/48; 12075/10537 tok/s;    111 sec;
[2024-03-13 11:33:56,347 INFO] Step 10350/13600; acc: 10.9; ppl: 4190.8; xent: 8.3; lr: 1.00000; sents:    2368; bsz:  589/ 512/47; 12370/10755 tok/s;    113 sec;
[2024-03-13 11:33:58,717 INFO] Step 10400/13600; acc: 10.5; ppl: 3276.8; xent: 8.1; lr: 1.00000; sents:    2270; bsz:  563/ 487/45; 11878/10280 tok/s;    116 sec;
[2024-03-13 11:34:02,033 INFO] valid stats calculation
                           took: 3.315507411956787 s.
[2024-03-13 11:34:02,034 INFO] Train perplexity: 9062.09
[2024-03-13 11:34:02,034 INFO] Train accuracy: 9.81394
[2024-03-13 11:34:02,034 INFO] Sentences processed: 84132
[2024-03-13 11:34:02,034 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:34:02,034 INFO] Validation perplexity: 2191.3
[2024-03-13 11:34:02,034 INFO] Validation accuracy: 3.28921
[2024-03-13 11:34:02,035 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_10400.pt
[2024-03-13 11:34:04,443 INFO] Step 10450/13600; acc: 9.9; ppl: 9010.1; xent: 9.1; lr: 1.00000; sents:    2248; bsz:  550/ 476/45; 4803/4154 tok/s;    121 sec;
[2024-03-13 11:34:06,756 INFO] Step 10500/13600; acc: 11.6; ppl: 2030.4; xent: 7.6; lr: 1.00000; sents:    2363; bsz:  564/ 490/47; 12185/10588 tok/s;    124 sec;
[2024-03-13 11:34:09,086 INFO] Step 10550/13600; acc: 9.5; ppl: 2758.7; xent: 7.9; lr: 1.00000; sents:    2365; bsz:  585/ 508/47; 12563/10900 tok/s;    126 sec;
[2024-03-13 11:34:11,392 INFO] Step 10600/13600; acc: 10.4; ppl: 3362.2; xent: 8.1; lr: 1.00000; sents:    2367; bsz:  561/ 488/47; 12159/10575 tok/s;    128 sec;
[2024-03-13 11:34:14,719 INFO] valid stats calculation
                           took: 3.326075792312622 s.
[2024-03-13 11:34:14,719 INFO] Train perplexity: 8263.1
[2024-03-13 11:34:14,719 INFO] Train accuracy: 9.86866
[2024-03-13 11:34:14,719 INFO] Sentences processed: 93475
[2024-03-13 11:34:14,719 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:34:14,719 INFO] Validation perplexity: 58844.7
[2024-03-13 11:34:14,719 INFO] Validation accuracy: 11.8732
[2024-03-13 11:34:14,720 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_10600.pt
[2024-03-13 11:34:17,200 INFO] Step 10650/13600; acc: 8.0; ppl: 6035.9; xent: 8.7; lr: 1.00000; sents:    2372; bsz:  583/ 505/47; 5015/4348 tok/s;    134 sec;
[2024-03-13 11:34:19,612 INFO] Step 10700/13600; acc: 11.7; ppl: 1714.3; xent: 7.4; lr: 1.00000; sents:    2275; bsz:  562/ 487/46; 11645/10098 tok/s;    137 sec;
[2024-03-13 11:34:21,949 INFO] Step 10750/13600; acc: 11.4; ppl: 2243.3; xent: 7.7; lr: 1.00000; sents:    2383; bsz:  567/ 495/48; 12140/10587 tok/s;    139 sec;
[2024-03-13 11:34:24,296 INFO] Step 10800/13600; acc: 9.4; ppl: 27253.4; xent: 10.2; lr: 1.00000; sents:    2267; bsz:  555/ 481/45; 11826/10243 tok/s;    141 sec;
[2024-03-13 11:34:27,614 INFO] valid stats calculation
                           took: 3.317800283432007 s.
[2024-03-13 11:34:27,614 INFO] Train perplexity: 7892.58
[2024-03-13 11:34:27,615 INFO] Train accuracy: 9.88941
[2024-03-13 11:34:27,615 INFO] Sentences processed: 102772
[2024-03-13 11:34:27,615 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:34:27,615 INFO] Validation perplexity: 216145
[2024-03-13 11:34:27,615 INFO] Validation accuracy: 3.81067
[2024-03-13 11:34:27,616 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_10800.pt
[2024-03-13 11:34:30,044 INFO] Step 10850/13600; acc: 9.1; ppl: 15728.4; xent: 9.7; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 5033/4348 tok/s;    147 sec;
[2024-03-13 11:34:32,424 INFO] Step 10900/13600; acc: 10.3; ppl: 14478.9; xent: 9.6; lr: 1.00000; sents:    2275; bsz:  567/ 492/46; 11919/10327 tok/s;    149 sec;
[2024-03-13 11:34:34,759 INFO] Step 10950/13600; acc: 9.7; ppl: 7039.9; xent: 8.9; lr: 1.00000; sents:    2367; bsz:  566/ 498/47; 12133/10655 tok/s;    152 sec;
[2024-03-13 11:34:37,105 INFO] Step 11000/13600; acc: 9.9; ppl: 3530.4; xent: 8.2; lr: 1.00000; sents:    2367; bsz:  588/ 515/47; 12526/10968 tok/s;    154 sec;
[2024-03-13 11:34:40,449 INFO] valid stats calculation
                           took: 3.3428847789764404 s.
[2024-03-13 11:34:40,449 INFO] Train perplexity: 7950.03
[2024-03-13 11:34:40,449 INFO] Train accuracy: 9.87731
[2024-03-13 11:34:40,449 INFO] Sentences processed: 112156
[2024-03-13 11:34:40,449 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:34:40,449 INFO] Validation perplexity: 1501.04
[2024-03-13 11:34:40,449 INFO] Validation accuracy: 12.7958
[2024-03-13 11:34:40,451 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_11000.pt
[2024-03-13 11:34:42,840 INFO] Step 11050/13600; acc: 11.3; ppl: 4667.1; xent: 8.4; lr: 1.00000; sents:    2364; bsz:  573/ 494/47; 4996/4307 tok/s;    160 sec;
[2024-03-13 11:34:45,210 INFO] Step 11100/13600; acc: 10.9; ppl: 16935.7; xent: 9.7; lr: 1.00000; sents:    2263; bsz:  542/ 471/45; 11430/9947 tok/s;    162 sec;
[2024-03-13 11:34:47,546 INFO] Step 11150/13600; acc: 6.8; ppl: 17559.8; xent: 9.8; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 12270/10622 tok/s;    165 sec;
[2024-03-13 11:34:49,961 INFO] Step 11200/13600; acc: 9.2; ppl: 18222.8; xent: 9.8; lr: 1.00000; sents:    2373; bsz:  582/ 507/47; 12048/10497 tok/s;    167 sec;
[2024-03-13 11:34:53,286 INFO] valid stats calculation
                           took: 3.3248419761657715 s.
[2024-03-13 11:34:53,286 INFO] Train perplexity: 8235.75
[2024-03-13 11:34:53,286 INFO] Train accuracy: 9.8502
[2024-03-13 11:34:53,286 INFO] Sentences processed: 121521
[2024-03-13 11:34:53,286 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:34:53,286 INFO] Validation perplexity: 10248.3
[2024-03-13 11:34:53,286 INFO] Validation accuracy: 10.2688
[2024-03-13 11:34:53,288 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_11200.pt
[2024-03-13 11:34:55,796 INFO] Step 11250/13600; acc: 7.5; ppl: 18718.6; xent: 9.8; lr: 1.00000; sents:    2275; bsz:  547/ 475/46; 4686/4068 tok/s;    173 sec;
[2024-03-13 11:34:58,273 INFO] Step 11300/13600; acc: 9.1; ppl: 31342.8; xent: 10.4; lr: 1.00000; sents:    2375; bsz:  580/ 505/48; 11717/10199 tok/s;    175 sec;
[2024-03-13 11:35:00,632 INFO] Step 11350/13600; acc: 9.5; ppl: 5826.1; xent: 8.7; lr: 1.00000; sents:    2381; bsz:  579/ 499/48; 12275/10582 tok/s;    178 sec;
[2024-03-13 11:35:02,986 INFO] Step 11400/13600; acc: 10.9; ppl: 2681.2; xent: 7.9; lr: 1.00000; sents:    2376; bsz:  565/ 490/48; 12003/10412 tok/s;    180 sec;
[2024-03-13 11:35:06,312 INFO] valid stats calculation
                           took: 3.3246943950653076 s.
[2024-03-13 11:35:06,312 INFO] Train perplexity: 8338.22
[2024-03-13 11:35:06,312 INFO] Train accuracy: 9.80817
[2024-03-13 11:35:06,312 INFO] Sentences processed: 130928
[2024-03-13 11:35:06,312 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:35:06,312 INFO] Validation perplexity: 7136.88
[2024-03-13 11:35:06,312 INFO] Validation accuracy: 5.69595
[2024-03-13 11:35:06,313 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_11400.pt
[2024-03-13 11:35:08,818 INFO] Step 11450/13600; acc: 11.1; ppl: 4222.3; xent: 8.3; lr: 1.00000; sents:    2275; bsz:  562/ 485/46; 4820/4161 tok/s;    186 sec;
[2024-03-13 11:35:11,160 INFO] Step 11500/13600; acc: 8.6; ppl: 6517.4; xent: 8.8; lr: 1.00000; sents:    2371; bsz:  566/ 491/47; 12077/10480 tok/s;    188 sec;
[2024-03-13 11:35:13,576 INFO] Step 11550/13600; acc: 10.6; ppl: 6812.3; xent: 8.8; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 11648/10109 tok/s;    191 sec;
[2024-03-13 11:35:15,916 INFO] Step 11600/13600; acc: 10.9; ppl: 7264.4; xent: 8.9; lr: 1.00000; sents:    2366; bsz:  585/ 507/47; 12493/10823 tok/s;    193 sec;
[2024-03-13 11:35:19,236 INFO] valid stats calculation
                           took: 3.3188672065734863 s.
[2024-03-13 11:35:19,236 INFO] Train perplexity: 8165.63
[2024-03-13 11:35:19,236 INFO] Train accuracy: 9.8413
[2024-03-13 11:35:19,236 INFO] Sentences processed: 140208
[2024-03-13 11:35:19,236 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:35:19,236 INFO] Validation perplexity: 18530.5
[2024-03-13 11:35:19,236 INFO] Validation accuracy: 14.28
[2024-03-13 11:35:19,238 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_11600.pt
[2024-03-13 11:35:21,629 INFO] Step 11650/13600; acc: 11.5; ppl: 6855.1; xent: 8.8; lr: 1.00000; sents:    2362; bsz:  562/ 488/47; 4922/4273 tok/s;    199 sec;
[2024-03-13 11:35:23,938 INFO] Step 11700/13600; acc: 10.9; ppl: 7010.0; xent: 8.9; lr: 1.00000; sents:    2369; bsz:  580/ 500/47; 12560/10823 tok/s;    201 sec;
[2024-03-13 11:35:26,303 INFO] Step 11750/13600; acc: 7.6; ppl: 12513.3; xent: 9.4; lr: 1.00000; sents:    2267; bsz:  561/ 484/45; 11857/10232 tok/s;    203 sec;
[2024-03-13 11:35:28,681 INFO] Step 11800/13600; acc: 10.4; ppl: 2788.3; xent: 7.9; lr: 1.00000; sents:    2372; bsz:  583/ 504/47; 12256/10604 tok/s;    206 sec;
[2024-03-13 11:35:32,016 INFO] valid stats calculation
                           took: 3.33433198928833 s.
[2024-03-13 11:35:32,016 INFO] Train perplexity: 8038.23
[2024-03-13 11:35:32,016 INFO] Train accuracy: 9.85925
[2024-03-13 11:35:32,016 INFO] Sentences processed: 149578
[2024-03-13 11:35:32,016 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:35:32,016 INFO] Validation perplexity: 31172.9
[2024-03-13 11:35:32,016 INFO] Validation accuracy: 4.85359
[2024-03-13 11:35:32,017 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_11800.pt
[2024-03-13 11:35:34,528 INFO] Step 11850/13600; acc: 9.5; ppl: 25089.8; xent: 10.1; lr: 1.00000; sents:    2269; bsz:  542/ 474/45; 4636/4052 tok/s;    212 sec;
[2024-03-13 11:35:36,924 INFO] Step 11900/13600; acc: 9.2; ppl: 4296.4; xent: 8.4; lr: 1.00000; sents:    2375; bsz:  582/ 503/48; 12147/10508 tok/s;    214 sec;
[2024-03-13 11:35:39,289 INFO] Step 11950/13600; acc: 9.9; ppl: 17041.3; xent: 9.7; lr: 1.00000; sents:    2382; bsz:  568/ 496/48; 12016/10496 tok/s;    216 sec;
[2024-03-13 11:35:41,740 INFO] Step 12000/13600; acc: 11.7; ppl: 7272.5; xent: 8.9; lr: 1.00000; sents:    2275; bsz:  583/ 502/46; 11896/10249 tok/s;    219 sec;
[2024-03-13 11:35:45,114 INFO] valid stats calculation
                           took: 3.37345290184021 s.
[2024-03-13 11:35:45,114 INFO] Train perplexity: 8170.14
[2024-03-13 11:35:45,114 INFO] Train accuracy: 9.87238
[2024-03-13 11:35:45,114 INFO] Sentences processed: 158879
[2024-03-13 11:35:45,114 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:35:45,114 INFO] Validation perplexity: 1873.2
[2024-03-13 11:35:45,114 INFO] Validation accuracy: 12.8359
[2024-03-13 11:35:45,116 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_12000.pt
[2024-03-13 11:35:47,597 INFO] Step 12050/13600; acc: 9.7; ppl: 1951.7; xent: 7.6; lr: 1.00000; sents:    2381; bsz:  572/ 499/48; 4883/4262 tok/s;    225 sec;
[2024-03-13 11:35:49,961 INFO] Step 12100/13600; acc: 10.0; ppl: 2587.3; xent: 7.9; lr: 1.00000; sents:    2247; bsz:  550/ 477/45; 11624/10080 tok/s;    227 sec;
[2024-03-13 11:35:52,301 INFO] Step 12150/13600; acc: 9.6; ppl: 3859.6; xent: 8.3; lr: 1.00000; sents:    2367; bsz:  565/ 490/47; 12075/10476 tok/s;    229 sec;
[2024-03-13 11:35:54,687 INFO] Step 12200/13600; acc: 9.4; ppl: 10948.4; xent: 9.3; lr: 1.00000; sents:    2368; bsz:  587/ 509/47; 12308/10660 tok/s;    232 sec;
[2024-03-13 11:35:58,013 INFO] valid stats calculation
                           took: 3.3254759311676025 s.
[2024-03-13 11:35:58,013 INFO] Train perplexity: 7836.72
[2024-03-13 11:35:58,013 INFO] Train accuracy: 9.86143
[2024-03-13 11:35:58,013 INFO] Sentences processed: 168242
[2024-03-13 11:35:58,013 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:35:58,013 INFO] Validation perplexity: 57306.8
[2024-03-13 11:35:58,013 INFO] Validation accuracy: 11.3919
[2024-03-13 11:35:58,014 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_12200.pt
[2024-03-13 11:36:00,423 INFO] Step 12250/13600; acc: 7.4; ppl: 9167.5; xent: 9.1; lr: 1.00000; sents:    2249; bsz:  551/ 478/45; 4803/4170 tok/s;    237 sec;
[2024-03-13 11:36:02,704 INFO] Step 12300/13600; acc: 9.0; ppl: 6239.5; xent: 8.7; lr: 1.00000; sents:    2365; bsz:  561/ 486/47; 12298/10658 tok/s;    240 sec;
[2024-03-13 11:36:05,053 INFO] Step 12350/13600; acc: 9.6; ppl: 8919.5; xent: 9.1; lr: 1.00000; sents:    2372; bsz:  582/ 505/47; 12398/10753 tok/s;    242 sec;
[2024-03-13 11:36:07,457 INFO] Step 12400/13600; acc: 8.8; ppl: 15630.0; xent: 9.7; lr: 1.00000; sents:    2274; bsz:  563/ 490/45; 11710/10183 tok/s;    244 sec;
[2024-03-13 11:36:10,784 INFO] valid stats calculation
                           took: 3.3266119956970215 s.
[2024-03-13 11:36:10,784 INFO] Train perplexity: 7913.88
[2024-03-13 11:36:10,784 INFO] Train accuracy: 9.80222
[2024-03-13 11:36:10,784 INFO] Sentences processed: 177502
[2024-03-13 11:36:10,784 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:36:10,784 INFO] Validation perplexity: 32766.9
[2024-03-13 11:36:10,784 INFO] Validation accuracy: 11.5925
[2024-03-13 11:36:10,786 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_12400.pt
[2024-03-13 11:36:13,253 INFO] Step 12450/13600; acc: 11.4; ppl: 11369.5; xent: 9.3; lr: 1.00000; sents:    2482; bsz:  589/ 517/50; 5082/4461 tok/s;    250 sec;
[2024-03-13 11:36:15,639 INFO] Step 12500/13600; acc: 11.4; ppl: 8506.2; xent: 9.0; lr: 1.00000; sents:    2274; bsz:  555/ 478/45; 11639/10026 tok/s;    253 sec;
[2024-03-13 11:36:17,998 INFO] Step 12550/13600; acc: 10.1; ppl: 6184.8; xent: 8.7; lr: 1.00000; sents:    2376; bsz:  564/ 492/48; 11956/10428 tok/s;    255 sec;
[2024-03-13 11:36:20,383 INFO] Step 12600/13600; acc: 7.4; ppl: 9311.4; xent: 9.1; lr: 1.00000; sents:    2375; bsz:  585/ 512/48; 12263/10724 tok/s;    257 sec;
[2024-03-13 11:36:23,709 INFO] valid stats calculation
                           took: 3.325077533721924 s.
[2024-03-13 11:36:23,709 INFO] Train perplexity: 7950.79
[2024-03-13 11:36:23,709 INFO] Train accuracy: 9.81453
[2024-03-13 11:36:23,709 INFO] Sentences processed: 187009
[2024-03-13 11:36:23,709 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:36:23,709 INFO] Validation perplexity: 5903.48
[2024-03-13 11:36:23,709 INFO] Validation accuracy: 13.9992
[2024-03-13 11:36:23,711 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_12600.pt
[2024-03-13 11:36:26,226 INFO] Step 12650/13600; acc: 10.3; ppl: 6824.6; xent: 8.8; lr: 1.00000; sents:    2275; bsz:  569/ 494/46; 4873/4227 tok/s;    263 sec;
[2024-03-13 11:36:28,554 INFO] Step 12700/13600; acc: 10.1; ppl: 3956.7; xent: 8.3; lr: 1.00000; sents:    2367; bsz:  563/ 489/47; 12087/10504 tok/s;    266 sec;
[2024-03-13 11:36:30,982 INFO] Step 12750/13600; acc: 10.4; ppl: 6390.6; xent: 8.8; lr: 1.00000; sents:    2263; bsz:  571/ 490/45; 11759/10085 tok/s;    268 sec;
[2024-03-13 11:36:33,237 INFO] Step 12800/13600; acc: 9.9; ppl: 3704.7; xent: 8.2; lr: 1.00000; sents:    2364; bsz:  558/ 487/47; 12376/10793 tok/s;    270 sec;
[2024-03-13 11:36:36,577 INFO] valid stats calculation
                           took: 3.3391473293304443 s.
[2024-03-13 11:36:36,577 INFO] Train perplexity: 7781
[2024-03-13 11:36:36,577 INFO] Train accuracy: 9.83125
[2024-03-13 11:36:36,577 INFO] Sentences processed: 196278
[2024-03-13 11:36:36,577 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:36:36,577 INFO] Validation perplexity: 6294.79
[2024-03-13 11:36:36,577 INFO] Validation accuracy: 6.73887
[2024-03-13 11:36:36,579 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_12800.pt
[2024-03-13 11:36:39,064 INFO] Step 12850/13600; acc: 8.6; ppl: 6480.6; xent: 8.8; lr: 1.00000; sents:    2367; bsz:  578/ 503/47; 4961/4318 tok/s;    276 sec;
[2024-03-13 11:36:41,423 INFO] Step 12900/13600; acc: 10.4; ppl: 7359.2; xent: 8.9; lr: 1.00000; sents:    2268; bsz:  561/ 485/45; 11892/10275 tok/s;    278 sec;
[2024-03-13 11:36:43,842 INFO] Step 12950/13600; acc: 12.4; ppl: 6604.8; xent: 8.8; lr: 1.00000; sents:    2373; bsz:  566/ 495/47; 11703/10236 tok/s;    281 sec;
[2024-03-13 11:36:46,267 INFO] Step 13000/13600; acc: 10.6; ppl: 4324.8; xent: 8.4; lr: 1.00000; sents:    2372; bsz:  585/ 503/47; 12057/10382 tok/s;    283 sec;
[2024-03-13 11:36:49,592 INFO] valid stats calculation
                           took: 3.3251664638519287 s.
[2024-03-13 11:36:49,593 INFO] Train perplexity: 7692.73
[2024-03-13 11:36:49,593 INFO] Train accuracy: 9.8612
[2024-03-13 11:36:49,593 INFO] Sentences processed: 205658
[2024-03-13 11:36:49,593 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:36:49,593 INFO] Validation perplexity: 35357.4
[2024-03-13 11:36:49,593 INFO] Validation accuracy: 10.9908
[2024-03-13 11:36:49,594 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_13000.pt
[2024-03-13 11:36:52,057 INFO] Step 13050/13600; acc: 8.9; ppl: 14109.3; xent: 9.6; lr: 1.00000; sents:    2274; bsz:  543/ 474/45; 4690/4091 tok/s;    289 sec;
[2024-03-13 11:36:54,378 INFO] Step 13100/13600; acc: 7.7; ppl: 12353.5; xent: 9.4; lr: 1.00000; sents:    2382; bsz:  577/ 497/48; 12424/10716 tok/s;    291 sec;
[2024-03-13 11:36:56,786 INFO] Step 13150/13600; acc: 9.3; ppl: 23385.5; xent: 10.1; lr: 1.00000; sents:    2276; bsz:  565/ 488/46; 11733/10144 tok/s;    294 sec;
[2024-03-13 11:36:59,182 INFO] Step 13200/13600; acc: 9.7; ppl: 13078.1; xent: 9.5; lr: 1.00000; sents:    2377; bsz:  588/ 509/48; 12267/10621 tok/s;    296 sec;
[2024-03-13 11:37:02,527 INFO] valid stats calculation
                           took: 3.3443491458892822 s.
[2024-03-13 11:37:02,527 INFO] Train perplexity: 7922.34
[2024-03-13 11:37:02,527 INFO] Train accuracy: 9.8189
[2024-03-13 11:37:02,527 INFO] Sentences processed: 214967
[2024-03-13 11:37:02,527 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:37:02,527 INFO] Validation perplexity: 19586.1
[2024-03-13 11:37:02,528 INFO] Validation accuracy: 11.5925
[2024-03-13 11:37:02,529 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_13200.pt
[2024-03-13 11:37:04,968 INFO] Step 13250/13600; acc: 9.0; ppl: 3410.7; xent: 8.1; lr: 1.00000; sents:    2371; bsz:  565/ 491/47; 4885/4244 tok/s;    302 sec;
[2024-03-13 11:37:07,285 INFO] Step 13300/13600; acc: 9.5; ppl: 3396.2; xent: 8.1; lr: 1.00000; sents:    2366; bsz:  579/ 500/47; 12493/10779 tok/s;    304 sec;
[2024-03-13 11:37:09,626 INFO] Step 13350/13600; acc: 11.8; ppl: 2504.8; xent: 7.8; lr: 1.00000; sents:    2263; bsz:  559/ 483/45; 11950/10314 tok/s;    307 sec;
[2024-03-13 11:37:11,920 INFO] Step 13400/13600; acc: 9.2; ppl: 24247.0; xent: 10.1; lr: 1.00000; sents:    2365; bsz:  564/ 489/47; 12289/10664 tok/s;    309 sec;
[2024-03-13 11:37:15,260 INFO] valid stats calculation
                           took: 3.3393146991729736 s.
[2024-03-13 11:37:15,260 INFO] Train perplexity: 7782.25
[2024-03-13 11:37:15,260 INFO] Train accuracy: 9.82142
[2024-03-13 11:37:15,260 INFO] Sentences processed: 224332
[2024-03-13 11:37:15,260 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:37:15,260 INFO] Validation perplexity: 1424.47
[2024-03-13 11:37:15,260 INFO] Validation accuracy: 13.197
[2024-03-13 11:37:15,262 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_13400.pt
[2024-03-13 11:37:17,691 INFO] Step 13450/13600; acc: 10.3; ppl: 20855.6; xent: 9.9; lr: 1.00000; sents:    2367; bsz:  586/ 507/47; 5074/4393 tok/s;    315 sec;
[2024-03-13 11:37:19,997 INFO] Step 13500/13600; acc: 10.0; ppl: 95107.4; xent: 11.5; lr: 1.00000; sents:    2369; bsz:  563/ 492/47; 12215/10666 tok/s;    317 sec;
[2024-03-13 11:37:22,353 INFO] Step 13550/13600; acc: 8.3; ppl: 3397.7; xent: 8.1; lr: 1.00000; sents:    2270; bsz:  557/ 483/45; 11824/10255 tok/s;    319 sec;
[2024-03-13 11:37:24,753 INFO] Step 13600/13600; acc: 8.5; ppl: 11115.8; xent: 9.3; lr: 1.00000; sents:    2257; bsz:  556/ 481/45; 11589/10022 tok/s;    322 sec;
[2024-03-13 11:37:28,092 INFO] valid stats calculation
                           took: 3.3376951217651367 s.
[2024-03-13 11:37:28,092 INFO] Train perplexity: 8022.72
[2024-03-13 11:37:28,092 INFO] Train accuracy: 9.80002
[2024-03-13 11:37:28,092 INFO] Sentences processed: 233595
[2024-03-13 11:37:28,092 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:37:28,092 INFO] Validation perplexity: 160785
[2024-03-13 11:37:28,092 INFO] Validation accuracy: 14.1596
[2024-03-13 11:37:28,094 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_03_step_13600.pt
