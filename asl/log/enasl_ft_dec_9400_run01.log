[2024-03-12 14:01:51,661 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-12 14:01:51,661 INFO] Parsed 2 corpora from -data.
[2024-03-12 14:01:51,661 INFO] Loading checkpoint from tg-pt-dec/models/tg-pt-dec_01_step_9400.pt
[2024-03-12 14:01:51,730 INFO] Building model...
[2024-03-12 14:01:51,787 INFO] Switching model to float32 for amp/apex_amp
[2024-03-12 14:01:51,787 INFO] Non quantized layer compute is fp32
[2024-03-12 14:01:53,800 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-12 14:01:53,800 INFO] encoder: 8952800
[2024-03-12 14:01:53,800 INFO] decoder: 16687344
[2024-03-12 14:01:53,800 INFO] * number of parameters: 25640144
[2024-03-12 14:01:53,801 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 14:01:53,801 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 14:01:53,801 INFO]  * src vocab size = 17816
[2024-03-12 14:01:53,801 INFO]  * tgt vocab size = 14144
[2024-03-12 14:01:53,802 INFO] Starting training on GPU: [0]
[2024-03-12 14:01:53,802 INFO] Start training loop and validate every 200 steps...
[2024-03-12 14:01:53,802 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-12 14:02:00,996 INFO] Step 9450/14400; acc: 9.5; ppl: 2593360.8; xent: 14.8; lr: 1.00000; sents:    2366; bsz:  591/ 513/47; 4105/3565 tok/s;      7 sec;
[2024-03-12 14:02:04,410 INFO] Step 9500/14400; acc: 10.7; ppl: 57986.7; xent: 11.0; lr: 1.00000; sents:    2273; bsz:  543/ 473/45; 7954/6923 tok/s;     11 sec;
[2024-03-12 14:02:07,815 INFO] Step 9550/14400; acc: 7.6; ppl: 154830.9; xent: 12.0; lr: 1.00000; sents:    2363; bsz:  585/ 508/47; 8593/7459 tok/s;     14 sec;
[2024-03-12 14:02:11,294 INFO] Step 9600/14400; acc: 7.6; ppl: 35240.4; xent: 10.5; lr: 1.00000; sents:    2244; bsz:  546/ 472/45; 7849/6791 tok/s;     17 sec;
[2024-03-12 14:02:14,905 INFO] valid stats calculation
                           took: 3.6108944416046143 s.
[2024-03-12 14:02:14,906 INFO] Train perplexity: 178728
[2024-03-12 14:02:14,906 INFO] Train accuracy: 8.81892
[2024-03-12 14:02:14,906 INFO] Sentences processed: 9246
[2024-03-12 14:02:14,906 INFO] Average bsz:  566/ 492/46
[2024-03-12 14:02:14,906 INFO] Validation perplexity: 277208
[2024-03-12 14:02:14,906 INFO] Validation accuracy: 1.80505
[2024-03-12 14:02:14,907 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_9600.pt
[2024-03-12 14:02:18,520 INFO] Step 9650/14400; acc: 8.8; ppl: 77850.8; xent: 11.3; lr: 1.00000; sents:    2367; bsz:  587/ 510/47; 4059/3527 tok/s;     25 sec;
[2024-03-12 14:02:21,975 INFO] Step 9700/14400; acc: 8.2; ppl: 32701.9; xent: 10.4; lr: 1.00000; sents:    2372; bsz:  566/ 491/47; 8190/7104 tok/s;     28 sec;
[2024-03-12 14:02:25,389 INFO] Step 9750/14400; acc: 8.9; ppl: 43334.6; xent: 10.7; lr: 1.00000; sents:    2378; bsz:  568/ 494/48; 8315/7242 tok/s;     32 sec;
[2024-03-12 14:02:28,939 INFO] Step 9800/14400; acc: 8.4; ppl: 37025.5; xent: 10.5; lr: 1.00000; sents:    2280; bsz:  581/ 502/46; 8177/7075 tok/s;     35 sec;
[2024-03-12 14:02:32,500 INFO] valid stats calculation
                           took: 3.5610790252685547 s.
[2024-03-12 14:02:32,501 INFO] Train perplexity: 89331.2
[2024-03-12 14:02:32,501 INFO] Train accuracy: 8.71665
[2024-03-12 14:02:32,501 INFO] Sentences processed: 18643
[2024-03-12 14:02:32,501 INFO] Average bsz:  571/ 495/47
[2024-03-12 14:02:32,501 INFO] Validation perplexity: 4126.68
[2024-03-12 14:02:32,501 INFO] Validation accuracy: 11.3117
[2024-03-12 14:02:32,502 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_9800.pt
[2024-03-12 14:02:36,054 INFO] Step 9850/14400; acc: 9.6; ppl: 75571.0; xent: 11.2; lr: 1.00000; sents:    2381; bsz:  568/ 495/48; 3992/3476 tok/s;     42 sec;
[2024-03-12 14:02:39,438 INFO] Step 9900/14400; acc: 9.5; ppl: 51290.9; xent: 10.8; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 8322/7226 tok/s;     46 sec;
[2024-03-12 14:02:42,873 INFO] Step 9950/14400; acc: 6.7; ppl: 227639.2; xent: 12.3; lr: 1.00000; sents:    2372; bsz:  580/ 502/47; 8439/7313 tok/s;     49 sec;
[2024-03-12 14:02:46,295 INFO] Step 10000/14400; acc: 8.3; ppl: 57884.9; xent: 11.0; lr: 1.00000; sents:    2252; bsz:  551/ 477/45; 8053/6964 tok/s;     52 sec;
[2024-03-12 14:02:49,885 INFO] valid stats calculation
                           took: 3.589282989501953 s.
[2024-03-12 14:02:49,885 INFO] Train perplexity: 87968.8
[2024-03-12 14:02:49,885 INFO] Train accuracy: 8.64752
[2024-03-12 14:02:49,885 INFO] Sentences processed: 28023
[2024-03-12 14:02:49,885 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:02:49,885 INFO] Validation perplexity: 11282.9
[2024-03-12 14:02:49,885 INFO] Validation accuracy: 13.919
[2024-03-12 14:02:49,887 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_10000.pt
[2024-03-12 14:02:53,183 INFO] Step 10050/14400; acc: 9.0; ppl: 25483.0; xent: 10.1; lr: 1.00000; sents:    2271; bsz:  567/ 491/45; 4115/3561 tok/s;     59 sec;
[2024-03-12 14:02:56,667 INFO] Step 10100/14400; acc: 6.7; ppl: 45009.9; xent: 10.7; lr: 1.00000; sents:    2364; bsz:  587/ 513/47; 8428/7364 tok/s;     63 sec;
[2024-03-12 14:03:00,198 INFO] Step 10150/14400; acc: 8.2; ppl: 23175.9; xent: 10.1; lr: 1.00000; sents:    2367; bsz:  567/ 499/47; 8032/7060 tok/s;     66 sec;
[2024-03-12 14:03:03,600 INFO] Step 10200/14400; acc: 8.3; ppl: 34781.1; xent: 10.5; lr: 1.00000; sents:    2365; bsz:  561/ 487/47; 8241/7152 tok/s;     70 sec;
[2024-03-12 14:03:07,247 INFO] valid stats calculation
                           took: 3.6465349197387695 s.
[2024-03-12 14:03:07,248 INFO] Train perplexity: 67739.8
[2024-03-12 14:03:07,248 INFO] Train accuracy: 8.49382
[2024-03-12 14:03:07,248 INFO] Sentences processed: 37390
[2024-03-12 14:03:07,248 INFO] Average bsz:  569/ 495/47
[2024-03-12 14:03:07,248 INFO] Validation perplexity: 34478.3
[2024-03-12 14:03:07,248 INFO] Validation accuracy: 3.04854
[2024-03-12 14:03:07,249 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_10200.pt
[2024-03-12 14:03:10,420 INFO] Step 10250/14400; acc: 8.0; ppl: 18118.0; xent: 9.8; lr: 1.00000; sents:    2269; bsz:  569/ 491/45; 4170/3603 tok/s;     77 sec;
[2024-03-12 14:03:13,967 INFO] Step 10300/14400; acc: 9.5; ppl: 11434.3; xent: 9.3; lr: 1.00000; sents:    2371; bsz:  563/ 491/47; 7944/6918 tok/s;     80 sec;
[2024-03-12 14:03:17,570 INFO] Step 10350/14400; acc: 9.7; ppl: 9001.8; xent: 9.1; lr: 1.00000; sents:    2376; bsz:  581/ 506/48; 8065/7018 tok/s;     84 sec;
[2024-03-12 14:03:20,959 INFO] Step 10400/14400; acc: 10.0; ppl: 6067.4; xent: 8.7; lr: 1.00000; sents:    2284; bsz:  547/ 475/46; 8073/7016 tok/s;     87 sec;
[2024-03-12 14:03:24,396 INFO] valid stats calculation
                           took: 3.4368247985839844 s.
[2024-03-12 14:03:24,397 INFO] Train perplexity: 46629.2
[2024-03-12 14:03:24,397 INFO] Train accuracy: 8.65357
[2024-03-12 14:03:24,397 INFO] Sentences processed: 46690
[2024-03-12 14:03:24,397 INFO] Average bsz:  568/ 494/47
[2024-03-12 14:03:24,397 INFO] Validation perplexity: 8247.18
[2024-03-12 14:03:24,397 INFO] Validation accuracy: 5.77617
[2024-03-12 14:03:24,399 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_10400.pt
[2024-03-12 14:03:27,472 INFO] Step 10450/14400; acc: 10.3; ppl: 7611.5; xent: 8.9; lr: 1.00000; sents:    2376; bsz:  581/ 505/48; 4459/3874 tok/s;     94 sec;
[2024-03-12 14:03:30,999 INFO] Step 10500/14400; acc: 9.2; ppl: 35150.3; xent: 10.5; lr: 1.00000; sents:    2275; bsz:  561/ 484/46; 7957/6865 tok/s;     97 sec;
[2024-03-12 14:03:34,510 INFO] Step 10550/14400; acc: 9.6; ppl: 14656.2; xent: 9.6; lr: 1.00000; sents:    2371; bsz:  578/ 498/47; 8234/7091 tok/s;    101 sec;
[2024-03-12 14:03:37,995 INFO] Step 10600/14400; acc: 8.2; ppl: 19220.5; xent: 9.9; lr: 1.00000; sents:    2366; bsz:  563/ 491/47; 8083/7042 tok/s;    104 sec;
[2024-03-12 14:03:41,511 INFO] valid stats calculation
                           took: 3.515281915664673 s.
[2024-03-12 14:03:41,511 INFO] Train perplexity: 39183.7
[2024-03-12 14:03:41,511 INFO] Train accuracy: 8.76931
[2024-03-12 14:03:41,511 INFO] Sentences processed: 56078
[2024-03-12 14:03:41,511 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:03:41,511 INFO] Validation perplexity: 10620.9
[2024-03-12 14:03:41,511 INFO] Validation accuracy: 5.2146
[2024-03-12 14:03:41,513 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_10600.pt
[2024-03-12 14:03:44,274 INFO] Step 10650/14400; acc: 9.2; ppl: 5909.8; xent: 8.7; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 4493/3906 tok/s;    110 sec;
[2024-03-12 14:03:47,770 INFO] Step 10700/14400; acc: 9.6; ppl: 8343.5; xent: 9.0; lr: 1.00000; sents:    2364; bsz:  584/ 506/47; 8352/7232 tok/s;    114 sec;
[2024-03-12 14:03:51,294 INFO] Step 10750/14400; acc: 7.9; ppl: 32253.4; xent: 10.4; lr: 1.00000; sents:    2269; bsz:  564/ 488/45; 8003/6925 tok/s;    117 sec;
[2024-03-12 14:03:54,814 INFO] Step 10800/14400; acc: 8.3; ppl: 3709.8; xent: 8.2; lr: 1.00000; sents:    2267; bsz:  561/ 483/45; 7970/6864 tok/s;    121 sec;
[2024-03-12 14:03:58,306 INFO] valid stats calculation
                           took: 3.4917054176330566 s.
[2024-03-12 14:03:58,306 INFO] Train perplexity: 31667.2
[2024-03-12 14:03:58,306 INFO] Train accuracy: 8.76842
[2024-03-12 14:03:58,306 INFO] Sentences processed: 65344
[2024-03-12 14:03:58,306 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:03:58,306 INFO] Validation perplexity: 31284.8
[2024-03-12 14:03:58,306 INFO] Validation accuracy: 5.77617
[2024-03-12 14:03:58,308 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_10800.pt
[2024-03-12 14:04:00,961 INFO] Step 10850/14400; acc: 9.1; ppl: 4553.0; xent: 8.4; lr: 1.00000; sents:    2472; bsz:  583/ 506/49; 4739/4115 tok/s;    127 sec;
[2024-03-12 14:04:04,568 INFO] Step 10900/14400; acc: 10.3; ppl: 5196.4; xent: 8.6; lr: 1.00000; sents:    2271; bsz:  562/ 485/45; 7789/6722 tok/s;    131 sec;
[2024-03-12 14:04:08,164 INFO] Step 10950/14400; acc: 8.3; ppl: 90928.7; xent: 11.4; lr: 1.00000; sents:    2375; bsz:  583/ 505/48; 8107/7017 tok/s;    134 sec;
[2024-03-12 14:04:11,669 INFO] Step 11000/14400; acc: 10.3; ppl: 6135.4; xent: 8.7; lr: 1.00000; sents:    2280; bsz:  543/ 474/46; 7746/6769 tok/s;    138 sec;
[2024-03-12 14:04:15,113 INFO] valid stats calculation
                           took: 3.443183660507202 s.
[2024-03-12 14:04:15,113 INFO] Train perplexity: 27717
[2024-03-12 14:04:15,113 INFO] Train accuracy: 8.85916
[2024-03-12 14:04:15,113 INFO] Sentences processed: 74742
[2024-03-12 14:04:15,113 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:04:15,113 INFO] Validation perplexity: 10039.6
[2024-03-12 14:04:15,113 INFO] Validation accuracy: 9.1055
[2024-03-12 14:04:15,114 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_11000.pt
[2024-03-12 14:04:17,713 INFO] Step 11050/14400; acc: 10.7; ppl: 7823.4; xent: 9.0; lr: 1.00000; sents:    2376; bsz:  580/ 501/48; 4796/4144 tok/s;    144 sec;
[2024-03-12 14:04:21,281 INFO] Step 11100/14400; acc: 11.3; ppl: 3857.9; xent: 8.3; lr: 1.00000; sents:    2280; bsz:  563/ 487/46; 7892/6823 tok/s;    147 sec;
[2024-03-12 14:04:24,854 INFO] Step 11150/14400; acc: 11.0; ppl: 2926.9; xent: 8.0; lr: 1.00000; sents:    2368; bsz:  589/ 512/47; 8241/7166 tok/s;    151 sec;
[2024-03-12 14:04:28,313 INFO] Step 11200/14400; acc: 9.4; ppl: 20817.9; xent: 9.9; lr: 1.00000; sents:    2366; bsz:  569/ 497/47; 8220/7179 tok/s;    155 sec;
[2024-03-12 14:04:31,704 INFO] valid stats calculation
                           took: 3.390342950820923 s.
[2024-03-12 14:04:31,705 INFO] Train perplexity: 23565.1
[2024-03-12 14:04:31,705 INFO] Train accuracy: 9.05572
[2024-03-12 14:04:31,705 INFO] Sentences processed: 84132
[2024-03-12 14:04:31,705 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:04:31,705 INFO] Validation perplexity: 2006.85
[2024-03-12 14:04:31,705 INFO] Validation accuracy: 9.74729
[2024-03-12 14:04:31,707 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_11200.pt
[2024-03-12 14:04:34,273 INFO] Step 11250/14400; acc: 10.5; ppl: 2371.3; xent: 7.8; lr: 1.00000; sents:    2369; bsz:  587/ 508/47; 4924/4260 tok/s;    160 sec;
[2024-03-12 14:04:37,423 INFO] Step 11300/14400; acc: 11.1; ppl: 3155.5; xent: 8.1; lr: 1.00000; sents:    2242; bsz:  527/ 458/45; 8362/7268 tok/s;    164 sec;
[2024-03-12 14:04:41,022 INFO] Step 11350/14400; acc: 9.4; ppl: 6263.2; xent: 8.7; lr: 1.00000; sents:    2365; bsz:  585/ 508/47; 8130/7054 tok/s;    167 sec;
[2024-03-12 14:04:44,618 INFO] Step 11400/14400; acc: 9.7; ppl: 6836.7; xent: 8.8; lr: 1.00000; sents:    2367; bsz:  579/ 502/47; 8055/6978 tok/s;    171 sec;
[2024-03-12 14:04:48,098 INFO] valid stats calculation
                           took: 3.480290412902832 s.
[2024-03-12 14:04:48,099 INFO] Train perplexity: 19860.8
[2024-03-12 14:04:48,099 INFO] Train accuracy: 9.16677
[2024-03-12 14:04:48,099 INFO] Sentences processed: 93475
[2024-03-12 14:04:48,099 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:04:48,099 INFO] Validation perplexity: 14397.5
[2024-03-12 14:04:48,099 INFO] Validation accuracy: 5.37505
[2024-03-12 14:04:48,100 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_11400.pt
[2024-03-12 14:04:50,693 INFO] Step 11450/14400; acc: 9.4; ppl: 5776.7; xent: 8.7; lr: 1.00000; sents:    2268; bsz:  539/ 468/45; 4438/3852 tok/s;    177 sec;
[2024-03-12 14:04:53,905 INFO] Step 11500/14400; acc: 7.7; ppl: 7773.3; xent: 9.0; lr: 1.00000; sents:    2379; bsz:  587/ 510/48; 9135/7944 tok/s;    180 sec;
[2024-03-12 14:04:57,441 INFO] Step 11550/14400; acc: 10.5; ppl: 4746.4; xent: 8.5; lr: 1.00000; sents:    2274; bsz:  558/ 483/45; 7886/6834 tok/s;    184 sec;
[2024-03-12 14:05:00,963 INFO] Step 11600/14400; acc: 9.9; ppl: 5917.8; xent: 8.7; lr: 1.00000; sents:    2376; bsz:  580/ 503/48; 8234/7139 tok/s;    187 sec;
[2024-03-12 14:05:04,456 INFO] valid stats calculation
                           took: 3.4920098781585693 s.
[2024-03-12 14:05:04,456 INFO] Train perplexity: 17819
[2024-03-12 14:05:04,456 INFO] Train accuracy: 9.18102
[2024-03-12 14:05:04,456 INFO] Sentences processed: 102772
[2024-03-12 14:05:04,456 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:05:04,456 INFO] Validation perplexity: 17860.8
[2024-03-12 14:05:04,456 INFO] Validation accuracy: 12.9964
[2024-03-12 14:05:04,457 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_11600.pt
[2024-03-12 14:05:07,108 INFO] Step 11650/14400; acc: 12.1; ppl: 2183.0; xent: 7.7; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 4582/3980 tok/s;    193 sec;
[2024-03-12 14:05:10,054 INFO] Step 11700/14400; acc: 12.3; ppl: 2098.9; xent: 7.6; lr: 1.00000; sents:    2372; bsz:  566/ 496/47; 9615/8424 tok/s;    196 sec;
[2024-03-12 14:05:13,694 INFO] Step 11750/14400; acc: 10.8; ppl: 4926.7; xent: 8.5; lr: 1.00000; sents:    2366; bsz:  587/ 514/47; 8060/7060 tok/s;    200 sec;
[2024-03-12 14:05:17,334 INFO] Step 11800/14400; acc: 8.2; ppl: 23522.3; xent: 10.1; lr: 1.00000; sents:    2271; bsz:  568/ 493/45; 7807/6778 tok/s;    204 sec;
[2024-03-12 14:05:21,225 INFO] valid stats calculation
                           took: 3.8899455070495605 s.
[2024-03-12 14:05:21,225 INFO] Train perplexity: 15961
[2024-03-12 14:05:21,225 INFO] Train accuracy: 9.3216
[2024-03-12 14:05:21,225 INFO] Sentences processed: 112156
[2024-03-12 14:05:21,225 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:05:21,225 INFO] Validation perplexity: 3634.76
[2024-03-12 14:05:21,225 INFO] Validation accuracy: 8.62415
[2024-03-12 14:05:21,226 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_11800.pt
[2024-03-12 14:05:24,032 INFO] Step 11850/14400; acc: 8.3; ppl: 10009.2; xent: 9.2; lr: 1.00000; sents:    2364; bsz:  573/ 494/47; 4277/3687 tok/s;    210 sec;
[2024-03-12 14:05:26,832 INFO] Step 11900/14400; acc: 9.7; ppl: 6963.3; xent: 8.8; lr: 1.00000; sents:    2263; bsz:  542/ 471/45; 9677/8422 tok/s;    213 sec;
[2024-03-12 14:05:30,381 INFO] Step 11950/14400; acc: 9.3; ppl: 2505.7; xent: 7.8; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 8075/6991 tok/s;    217 sec;
[2024-03-12 14:05:34,041 INFO] Step 12000/14400; acc: 9.8; ppl: 5699.3; xent: 8.6; lr: 1.00000; sents:    2373; bsz:  582/ 507/47; 7947/6924 tok/s;    220 sec;
[2024-03-12 14:05:37,481 INFO] valid stats calculation
                           took: 3.4389472007751465 s.
[2024-03-12 14:05:37,481 INFO] Train perplexity: 14729.8
[2024-03-12 14:05:37,481 INFO] Train accuracy: 9.32026
[2024-03-12 14:05:37,481 INFO] Sentences processed: 121521
[2024-03-12 14:05:37,481 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:05:37,481 INFO] Validation perplexity: 10410.5
[2024-03-12 14:05:37,481 INFO] Validation accuracy: 12.7156
[2024-03-12 14:05:37,483 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_12000.pt
[2024-03-12 14:05:40,535 INFO] Step 12050/14400; acc: 8.7; ppl: 20682.1; xent: 9.9; lr: 1.00000; sents:    2275; bsz:  547/ 475/46; 4211/3656 tok/s;    227 sec;
[2024-03-12 14:05:43,381 INFO] Step 12100/14400; acc: 9.2; ppl: 3804.8; xent: 8.2; lr: 1.00000; sents:    2375; bsz:  580/ 505/48; 10200/8878 tok/s;    230 sec;
[2024-03-12 14:05:46,912 INFO] Step 12150/14400; acc: 10.5; ppl: 2261.2; xent: 7.7; lr: 1.00000; sents:    2281; bsz:  563/ 486/46; 7966/6882 tok/s;    233 sec;
[2024-03-12 14:05:50,467 INFO] Step 12200/14400; acc: 9.8; ppl: 6532.0; xent: 8.8; lr: 1.00000; sents:    2376; bsz:  565/ 490/48; 7947/6897 tok/s;    237 sec;
[2024-03-12 14:05:53,885 INFO] valid stats calculation
                           took: 3.417901039123535 s.
[2024-03-12 14:05:53,885 INFO] Train perplexity: 13785.3
[2024-03-12 14:05:53,885 INFO] Train accuracy: 9.33574
[2024-03-12 14:05:53,885 INFO] Sentences processed: 130828
[2024-03-12 14:05:53,885 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:05:53,885 INFO] Validation perplexity: 4571.59
[2024-03-12 14:05:53,885 INFO] Validation accuracy: 9.90774
[2024-03-12 14:05:53,887 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_12200.pt
[2024-03-12 14:05:56,978 INFO] Step 12250/14400; acc: 10.7; ppl: 3005.2; xent: 8.0; lr: 1.00000; sents:    2375; bsz:  579/ 499/48; 4446/3828 tok/s;    243 sec;
[2024-03-12 14:05:59,558 INFO] Step 12300/14400; acc: 8.6; ppl: 13968.2; xent: 9.5; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 11358/9844 tok/s;    246 sec;
[2024-03-12 14:06:03,130 INFO] Step 12350/14400; acc: 9.4; ppl: 14118.2; xent: 9.6; lr: 1.00000; sents:    2366; bsz:  564/ 489/47; 7890/6851 tok/s;    249 sec;
[2024-03-12 14:06:06,752 INFO] Step 12400/14400; acc: 11.0; ppl: 1489.8; xent: 7.3; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 7777/6742 tok/s;    253 sec;
[2024-03-12 14:06:10,224 INFO] valid stats calculation
                           took: 3.471439838409424 s.
[2024-03-12 14:06:10,225 INFO] Train perplexity: 12960.6
[2024-03-12 14:06:10,225 INFO] Train accuracy: 9.37339
[2024-03-12 14:06:10,225 INFO] Sentences processed: 140208
[2024-03-12 14:06:10,225 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:06:10,225 INFO] Validation perplexity: 27378.7
[2024-03-12 14:06:10,225 INFO] Validation accuracy: 14.1998
[2024-03-12 14:06:10,226 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_12400.pt
[2024-03-12 14:06:13,578 INFO] Step 12450/14400; acc: 9.8; ppl: 4156.2; xent: 8.3; lr: 1.00000; sents:    2362; bsz:  579/ 499/47; 4239/3655 tok/s;    260 sec;
[2024-03-12 14:06:16,021 INFO] Step 12500/14400; acc: 10.1; ppl: 1841.2; xent: 7.5; lr: 1.00000; sents:    2267; bsz:  544/ 472/45; 11133/9663 tok/s;    262 sec;
[2024-03-12 14:06:19,424 INFO] Step 12550/14400; acc: 7.1; ppl: 9882.9; xent: 9.2; lr: 1.00000; sents:    2369; bsz:  580/ 501/47; 8530/7359 tok/s;    266 sec;
[2024-03-12 14:06:23,011 INFO] Step 12600/14400; acc: 10.8; ppl: 9156.8; xent: 9.1; lr: 1.00000; sents:    2372; bsz:  583/ 504/47; 8126/7031 tok/s;    269 sec;
[2024-03-12 14:06:26,454 INFO] valid stats calculation
                           took: 3.4432404041290283 s.
[2024-03-12 14:06:26,455 INFO] Train perplexity: 12243.2
[2024-03-12 14:06:26,455 INFO] Train accuracy: 9.37624
[2024-03-12 14:06:26,455 INFO] Sentences processed: 149578
[2024-03-12 14:06:26,455 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:06:26,455 INFO] Validation perplexity: 2562.55
[2024-03-12 14:06:26,455 INFO] Validation accuracy: 15.6839
[2024-03-12 14:06:26,456 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_12600.pt
[2024-03-12 14:06:29,944 INFO] Step 12650/14400; acc: 9.4; ppl: 3126.1; xent: 8.0; lr: 1.00000; sents:    2269; bsz:  559/ 485/45; 4030/3497 tok/s;    276 sec;
[2024-03-12 14:06:32,361 INFO] Step 12700/14400; acc: 8.2; ppl: 4572.3; xent: 8.4; lr: 1.00000; sents:    2375; bsz:  565/ 492/48; 11696/10187 tok/s;    279 sec;
[2024-03-12 14:06:35,802 INFO] Step 12750/14400; acc: 8.2; ppl: 8461.3; xent: 9.0; lr: 1.00000; sents:    2382; bsz:  589/ 510/48; 8556/7417 tok/s;    282 sec;
[2024-03-12 14:06:39,358 INFO] Step 12800/14400; acc: 9.7; ppl: 3407.9; xent: 8.1; lr: 1.00000; sents:    2275; bsz:  542/ 473/46; 7624/6646 tok/s;    286 sec;
[2024-03-12 14:06:42,891 INFO] valid stats calculation
                           took: 3.531820774078369 s.
[2024-03-12 14:06:42,891 INFO] Train perplexity: 11555.6
[2024-03-12 14:06:42,891 INFO] Train accuracy: 9.34692
[2024-03-12 14:06:42,891 INFO] Sentences processed: 158879
[2024-03-12 14:06:42,891 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:06:42,891 INFO] Validation perplexity: 2123.09
[2024-03-12 14:06:42,891 INFO] Validation accuracy: 5.2146
[2024-03-12 14:06:42,893 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_12800.pt
[2024-03-12 14:06:46,563 INFO] Step 12850/14400; acc: 10.2; ppl: 7426.0; xent: 8.9; lr: 1.00000; sents:    2381; bsz:  592/ 515/48; 4111/3573 tok/s;    293 sec;
[2024-03-12 14:06:49,017 INFO] Step 12900/14400; acc: 9.9; ppl: 2333.3; xent: 7.8; lr: 1.00000; sents:    2247; bsz:  550/ 477/45; 11196/9709 tok/s;    295 sec;
[2024-03-12 14:06:52,148 INFO] Step 12950/14400; acc: 11.7; ppl: 1717.7; xent: 7.4; lr: 1.00000; sents:    2367; bsz:  565/ 490/47; 9026/7831 tok/s;    298 sec;
[2024-03-12 14:06:55,697 INFO] Step 13000/14400; acc: 10.5; ppl: 3000.3; xent: 8.0; lr: 1.00000; sents:    2368; bsz:  587/ 509/47; 8273/7165 tok/s;    302 sec;
[2024-03-12 14:06:59,102 INFO] valid stats calculation
                           took: 3.4053738117218018 s.
[2024-03-12 14:06:59,103 INFO] Train perplexity: 10737.7
[2024-03-12 14:06:59,103 INFO] Train accuracy: 9.41684
[2024-03-12 14:06:59,103 INFO] Sentences processed: 168242
[2024-03-12 14:06:59,103 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:06:59,103 INFO] Validation perplexity: 1.25422e+06
[2024-03-12 14:06:59,103 INFO] Validation accuracy: 5.25471
[2024-03-12 14:06:59,104 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_13000.pt
[2024-03-12 14:07:02,700 INFO] Step 13050/14400; acc: 11.0; ppl: 2217.3; xent: 7.7; lr: 1.00000; sents:    2363; bsz:  576/ 498/47; 4116/3554 tok/s;    309 sec;
[2024-03-12 14:07:05,337 INFO] Step 13100/14400; acc: 11.1; ppl: 7415.1; xent: 8.9; lr: 1.00000; sents:    2251; bsz:  535/ 467/45; 10153/8848 tok/s;    312 sec;
[2024-03-12 14:07:08,148 INFO] Step 13150/14400; acc: 9.6; ppl: 1815.9; xent: 7.5; lr: 1.00000; sents:    2372; bsz:  582/ 505/47; 10361/8986 tok/s;    314 sec;
[2024-03-12 14:07:11,684 INFO] Step 13200/14400; acc: 13.0; ppl: 1100.9; xent: 7.0; lr: 1.00000; sents:    2377; bsz:  569/ 497/48; 8041/7033 tok/s;    318 sec;
[2024-03-12 14:07:15,159 INFO] valid stats calculation
                           took: 3.4741780757904053 s.
[2024-03-12 14:07:15,159 INFO] Train perplexity: 9915.68
[2024-03-12 14:07:15,159 INFO] Train accuracy: 9.50879
[2024-03-12 14:07:15,159 INFO] Sentences processed: 177605
[2024-03-12 14:07:15,159 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:07:15,159 INFO] Validation perplexity: 1148.6
[2024-03-12 14:07:15,159 INFO] Validation accuracy: 16.446
[2024-03-12 14:07:15,161 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_13200.pt
[2024-03-12 14:07:18,876 INFO] Step 13250/14400; acc: 12.5; ppl: 3780.5; xent: 8.2; lr: 1.00000; sents:    2379; bsz:  583/ 509/48; 4056/3541 tok/s;    325 sec;
[2024-03-12 14:07:21,775 INFO] Step 13300/14400; acc: 10.4; ppl: 4208.0; xent: 8.3; lr: 1.00000; sents:    2274; bsz:  555/ 478/45; 9580/8253 tok/s;    328 sec;
[2024-03-12 14:07:24,454 INFO] Step 13350/14400; acc: 10.3; ppl: 11295.7; xent: 9.3; lr: 1.00000; sents:    2277; bsz:  566/ 489/46; 10557/9127 tok/s;    331 sec;
[2024-03-12 14:07:27,982 INFO] Step 13400/14400; acc: 8.4; ppl: 6850.9; xent: 8.8; lr: 1.00000; sents:    2474; bsz:  583/ 514/49; 8268/7292 tok/s;    334 sec;
[2024-03-12 14:07:31,461 INFO] valid stats calculation
                           took: 3.4786722660064697 s.
[2024-03-12 14:07:31,461 INFO] Train perplexity: 9661.15
[2024-03-12 14:07:31,461 INFO] Train accuracy: 9.55271
[2024-03-12 14:07:31,461 INFO] Sentences processed: 187009
[2024-03-12 14:07:31,462 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:07:31,462 INFO] Validation perplexity: 3294.84
[2024-03-12 14:07:31,462 INFO] Validation accuracy: 10.4292
[2024-03-12 14:07:31,463 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_13400.pt
[2024-03-12 14:07:35,258 INFO] Step 13450/14400; acc: 10.7; ppl: 2589.3; xent: 7.9; lr: 1.00000; sents:    2275; bsz:  569/ 494/46; 3914/3394 tok/s;    341 sec;
[2024-03-12 14:07:38,297 INFO] Step 13500/14400; acc: 9.6; ppl: 6878.2; xent: 8.8; lr: 1.00000; sents:    2367; bsz:  578/ 498/47; 9503/8191 tok/s;    344 sec;
[2024-03-12 14:07:40,749 INFO] Step 13550/14400; acc: 11.8; ppl: 3090.9; xent: 8.0; lr: 1.00000; sents:    2263; bsz:  542/ 474/45; 11066/9665 tok/s;    347 sec;
[2024-03-12 14:07:44,225 INFO] Step 13600/14400; acc: 10.0; ppl: 5122.7; xent: 8.5; lr: 1.00000; sents:    2364; bsz:  572/ 494/47; 8224/7102 tok/s;    350 sec;
[2024-03-12 14:07:47,643 INFO] valid stats calculation
                           took: 3.417506694793701 s.
[2024-03-12 14:07:47,643 INFO] Train perplexity: 9279.26
[2024-03-12 14:07:47,643 INFO] Train accuracy: 9.59698
[2024-03-12 14:07:47,643 INFO] Sentences processed: 196278
[2024-03-12 14:07:47,643 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:07:47,643 INFO] Validation perplexity: 2860.35
[2024-03-12 14:07:47,643 INFO] Validation accuracy: 11.3518
[2024-03-12 14:07:47,645 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_13600.pt
[2024-03-12 14:07:51,281 INFO] Step 13650/14400; acc: 8.7; ppl: 7000.5; xent: 8.9; lr: 1.00000; sents:    2268; bsz:  558/ 481/45; 3952/3411 tok/s;    357 sec;
[2024-03-12 14:07:54,757 INFO] Step 13700/14400; acc: 10.3; ppl: 2760.7; xent: 7.9; lr: 1.00000; sents:    2367; bsz:  566/ 495/47; 8148/7120 tok/s;    361 sec;
[2024-03-12 14:07:57,249 INFO] Step 13750/14400; acc: 11.4; ppl: 1608.7; xent: 7.4; lr: 1.00000; sents:    2373; bsz:  581/ 507/47; 11657/10165 tok/s;    363 sec;
[2024-03-12 14:08:00,611 INFO] Step 13800/14400; acc: 10.2; ppl: 6752.2; xent: 8.8; lr: 1.00000; sents:    2372; bsz:  565/ 491/47; 8409/7303 tok/s;    367 sec;
[2024-03-12 14:08:04,029 INFO] valid stats calculation
                           took: 3.417142391204834 s.
[2024-03-12 14:08:04,029 INFO] Train perplexity: 8906.88
[2024-03-12 14:08:04,029 INFO] Train accuracy: 9.62383
[2024-03-12 14:08:04,029 INFO] Sentences processed: 205658
[2024-03-12 14:08:04,029 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:08:04,029 INFO] Validation perplexity: 78919.9
[2024-03-12 14:08:04,029 INFO] Validation accuracy: 4.21179
[2024-03-12 14:08:04,031 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_13800.pt
[2024-03-12 14:08:07,820 INFO] Step 13850/14400; acc: 8.9; ppl: 7347.0; xent: 8.9; lr: 1.00000; sents:    2274; bsz:  562/ 486/45; 3901/3373 tok/s;    374 sec;
[2024-03-12 14:08:11,284 INFO] Step 13900/14400; acc: 9.8; ppl: 12989.1; xent: 9.5; lr: 1.00000; sents:    2382; bsz:  577/ 497/48; 8324/7180 tok/s;    377 sec;
[2024-03-12 14:08:13,787 INFO] Step 13950/14400; acc: 11.6; ppl: 2333.4; xent: 7.8; lr: 1.00000; sents:    2376; bsz:  589/ 509/48; 11759/10170 tok/s;    380 sec;
[2024-03-12 14:08:17,093 INFO] Step 14000/14400; acc: 7.7; ppl: 49417.1; xent: 10.8; lr: 1.00000; sents:    2277; bsz:  564/ 488/46; 8533/7385 tok/s;    383 sec;
[2024-03-12 14:08:20,625 INFO] valid stats calculation
                           took: 3.531116008758545 s.
[2024-03-12 14:08:20,625 INFO] Train perplexity: 8955.77
[2024-03-12 14:08:20,625 INFO] Train accuracy: 9.62012
[2024-03-12 14:08:20,625 INFO] Sentences processed: 214967
[2024-03-12 14:08:20,625 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:08:20,625 INFO] Validation perplexity: 3245.19
[2024-03-12 14:08:20,625 INFO] Validation accuracy: 10.0281
[2024-03-12 14:08:20,626 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_14000.pt
[2024-03-12 14:08:24,361 INFO] Step 14050/14400; acc: 10.9; ppl: 2153.8; xent: 7.7; lr: 1.00000; sents:    2371; bsz:  565/ 491/47; 3888/3378 tok/s;    391 sec;
[2024-03-12 14:08:27,943 INFO] Step 14100/14400; acc: 9.5; ppl: 3431.8; xent: 8.1; lr: 1.00000; sents:    2366; bsz:  579/ 500/47; 8084/6975 tok/s;    394 sec;
[2024-03-12 14:08:30,339 INFO] Step 14150/14400; acc: 11.2; ppl: 3214.3; xent: 8.1; lr: 1.00000; sents:    2366; bsz:  563/ 489/47; 11754/10209 tok/s;    397 sec;
[2024-03-12 14:08:33,346 INFO] Step 14200/14400; acc: 10.3; ppl: 1693.2; xent: 7.4; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 9310/8029 tok/s;    400 sec;
[2024-03-12 14:08:36,811 INFO] valid stats calculation
                           took: 3.464031457901001 s.
[2024-03-12 14:08:36,811 INFO] Train perplexity: 8498.35
[2024-03-12 14:08:36,811 INFO] Train accuracy: 9.65556
[2024-03-12 14:08:36,811 INFO] Sentences processed: 224332
[2024-03-12 14:08:36,811 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:08:36,811 INFO] Validation perplexity: 41474.7
[2024-03-12 14:08:36,811 INFO] Validation accuracy: 11.793
[2024-03-12 14:08:36,813 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_14200.pt
[2024-03-12 14:08:40,428 INFO] Step 14250/14400; acc: 10.6; ppl: 3129.7; xent: 8.0; lr: 1.00000; sents:    2367; bsz:  566/ 494/47; 3996/3490 tok/s;    407 sec;
[2024-03-12 14:08:43,969 INFO] Step 14300/14400; acc: 10.3; ppl: 2686.9; xent: 7.9; lr: 1.00000; sents:    2267; bsz:  558/ 484/45; 7885/6839 tok/s;    410 sec;
[2024-03-12 14:08:46,811 INFO] Step 14350/14400; acc: 11.1; ppl: 3324.6; xent: 8.1; lr: 1.00000; sents:    2372; bsz:  582/ 503/47; 10235/8857 tok/s;    413 sec;
[2024-03-12 14:08:49,332 INFO] Step 14400/14400; acc: 10.7; ppl: 2520.8; xent: 7.8; lr: 1.00000; sents:    2371; bsz:  590/ 510/47; 11701/10125 tok/s;    416 sec;
[2024-03-12 14:08:53,007 INFO] valid stats calculation
                           took: 3.6743381023406982 s.
[2024-03-12 14:08:53,007 INFO] Train perplexity: 8137.26
[2024-03-12 14:08:53,007 INFO] Train accuracy: 9.69587
[2024-03-12 14:08:53,007 INFO] Sentences processed: 233709
[2024-03-12 14:08:53,007 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:08:53,008 INFO] Validation perplexity: 1624.46
[2024-03-12 14:08:53,008 INFO] Validation accuracy: 13.2772
[2024-03-12 14:08:53,009 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_01_step_14400.pt
