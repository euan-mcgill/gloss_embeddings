[2024-03-13 07:22:28,707 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-13 07:22:28,707 INFO] Parsed 2 corpora from -data.
[2024-03-13 07:22:28,707 INFO] Get special vocabs from Transforms: {'src': [], 'tgt': []}.
[2024-03-13 07:22:28,741 INFO] Reading encoder embeddings from en_w2v.txt
[2024-03-13 07:23:04,178 INFO] 	Found 3000000 total vectors in file.
[2024-03-13 07:23:04,178 INFO] Reading decoder embeddings from asl_w2v.txt
[2024-03-13 07:23:39,205 INFO] 	Found 3002605 total vectors in file
[2024-03-13 07:23:39,205 INFO] After filtering to vectors in vocab:
[2024-03-13 07:23:39,210 INFO] 	* enc: 14009 match, 3807 missing, (78.63%)
[2024-03-13 07:23:39,213 INFO] 	* dec: 10421 match, 3723 missing, (73.68%)
[2024-03-13 07:23:39,213 INFO] 
Saving encoder embeddings as:
	* enc: tg-pt-both.enc_embeddings.pt
[2024-03-13 07:24:06,128 INFO] 
Saving decoder embeddings as:
	* dec: tg-pt-both.dec_embeddings.pt
[2024-03-13 07:24:23,485 INFO] The first 10 tokens of the vocabs are:['<unk>', '<blank>', '<s>', '</s>', '.', 'the', ',', 'of', 'to', 'is']
[2024-03-13 07:24:23,486 INFO] The decoder start token is: <s>
[2024-03-13 07:24:23,486 INFO] Building model...
[2024-03-13 07:24:23,681 INFO] Switching model to float32 for amp/apex_amp
[2024-03-13 07:24:23,681 INFO] Non quantized layer compute is fp32
[2024-03-13 07:24:25,437 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-13 07:24:25,437 INFO] encoder: 8952800
[2024-03-13 07:24:25,437 INFO] decoder: 16687344
[2024-03-13 07:24:25,437 INFO] * number of parameters: 25640144
[2024-03-13 07:24:25,437 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 07:24:25,437 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 07:24:25,438 INFO]  * src vocab size = 17816
[2024-03-13 07:24:25,438 INFO]  * tgt vocab size = 14144
[2024-03-13 07:24:25,438 INFO] Starting training on GPU: [0]
[2024-03-13 07:24:25,438 INFO] Start training loop and validate every 200 steps...
[2024-03-13 07:24:25,439 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-13 07:24:42,132 INFO] Step 50/10000; acc: 5.5; ppl: 60745.5; xent: 11.0; lr: 1.00000; sents:    3200; bsz:  804/ 724/64; 2408/2170 tok/s;     17 sec;
[2024-03-13 07:24:43,256 INFO] Step 100/10000; acc: 6.0; ppl: 9070.8; xent: 9.1; lr: 1.00000; sents:    3200; bsz:  865/ 753/64; 38495/33503 tok/s;     18 sec;
[2024-03-13 07:24:44,472 INFO] Step 150/10000; acc: 6.5; ppl: 1481.3; xent: 7.3; lr: 1.00000; sents:    3200; bsz:  937/ 826/64; 38532/33971 tok/s;     19 sec;
[2024-03-13 07:24:45,652 INFO] Step 200/10000; acc: 7.5; ppl: 1208.0; xent: 7.1; lr: 1.00000; sents:    3200; bsz:  887/ 795/64; 37609/33698 tok/s;     20 sec;
[2024-03-13 07:24:49,206 INFO] valid stats calculation
                           took: 3.553962230682373 s.
[2024-03-13 07:24:49,207 INFO] Train perplexity: 5203.61
[2024-03-13 07:24:49,207 INFO] Train accuracy: 6.38748
[2024-03-13 07:24:49,207 INFO] Sentences processed: 12800
[2024-03-13 07:24:49,207 INFO] Average bsz:  873/ 775/64
[2024-03-13 07:24:49,207 INFO] Validation perplexity: 8024.39
[2024-03-13 07:24:49,207 INFO] Validation accuracy: 4.49258
[2024-03-13 07:24:49,208 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_200.pt
[2024-03-13 07:24:50,419 INFO] Step 250/10000; acc: 9.1; ppl: 839.0; xent: 6.7; lr: 1.00000; sents:    3200; bsz:  785/ 706/64; 8233/7410 tok/s;     25 sec;
[2024-03-13 07:24:51,706 INFO] Step 300/10000; acc: 9.2; ppl: 733.2; xent: 6.6; lr: 1.00000; sents:    3200; bsz:  900/ 769/64; 34957/29885 tok/s;     26 sec;
[2024-03-13 07:24:53,696 INFO] Step 350/10000; acc: 10.8; ppl: 625.5; xent: 6.4; lr: 1.00000; sents:    3200; bsz:  899/ 793/64; 22578/19932 tok/s;     28 sec;
[2024-03-13 07:24:55,570 INFO] Step 400/10000; acc: 12.8; ppl: 509.5; xent: 6.2; lr: 1.00000; sents:    3200; bsz:  783/ 711/64; 20909/18974 tok/s;     30 sec;
[2024-03-13 07:24:58,993 INFO] valid stats calculation
                           took: 3.4232823848724365 s.
[2024-03-13 07:24:58,994 INFO] Train perplexity: 1898.44
[2024-03-13 07:24:58,994 INFO] Train accuracy: 8.3839
[2024-03-13 07:24:58,994 INFO] Sentences processed: 25600
[2024-03-13 07:24:58,994 INFO] Average bsz:  857/ 760/64
[2024-03-13 07:24:58,994 INFO] Validation perplexity: 13045.7
[2024-03-13 07:24:58,994 INFO] Validation accuracy: 9.50662
[2024-03-13 07:24:58,995 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_400.pt
[2024-03-13 07:25:00,288 INFO] Step 450/10000; acc: 14.3; ppl: 477.6; xent: 6.2; lr: 1.00000; sents:    3200; bsz:  863/ 756/64; 9143/8013 tok/s;     35 sec;
[2024-03-13 07:25:01,469 INFO] Step 500/10000; acc: 15.5; ppl: 439.6; xent: 6.1; lr: 1.00000; sents:    3200; bsz:  910/ 773/64; 38520/32736 tok/s;     36 sec;
[2024-03-13 07:25:02,996 INFO] Step 550/10000; acc: 19.9; ppl: 286.5; xent: 5.7; lr: 1.00000; sents:    3200; bsz:  803/ 722/64; 26301/23640 tok/s;     38 sec;
[2024-03-13 07:25:05,031 INFO] Step 600/10000; acc: 20.8; ppl: 260.4; xent: 5.6; lr: 1.00000; sents:    3200; bsz:  911/ 801/64; 22393/19678 tok/s;     40 sec;
[2024-03-13 07:25:08,458 INFO] valid stats calculation
                           took: 3.4272186756134033 s.
[2024-03-13 07:25:08,459 INFO] Train perplexity: 1082.35
[2024-03-13 07:25:08,459 INFO] Train accuracy: 11.4698
[2024-03-13 07:25:08,459 INFO] Sentences processed: 38400
[2024-03-13 07:25:08,459 INFO] Average bsz:  862/ 761/64
[2024-03-13 07:25:08,459 INFO] Validation perplexity: 15831.2
[2024-03-13 07:25:08,459 INFO] Validation accuracy: 10.9105
[2024-03-13 07:25:08,460 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_600.pt
[2024-03-13 07:25:09,669 INFO] Step 650/10000; acc: 25.4; ppl: 209.0; xent: 5.3; lr: 1.00000; sents:    3200; bsz:  828/ 714/64; 8928/7695 tok/s;     44 sec;
[2024-03-13 07:25:10,897 INFO] Step 700/10000; acc: 29.1; ppl: 157.5; xent: 5.1; lr: 1.00000; sents:    3200; bsz:  942/ 818/64; 38386/33348 tok/s;     45 sec;
[2024-03-13 07:25:11,993 INFO] Step 750/10000; acc: 39.2; ppl:  84.1; xent: 4.4; lr: 1.00000; sents:    3200; bsz:  793/ 686/64; 36172/31307 tok/s;     47 sec;
[2024-03-13 07:25:13,867 INFO] Step 800/10000; acc: 43.9; ppl:  58.3; xent: 4.1; lr: 1.00000; sents:    3200; bsz:  900/ 759/64; 24021/20252 tok/s;     48 sec;
[2024-03-13 07:25:17,348 INFO] valid stats calculation
                           took: 3.48012638092041 s.
[2024-03-13 07:25:17,348 INFO] Train perplexity: 621.231
[2024-03-13 07:25:17,348 INFO] Train accuracy: 17.0907
[2024-03-13 07:25:17,348 INFO] Sentences processed: 51200
[2024-03-13 07:25:17,348 INFO] Average bsz:  863/ 757/64
[2024-03-13 07:25:17,348 INFO] Validation perplexity: 109445
[2024-03-13 07:25:17,348 INFO] Validation accuracy: 8.06258
[2024-03-13 07:25:17,350 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_800.pt
[2024-03-13 07:25:19,207 INFO] Step 850/10000; acc: 56.1; ppl:  23.1; xent: 3.1; lr: 1.00000; sents:    3200; bsz:  881/ 761/64; 8247/7125 tok/s;     54 sec;
[2024-03-13 07:25:20,332 INFO] Step 900/10000; acc: 63.7; ppl:  12.8; xent: 2.6; lr: 1.00000; sents:    3200; bsz:  840/ 728/64; 37342/32381 tok/s;     55 sec;
[2024-03-13 07:25:21,590 INFO] Step 950/10000; acc: 67.5; ppl:   9.8; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  938/ 837/64; 37290/33252 tok/s;     56 sec;
[2024-03-13 07:25:23,082 INFO] Step 1000/10000; acc: 70.8; ppl:   7.5; xent: 2.0; lr: 1.00000; sents:    3200; bsz:  876/ 771/64; 29337/25837 tok/s;     58 sec;
[2024-03-13 07:25:26,508 INFO] valid stats calculation
                           took: 3.4252374172210693 s.
[2024-03-13 07:25:26,508 INFO] Train perplexity: 278.379
[2024-03-13 07:25:26,508 INFO] Train accuracy: 26.7675
[2024-03-13 07:25:26,508 INFO] Sentences processed: 64000
[2024-03-13 07:25:26,508 INFO] Average bsz:  867/ 760/64
[2024-03-13 07:25:26,508 INFO] Validation perplexity: 1.29598e+06
[2024-03-13 07:25:26,508 INFO] Validation accuracy: 8.18291
[2024-03-13 07:25:26,510 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_1000.pt
[2024-03-13 07:25:28,516 INFO] Step 1050/10000; acc: 72.7; ppl:   6.6; xent: 1.9; lr: 1.00000; sents:    3200; bsz:  841/ 727/64; 7738/6690 tok/s;     63 sec;
[2024-03-13 07:25:29,981 INFO] Step 1100/10000; acc: 72.2; ppl:   7.2; xent: 2.0; lr: 1.00000; sents:    3200; bsz:  864/ 772/64; 29490/26366 tok/s;     65 sec;
[2024-03-13 07:25:31,068 INFO] Step 1150/10000; acc: 76.5; ppl:   5.2; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  837/ 730/64; 38535/33593 tok/s;     66 sec;
[2024-03-13 07:25:32,223 INFO] Step 1200/10000; acc: 77.9; ppl:   4.6; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  901/ 760/64; 39004/32909 tok/s;     67 sec;
[2024-03-13 07:25:35,729 INFO] valid stats calculation
                           took: 3.505646228790283 s.
[2024-03-13 07:25:35,729 INFO] Train perplexity: 147.514
[2024-03-13 07:25:35,730 INFO] Train accuracy: 34.6615
[2024-03-13 07:25:35,730 INFO] Sentences processed: 76800
[2024-03-13 07:25:35,730 INFO] Average bsz:  866/ 758/64
[2024-03-13 07:25:35,730 INFO] Validation perplexity: 2.19326e+06
[2024-03-13 07:25:35,730 INFO] Validation accuracy: 7.74168
[2024-03-13 07:25:35,731 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_1200.pt
[2024-03-13 07:25:37,947 INFO] Step 1250/10000; acc: 78.6; ppl:   4.4; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  952/ 824/64; 8321/7202 tok/s;     73 sec;
[2024-03-13 07:25:39,718 INFO] Step 1300/10000; acc: 78.7; ppl:   4.7; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  913/ 792/64; 25783/22358 tok/s;     74 sec;
[2024-03-13 07:25:40,829 INFO] Step 1350/10000; acc: 80.0; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  799/ 693/64; 35969/31192 tok/s;     75 sec;
[2024-03-13 07:25:42,021 INFO] Step 1400/10000; acc: 82.0; ppl:   3.5; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  906/ 800/64; 37996/33542 tok/s;     77 sec;
[2024-03-13 07:25:45,541 INFO] valid stats calculation
                           took: 3.519183397293091 s.
[2024-03-13 07:25:45,541 INFO] Train perplexity: 87.5575
[2024-03-13 07:25:45,541 INFO] Train accuracy: 41.2537
[2024-03-13 07:25:45,541 INFO] Sentences processed: 89600
[2024-03-13 07:25:45,541 INFO] Average bsz:  870/ 761/64
[2024-03-13 07:25:45,542 INFO] Validation perplexity: 3.70172e+06
[2024-03-13 07:25:45,542 INFO] Validation accuracy: 8.58404
[2024-03-13 07:25:45,543 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_1400.pt
[2024-03-13 07:25:47,519 INFO] Step 1450/10000; acc: 81.3; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  794/ 718/64; 7218/6527 tok/s;     82 sec;
[2024-03-13 07:25:49,413 INFO] Step 1500/10000; acc: 82.7; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  854/ 724/64; 22549/19121 tok/s;     84 sec;
[2024-03-13 07:25:50,596 INFO] Step 1550/10000; acc: 83.9; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  787/ 694/64; 33270/29322 tok/s;     85 sec;
[2024-03-13 07:25:51,701 INFO] Step 1600/10000; acc: 83.4; ppl:   3.2; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  861/ 719/64; 38967/32534 tok/s;     86 sec;
[2024-03-13 07:25:55,260 INFO] valid stats calculation
                           took: 3.558090925216675 s.
[2024-03-13 07:25:55,260 INFO] Train perplexity: 59.418
[2024-03-13 07:25:55,260 INFO] Train accuracy: 46.1664
[2024-03-13 07:25:55,260 INFO] Sentences processed: 102400
[2024-03-13 07:25:55,260 INFO] Average bsz:  864/ 755/64
[2024-03-13 07:25:55,260 INFO] Validation perplexity: 8.63652e+06
[2024-03-13 07:25:55,260 INFO] Validation accuracy: 8.74448
[2024-03-13 07:25:55,262 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_1600.pt
[2024-03-13 07:25:57,371 INFO] Step 1650/10000; acc: 83.7; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  889/ 764/64; 7839/6742 tok/s;     92 sec;
[2024-03-13 07:25:59,156 INFO] Step 1700/10000; acc: 85.5; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  730/ 648/64; 20442/18154 tok/s;     94 sec;
[2024-03-13 07:26:00,868 INFO] Step 1750/10000; acc: 85.9; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  819/ 746/64; 23927/21796 tok/s;     95 sec;
[2024-03-13 07:26:02,076 INFO] Step 1800/10000; acc: 86.0; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  933/ 807/64; 38653/33413 tok/s;     97 sec;
[2024-03-13 07:26:05,676 INFO] valid stats calculation
                           took: 3.600295305252075 s.
[2024-03-13 07:26:05,677 INFO] Train perplexity: 42.5242
[2024-03-13 07:26:05,677 INFO] Train accuracy: 50.4423
[2024-03-13 07:26:05,677 INFO] Sentences processed: 115200
[2024-03-13 07:26:05,677 INFO] Average bsz:  862/ 753/64
[2024-03-13 07:26:05,677 INFO] Validation perplexity: 6.55631e+06
[2024-03-13 07:26:05,677 INFO] Validation accuracy: 8.58404
[2024-03-13 07:26:05,678 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_1800.pt
[2024-03-13 07:26:07,766 INFO] Step 1850/10000; acc: 84.1; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  902/ 803/64; 7929/7056 tok/s;    102 sec;
[2024-03-13 07:26:09,644 INFO] Step 1900/10000; acc: 85.4; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  836/ 706/64; 22257/18795 tok/s;    104 sec;
[2024-03-13 07:26:11,739 INFO] Step 1950/10000; acc: 86.4; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  908/ 790/64; 21665/18848 tok/s;    106 sec;
[2024-03-13 07:26:12,958 INFO] Step 2000/10000; acc: 86.7; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  824/ 748/64; 33804/30662 tok/s;    108 sec;
[2024-03-13 07:26:16,543 INFO] valid stats calculation
                           took: 3.5841448307037354 s.
[2024-03-13 07:26:16,543 INFO] Train perplexity: 32.2161
[2024-03-13 07:26:16,543 INFO] Train accuracy: 53.9984
[2024-03-13 07:26:16,543 INFO] Sentences processed: 128000
[2024-03-13 07:26:16,543 INFO] Average bsz:  862/ 754/64
[2024-03-13 07:26:16,543 INFO] Validation perplexity: 1.42803e+07
[2024-03-13 07:26:16,543 INFO] Validation accuracy: 8.26314
[2024-03-13 07:26:16,545 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_2000.pt
[2024-03-13 07:26:18,547 INFO] Step 2050/10000; acc: 87.4; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  838/ 722/64; 7495/6463 tok/s;    113 sec;
[2024-03-13 07:26:20,462 INFO] Step 2100/10000; acc: 86.3; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  835/ 727/64; 21793/18981 tok/s;    115 sec;
[2024-03-13 07:26:22,297 INFO] Step 2150/10000; acc: 87.9; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  763/ 672/64; 20789/18309 tok/s;    117 sec;
[2024-03-13 07:26:24,141 INFO] Step 2200/10000; acc: 87.4; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  955/ 849/64; 25904/23006 tok/s;    119 sec;
[2024-03-13 07:26:27,712 INFO] valid stats calculation
                           took: 3.5705602169036865 s.
[2024-03-13 07:26:27,712 INFO] Train perplexity: 25.6219
[2024-03-13 07:26:27,712 INFO] Train accuracy: 56.9774
[2024-03-13 07:26:27,712 INFO] Sentences processed: 140800
[2024-03-13 07:26:27,712 INFO] Average bsz:  861/ 753/64
[2024-03-13 07:26:27,712 INFO] Validation perplexity: 2.45977e+07
[2024-03-13 07:26:27,712 INFO] Validation accuracy: 8.50381
[2024-03-13 07:26:27,714 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_2200.pt
[2024-03-13 07:26:29,880 INFO] Step 2250/10000; acc: 88.0; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  856/ 754/64; 7461/6571 tok/s;    124 sec;
[2024-03-13 07:26:32,053 INFO] Step 2300/10000; acc: 86.5; ppl:   2.9; xent: 1.0; lr: 1.00000; sents:    3163; bsz:  948/ 792/63; 21815/18227 tok/s;    127 sec;
[2024-03-13 07:26:33,965 INFO] Step 2350/10000; acc: 88.7; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  786/ 701/64; 20560/18325 tok/s;    129 sec;
[2024-03-13 07:26:35,946 INFO] Step 2400/10000; acc: 89.0; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  855/ 765/64; 21582/19308 tok/s;    131 sec;
[2024-03-13 07:26:39,576 INFO] valid stats calculation
                           took: 3.629138946533203 s.
[2024-03-13 07:26:39,576 INFO] Train perplexity: 21.0268
[2024-03-13 07:26:39,576 INFO] Train accuracy: 59.5632
[2024-03-13 07:26:39,576 INFO] Sentences processed: 153563
[2024-03-13 07:26:39,576 INFO] Average bsz:  861/ 753/64
[2024-03-13 07:26:39,576 INFO] Validation perplexity: 2.15566e+07
[2024-03-13 07:26:39,576 INFO] Validation accuracy: 9.18572
[2024-03-13 07:26:39,578 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_2400.pt
[2024-03-13 07:26:41,606 INFO] Step 2450/10000; acc: 88.1; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  823/ 702/64; 7273/6204 tok/s;    136 sec;
[2024-03-13 07:26:43,633 INFO] Step 2500/10000; acc: 89.3; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  853/ 776/64; 21045/19154 tok/s;    138 sec;
[2024-03-13 07:26:45,792 INFO] Step 2550/10000; acc: 88.8; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  946/ 799/64; 21902/18501 tok/s;    140 sec;
[2024-03-13 07:26:47,783 INFO] Step 2600/10000; acc: 89.5; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  906/ 777/64; 22748/19507 tok/s;    142 sec;
[2024-03-13 07:26:51,353 INFO] valid stats calculation
                           took: 3.5696542263031006 s.
[2024-03-13 07:26:51,353 INFO] Train perplexity: 17.6179
[2024-03-13 07:26:51,353 INFO] Train accuracy: 61.8528
[2024-03-13 07:26:51,353 INFO] Sentences processed: 166363
[2024-03-13 07:26:51,353 INFO] Average bsz:  863/ 754/64
[2024-03-13 07:26:51,353 INFO] Validation perplexity: 1.65658e+07
[2024-03-13 07:26:51,353 INFO] Validation accuracy: 9.38628
[2024-03-13 07:26:51,355 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_2600.pt
[2024-03-13 07:26:53,153 INFO] Step 2650/10000; acc: 89.8; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  892/ 767/64; 8308/7142 tok/s;    148 sec;
[2024-03-13 07:26:55,184 INFO] Step 2700/10000; acc: 90.5; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  856/ 769/64; 21083/18934 tok/s;    150 sec;
[2024-03-13 07:26:57,100 INFO] Step 2750/10000; acc: 90.1; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  818/ 702/64; 21342/18306 tok/s;    152 sec;
[2024-03-13 07:26:59,100 INFO] Step 2800/10000; acc: 91.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  847/ 741/64; 21190/18536 tok/s;    154 sec;
[2024-03-13 07:27:02,708 INFO] valid stats calculation
                           took: 3.6082801818847656 s.
[2024-03-13 07:27:02,709 INFO] Train perplexity: 15.0745
[2024-03-13 07:27:02,709 INFO] Train accuracy: 63.8667
[2024-03-13 07:27:02,709 INFO] Sentences processed: 179163
[2024-03-13 07:27:02,709 INFO] Average bsz:  862/ 753/64
[2024-03-13 07:27:02,709 INFO] Validation perplexity: 4.84223e+07
[2024-03-13 07:27:02,709 INFO] Validation accuracy: 8.86482
[2024-03-13 07:27:02,710 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_2800.pt
[2024-03-13 07:27:04,269 INFO] Step 2850/10000; acc: 90.6; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  932/ 808/64; 9014/7813 tok/s;    159 sec;
[2024-03-13 07:27:06,200 INFO] Step 2900/10000; acc: 89.1; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  844/ 713/64; 21856/18468 tok/s;    161 sec;
[2024-03-13 07:27:08,385 INFO] Step 2950/10000; acc: 89.5; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  968/ 814/64; 22149/18621 tok/s;    163 sec;
[2024-03-13 07:27:10,570 INFO] Step 3000/10000; acc: 90.7; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  924/ 814/64; 21142/18610 tok/s;    165 sec;
[2024-03-13 07:27:14,075 INFO] valid stats calculation
                           took: 3.504417657852173 s.
[2024-03-13 07:27:14,076 INFO] Train perplexity: 13.1242
[2024-03-13 07:27:14,076 INFO] Train accuracy: 65.683
[2024-03-13 07:27:14,076 INFO] Sentences processed: 191963
[2024-03-13 07:27:14,076 INFO] Average bsz:  866/ 756/64
[2024-03-13 07:27:14,076 INFO] Validation perplexity: 5.78063e+07
[2024-03-13 07:27:14,076 INFO] Validation accuracy: 8.62415
[2024-03-13 07:27:14,077 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_3000.pt
[2024-03-13 07:27:15,420 INFO] Step 3050/10000; acc: 90.7; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  902/ 790/64; 9305/8144 tok/s;    170 sec;
[2024-03-13 07:27:17,125 INFO] Step 3100/10000; acc: 90.9; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  750/ 667/64; 21979/19550 tok/s;    172 sec;
[2024-03-13 07:27:19,091 INFO] Step 3150/10000; acc: 90.6; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  851/ 741/64; 21649/18858 tok/s;    174 sec;
[2024-03-13 07:27:21,043 INFO] Step 3200/10000; acc: 91.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  847/ 732/64; 21699/18752 tok/s;    176 sec;
[2024-03-13 07:27:24,560 INFO] valid stats calculation
                           took: 3.516658306121826 s.
[2024-03-13 07:27:24,560 INFO] Train perplexity: 11.6697
[2024-03-13 07:27:24,560 INFO] Train accuracy: 67.2076
[2024-03-13 07:27:24,560 INFO] Sentences processed: 204763
[2024-03-13 07:27:24,560 INFO] Average bsz:  864/ 754/64
[2024-03-13 07:27:24,560 INFO] Validation perplexity: 8.0955e+07
[2024-03-13 07:27:24,560 INFO] Validation accuracy: 9.30606
[2024-03-13 07:27:24,562 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_3200.pt
[2024-03-13 07:27:25,814 INFO] Step 3250/10000; acc: 90.4; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  854/ 738/64; 8946/7734 tok/s;    180 sec;
[2024-03-13 07:27:27,273 INFO] Step 3300/10000; acc: 91.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  852/ 769/64; 29217/26366 tok/s;    182 sec;
[2024-03-13 07:27:29,196 INFO] Step 3350/10000; acc: 91.5; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  803/ 701/64; 20875/18236 tok/s;    184 sec;
[2024-03-13 07:27:31,228 INFO] Step 3400/10000; acc: 92.1; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  849/ 750/64; 20882/18465 tok/s;    186 sec;
[2024-03-13 07:27:34,689 INFO] valid stats calculation
                           took: 3.461061716079712 s.
[2024-03-13 07:27:34,690 INFO] Train perplexity: 10.4875
[2024-03-13 07:27:34,690 INFO] Train accuracy: 68.6096
[2024-03-13 07:27:34,690 INFO] Sentences processed: 217563
[2024-03-13 07:27:34,690 INFO] Average bsz:  862/ 753/64
[2024-03-13 07:27:34,690 INFO] Validation perplexity: 1.24769e+08
[2024-03-13 07:27:34,690 INFO] Validation accuracy: 9.14561
[2024-03-13 07:27:34,691 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_3400.pt
[2024-03-13 07:27:36,012 INFO] Step 3450/10000; acc: 91.8; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  890/ 787/64; 9308/8231 tok/s;    191 sec;
[2024-03-13 07:27:37,158 INFO] Step 3500/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  813/ 724/64; 35466/31612 tok/s;    192 sec;
[2024-03-13 07:27:38,901 INFO] Step 3550/10000; acc: 92.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  841/ 736/64; 24131/21119 tok/s;    193 sec;
[2024-03-13 07:27:41,031 INFO] Step 3600/10000; acc: 91.1; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  933/ 799/64; 21905/18751 tok/s;    196 sec;
[2024-03-13 07:27:44,515 INFO] valid stats calculation
                           took: 3.483292818069458 s.
[2024-03-13 07:27:44,515 INFO] Train perplexity: 9.50008
[2024-03-13 07:27:44,515 INFO] Train accuracy: 69.917
[2024-03-13 07:27:44,515 INFO] Sentences processed: 230363
[2024-03-13 07:27:44,515 INFO] Average bsz:  863/ 754/64
[2024-03-13 07:27:44,515 INFO] Validation perplexity: 1.306e+08
[2024-03-13 07:27:44,515 INFO] Validation accuracy: 9.30606
[2024-03-13 07:27:44,517 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_3600.pt
[2024-03-13 07:27:45,770 INFO] Step 3650/10000; acc: 92.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  864/ 742/64; 9117/7834 tok/s;    200 sec;
[2024-03-13 07:27:46,945 INFO] Step 3700/10000; acc: 91.8; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  845/ 771/64; 35945/32794 tok/s;    202 sec;
[2024-03-13 07:27:48,054 INFO] Step 3750/10000; acc: 92.1; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  819/ 686/64; 36953/30948 tok/s;    203 sec;
[2024-03-13 07:27:49,892 INFO] Step 3800/10000; acc: 92.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  800/ 705/64; 21760/19179 tok/s;    204 sec;
[2024-03-13 07:27:53,340 INFO] valid stats calculation
                           took: 3.4475555419921875 s.
[2024-03-13 07:27:53,341 INFO] Train perplexity: 8.71816
[2024-03-13 07:27:53,341 INFO] Train accuracy: 71.0435
[2024-03-13 07:27:53,341 INFO] Sentences processed: 243163
[2024-03-13 07:27:53,341 INFO] Average bsz:  861/ 752/64
[2024-03-13 07:27:53,341 INFO] Validation perplexity: 4.63243e+08
[2024-03-13 07:27:53,341 INFO] Validation accuracy: 8.7846
[2024-03-13 07:27:53,342 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_3800.pt
[2024-03-13 07:27:55,191 INFO] Step 3850/10000; acc: 91.8; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  882/ 755/64; 8323/7129 tok/s;    210 sec;
[2024-03-13 07:27:56,415 INFO] Step 3900/10000; acc: 92.3; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  847/ 733/64; 34612/29958 tok/s;    211 sec;
[2024-03-13 07:27:57,532 INFO] Step 3950/10000; acc: 92.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  812/ 712/64; 36326/31857 tok/s;    212 sec;
[2024-03-13 07:27:58,900 INFO] Step 4000/10000; acc: 92.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  847/ 731/64; 30985/26741 tok/s;    213 sec;
[2024-03-13 07:28:02,371 INFO] valid stats calculation
                           took: 3.4709460735321045 s.
[2024-03-13 07:28:02,372 INFO] Train perplexity: 8.06138
[2024-03-13 07:28:02,372 INFO] Train accuracy: 72.0823
[2024-03-13 07:28:02,372 INFO] Sentences processed: 255963
[2024-03-13 07:28:02,372 INFO] Average bsz:  861/ 751/64
[2024-03-13 07:28:02,372 INFO] Validation perplexity: 1.68766e+08
[2024-03-13 07:28:02,372 INFO] Validation accuracy: 8.86482
[2024-03-13 07:28:02,373 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_4000.pt
[2024-03-13 07:28:04,544 INFO] Step 4050/10000; acc: 92.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  916/ 786/64; 8119/6961 tok/s;    219 sec;
[2024-03-13 07:28:06,008 INFO] Step 4100/10000; acc: 91.2; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  878/ 755/64; 30004/25789 tok/s;    221 sec;
[2024-03-13 07:28:07,130 INFO] Step 4150/10000; acc: 92.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  812/ 727/64; 36161/32396 tok/s;    222 sec;
[2024-03-13 07:28:08,303 INFO] Step 4200/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  861/ 748/64; 36745/31885 tok/s;    223 sec;
[2024-03-13 07:28:11,804 INFO] valid stats calculation
                           took: 3.500643253326416 s.
[2024-03-13 07:28:11,804 INFO] Train perplexity: 7.4981
[2024-03-13 07:28:11,804 INFO] Train accuracy: 73.0436
[2024-03-13 07:28:11,804 INFO] Sentences processed: 268763
[2024-03-13 07:28:11,804 INFO] Average bsz:  861/ 751/64
[2024-03-13 07:28:11,804 INFO] Validation perplexity: 1.29931e+08
[2024-03-13 07:28:11,804 INFO] Validation accuracy: 9.42639
[2024-03-13 07:28:11,806 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_4200.pt
[2024-03-13 07:28:13,890 INFO] Step 4250/10000; acc: 93.0; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  831/ 737/64; 7434/6598 tok/s;    228 sec;
[2024-03-13 07:28:15,829 INFO] Step 4300/10000; acc: 92.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  854/ 739/64; 22026/19057 tok/s;    230 sec;
[2024-03-13 07:28:16,941 INFO] Step 4350/10000; acc: 92.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  837/ 724/64; 37646/32552 tok/s;    232 sec;
[2024-03-13 07:28:18,113 INFO] Step 4400/10000; acc: 91.5; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  898/ 769/64; 38304/32826 tok/s;    233 sec;
[2024-03-13 07:28:21,637 INFO] valid stats calculation
                           took: 3.5235941410064697 s.
[2024-03-13 07:28:21,637 INFO] Train perplexity: 7.02544
[2024-03-13 07:28:21,638 INFO] Train accuracy: 73.9106
[2024-03-13 07:28:21,638 INFO] Sentences processed: 281563
[2024-03-13 07:28:21,638 INFO] Average bsz:  861/ 751/64
[2024-03-13 07:28:21,638 INFO] Validation perplexity: 7.51926e+07
[2024-03-13 07:28:21,638 INFO] Validation accuracy: 9.26594
[2024-03-13 07:28:21,639 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_4400.pt
[2024-03-13 07:28:23,800 INFO] Step 4450/10000; acc: 92.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  854/ 740/64; 7509/6507 tok/s;    238 sec;
[2024-03-13 07:28:25,709 INFO] Step 4500/10000; acc: 93.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  794/ 719/64; 20791/18846 tok/s;    240 sec;
[2024-03-13 07:28:27,246 INFO] Step 4550/10000; acc: 93.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  852/ 722/64; 27739/23491 tok/s;    242 sec;
[2024-03-13 07:28:28,416 INFO] Step 4600/10000; acc: 92.5; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  914/ 784/64; 39068/33506 tok/s;    243 sec;
[2024-03-13 07:28:31,976 INFO] valid stats calculation
                           took: 3.559810161590576 s.
[2024-03-13 07:28:31,976 INFO] Train perplexity: 6.60472
[2024-03-13 07:28:31,976 INFO] Train accuracy: 74.7209
[2024-03-13 07:28:31,976 INFO] Sentences processed: 294363
[2024-03-13 07:28:31,976 INFO] Average bsz:  860/ 751/64
[2024-03-13 07:28:31,976 INFO] Validation perplexity: 2.521e+08
[2024-03-13 07:28:31,976 INFO] Validation accuracy: 9.06538
[2024-03-13 07:28:31,978 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_4600.pt
[2024-03-13 07:28:34,111 INFO] Step 4650/10000; acc: 92.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  869/ 752/64; 7628/6605 tok/s;    249 sec;
[2024-03-13 07:28:36,180 INFO] Step 4700/10000; acc: 93.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  941/ 795/64; 22738/19212 tok/s;    251 sec;
[2024-03-13 07:28:38,097 INFO] Step 4750/10000; acc: 93.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  841/ 718/64; 21939/18734 tok/s;    253 sec;
[2024-03-13 07:28:39,313 INFO] Step 4800/10000; acc: 93.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  895/ 788/64; 36799/32430 tok/s;    254 sec;
[2024-03-13 07:28:42,939 INFO] valid stats calculation
                           took: 3.625885248184204 s.
[2024-03-13 07:28:42,939 INFO] Train perplexity: 6.22411
[2024-03-13 07:28:42,939 INFO] Train accuracy: 75.4994
[2024-03-13 07:28:42,939 INFO] Sentences processed: 307163
[2024-03-13 07:28:42,939 INFO] Average bsz:  861/ 751/64
[2024-03-13 07:28:42,939 INFO] Validation perplexity: 2.24788e+08
[2024-03-13 07:28:42,939 INFO] Validation accuracy: 8.66426
[2024-03-13 07:28:42,941 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_4800.pt
[2024-03-13 07:28:45,037 INFO] Step 4850/10000; acc: 92.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  800/ 703/64; 6989/6142 tok/s;    260 sec;
[2024-03-13 07:28:47,232 INFO] Step 4900/10000; acc: 91.6; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  937/ 822/64; 21350/18731 tok/s;    262 sec;
[2024-03-13 07:28:49,334 INFO] Step 4950/10000; acc: 93.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  881/ 782/64; 20969/18597 tok/s;    264 sec;
[2024-03-13 07:28:50,778 INFO] Step 5000/10000; acc: 93.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  950/ 820/64; 32877/28378 tok/s;    265 sec;
[2024-03-13 07:28:54,439 INFO] valid stats calculation
                           took: 3.6605451107025146 s.
[2024-03-13 07:28:54,439 INFO] Train perplexity: 5.90008
[2024-03-13 07:28:54,439 INFO] Train accuracy: 76.2164
[2024-03-13 07:28:54,440 INFO] Sentences processed: 319963
[2024-03-13 07:28:54,440 INFO] Average bsz:  863/ 752/64
[2024-03-13 07:28:54,440 INFO] Validation perplexity: 4.02059e+08
[2024-03-13 07:28:54,440 INFO] Validation accuracy: 8.94505
[2024-03-13 07:28:54,441 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_5000.pt
[2024-03-13 07:28:56,641 INFO] Step 5050/10000; acc: 92.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  906/ 781/64; 7729/6660 tok/s;    271 sec;
[2024-03-13 07:28:58,718 INFO] Step 5100/10000; acc: 93.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  858/ 757/64; 20648/18219 tok/s;    273 sec;
[2024-03-13 07:29:00,725 INFO] Step 5150/10000; acc: 92.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  910/ 792/64; 22676/19724 tok/s;    275 sec;
[2024-03-13 07:29:02,486 INFO] Step 5200/10000; acc: 93.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  858/ 755/64; 24344/21441 tok/s;    277 sec;
[2024-03-13 07:29:06,101 INFO] valid stats calculation
                           took: 3.6146798133850098 s.
[2024-03-13 07:29:06,102 INFO] Train perplexity: 5.60785
[2024-03-13 07:29:06,102 INFO] Train accuracy: 76.8835
[2024-03-13 07:29:06,102 INFO] Sentences processed: 332763
[2024-03-13 07:29:06,102 INFO] Average bsz:  863/ 753/64
[2024-03-13 07:29:06,102 INFO] Validation perplexity: 4.3625e+08
[2024-03-13 07:29:06,102 INFO] Validation accuracy: 8.94505
[2024-03-13 07:29:06,103 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_5200.pt
[2024-03-13 07:29:08,334 INFO] Step 5250/10000; acc: 93.5; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  936/ 812/64; 8003/6948 tok/s;    283 sec;
[2024-03-13 07:29:10,498 INFO] Step 5300/10000; acc: 93.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  924/ 833/64; 21348/19252 tok/s;    285 sec;
[2024-03-13 07:29:12,680 INFO] Step 5350/10000; acc: 93.5; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  954/ 823/64; 21858/18865 tok/s;    287 sec;
[2024-03-13 07:29:14,636 INFO] Step 5400/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  844/ 725/64; 21568/18531 tok/s;    289 sec;
[2024-03-13 07:29:18,291 INFO] valid stats calculation
                           took: 3.655042886734009 s.
[2024-03-13 07:29:18,292 INFO] Train perplexity: 5.33875
[2024-03-13 07:29:18,292 INFO] Train accuracy: 77.5281
[2024-03-13 07:29:18,292 INFO] Sentences processed: 345563
[2024-03-13 07:29:18,292 INFO] Average bsz:  865/ 755/64
[2024-03-13 07:29:18,292 INFO] Validation perplexity: 7.21206e+08
[2024-03-13 07:29:18,292 INFO] Validation accuracy: 9.34617
[2024-03-13 07:29:18,293 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_5400.pt
[2024-03-13 07:29:20,351 INFO] Step 5450/10000; acc: 92.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  823/ 722/64; 7199/6320 tok/s;    295 sec;
[2024-03-13 07:29:22,347 INFO] Step 5500/10000; acc: 93.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  833/ 741/64; 20866/18546 tok/s;    297 sec;
[2024-03-13 07:29:24,449 INFO] Step 5550/10000; acc: 93.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  922/ 795/64; 21934/18918 tok/s;    299 sec;
[2024-03-13 07:29:26,551 INFO] Step 5600/10000; acc: 93.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  921/ 799/64; 21906/19015 tok/s;    301 sec;
[2024-03-13 07:29:30,110 INFO] valid stats calculation
                           took: 3.5592494010925293 s.
[2024-03-13 07:29:30,111 INFO] Train perplexity: 5.1115
[2024-03-13 07:29:30,111 INFO] Train accuracy: 78.1015
[2024-03-13 07:29:30,111 INFO] Sentences processed: 358363
[2024-03-13 07:29:30,111 INFO] Average bsz:  866/ 755/64
[2024-03-13 07:29:30,111 INFO] Validation perplexity: 5.56119e+08
[2024-03-13 07:29:30,111 INFO] Validation accuracy: 8.94505
[2024-03-13 07:29:30,112 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_5600.pt
[2024-03-13 07:29:31,621 INFO] Step 5650/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  827/ 709/64; 8154/6988 tok/s;    306 sec;
[2024-03-13 07:29:33,653 INFO] Step 5700/10000; acc: 93.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  925/ 812/64; 22772/19969 tok/s;    308 sec;
[2024-03-13 07:29:35,602 INFO] Step 5750/10000; acc: 93.6; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  817/ 724/64; 20960/18587 tok/s;    310 sec;
[2024-03-13 07:29:37,507 INFO] Step 5800/10000; acc: 93.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  854/ 724/64; 22411/19018 tok/s;    312 sec;
[2024-03-13 07:29:41,027 INFO] valid stats calculation
                           took: 3.5198655128479004 s.
[2024-03-13 07:29:41,027 INFO] Train perplexity: 4.91627
[2024-03-13 07:29:41,027 INFO] Train accuracy: 78.6152
[2024-03-13 07:29:41,027 INFO] Sentences processed: 371163
[2024-03-13 07:29:41,027 INFO] Average bsz:  865/ 755/64
[2024-03-13 07:29:41,027 INFO] Validation perplexity: 6.90046e+08
[2024-03-13 07:29:41,027 INFO] Validation accuracy: 9.58684
[2024-03-13 07:29:41,029 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_5800.pt
[2024-03-13 07:29:42,402 INFO] Step 5850/10000; acc: 92.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  899/ 764/64; 9178/7799 tok/s;    317 sec;
[2024-03-13 07:29:44,544 INFO] Step 5900/10000; acc: 91.8; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  955/ 795/64; 22295/18554 tok/s;    319 sec;
[2024-03-13 07:29:46,614 INFO] Step 5950/10000; acc: 93.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  849/ 749/64; 20502/18084 tok/s;    321 sec;
[2024-03-13 07:29:48,526 INFO] Step 6000/10000; acc: 93.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  773/ 666/64; 20225/17410 tok/s;    323 sec;
[2024-03-13 07:29:52,056 INFO] valid stats calculation
                           took: 3.5297601222991943 s.
[2024-03-13 07:29:52,056 INFO] Train perplexity: 4.74949
[2024-03-13 07:29:52,056 INFO] Train accuracy: 79.0806
[2024-03-13 07:29:52,056 INFO] Sentences processed: 383963
[2024-03-13 07:29:52,056 INFO] Average bsz:  865/ 754/64
[2024-03-13 07:29:52,056 INFO] Validation perplexity: 1.22093e+09
[2024-03-13 07:29:52,056 INFO] Validation accuracy: 8.86482
[2024-03-13 07:29:52,058 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_6000.pt
[2024-03-13 07:29:53,278 INFO] Step 6050/10000; acc: 92.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  855/ 731/64; 8997/7691 tok/s;    328 sec;
[2024-03-13 07:29:54,738 INFO] Step 6100/10000; acc: 93.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  863/ 727/64; 29545/24904 tok/s;    329 sec;
[2024-03-13 07:29:56,854 INFO] Step 6150/10000; acc: 93.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  881/ 772/64; 20807/18235 tok/s;    331 sec;
[2024-03-13 07:29:58,967 INFO] Step 6200/10000; acc: 93.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  906/ 764/64; 21453/18090 tok/s;    334 sec;
[2024-03-13 07:30:02,454 INFO] valid stats calculation
                           took: 3.4865353107452393 s.
[2024-03-13 07:30:02,454 INFO] Train perplexity: 4.58938
[2024-03-13 07:30:02,454 INFO] Train accuracy: 79.5288
[2024-03-13 07:30:02,454 INFO] Sentences processed: 396763
[2024-03-13 07:30:02,454 INFO] Average bsz:  866/ 754/64
[2024-03-13 07:30:02,454 INFO] Validation perplexity: 5.8068e+08
[2024-03-13 07:30:02,454 INFO] Validation accuracy: 8.90493
[2024-03-13 07:30:02,456 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_6200.pt
[2024-03-13 07:30:03,697 INFO] Step 6250/10000; acc: 93.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  844/ 725/64; 8917/7663 tok/s;    338 sec;
[2024-03-13 07:30:04,962 INFO] Step 6300/10000; acc: 93.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  959/ 810/64; 37881/31988 tok/s;    340 sec;
[2024-03-13 07:30:06,650 INFO] Step 6350/10000; acc: 93.8; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  779/ 686/64; 23104/20323 tok/s;    341 sec;
[2024-03-13 07:30:08,686 INFO] Step 6400/10000; acc: 93.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  880/ 764/64; 21610/18758 tok/s;    343 sec;
[2024-03-13 07:30:12,151 INFO] valid stats calculation
                           took: 3.464876413345337 s.
[2024-03-13 07:30:12,152 INFO] Train perplexity: 4.44644
[2024-03-13 07:30:12,152 INFO] Train accuracy: 79.9569
[2024-03-13 07:30:12,152 INFO] Sentences processed: 409563
[2024-03-13 07:30:12,152 INFO] Average bsz:  866/ 754/64
[2024-03-13 07:30:12,152 INFO] Validation perplexity: 8.51839e+08
[2024-03-13 07:30:12,152 INFO] Validation accuracy: 9.26594
[2024-03-13 07:30:12,153 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_6400.pt
[2024-03-13 07:30:13,359 INFO] Step 6450/10000; acc: 93.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  836/ 719/64; 8944/7697 tok/s;    348 sec;
[2024-03-13 07:30:14,534 INFO] Step 6500/10000; acc: 94.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  831/ 746/64; 35360/31764 tok/s;    349 sec;
[2024-03-13 07:30:15,728 INFO] Step 6550/10000; acc: 93.9; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  863/ 752/64; 36142/31491 tok/s;    350 sec;
[2024-03-13 07:30:17,851 INFO] Step 6600/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  864/ 750/64; 20351/17677 tok/s;    352 sec;
[2024-03-13 07:30:21,324 INFO] valid stats calculation
                           took: 3.472885847091675 s.
[2024-03-13 07:30:21,324 INFO] Train perplexity: 4.30644
[2024-03-13 07:30:21,325 INFO] Train accuracy: 80.3771
[2024-03-13 07:30:21,325 INFO] Sentences processed: 422363
[2024-03-13 07:30:21,325 INFO] Average bsz:  865/ 753/64
[2024-03-13 07:30:21,325 INFO] Validation perplexity: 7.61678e+08
[2024-03-13 07:30:21,325 INFO] Validation accuracy: 8.86482
[2024-03-13 07:30:21,326 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_6600.pt
[2024-03-13 07:30:23,191 INFO] Step 6650/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  878/ 746/64; 8222/6989 tok/s;    358 sec;
[2024-03-13 07:30:24,320 INFO] Step 6700/10000; acc: 94.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  885/ 751/64; 39174/33237 tok/s;    359 sec;
[2024-03-13 07:30:25,496 INFO] Step 6750/10000; acc: 94.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  878/ 777/64; 37337/33038 tok/s;    360 sec;
[2024-03-13 07:30:27,017 INFO] Step 6800/10000; acc: 94.8; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  906/ 799/64; 29799/26263 tok/s;    362 sec;
[2024-03-13 07:30:30,517 INFO] valid stats calculation
                           took: 3.499420404434204 s.
[2024-03-13 07:30:30,517 INFO] Train perplexity: 4.17098
[2024-03-13 07:30:30,517 INFO] Train accuracy: 80.7965
[2024-03-13 07:30:30,517 INFO] Sentences processed: 435163
[2024-03-13 07:30:30,517 INFO] Average bsz:  866/ 754/64
[2024-03-13 07:30:30,517 INFO] Validation perplexity: 1.15486e+09
[2024-03-13 07:30:30,518 INFO] Validation accuracy: 9.58684
[2024-03-13 07:30:30,519 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_6800.pt
[2024-03-13 07:30:32,643 INFO] Step 6850/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  824/ 717/64; 7327/6370 tok/s;    367 sec;
[2024-03-13 07:30:34,168 INFO] Step 6900/10000; acc: 94.3; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  904/ 802/64; 29629/26304 tok/s;    369 sec;
[2024-03-13 07:30:35,213 INFO] Step 6950/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  767/ 686/64; 36686/32835 tok/s;    370 sec;
[2024-03-13 07:30:36,359 INFO] Step 7000/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  890/ 744/64; 38814/32476 tok/s;    371 sec;
[2024-03-13 07:30:39,820 INFO] valid stats calculation
                           took: 3.460237979888916 s.
[2024-03-13 07:30:39,820 INFO] Train perplexity: 4.05343
[2024-03-13 07:30:39,820 INFO] Train accuracy: 81.1758
[2024-03-13 07:30:39,821 INFO] Sentences processed: 447963
[2024-03-13 07:30:39,821 INFO] Average bsz:  865/ 753/64
[2024-03-13 07:30:39,821 INFO] Validation perplexity: 5.678e+08
[2024-03-13 07:30:39,821 INFO] Validation accuracy: 9.50662
[2024-03-13 07:30:39,822 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_7000.pt
[2024-03-13 07:30:41,988 INFO] Step 7050/10000; acc: 94.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  859/ 751/64; 7630/6671 tok/s;    377 sec;
[2024-03-13 07:30:44,068 INFO] Step 7100/10000; acc: 94.3; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  864/ 758/64; 20769/18215 tok/s;    379 sec;
[2024-03-13 07:30:45,218 INFO] Step 7150/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  867/ 760/64; 37688/33057 tok/s;    380 sec;
[2024-03-13 07:30:46,345 INFO] Step 7200/10000; acc: 93.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  844/ 741/64; 37434/32889 tok/s;    381 sec;
[2024-03-13 07:30:50,059 INFO] valid stats calculation
                           took: 3.7136240005493164 s.
[2024-03-13 07:30:50,060 INFO] Train perplexity: 3.94312
[2024-03-13 07:30:50,060 INFO] Train accuracy: 81.5372
[2024-03-13 07:30:50,060 INFO] Sentences processed: 460763
[2024-03-13 07:30:50,060 INFO] Average bsz:  865/ 753/64
[2024-03-13 07:30:50,060 INFO] Validation perplexity: 1.35645e+09
[2024-03-13 07:30:50,060 INFO] Validation accuracy: 9.58684
[2024-03-13 07:30:50,061 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_7200.pt
[2024-03-13 07:30:52,201 INFO] Step 7250/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  870/ 761/64; 7432/6500 tok/s;    387 sec;
[2024-03-13 07:30:54,185 INFO] Step 7300/10000; acc: 94.8; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  799/ 702/64; 20133/17684 tok/s;    389 sec;
[2024-03-13 07:30:55,797 INFO] Step 7350/10000; acc: 94.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  879/ 746/64; 27288/23157 tok/s;    390 sec;
[2024-03-13 07:30:56,872 INFO] Step 7400/10000; acc: 94.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  838/ 724/64; 38979/33669 tok/s;    391 sec;
[2024-03-13 07:31:00,497 INFO] valid stats calculation
                           took: 3.624309539794922 s.
[2024-03-13 07:31:00,497 INFO] Train perplexity: 3.84194
[2024-03-13 07:31:00,497 INFO] Train accuracy: 81.8807
[2024-03-13 07:31:00,497 INFO] Sentences processed: 473563
[2024-03-13 07:31:00,497 INFO] Average bsz:  865/ 753/64
[2024-03-13 07:31:00,497 INFO] Validation perplexity: 1.67782e+09
[2024-03-13 07:31:00,497 INFO] Validation accuracy: 9.38628
[2024-03-13 07:31:00,499 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_7400.pt
[2024-03-13 07:31:02,609 INFO] Step 7450/10000; acc: 95.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  868/ 763/64; 7564/6649 tok/s;    397 sec;
[2024-03-13 07:31:04,477 INFO] Step 7500/10000; acc: 94.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  774/ 671/64; 20714/17954 tok/s;    399 sec;
[2024-03-13 07:31:06,538 INFO] Step 7550/10000; acc: 94.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  859/ 766/64; 20839/18586 tok/s;    401 sec;
[2024-03-13 07:31:08,024 INFO] Step 7600/10000; acc: 94.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  881/ 773/64; 29638/26019 tok/s;    403 sec;
[2024-03-13 07:31:11,622 INFO] valid stats calculation
                           took: 3.597465991973877 s.
[2024-03-13 07:31:11,622 INFO] Train perplexity: 3.74439
[2024-03-13 07:31:11,622 INFO] Train accuracy: 82.2165
[2024-03-13 07:31:11,622 INFO] Sentences processed: 486363
[2024-03-13 07:31:11,623 INFO] Average bsz:  864/ 753/64
[2024-03-13 07:31:11,623 INFO] Validation perplexity: 1.61535e+09
[2024-03-13 07:31:11,623 INFO] Validation accuracy: 9.66707
[2024-03-13 07:31:11,624 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_7600.pt
[2024-03-13 07:31:13,781 INFO] Step 7650/10000; acc: 94.8; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  846/ 756/64; 7350/6563 tok/s;    408 sec;
[2024-03-13 07:31:15,918 INFO] Step 7700/10000; acc: 94.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  909/ 792/64; 21280/18534 tok/s;    410 sec;
[2024-03-13 07:31:18,003 INFO] Step 7750/10000; acc: 94.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  873/ 779/64; 20935/18686 tok/s;    413 sec;
[2024-03-13 07:31:19,825 INFO] Step 7800/10000; acc: 94.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  910/ 790/64; 24979/21688 tok/s;    414 sec;
[2024-03-13 07:31:23,434 INFO] valid stats calculation
                           took: 3.6091578006744385 s.
[2024-03-13 07:31:23,435 INFO] Train perplexity: 3.65386
[2024-03-13 07:31:23,435 INFO] Train accuracy: 82.5409
[2024-03-13 07:31:23,435 INFO] Sentences processed: 499163
[2024-03-13 07:31:23,435 INFO] Average bsz:  865/ 753/64
[2024-03-13 07:31:23,435 INFO] Validation perplexity: 8.67352e+08
[2024-03-13 07:31:23,435 INFO] Validation accuracy: 9.18572
[2024-03-13 07:31:23,436 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_7800.pt
[2024-03-13 07:31:25,766 INFO] Step 7850/10000; acc: 93.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  989/ 869/64; 8322/7317 tok/s;    420 sec;
[2024-03-13 07:31:27,839 INFO] Step 7900/10000; acc: 93.9; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  881/ 748/64; 21245/18038 tok/s;    422 sec;
[2024-03-13 07:31:29,927 INFO] Step 7950/10000; acc: 94.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  851/ 785/64; 20383/18786 tok/s;    424 sec;
[2024-03-13 07:31:32,038 INFO] Step 8000/10000; acc: 94.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  914/ 800/64; 21651/18952 tok/s;    427 sec;
[2024-03-13 07:31:35,760 INFO] valid stats calculation
                           took: 3.721687078475952 s.
[2024-03-13 07:31:35,760 INFO] Train perplexity: 3.56992
[2024-03-13 07:31:35,760 INFO] Train accuracy: 82.852
[2024-03-13 07:31:35,760 INFO] Sentences processed: 511963
[2024-03-13 07:31:35,760 INFO] Average bsz:  866/ 754/64
[2024-03-13 07:31:35,760 INFO] Validation perplexity: 2.37497e+09
[2024-03-13 07:31:35,760 INFO] Validation accuracy: 8.86482
[2024-03-13 07:31:35,762 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_8000.pt
[2024-03-13 07:31:38,055 INFO] Step 8050/10000; acc: 94.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  926/ 812/64; 7694/6743 tok/s;    433 sec;
[2024-03-13 07:31:40,012 INFO] Step 8100/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  854/ 727/64; 21816/18578 tok/s;    435 sec;
[2024-03-13 07:31:42,105 INFO] Step 8150/10000; acc: 94.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  951/ 818/64; 22722/19555 tok/s;    437 sec;
[2024-03-13 07:31:44,150 INFO] Step 8200/10000; acc: 94.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  927/ 813/64; 22678/19879 tok/s;    439 sec;
[2024-03-13 07:31:47,697 INFO] valid stats calculation
                           took: 3.5469911098480225 s.
[2024-03-13 07:31:47,698 INFO] Train perplexity: 3.49242
[2024-03-13 07:31:47,698 INFO] Train accuracy: 83.1461
[2024-03-13 07:31:47,698 INFO] Sentences processed: 524763
[2024-03-13 07:31:47,698 INFO] Average bsz:  867/ 755/64
[2024-03-13 07:31:47,698 INFO] Validation perplexity: 8.48843e+09
[2024-03-13 07:31:47,698 INFO] Validation accuracy: 9.1055
[2024-03-13 07:31:47,699 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_8200.pt
[2024-03-13 07:31:49,319 INFO] Step 8250/10000; acc: 94.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  772/ 684/64; 7466/6616 tok/s;    444 sec;
[2024-03-13 07:31:51,330 INFO] Step 8300/10000; acc: 94.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  874/ 748/64; 21746/18608 tok/s;    446 sec;
[2024-03-13 07:31:53,430 INFO] Step 8350/10000; acc: 94.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  911/ 796/64; 21708/18964 tok/s;    448 sec;
[2024-03-13 07:31:55,398 INFO] Step 8400/10000; acc: 94.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  800/ 714/64; 20318/18143 tok/s;    450 sec;
[2024-03-13 07:31:58,894 INFO] valid stats calculation
                           took: 3.496340751647949 s.
[2024-03-13 07:31:58,895 INFO] Train perplexity: 3.42532
[2024-03-13 07:31:58,895 INFO] Train accuracy: 83.4085
[2024-03-13 07:31:58,895 INFO] Sentences processed: 537563
[2024-03-13 07:31:58,895 INFO] Average bsz:  866/ 755/64
[2024-03-13 07:31:58,895 INFO] Validation perplexity: 3.01398e+09
[2024-03-13 07:31:58,895 INFO] Validation accuracy: 9.06538
[2024-03-13 07:31:58,896 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_8400.pt
[2024-03-13 07:32:00,239 INFO] Step 8450/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  924/ 793/64; 9546/8189 tok/s;    455 sec;
[2024-03-13 07:32:02,252 INFO] Step 8500/10000; acc: 94.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  972/ 828/64; 24133/20577 tok/s;    457 sec;
[2024-03-13 07:32:04,190 INFO] Step 8550/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  822/ 713/64; 21201/18394 tok/s;    459 sec;
[2024-03-13 07:32:06,216 INFO] Step 8600/10000; acc: 93.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  904/ 767/64; 22303/18940 tok/s;    461 sec;
[2024-03-13 07:32:09,716 INFO] valid stats calculation
                           took: 3.4992828369140625 s.
[2024-03-13 07:32:09,716 INFO] Train perplexity: 3.35799
[2024-03-13 07:32:09,716 INFO] Train accuracy: 83.6684
[2024-03-13 07:32:09,716 INFO] Sentences processed: 550363
[2024-03-13 07:32:09,716 INFO] Average bsz:  867/ 755/64
[2024-03-13 07:32:09,716 INFO] Validation perplexity: 3.57483e+09
[2024-03-13 07:32:09,716 INFO] Validation accuracy: 9.06538
[2024-03-13 07:32:09,718 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_8600.pt
[2024-03-13 07:32:11,030 INFO] Step 8650/10000; acc: 94.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  939/ 792/64; 9756/8230 tok/s;    466 sec;
[2024-03-13 07:32:12,530 INFO] Step 8700/10000; acc: 94.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  782/ 686/64; 26069/22861 tok/s;    467 sec;
[2024-03-13 07:32:14,632 INFO] Step 8750/10000; acc: 94.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  901/ 786/64; 21441/18696 tok/s;    469 sec;
[2024-03-13 07:32:16,761 INFO] Step 8800/10000; acc: 93.8; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  933/ 806/64; 21919/18921 tok/s;    471 sec;
[2024-03-13 07:32:20,205 INFO] valid stats calculation
                           took: 3.4437737464904785 s.
[2024-03-13 07:32:20,205 INFO] Train perplexity: 3.29569
[2024-03-13 07:32:20,205 INFO] Train accuracy: 83.9119
[2024-03-13 07:32:20,206 INFO] Sentences processed: 563163
[2024-03-13 07:32:20,206 INFO] Average bsz:  868/ 756/64
[2024-03-13 07:32:20,206 INFO] Validation perplexity: 1.69189e+09
[2024-03-13 07:32:20,206 INFO] Validation accuracy: 8.66426
[2024-03-13 07:32:20,207 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_8800.pt
[2024-03-13 07:32:21,561 INFO] Step 8850/10000; acc: 93.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  945/ 817/64; 9840/8510 tok/s;    476 sec;
[2024-03-13 07:32:22,823 INFO] Step 8900/10000; acc: 94.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  867/ 741/64; 34328/29368 tok/s;    477 sec;
[2024-03-13 07:32:24,823 INFO] Step 8950/10000; acc: 94.1; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  841/ 752/64; 21031/18793 tok/s;    479 sec;
[2024-03-13 07:32:26,763 INFO] Step 9000/10000; acc: 94.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  794/ 701/64; 20456/18080 tok/s;    481 sec;
[2024-03-13 07:32:30,176 INFO] valid stats calculation
                           took: 3.4123451709747314 s.
[2024-03-13 07:32:30,176 INFO] Train perplexity: 3.24133
[2024-03-13 07:32:30,177 INFO] Train accuracy: 84.1363
[2024-03-13 07:32:30,177 INFO] Sentences processed: 575963
[2024-03-13 07:32:30,177 INFO] Average bsz:  867/ 756/64
[2024-03-13 07:32:30,177 INFO] Validation perplexity: 3.3169e+09
[2024-03-13 07:32:30,177 INFO] Validation accuracy: 8.94505
[2024-03-13 07:32:30,179 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_9000.pt
[2024-03-13 07:32:31,435 INFO] Step 9050/10000; acc: 94.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  879/ 769/64; 9412/8235 tok/s;    486 sec;
[2024-03-13 07:32:32,611 INFO] Step 9100/10000; acc: 94.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  892/ 791/64; 37935/33636 tok/s;    487 sec;
[2024-03-13 07:32:34,202 INFO] Step 9150/10000; acc: 94.8; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  883/ 760/64; 27759/23897 tok/s;    489 sec;
[2024-03-13 07:32:36,205 INFO] Step 9200/10000; acc: 94.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  815/ 721/64; 20355/18011 tok/s;    491 sec;
[2024-03-13 07:32:39,612 INFO] valid stats calculation
                           took: 3.4063916206359863 s.
[2024-03-13 07:32:39,612 INFO] Train perplexity: 3.18608
[2024-03-13 07:32:39,612 INFO] Train accuracy: 84.3635
[2024-03-13 07:32:39,612 INFO] Sentences processed: 588763
[2024-03-13 07:32:39,613 INFO] Average bsz:  867/ 756/64
[2024-03-13 07:32:39,613 INFO] Validation perplexity: 3.13219e+09
[2024-03-13 07:32:39,613 INFO] Validation accuracy: 8.70437
[2024-03-13 07:32:39,614 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_9200.pt
[2024-03-13 07:32:40,865 INFO] Step 9250/10000; acc: 94.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  818/ 699/64; 8776/7502 tok/s;    495 sec;
[2024-03-13 07:32:42,003 INFO] Step 9300/10000; acc: 94.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  824/ 720/64; 36218/31675 tok/s;    497 sec;
[2024-03-13 07:32:43,194 INFO] Step 9350/10000; acc: 94.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  860/ 759/64; 36105/31861 tok/s;    498 sec;
[2024-03-13 07:32:45,187 INFO] Step 9400/10000; acc: 94.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  925/ 835/64; 23221/20940 tok/s;    500 sec;
[2024-03-13 07:32:48,627 INFO] valid stats calculation
                           took: 3.4395036697387695 s.
[2024-03-13 07:32:48,627 INFO] Train perplexity: 3.13625
[2024-03-13 07:32:48,627 INFO] Train accuracy: 84.5751
[2024-03-13 07:32:48,627 INFO] Sentences processed: 601563
[2024-03-13 07:32:48,627 INFO] Average bsz:  867/ 756/64
[2024-03-13 07:32:48,627 INFO] Validation perplexity: 1.88061e+09
[2024-03-13 07:32:48,627 INFO] Validation accuracy: 8.66426
[2024-03-13 07:32:48,629 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_9400.pt
[2024-03-13 07:32:50,659 INFO] Step 9450/10000; acc: 93.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  959/ 844/64; 8761/7710 tok/s;    505 sec;
[2024-03-13 07:32:51,737 INFO] Step 9500/10000; acc: 93.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  828/ 706/64; 38436/32787 tok/s;    506 sec;
[2024-03-13 07:32:52,827 INFO] Step 9550/10000; acc: 94.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  805/ 708/64; 36935/32474 tok/s;    507 sec;
[2024-03-13 07:32:54,228 INFO] Step 9600/10000; acc: 93.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  913/ 783/64; 32565/27939 tok/s;    509 sec;
[2024-03-13 07:32:57,658 INFO] valid stats calculation
                           took: 3.4293744564056396 s.
[2024-03-13 07:32:57,658 INFO] Train perplexity: 3.09232
[2024-03-13 07:32:57,658 INFO] Train accuracy: 84.7693
[2024-03-13 07:32:57,658 INFO] Sentences processed: 614363
[2024-03-13 07:32:57,659 INFO] Average bsz:  867/ 756/64
[2024-03-13 07:32:57,659 INFO] Validation perplexity: 2.32595e+09
[2024-03-13 07:32:57,659 INFO] Validation accuracy: 9.34617
[2024-03-13 07:32:57,660 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_9600.pt
[2024-03-13 07:32:59,889 INFO] Step 9650/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  881/ 768/64; 7779/6782 tok/s;    514 sec;
[2024-03-13 07:33:01,554 INFO] Step 9700/10000; acc: 94.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  864/ 763/64; 25953/22910 tok/s;    516 sec;
[2024-03-13 07:33:02,699 INFO] Step 9750/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  881/ 768/64; 38475/33533 tok/s;    517 sec;
[2024-03-13 07:33:03,804 INFO] Step 9800/10000; acc: 94.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  832/ 707/64; 37674/32015 tok/s;    518 sec;
[2024-03-13 07:33:07,357 INFO] valid stats calculation
                           took: 3.552457332611084 s.
[2024-03-13 07:33:07,357 INFO] Train perplexity: 3.04541
[2024-03-13 07:33:07,357 INFO] Train accuracy: 84.9669
[2024-03-13 07:33:07,357 INFO] Sentences processed: 627163
[2024-03-13 07:33:07,357 INFO] Average bsz:  867/ 756/64
[2024-03-13 07:33:07,357 INFO] Validation perplexity: 3.7368e+09
[2024-03-13 07:33:07,357 INFO] Validation accuracy: 9.02527
[2024-03-13 07:33:07,359 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_9800.pt
[2024-03-13 07:33:09,310 INFO] Step 9850/10000; acc: 94.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  773/ 649/64; 7021/5895 tok/s;    524 sec;
[2024-03-13 07:33:11,347 INFO] Step 9900/10000; acc: 94.8; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  872/ 755/64; 21390/18526 tok/s;    526 sec;
[2024-03-13 07:33:12,585 INFO] Step 9950/10000; acc: 93.8; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  868/ 758/64; 35085/30624 tok/s;    527 sec;
[2024-03-13 07:33:13,738 INFO] Step 10000/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  860/ 757/64; 37281/32837 tok/s;    528 sec;
[2024-03-13 07:33:17,207 INFO] valid stats calculation
                           took: 3.468860626220703 s.
[2024-03-13 07:33:17,208 INFO] Train perplexity: 3.00563
[2024-03-13 07:33:17,208 INFO] Train accuracy: 85.1476
[2024-03-13 07:33:17,208 INFO] Sentences processed: 639963
[2024-03-13 07:33:17,208 INFO] Average bsz:  867/ 755/64
[2024-03-13 07:33:17,208 INFO] Validation perplexity: 5.41541e+09
[2024-03-13 07:33:17,208 INFO] Validation accuracy: 8.7846
[2024-03-13 07:33:17,209 INFO] Saving checkpoint tg-pt-both/tg-pt-both_02_step_10000.pt
