[2024-03-13 09:10:05,345 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-13 09:10:05,345 INFO] Parsed 2 corpora from -data.
[2024-03-13 09:10:05,345 INFO] Loading checkpoint from tg-pt-both/models/tg-pt-both_01_step_3200.pt
[2024-03-13 09:12:16,069 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-13 09:12:16,069 INFO] Parsed 2 corpora from -data.
[2024-03-13 09:12:16,069 INFO] Loading checkpoint from tg-pt-both/models/tg-pt-both_01_step_3200.pt
[2024-03-13 09:12:16,138 INFO] Building model...
[2024-03-13 09:12:16,194 INFO] Switching model to float32 for amp/apex_amp
[2024-03-13 09:12:16,194 INFO] Non quantized layer compute is fp32
[2024-03-13 09:12:18,495 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-13 09:12:18,495 INFO] encoder: 8952800
[2024-03-13 09:12:18,495 INFO] decoder: 16687344
[2024-03-13 09:12:18,495 INFO] * number of parameters: 25640144
[2024-03-13 09:12:18,496 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 09:12:18,496 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 09:12:18,496 INFO]  * src vocab size = 17816
[2024-03-13 09:12:18,496 INFO]  * tgt vocab size = 14144
[2024-03-13 09:12:18,497 INFO] Starting training on GPU: [0]
[2024-03-13 09:12:18,497 INFO] Start training loop and validate every 200 steps...
[2024-03-13 09:12:18,497 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-13 09:12:25,305 INFO] Step 3250/ 8200; acc: 9.9; ppl: 104476.6; xent: 11.6; lr: 1.00000; sents:    2366; bsz:  569/ 497/47; 4182/3652 tok/s;      7 sec;
[2024-03-13 09:12:27,804 INFO] Step 3300/ 8200; acc: 8.9; ppl: 19844.9; xent: 9.9; lr: 1.00000; sents:    2369; bsz:  590/ 512/47; 11795/10235 tok/s;      9 sec;
[2024-03-13 09:12:30,667 INFO] Step 3350/ 8200; acc: 11.7; ppl: 4586.4; xent: 8.4; lr: 1.00000; sents:    2267; bsz:  560/ 485/45; 9780/8467 tok/s;     12 sec;
[2024-03-13 09:12:33,985 INFO] Step 3400/ 8200; acc: 14.6; ppl: 989.7; xent: 6.9; lr: 1.00000; sents:    2365; bsz:  563/ 489/47; 8479/7365 tok/s;     15 sec;
[2024-03-13 09:12:37,476 INFO] valid stats calculation
                           took: 3.4900119304656982 s.
[2024-03-13 09:12:37,476 INFO] Train perplexity: 10045.4
[2024-03-13 09:12:37,476 INFO] Train accuracy: 11.2473
[2024-03-13 09:12:37,476 INFO] Sentences processed: 9367
[2024-03-13 09:12:37,476 INFO] Average bsz:  570/ 496/47
[2024-03-13 09:12:37,476 INFO] Validation perplexity: 609.262
[2024-03-13 09:12:37,476 INFO] Validation accuracy: 14.3602
[2024-03-13 09:12:37,477 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_3400.pt
[2024-03-13 09:12:41,088 INFO] Step 3450/ 8200; acc: 16.6; ppl: 407.3; xent: 6.0; lr: 1.00000; sents:    2246; bsz:  570/ 493/45; 4012/3473 tok/s;     23 sec;
[2024-03-13 09:12:43,835 INFO] Step 3500/ 8200; acc: 20.8; ppl: 201.7; xent: 5.3; lr: 1.00000; sents:    2372; bsz:  566/ 491/47; 10300/8935 tok/s;     25 sec;
[2024-03-13 09:12:46,399 INFO] Step 3550/ 8200; acc: 25.3; ppl: 113.3; xent: 4.7; lr: 1.00000; sents:    2378; bsz:  568/ 494/48; 11068/9640 tok/s;     28 sec;
[2024-03-13 09:12:49,838 INFO] Step 3600/ 8200; acc: 27.7; ppl:  82.2; xent: 4.4; lr: 1.00000; sents:    2384; bsz:  587/ 510/48; 8540/7418 tok/s;     31 sec;
[2024-03-13 09:12:53,268 INFO] valid stats calculation
                           took: 3.4297573566436768 s.
[2024-03-13 09:12:53,268 INFO] Train perplexity: 1284.22
[2024-03-13 09:12:53,268 INFO] Train accuracy: 16.9548
[2024-03-13 09:12:53,268 INFO] Sentences processed: 18747
[2024-03-13 09:12:53,268 INFO] Average bsz:  572/ 496/47
[2024-03-13 09:12:53,269 INFO] Validation perplexity: 260.75
[2024-03-13 09:12:53,269 INFO] Validation accuracy: 20.8985
[2024-03-13 09:12:53,270 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_3600.pt
[2024-03-13 09:12:56,792 INFO] Step 3650/ 8200; acc: 30.3; ppl:  57.7; xent: 4.1; lr: 1.00000; sents:    2277; bsz:  561/ 487/46; 4036/3500 tok/s;     38 sec;
[2024-03-13 09:12:59,727 INFO] Step 3700/ 8200; acc: 34.4; ppl:  41.0; xent: 3.7; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 9598/8334 tok/s;     41 sec;
[2024-03-13 09:13:02,152 INFO] Step 3750/ 8200; acc: 35.9; ppl:  34.4; xent: 3.5; lr: 1.00000; sents:    2258; bsz:  569/ 490/45; 11722/10097 tok/s;     44 sec;
[2024-03-13 09:13:05,653 INFO] Step 3800/ 8200; acc: 39.3; ppl:  24.2; xent: 3.2; lr: 1.00000; sents:    2366; bsz:  562/ 489/47; 8030/6987 tok/s;     47 sec;
[2024-03-13 09:13:09,100 INFO] valid stats calculation
                           took: 3.445786952972412 s.
[2024-03-13 09:13:09,100 INFO] Train perplexity: 399.977
[2024-03-13 09:13:09,100 INFO] Train accuracy: 22.9023
[2024-03-13 09:13:09,100 INFO] Sentences processed: 28023
[2024-03-13 09:13:09,100 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:13:09,100 INFO] Validation perplexity: 237.755
[2024-03-13 09:13:09,100 INFO] Validation accuracy: 26.073
[2024-03-13 09:13:09,101 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_3800.pt
[2024-03-13 09:13:12,720 INFO] Step 3850/ 8200; acc: 40.4; ppl:  22.0; xent: 3.1; lr: 1.00000; sents:    2367; bsz:  587/ 513/47; 4154/3627 tok/s;     54 sec;
[2024-03-13 09:13:15,914 INFO] Step 3900/ 8200; acc: 42.8; ppl:  17.6; xent: 2.9; lr: 1.00000; sents:    2268; bsz:  567/ 491/45; 8875/7688 tok/s;     57 sec;
[2024-03-13 09:13:18,276 INFO] Step 3950/ 8200; acc: 44.9; ppl:  14.7; xent: 2.7; lr: 1.00000; sents:    2367; bsz:  567/ 499/47; 12013/10559 tok/s;     60 sec;
[2024-03-13 09:13:21,519 INFO] Step 4000/ 8200; acc: 47.6; ppl:  12.1; xent: 2.5; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 8829/7652 tok/s;     63 sec;
[2024-03-13 09:13:24,972 INFO] valid stats calculation
                           took: 3.453066825866699 s.
[2024-03-13 09:13:24,972 INFO] Train perplexity: 178.22
[2024-03-13 09:13:24,972 INFO] Train accuracy: 28.196
[2024-03-13 09:13:24,973 INFO] Sentences processed: 37390
[2024-03-13 09:13:24,973 INFO] Average bsz:  570/ 495/47
[2024-03-13 09:13:24,973 INFO] Validation perplexity: 402.764
[2024-03-13 09:13:24,973 INFO] Validation accuracy: 26.6747
[2024-03-13 09:13:24,974 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_4000.pt
[2024-03-13 09:13:28,623 INFO] Step 4050/ 8200; acc: 50.3; ppl:  10.0; xent: 2.3; lr: 1.00000; sents:    2372; bsz:  563/ 490/47; 3964/3448 tok/s;     70 sec;
[2024-03-13 09:13:31,999 INFO] Step 4100/ 8200; acc: 51.2; ppl:   8.9; xent: 2.2; lr: 1.00000; sents:    2268; bsz:  557/ 483/45; 8251/7147 tok/s;     74 sec;
[2024-03-13 09:13:34,475 INFO] Step 4150/ 8200; acc: 53.2; ppl:   8.0; xent: 2.1; lr: 1.00000; sents:    2279; bsz:  563/ 487/46; 11366/9827 tok/s;     76 sec;
[2024-03-13 09:13:37,716 INFO] Step 4200/ 8200; acc: 55.3; ppl:   6.9; xent: 1.9; lr: 1.00000; sents:    2381; bsz:  582/ 506/48; 8980/7811 tok/s;     79 sec;
[2024-03-13 09:13:41,174 INFO] valid stats calculation
                           took: 3.458178997039795 s.
[2024-03-13 09:13:41,175 INFO] Train perplexity: 97.0814
[2024-03-13 09:13:41,175 INFO] Train accuracy: 33.0314
[2024-03-13 09:13:41,175 INFO] Sentences processed: 46690
[2024-03-13 09:13:41,175 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:13:41,175 INFO] Validation perplexity: 472.138
[2024-03-13 09:13:41,175 INFO] Validation accuracy: 26.6346
[2024-03-13 09:13:41,176 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_4200.pt
[2024-03-13 09:13:44,861 INFO] Step 4250/ 8200; acc: 57.9; ppl:   5.9; xent: 1.8; lr: 1.00000; sents:    2376; bsz:  564/ 493/48; 3950/3450 tok/s;     86 sec;
[2024-03-13 09:13:48,213 INFO] Step 4300/ 8200; acc: 59.3; ppl:   5.5; xent: 1.7; lr: 1.00000; sents:    2275; bsz:  561/ 484/46; 8375/7226 tok/s;     90 sec;
[2024-03-13 09:13:50,632 INFO] Step 4350/ 8200; acc: 60.9; ppl:   4.9; xent: 1.6; lr: 1.00000; sents:    2371; bsz:  578/ 498/47; 11950/10291 tok/s;     92 sec;
[2024-03-13 09:13:53,665 INFO] Step 4400/ 8200; acc: 62.5; ppl:   4.5; xent: 1.5; lr: 1.00000; sents:    2366; bsz:  563/ 491/47; 9286/8089 tok/s;     95 sec;
[2024-03-13 09:13:57,126 INFO] valid stats calculation
                           took: 3.4603207111358643 s.
[2024-03-13 09:13:57,127 INFO] Train perplexity: 59.7083
[2024-03-13 09:13:57,127 INFO] Train accuracy: 37.5264
[2024-03-13 09:13:57,127 INFO] Sentences processed: 56078
[2024-03-13 09:13:57,127 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:13:57,127 INFO] Validation perplexity: 639.202
[2024-03-13 09:13:57,127 INFO] Validation accuracy: 29.2018
[2024-03-13 09:13:57,128 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_4400.pt
[2024-03-13 09:14:00,759 INFO] Step 4450/ 8200; acc: 63.7; ppl:   4.3; xent: 1.5; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 3965/3439 tok/s;    102 sec;
[2024-03-13 09:14:04,134 INFO] Step 4500/ 8200; acc: 65.0; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    2362; bsz:  563/ 489/47; 8345/7250 tok/s;    106 sec;
[2024-03-13 09:14:06,725 INFO] Step 4550/ 8200; acc: 67.2; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    2369; bsz:  586/ 507/47; 11313/9782 tok/s;    108 sec;
[2024-03-13 09:14:09,490 INFO] Step 4600/ 8200; acc: 67.8; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    2267; bsz:  561/ 483/45; 10144/8738 tok/s;    111 sec;
[2024-03-13 09:14:12,957 INFO] valid stats calculation
                           took: 3.4660770893096924 s.
[2024-03-13 09:14:12,958 INFO] Train perplexity: 40.3196
[2024-03-13 09:14:12,958 INFO] Train accuracy: 41.5683
[2024-03-13 09:14:12,958 INFO] Sentences processed: 65344
[2024-03-13 09:14:12,958 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:14:12,958 INFO] Validation perplexity: 742.343
[2024-03-13 09:14:12,958 INFO] Validation accuracy: 27.9182
[2024-03-13 09:14:12,959 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_4600.pt
[2024-03-13 09:14:16,533 INFO] Step 4650/ 8200; acc: 69.5; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    2472; bsz:  583/ 506/49; 4137/3592 tok/s;    118 sec;
[2024-03-13 09:14:20,104 INFO] Step 4700/ 8200; acc: 70.4; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    2271; bsz:  562/ 485/45; 7867/6790 tok/s;    122 sec;
[2024-03-13 09:14:22,929 INFO] Step 4750/ 8200; acc: 70.9; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    2375; bsz:  583/ 505/48; 10321/8933 tok/s;    124 sec;
[2024-03-13 09:14:25,533 INFO] Step 4800/ 8200; acc: 73.5; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    2280; bsz:  559/ 486/46; 10733/9322 tok/s;    127 sec;
[2024-03-13 09:14:28,987 INFO] valid stats calculation
                           took: 3.453023910522461 s.
[2024-03-13 09:14:28,987 INFO] Train perplexity: 29.0356
[2024-03-13 09:14:28,987 INFO] Train accuracy: 45.2621
[2024-03-13 09:14:28,987 INFO] Sentences processed: 74742
[2024-03-13 09:14:28,987 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:14:28,988 INFO] Validation perplexity: 881.042
[2024-03-13 09:14:28,988 INFO] Validation accuracy: 29.4424
[2024-03-13 09:14:28,989 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_4800.pt
[2024-03-13 09:14:32,496 INFO] Step 4850/ 8200; acc: 74.3; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2376; bsz:  564/ 490/48; 4048/3518 tok/s;    134 sec;
[2024-03-13 09:14:36,010 INFO] Step 4900/ 8200; acc: 76.0; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2280; bsz:  563/ 487/46; 8011/6926 tok/s;    138 sec;
[2024-03-13 09:14:39,113 INFO] Step 4950/ 8200; acc: 76.0; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2464; bsz:  595/ 521/49; 9584/8406 tok/s;    141 sec;
[2024-03-13 09:14:41,561 INFO] Step 5000/ 8200; acc: 77.4; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2270; bsz:  563/ 487/45; 11499/9951 tok/s;    143 sec;
[2024-03-13 09:14:44,999 INFO] valid stats calculation
                           took: 3.437927722930908 s.
[2024-03-13 09:14:44,999 INFO] Train perplexity: 21.959
[2024-03-13 09:14:45,000 INFO] Train accuracy: 48.6847
[2024-03-13 09:14:45,000 INFO] Sentences processed: 84132
[2024-03-13 09:14:45,000 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:14:45,000 INFO] Validation perplexity: 1466.13
[2024-03-13 09:14:45,000 INFO] Validation accuracy: 30.4452
[2024-03-13 09:14:45,001 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_5000.pt
[2024-03-13 09:14:48,668 INFO] Step 5050/ 8200; acc: 77.6; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2369; bsz:  587/ 508/47; 4129/3572 tok/s;    150 sec;
[2024-03-13 09:14:52,111 INFO] Step 5100/ 8200; acc: 79.8; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2242; bsz:  527/ 458/45; 7648/6648 tok/s;    154 sec;
[2024-03-13 09:14:55,378 INFO] Step 5150/ 8200; acc: 79.3; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2365; bsz:  585/ 508/47; 8959/7773 tok/s;    157 sec;
[2024-03-13 09:14:57,731 INFO] Step 5200/ 8200; acc: 81.0; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2367; bsz:  561/ 488/47; 11916/10364 tok/s;    159 sec;
[2024-03-13 09:15:01,244 INFO] valid stats calculation
                           took: 3.5122814178466797 s.
[2024-03-13 09:15:01,245 INFO] Train perplexity: 17.3693
[2024-03-13 09:15:01,245 INFO] Train accuracy: 51.7337
[2024-03-13 09:15:01,245 INFO] Sentences processed: 93475
[2024-03-13 09:15:01,245 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:15:01,245 INFO] Validation perplexity: 1637.26
[2024-03-13 09:15:01,245 INFO] Validation accuracy: 29.0012
[2024-03-13 09:15:01,247 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_5200.pt
[2024-03-13 09:15:05,255 INFO] Step 5250/ 8200; acc: 80.9; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2268; bsz:  576/ 498/45; 3830/3308 tok/s;    167 sec;
[2024-03-13 09:15:08,793 INFO] Step 5300/ 8200; acc: 82.3; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2379; bsz:  568/ 494/48; 8026/6988 tok/s;    170 sec;
[2024-03-13 09:15:12,211 INFO] Step 5350/ 8200; acc: 83.5; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2383; bsz:  567/ 495/48; 8302/7240 tok/s;    174 sec;
[2024-03-13 09:15:14,648 INFO] Step 5400/ 8200; acc: 83.5; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2381; bsz:  582/ 504/48; 11936/10341 tok/s;    176 sec;
[2024-03-13 09:15:18,158 INFO] valid stats calculation
                           took: 3.509565591812134 s.
[2024-03-13 09:15:18,158 INFO] Train perplexity: 14.1417
[2024-03-13 09:15:18,158 INFO] Train accuracy: 54.557
[2024-03-13 09:15:18,158 INFO] Sentences processed: 102886
[2024-03-13 09:15:18,158 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:15:18,158 INFO] Validation perplexity: 2228.42
[2024-03-13 09:15:18,158 INFO] Validation accuracy: 29.2419
[2024-03-13 09:15:18,160 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_5400.pt
[2024-03-13 09:15:21,842 INFO] Step 5450/ 8200; acc: 84.4; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2261; bsz:  552/ 476/45; 3834/3312 tok/s;    183 sec;
[2024-03-13 09:15:25,462 INFO] Step 5500/ 8200; acc: 84.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2372; bsz:  586/ 513/47; 8099/7090 tok/s;    187 sec;
[2024-03-13 09:15:29,030 INFO] Step 5550/ 8200; acc: 85.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2270; bsz:  548/ 476/45; 7673/6668 tok/s;    191 sec;
[2024-03-13 09:15:31,461 INFO] Step 5600/ 8200; acc: 85.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2367; bsz:  588/ 515/47; 12090/10586 tok/s;    193 sec;
[2024-03-13 09:15:34,972 INFO] valid stats calculation
                           took: 3.5104146003723145 s.
[2024-03-13 09:15:34,973 INFO] Train perplexity: 11.8361
[2024-03-13 09:15:34,973 INFO] Train accuracy: 57.0922
[2024-03-13 09:15:34,973 INFO] Sentences processed: 112156
[2024-03-13 09:15:34,973 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:15:34,973 INFO] Validation perplexity: 3202.72
[2024-03-13 09:15:34,973 INFO] Validation accuracy: 27.0357
[2024-03-13 09:15:34,974 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_5600.pt
[2024-03-13 09:15:38,599 INFO] Step 5650/ 8200; acc: 86.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2260; bsz:  555/ 480/45; 3891/3366 tok/s;    200 sec;
[2024-03-13 09:15:42,111 INFO] Step 5700/ 8200; acc: 86.8; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2367; bsz:  559/ 485/47; 7963/6904 tok/s;    204 sec;
[2024-03-13 09:15:45,696 INFO] Step 5750/ 8200; acc: 87.0; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 7996/6922 tok/s;    207 sec;
[2024-03-13 09:15:48,353 INFO] Step 5800/ 8200; acc: 87.2; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2373; bsz:  567/ 495/47; 10661/9323 tok/s;    210 sec;
[2024-03-13 09:15:51,879 INFO] valid stats calculation
                           took: 3.525453567504883 s.
[2024-03-13 09:15:51,879 INFO] Train perplexity: 10.1563
[2024-03-13 09:15:51,879 INFO] Train accuracy: 59.3548
[2024-03-13 09:15:51,880 INFO] Sentences processed: 121521
[2024-03-13 09:15:51,880 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:15:51,880 INFO] Validation perplexity: 3560
[2024-03-13 09:15:51,880 INFO] Validation accuracy: 28.8006
[2024-03-13 09:15:51,881 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_5800.pt
[2024-03-13 09:15:55,664 INFO] Step 5850/ 8200; acc: 87.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2371; bsz:  580/ 506/47; 3968/3458 tok/s;    217 sec;
[2024-03-13 09:15:59,230 INFO] Step 5900/ 8200; acc: 87.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2279; bsz:  562/ 486/46; 7886/6811 tok/s;    221 sec;
[2024-03-13 09:16:02,742 INFO] Step 5950/ 8200; acc: 88.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2381; bsz:  566/ 491/48; 8061/6994 tok/s;    224 sec;
[2024-03-13 09:16:05,478 INFO] Step 6000/ 8200; acc: 88.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2276; bsz:  561/ 485/46; 10259/8867 tok/s;    227 sec;
[2024-03-13 09:16:09,067 INFO] valid stats calculation
                           took: 3.5890231132507324 s.
[2024-03-13 09:16:09,068 INFO] Train perplexity: 8.86695
[2024-03-13 09:16:09,068 INFO] Train accuracy: 61.396
[2024-03-13 09:16:09,068 INFO] Sentences processed: 130828
[2024-03-13 09:16:09,068 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:16:09,068 INFO] Validation perplexity: 3890.77
[2024-03-13 09:16:09,068 INFO] Validation accuracy: 29.0012
[2024-03-13 09:16:09,069 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_6000.pt
[2024-03-13 09:16:12,727 INFO] Step 6050/ 8200; acc: 88.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  579/ 499/48; 3994/3439 tok/s;    234 sec;
[2024-03-13 09:16:16,416 INFO] Step 6100/ 8200; acc: 89.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 7944/6885 tok/s;    238 sec;
[2024-03-13 09:16:20,056 INFO] Step 6150/ 8200; acc: 89.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2268; bsz:  563/ 487/45; 7728/6694 tok/s;    242 sec;
[2024-03-13 09:16:22,772 INFO] Step 6200/ 8200; acc: 89.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 10390/9029 tok/s;    244 sec;
[2024-03-13 09:16:26,329 INFO] valid stats calculation
                           took: 3.555987596511841 s.
[2024-03-13 09:16:26,329 INFO] Train perplexity: 7.85477
[2024-03-13 09:16:26,329 INFO] Train accuracy: 63.2599
[2024-03-13 09:16:26,329 INFO] Sentences processed: 140208
[2024-03-13 09:16:26,329 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:16:26,329 INFO] Validation perplexity: 4269
[2024-03-13 09:16:26,329 INFO] Validation accuracy: 27.7978
[2024-03-13 09:16:26,330 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_6200.pt
[2024-03-13 09:16:30,014 INFO] Step 6250/ 8200; acc: 89.9; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2362; bsz:  579/ 499/47; 3995/3445 tok/s;    252 sec;
[2024-03-13 09:16:33,499 INFO] Step 6300/ 8200; acc: 89.8; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2267; bsz:  561/ 484/45; 8052/6947 tok/s;    255 sec;
[2024-03-13 09:16:37,030 INFO] Step 6350/ 8200; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2369; bsz:  563/ 489/47; 7978/6924 tok/s;    259 sec;
[2024-03-13 09:16:40,047 INFO] Step 6400/ 8200; acc: 90.5; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  566/ 494/47; 9380/8185 tok/s;    262 sec;
[2024-03-13 09:16:43,612 INFO] valid stats calculation
                           took: 3.564696788787842 s.
[2024-03-13 09:16:43,612 INFO] Train perplexity: 7.06059
[2024-03-13 09:16:43,612 INFO] Train accuracy: 64.9301
[2024-03-13 09:16:43,612 INFO] Sentences processed: 149578
[2024-03-13 09:16:43,612 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:16:43,612 INFO] Validation perplexity: 5386.09
[2024-03-13 09:16:43,612 INFO] Validation accuracy: 27.7978
[2024-03-13 09:16:43,614 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_6400.pt
[2024-03-13 09:16:47,301 INFO] Step 6450/ 8200; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2371; bsz:  583/ 503/47; 4015/3466 tok/s;    269 sec;
[2024-03-13 09:16:50,834 INFO] Step 6500/ 8200; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2273; bsz:  558/ 485/45; 7903/6862 tok/s;    272 sec;
[2024-03-13 09:16:54,390 INFO] Step 6550/ 8200; acc: 91.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2279; bsz:  561/ 487/46; 7895/6849 tok/s;    276 sec;
[2024-03-13 09:16:57,656 INFO] Step 6600/ 8200; acc: 91.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2378; bsz:  570/ 496/48; 8720/7594 tok/s;    279 sec;
[2024-03-13 09:17:01,245 INFO] valid stats calculation
                           took: 3.588207960128784 s.
[2024-03-13 09:17:01,245 INFO] Train perplexity: 6.41374
[2024-03-13 09:17:01,245 INFO] Train accuracy: 66.4525
[2024-03-13 09:17:01,245 INFO] Sentences processed: 158879
[2024-03-13 09:17:01,245 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:17:01,245 INFO] Validation perplexity: 4991.37
[2024-03-13 09:17:01,245 INFO] Validation accuracy: 29.7232
[2024-03-13 09:17:01,246 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_6600.pt
[2024-03-13 09:17:04,877 INFO] Step 6650/ 8200; acc: 91.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  592/ 515/48; 4101/3564 tok/s;    286 sec;
[2024-03-13 09:17:08,509 INFO] Step 6700/ 8200; acc: 91.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2368; bsz:  565/ 491/47; 7778/6761 tok/s;    290 sec;
[2024-03-13 09:17:12,169 INFO] Step 6750/ 8200; acc: 91.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  586/ 506/47; 8000/6913 tok/s;    294 sec;
[2024-03-13 09:17:15,451 INFO] Step 6800/ 8200; acc: 91.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2248; bsz:  551/ 478/45; 8402/7289 tok/s;    297 sec;
[2024-03-13 09:17:19,028 INFO] valid stats calculation
                           took: 3.5770533084869385 s.
[2024-03-13 09:17:19,029 INFO] Train perplexity: 5.87657
[2024-03-13 09:17:19,029 INFO] Train accuracy: 67.8466
[2024-03-13 09:17:19,029 INFO] Sentences processed: 168242
[2024-03-13 09:17:19,029 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:17:19,029 INFO] Validation perplexity: 5536.78
[2024-03-13 09:17:19,029 INFO] Validation accuracy: 29.282
[2024-03-13 09:17:19,030 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_6800.pt
[2024-03-13 09:17:22,679 INFO] Step 6850/ 8200; acc: 91.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2249; bsz:  551/ 478/45; 3812/3309 tok/s;    304 sec;
[2024-03-13 09:17:26,152 INFO] Step 6900/ 8200; acc: 91.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2365; bsz:  561/ 486/47; 8077/6999 tok/s;    308 sec;
[2024-03-13 09:17:29,812 INFO] Step 6950/ 8200; acc: 92.1; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  582/ 505/47; 7957/6901 tok/s;    311 sec;
[2024-03-13 09:17:33,257 INFO] Step 7000/ 8200; acc: 92.1; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  587/ 513/48; 8517/7448 tok/s;    315 sec;
[2024-03-13 09:17:36,874 INFO] valid stats calculation
                           took: 3.616671562194824 s.
[2024-03-13 09:17:36,875 INFO] Train perplexity: 5.43151
[2024-03-13 09:17:36,875 INFO] Train accuracy: 69.1177
[2024-03-13 09:17:36,875 INFO] Sentences processed: 177605
[2024-03-13 09:17:36,875 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:17:36,875 INFO] Validation perplexity: 6811.49
[2024-03-13 09:17:36,875 INFO] Validation accuracy: 28.6803
[2024-03-13 09:17:36,876 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_7000.pt
[2024-03-13 09:17:40,547 INFO] Step 7050/ 8200; acc: 92.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2272; bsz:  539/ 467/45; 3697/3205 tok/s;    322 sec;
[2024-03-13 09:17:44,199 INFO] Step 7100/ 8200; acc: 92.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  582/ 505/48; 7962/6909 tok/s;    326 sec;
[2024-03-13 09:17:47,814 INFO] Step 7150/ 8200; acc: 91.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2277; bsz:  566/ 489/46; 7826/6765 tok/s;    329 sec;
[2024-03-13 09:17:51,258 INFO] Step 7200/ 8200; acc: 92.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2474; bsz:  583/ 514/49; 8466/7467 tok/s;    333 sec;
[2024-03-13 09:17:54,954 INFO] valid stats calculation
                           took: 3.695342540740967 s.
[2024-03-13 09:17:54,955 INFO] Train perplexity: 5.05782
[2024-03-13 09:17:54,955 INFO] Train accuracy: 70.2781
[2024-03-13 09:17:54,955 INFO] Sentences processed: 187009
[2024-03-13 09:17:54,955 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:17:54,955 INFO] Validation perplexity: 7282.62
[2024-03-13 09:17:54,955 INFO] Validation accuracy: 28.7204
[2024-03-13 09:17:54,956 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_7200.pt
[2024-03-13 09:17:58,692 INFO] Step 7250/ 8200; acc: 92.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2275; bsz:  569/ 494/46; 3831/3322 tok/s;    340 sec;
[2024-03-13 09:18:02,249 INFO] Step 7300/ 8200; acc: 92.8; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2264; bsz:  559/ 483/45; 7859/6794 tok/s;    344 sec;
[2024-03-13 09:18:05,901 INFO] Step 7350/ 8200; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2366; bsz:  575/ 495/47; 7869/6784 tok/s;    347 sec;
[2024-03-13 09:18:09,325 INFO] Step 7400/ 8200; acc: 93.2; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2364; bsz:  558/ 487/47; 8149/7107 tok/s;    351 sec;
[2024-03-13 09:18:12,842 INFO] valid stats calculation
                           took: 3.516824245452881 s.
[2024-03-13 09:18:12,842 INFO] Train perplexity: 4.73941
[2024-03-13 09:18:12,842 INFO] Train accuracy: 71.3497
[2024-03-13 09:18:12,843 INFO] Sentences processed: 196278
[2024-03-13 09:18:12,843 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:18:12,843 INFO] Validation perplexity: 8598.8
[2024-03-13 09:18:12,843 INFO] Validation accuracy: 29.6029
[2024-03-13 09:18:12,844 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_7400.pt
[2024-03-13 09:18:16,466 INFO] Step 7450/ 8200; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2268; bsz:  558/ 481/45; 3905/3371 tok/s;    358 sec;
[2024-03-13 09:18:20,134 INFO] Step 7500/ 8200; acc: 93.2; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  581/ 506/47; 7925/6904 tok/s;    362 sec;
[2024-03-13 09:18:23,817 INFO] Step 7550/ 8200; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2373; bsz:  566/ 495/47; 7686/6723 tok/s;    365 sec;
[2024-03-13 09:18:27,370 INFO] Step 7600/ 8200; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2372; bsz:  565/ 491/47; 7956/6909 tok/s;    369 sec;
[2024-03-13 09:18:30,931 INFO] valid stats calculation
                           took: 3.5611395835876465 s.
[2024-03-13 09:18:30,932 INFO] Train perplexity: 4.46503
[2024-03-13 09:18:30,932 INFO] Train accuracy: 72.3358
[2024-03-13 09:18:30,932 INFO] Sentences processed: 205658
[2024-03-13 09:18:30,932 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:18:30,932 INFO] Validation perplexity: 9130.11
[2024-03-13 09:18:30,932 INFO] Validation accuracy: 28.8006
[2024-03-13 09:18:30,933 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_7600.pt
[2024-03-13 09:18:34,444 INFO] Step 7650/ 8200; acc: 93.2; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2375; bsz:  580/ 500/48; 4102/3532 tok/s;    376 sec;
[2024-03-13 09:18:37,994 INFO] Step 7700/ 8200; acc: 93.3; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2281; bsz:  559/ 484/46; 7868/6816 tok/s;    379 sec;
[2024-03-13 09:18:41,602 INFO] Step 7750/ 8200; acc: 93.3; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2276; bsz:  565/ 488/46; 7831/6770 tok/s;    383 sec;
[2024-03-13 09:18:45,106 INFO] Step 7800/ 8200; acc: 93.7; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2377; bsz:  567/ 492/48; 8097/7021 tok/s;    387 sec;
[2024-03-13 09:18:48,688 INFO] valid stats calculation
                           took: 3.5815048217773438 s.
[2024-03-13 09:18:48,688 INFO] Train perplexity: 4.22715
[2024-03-13 09:18:48,688 INFO] Train accuracy: 73.2461
[2024-03-13 09:18:48,688 INFO] Sentences processed: 214967
[2024-03-13 09:18:48,688 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:18:48,688 INFO] Validation perplexity: 9185.29
[2024-03-13 09:18:48,688 INFO] Validation accuracy: 29.0012
[2024-03-13 09:18:48,690 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_7800.pt
[2024-03-13 09:18:52,077 INFO] Step 7850/ 8200; acc: 93.2; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 4200/3643 tok/s;    394 sec;
[2024-03-13 09:18:55,574 INFO] Step 7900/ 8200; acc: 93.5; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2366; bsz:  563/ 489/47; 8047/6996 tok/s;    397 sec;
[2024-03-13 09:18:59,133 INFO] Step 7950/ 8200; acc: 94.0; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2263; bsz:  560/ 483/45; 7862/6784 tok/s;    401 sec;
[2024-03-13 09:19:02,664 INFO] Step 8000/ 8200; acc: 93.7; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2365; bsz:  580/ 500/47; 8211/7074 tok/s;    404 sec;
[2024-03-13 09:19:06,250 INFO] valid stats calculation
                           took: 3.5861446857452393 s.
[2024-03-13 09:19:06,251 INFO] Train perplexity: 4.01692
[2024-03-13 09:19:06,251 INFO] Train accuracy: 74.0953
[2024-03-13 09:19:06,251 INFO] Sentences processed: 224332
[2024-03-13 09:19:06,251 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:19:06,251 INFO] Validation perplexity: 10537.9
[2024-03-13 09:19:06,251 INFO] Validation accuracy: 29.7232
[2024-03-13 09:19:06,252 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_8000.pt
[2024-03-13 09:19:09,412 INFO] Step 8050/ 8200; acc: 93.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  586/ 507/47; 4339/3756 tok/s;    411 sec;
[2024-03-13 09:19:12,937 INFO] Step 8100/ 8200; acc: 94.0; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2267; bsz:  539/ 472/45; 7642/6691 tok/s;    414 sec;
[2024-03-13 09:19:16,480 INFO] Step 8150/ 8200; acc: 93.9; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2372; bsz:  582/ 503/47; 8211/7105 tok/s;    418 sec;
[2024-03-13 09:19:20,078 INFO] Step 8200/ 8200; acc: 94.0; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2371; bsz:  567/ 494/47; 7883/6861 tok/s;    422 sec;
[2024-03-13 09:19:23,552 INFO] valid stats calculation
                           took: 3.4728009700775146 s.
[2024-03-13 09:19:23,552 INFO] Train perplexity: 3.83193
[2024-03-13 09:19:23,552 INFO] Train accuracy: 74.8879
[2024-03-13 09:19:23,552 INFO] Sentences processed: 233709
[2024-03-13 09:19:23,552 INFO] Average bsz:  569/ 494/47
[2024-03-13 09:19:23,552 INFO] Validation perplexity: 11796.3
[2024-03-13 09:19:23,552 INFO] Validation accuracy: 28.6001
[2024-03-13 09:19:23,554 INFO] Saving checkpoint tg-ft-both/tg-ft-both_3200_01_step_8200.pt
