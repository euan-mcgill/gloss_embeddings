[2024-03-11 10:09:23,639 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-11 10:09:23,639 INFO] Parsed 2 corpora from -data.
[2024-03-11 10:09:23,639 INFO] Get special vocabs from Transforms: {'src': [], 'tgt': []}.
[2024-03-11 10:09:23,676 INFO] The first 10 tokens of the vocabs are:['<unk>', '<blank>', '<s>', '</s>', '.', 'the', ',', 'of', 'to', 'is']
[2024-03-11 10:09:23,676 INFO] The decoder start token is: <s>
[2024-03-11 10:09:23,676 INFO] Building model...
[2024-03-11 10:09:24,003 INFO] Switching model to float32 for amp/apex_amp
[2024-03-11 10:09:24,003 INFO] Non quantized layer compute is fp32
[2024-03-11 10:09:25,980 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(500, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(1000, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-11 10:09:25,981 INFO] encoder: 12916000
[2024-03-11 10:09:25,981 INFO] decoder: 19916144
[2024-03-11 10:09:25,981 INFO] * number of parameters: 32832144
[2024-03-11 10:09:25,981 INFO] Trainable parameters = {'torch.float32': 32832144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-11 10:09:25,981 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-11 10:09:25,981 INFO]  * src vocab size = 17816
[2024-03-11 10:09:25,981 INFO]  * tgt vocab size = 14144
[2024-03-11 10:09:25,982 INFO] Starting training on GPU: [0]
[2024-03-11 10:09:25,982 INFO] Start training loop and validate every 200 steps...
[2024-03-11 10:09:25,982 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-11 10:09:42,855 INFO] Step 50/10000; acc: 5.2; ppl: 120460.5; xent: 11.7; lr: 1.00000; sents:    3200; bsz:  988/ 859/64; 2929/2545 tok/s;     17 sec;
[2024-03-11 10:09:43,994 INFO] Step 100/10000; acc: 6.7; ppl: 7404.8; xent: 8.9; lr: 1.00000; sents:    3200; bsz:  804/ 687/64; 35277/30165 tok/s;     18 sec;
[2024-03-11 10:09:45,090 INFO] Step 150/10000; acc: 7.4; ppl: 2046.6; xent: 7.6; lr: 1.00000; sents:    3200; bsz:  808/ 676/64; 36910/30864 tok/s;     19 sec;
[2024-03-11 10:09:46,281 INFO] Step 200/10000; acc: 7.1; ppl: 1247.6; xent: 7.1; lr: 1.00000; sents:    3200; bsz:  902/ 777/64; 37868/32594 tok/s;     20 sec;
[2024-03-11 10:09:49,882 INFO] valid stats calculation
                           took: 3.599792003631592 s.
[2024-03-11 10:09:49,882 INFO] Train perplexity: 7765.63
[2024-03-11 10:09:49,882 INFO] Train accuracy: 6.52728
[2024-03-11 10:09:49,882 INFO] Sentences processed: 12800
[2024-03-11 10:09:49,882 INFO] Average bsz:  876/ 750/64
[2024-03-11 10:09:49,882 INFO] Validation perplexity: 9051.06
[2024-03-11 10:09:49,882 INFO] Validation accuracy: 10.0682
[2024-03-11 10:09:49,883 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_200.pt
[2024-03-11 10:09:51,220 INFO] Step 250/10000; acc: 8.8; ppl: 869.6; xent: 6.8; lr: 1.00000; sents:    3200; bsz:  859/ 744/64; 8698/7528 tok/s;     25 sec;
[2024-03-11 10:09:52,368 INFO] Step 300/10000; acc: 9.9; ppl: 657.8; xent: 6.5; lr: 1.00000; sents:    3200; bsz:  814/ 741/64; 35462/32289 tok/s;     26 sec;
[2024-03-11 10:09:53,566 INFO] Step 350/10000; acc: 10.6; ppl: 642.9; xent: 6.5; lr: 1.00000; sents:    3200; bsz:  914/ 782/64; 38143/32641 tok/s;     28 sec;
[2024-03-11 10:09:54,643 INFO] Step 400/10000; acc: 12.5; ppl: 538.2; xent: 6.3; lr: 1.00000; sents:    3200; bsz:  783/ 675/64; 36372/31321 tok/s;     29 sec;
[2024-03-11 10:09:58,174 INFO] valid stats calculation
                           took: 3.53076434135437 s.
[2024-03-11 10:09:58,175 INFO] Train perplexity: 2308.26
[2024-03-11 10:09:58,175 INFO] Train accuracy: 8.44284
[2024-03-11 10:09:58,175 INFO] Sentences processed: 25600
[2024-03-11 10:09:58,175 INFO] Average bsz:  859/ 743/64
[2024-03-11 10:09:58,175 INFO] Validation perplexity: 11444.1
[2024-03-11 10:09:58,175 INFO] Validation accuracy: 5.01404
[2024-03-11 10:09:58,176 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_400.pt
[2024-03-11 10:09:59,464 INFO] Step 450/10000; acc: 14.0; ppl: 478.9; xent: 6.2; lr: 1.00000; sents:    3200; bsz:  822/ 707/64; 8529/7331 tok/s;     33 sec;
[2024-03-11 10:10:00,628 INFO] Step 500/10000; acc: 15.0; ppl: 404.5; xent: 6.0; lr: 1.00000; sents:    3200; bsz:  859/ 754/64; 36901/32362 tok/s;     35 sec;
[2024-03-11 10:10:01,735 INFO] Step 550/10000; acc: 16.8; ppl: 371.9; xent: 5.9; lr: 1.00000; sents:    3200; bsz:  820/ 708/64; 37075/31985 tok/s;     36 sec;
[2024-03-11 10:10:02,833 INFO] Step 600/10000; acc: 19.3; ppl: 297.2; xent: 5.7; lr: 1.00000; sents:    3200; bsz:  796/ 713/64; 36251/32458 tok/s;     37 sec;
[2024-03-11 10:10:06,399 INFO] valid stats calculation
                           took: 3.5654077529907227 s.
[2024-03-11 10:10:06,400 INFO] Train perplexity: 1283.43
[2024-03-11 10:10:06,400 INFO] Train accuracy: 10.9936
[2024-03-11 10:10:06,400 INFO] Sentences processed: 38400
[2024-03-11 10:10:06,400 INFO] Average bsz:  848/ 735/64
[2024-03-11 10:10:06,400 INFO] Validation perplexity: 13193.2
[2024-03-11 10:10:06,400 INFO] Validation accuracy: 2.40674
[2024-03-11 10:10:06,402 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_600.pt
[2024-03-11 10:10:08,577 INFO] Step 650/10000; acc: 21.9; ppl: 245.0; xent: 5.5; lr: 1.00000; sents:    3200; bsz:  811/ 706/64; 7057/6147 tok/s;     43 sec;
[2024-03-11 10:10:10,620 INFO] Step 700/10000; acc: 26.2; ppl: 187.7; xent: 5.2; lr: 1.00000; sents:    3200; bsz:  865/ 755/64; 21172/18463 tok/s;     45 sec;
[2024-03-11 10:10:12,694 INFO] Step 750/10000; acc: 35.3; ppl: 107.4; xent: 4.7; lr: 1.00000; sents:    3200; bsz:  799/ 704/64; 19262/16974 tok/s;     47 sec;
[2024-03-11 10:10:14,240 INFO] Step 800/10000; acc: 40.8; ppl:  78.2; xent: 4.4; lr: 1.00000; sents:    3200; bsz:  739/ 664/64; 23886/21485 tok/s;     48 sec;
[2024-03-11 10:10:17,864 INFO] valid stats calculation
                           took: 3.623913288116455 s.
[2024-03-11 10:10:17,865 INFO] Train perplexity: 752.194
[2024-03-11 10:10:17,865 INFO] Train accuracy: 15.8144
[2024-03-11 10:10:17,865 INFO] Sentences processed: 51200
[2024-03-11 10:10:17,865 INFO] Average bsz:  837/ 728/64
[2024-03-11 10:10:17,865 INFO] Validation perplexity: 81996.8
[2024-03-11 10:10:17,865 INFO] Validation accuracy: 6.21741
[2024-03-11 10:10:17,867 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_800.pt
[2024-03-11 10:10:19,842 INFO] Step 850/10000; acc: 47.8; ppl:  45.7; xent: 3.8; lr: 1.00000; sents:    3200; bsz:  728/ 635/64; 6501/5670 tok/s;     54 sec;
[2024-03-11 10:10:21,990 INFO] Step 900/10000; acc: 51.3; ppl:  33.4; xent: 3.5; lr: 1.00000; sents:    3200; bsz:  887/ 783/64; 20647/18234 tok/s;     56 sec;
[2024-03-11 10:10:24,011 INFO] Step 950/10000; acc: 58.1; ppl:  20.3; xent: 3.0; lr: 1.00000; sents:    3200; bsz:  858/ 732/64; 21225/18120 tok/s;     58 sec;
[2024-03-11 10:10:26,212 INFO] Step 1000/10000; acc: 61.1; ppl:  16.2; xent: 2.8; lr: 1.00000; sents:    3200; bsz:  950/ 800/64; 21571/18169 tok/s;     60 sec;
[2024-03-11 10:10:29,747 INFO] valid stats calculation
                           took: 3.534336566925049 s.
[2024-03-11 10:10:29,747 INFO] Train perplexity: 380.876
[2024-03-11 10:10:29,748 INFO] Train accuracy: 23.7176
[2024-03-11 10:10:29,748 INFO] Sentences processed: 64000
[2024-03-11 10:10:29,748 INFO] Average bsz:  840/ 730/64
[2024-03-11 10:10:29,748 INFO] Validation perplexity: 373685
[2024-03-11 10:10:29,748 INFO] Validation accuracy: 7.94224
[2024-03-11 10:10:29,749 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_1000.pt
[2024-03-11 10:10:31,959 INFO] Step 1050/10000; acc: 67.9; ppl:   9.9; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  814/ 723/64; 7084/6293 tok/s;     66 sec;
[2024-03-11 10:10:34,198 INFO] Step 1100/10000; acc: 69.6; ppl:   9.3; xent: 2.2; lr: 1.00000; sents:    3200; bsz:  908/ 785/64; 20279/17542 tok/s;     68 sec;
[2024-03-11 10:10:36,285 INFO] Step 1150/10000; acc: 74.4; ppl:   6.2; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  797/ 712/64; 19100/17045 tok/s;     70 sec;
[2024-03-11 10:10:38,290 INFO] Step 1200/10000; acc: 75.4; ppl:   5.8; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  818/ 708/64; 20400/17654 tok/s;     72 sec;
[2024-03-11 10:10:41,830 INFO] valid stats calculation
                           took: 3.539031505584717 s.
[2024-03-11 10:10:41,830 INFO] Train perplexity: 198.193
[2024-03-11 10:10:41,830 INFO] Train accuracy: 31.7389
[2024-03-11 10:10:41,830 INFO] Sentences processed: 76800
[2024-03-11 10:10:41,830 INFO] Average bsz:  839/ 730/64
[2024-03-11 10:10:41,830 INFO] Validation perplexity: 1.62815e+06
[2024-03-11 10:10:41,830 INFO] Validation accuracy: 7.66145
[2024-03-11 10:10:41,832 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_1200.pt
[2024-03-11 10:10:43,509 INFO] Step 1250/10000; acc: 76.5; ppl:   5.3; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  828/ 754/64; 7935/7223 tok/s;     78 sec;
[2024-03-11 10:10:45,743 INFO] Step 1300/10000; acc: 75.7; ppl:   5.9; xent: 1.8; lr: 1.00000; sents:    3200; bsz:  910/ 793/64; 20379/17750 tok/s;     80 sec;
[2024-03-11 10:10:47,854 INFO] Step 1350/10000; acc: 78.1; ppl:   4.8; xent: 1.6; lr: 1.00000; sents:    3200; bsz:  886/ 774/64; 20982/18343 tok/s;     82 sec;
[2024-03-11 10:10:49,976 INFO] Step 1400/10000; acc: 79.0; ppl:   4.5; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  915/ 800/64; 21564/18845 tok/s;     84 sec;
[2024-03-11 10:10:53,450 INFO] valid stats calculation
                           took: 3.4736368656158447 s.
[2024-03-11 10:10:53,451 INFO] Train perplexity: 114.05
[2024-03-11 10:10:53,451 INFO] Train accuracy: 38.6327
[2024-03-11 10:10:53,451 INFO] Sentences processed: 89600
[2024-03-11 10:10:53,451 INFO] Average bsz:  846/ 738/64
[2024-03-11 10:10:53,451 INFO] Validation perplexity: 3.62855e+06
[2024-03-11 10:10:53,451 INFO] Validation accuracy: 7.8219
[2024-03-11 10:10:53,452 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_1400.pt
[2024-03-11 10:10:54,888 INFO] Step 1450/10000; acc: 79.1; ppl:   4.5; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  957/ 792/64; 9748/8060 tok/s;     89 sec;
[2024-03-11 10:10:57,169 INFO] Step 1500/10000; acc: 81.1; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  890/ 796/64; 19515/17451 tok/s;     91 sec;
[2024-03-11 10:10:59,325 INFO] Step 1550/10000; acc: 82.0; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  863/ 766/64; 20008/17764 tok/s;     93 sec;
[2024-03-11 10:11:01,412 INFO] Step 1600/10000; acc: 82.5; ppl:   3.5; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  847/ 737/64; 20297/17665 tok/s;     95 sec;
[2024-03-11 10:11:04,894 INFO] valid stats calculation
                           took: 3.480984687805176 s.
[2024-03-11 10:11:04,894 INFO] Train perplexity: 73.3821
[2024-03-11 10:11:04,894 INFO] Train accuracy: 44.1661
[2024-03-11 10:11:04,894 INFO] Sentences processed: 102400
[2024-03-11 10:11:04,894 INFO] Average bsz:  851/ 742/64
[2024-03-11 10:11:04,894 INFO] Validation perplexity: 8.73285e+06
[2024-03-11 10:11:04,894 INFO] Validation accuracy: 7.86201
[2024-03-11 10:11:04,896 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_1600.pt
[2024-03-11 10:11:06,348 INFO] Step 1650/10000; acc: 82.6; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  949/ 832/64; 9620/8430 tok/s;    100 sec;
[2024-03-11 10:11:08,163 INFO] Step 1700/10000; acc: 83.8; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  925/ 784/64; 25487/21595 tok/s;    102 sec;
[2024-03-11 10:11:10,303 INFO] Step 1750/10000; acc: 83.3; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  925/ 818/64; 21627/19113 tok/s;    104 sec;
[2024-03-11 10:11:12,349 INFO] Step 1800/10000; acc: 82.5; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  817/ 719/64; 19978/17568 tok/s;    106 sec;
[2024-03-11 10:11:15,802 INFO] valid stats calculation
                           took: 3.4532413482666016 s.
[2024-03-11 10:11:15,802 INFO] Train perplexity: 51.2547
[2024-03-11 10:11:15,803 INFO] Train accuracy: 48.7276
[2024-03-11 10:11:15,803 INFO] Sentences processed: 115200
[2024-03-11 10:11:15,803 INFO] Average bsz:  857/ 747/64
[2024-03-11 10:11:15,803 INFO] Validation perplexity: 1.068e+07
[2024-03-11 10:11:15,803 INFO] Validation accuracy: 5.8564
[2024-03-11 10:11:15,804 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_1800.pt
[2024-03-11 10:11:17,088 INFO] Step 1850/10000; acc: 82.0; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  849/ 724/64; 8955/7638 tok/s;    111 sec;
[2024-03-11 10:11:18,349 INFO] Step 1900/10000; acc: 84.1; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  906/ 794/64; 35948/31512 tok/s;    112 sec;
[2024-03-11 10:11:20,540 INFO] Step 1950/10000; acc: 84.6; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  922/ 800/64; 21025/18242 tok/s;    115 sec;
[2024-03-11 10:11:22,609 INFO] Step 2000/10000; acc: 85.2; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  820/ 734/64; 19813/17740 tok/s;    117 sec;
[2024-03-11 10:11:26,028 INFO] valid stats calculation
                           took: 3.418722629547119 s.
[2024-03-11 10:11:26,029 INFO] Train perplexity: 38.621
[2024-03-11 10:11:26,029 INFO] Train accuracy: 52.3205
[2024-03-11 10:11:26,029 INFO] Sentences processed: 128000
[2024-03-11 10:11:26,029 INFO] Average bsz:  859/ 749/64
[2024-03-11 10:11:26,029 INFO] Validation perplexity: 1.20781e+07
[2024-03-11 10:11:26,029 INFO] Validation accuracy: 8.4637
[2024-03-11 10:11:26,031 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_2000.pt
[2024-03-11 10:11:27,493 INFO] Step 2050/10000; acc: 86.5; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  966/ 841/64; 9889/8615 tok/s;    122 sec;
[2024-03-11 10:11:28,795 INFO] Step 2100/10000; acc: 87.0; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  934/ 836/64; 35899/32119 tok/s;    123 sec;
[2024-03-11 10:11:30,575 INFO] Step 2150/10000; acc: 86.6; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  867/ 744/64; 24341/20903 tok/s;    125 sec;
[2024-03-11 10:11:32,898 INFO] Step 2200/10000; acc: 86.7; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  990/ 862/64; 21298/18562 tok/s;    127 sec;
[2024-03-11 10:11:36,281 INFO] valid stats calculation
                           took: 3.3823320865631104 s.
[2024-03-11 10:11:36,281 INFO] Train perplexity: 29.5724
[2024-03-11 10:11:36,281 INFO] Train accuracy: 55.7178
[2024-03-11 10:11:36,281 INFO] Sentences processed: 140800
[2024-03-11 10:11:36,281 INFO] Average bsz:  866/ 755/64
[2024-03-11 10:11:36,282 INFO] Validation perplexity: 1.61156e+07
[2024-03-11 10:11:36,282 INFO] Validation accuracy: 8.34336
[2024-03-11 10:11:36,283 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_2200.pt
[2024-03-11 10:11:37,578 INFO] Step 2250/10000; acc: 87.2; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  829/ 702/64; 8862/7499 tok/s;    132 sec;
[2024-03-11 10:11:38,701 INFO] Step 2300/10000; acc: 87.8; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  781/ 701/64; 34788/31245 tok/s;    133 sec;
[2024-03-11 10:11:40,020 INFO] Step 2350/10000; acc: 88.2; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  959/ 840/64; 36344/31831 tok/s;    134 sec;
[2024-03-11 10:11:42,260 INFO] Step 2400/10000; acc: 87.7; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  945/ 803/64; 21090/17920 tok/s;    136 sec;
[2024-03-11 10:11:45,688 INFO] valid stats calculation
                           took: 3.427407741546631 s.
[2024-03-11 10:11:45,688 INFO] Train perplexity: 23.9684
[2024-03-11 10:11:45,688 INFO] Train accuracy: 58.4076
[2024-03-11 10:11:45,688 INFO] Sentences processed: 153600
[2024-03-11 10:11:45,688 INFO] Average bsz:  867/ 756/64
[2024-03-11 10:11:45,688 INFO] Validation perplexity: 2.38575e+07
[2024-03-11 10:11:45,688 INFO] Validation accuracy: 7.70156
[2024-03-11 10:11:45,690 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_2400.pt
[2024-03-11 10:11:47,723 INFO] Step 2450/10000; acc: 87.7; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  937/ 805/64; 8576/7370 tok/s;    142 sec;
[2024-03-11 10:11:48,949 INFO] Step 2500/10000; acc: 85.9; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  919/ 810/64; 37484/33012 tok/s;    143 sec;
[2024-03-11 10:11:50,114 INFO] Step 2550/10000; acc: 88.4; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  878/ 748/64; 37704/32124 tok/s;    144 sec;
[2024-03-11 10:11:51,683 INFO] Step 2600/10000; acc: 88.6; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  851/ 759/64; 27131/24194 tok/s;    146 sec;
[2024-03-11 10:11:55,147 INFO] valid stats calculation
                           took: 3.464036703109741 s.
[2024-03-11 10:11:55,148 INFO] Train perplexity: 20.0454
[2024-03-11 10:11:55,148 INFO] Train accuracy: 60.7235
[2024-03-11 10:11:55,148 INFO] Sentences processed: 166400
[2024-03-11 10:11:55,148 INFO] Average bsz:  869/ 758/64
[2024-03-11 10:11:55,148 INFO] Validation perplexity: 3.31839e+07
[2024-03-11 10:11:55,148 INFO] Validation accuracy: 8.18291
[2024-03-11 10:11:55,149 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_2600.pt
[2024-03-11 10:11:57,332 INFO] Step 2650/10000; acc: 88.9; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  850/ 732/64; 7523/6481 tok/s;    151 sec;
[2024-03-11 10:11:58,728 INFO] Step 2700/10000; acc: 87.6; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  901/ 782/64; 32279/28000 tok/s;    153 sec;
[2024-03-11 10:12:00,020 INFO] Step 2750/10000; acc: 88.5; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  906/ 799/64; 35076/30919 tok/s;    154 sec;
[2024-03-11 10:12:01,169 INFO] Step 2800/10000; acc: 88.8; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  815/ 705/64; 35493/30670 tok/s;    155 sec;
[2024-03-11 10:12:04,663 INFO] valid stats calculation
                           took: 3.4933345317840576 s.
[2024-03-11 10:12:04,663 INFO] Train perplexity: 17.2025
[2024-03-11 10:12:04,663 INFO] Train accuracy: 62.6952
[2024-03-11 10:12:04,663 INFO] Sentences processed: 179200
[2024-03-11 10:12:04,663 INFO] Average bsz:  869/ 757/64
[2024-03-11 10:12:04,663 INFO] Validation perplexity: 5.80148e+07
[2024-03-11 10:12:04,663 INFO] Validation accuracy: 8.58404
[2024-03-11 10:12:04,665 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_2800.pt
[2024-03-11 10:12:07,157 INFO] Step 2850/10000; acc: 88.1; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  982/ 813/64; 8198/6790 tok/s;    161 sec;
[2024-03-11 10:12:08,955 INFO] Step 2900/10000; acc: 88.4; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  813/ 723/64; 22604/20109 tok/s;    163 sec;
[2024-03-11 10:12:10,242 INFO] Step 2950/10000; acc: 87.8; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  965/ 839/64; 37489/32599 tok/s;    164 sec;
[2024-03-11 10:12:11,459 INFO] Step 3000/10000; acc: 89.2; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  895/ 791/64; 36772/32512 tok/s;    165 sec;
[2024-03-11 10:12:14,946 INFO] valid stats calculation
                           took: 3.4860613346099854 s.
[2024-03-11 10:12:14,946 INFO] Train perplexity: 14.9654
[2024-03-11 10:12:14,946 INFO] Train accuracy: 64.4778
[2024-03-11 10:12:14,946 INFO] Sentences processed: 192000
[2024-03-11 10:12:14,946 INFO] Average bsz:  872/ 760/64
[2024-03-11 10:12:14,946 INFO] Validation perplexity: 1.27281e+08
[2024-03-11 10:12:14,946 INFO] Validation accuracy: 9.22583
[2024-03-11 10:12:14,948 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_3000.pt
[2024-03-11 10:12:17,370 INFO] Step 3050/10000; acc: 89.5; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  896/ 791/64; 7579/6692 tok/s;    171 sec;
[2024-03-11 10:12:19,543 INFO] Step 3100/10000; acc: 88.6; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  867/ 746/64; 19960/17180 tok/s;    174 sec;
[2024-03-11 10:12:20,968 INFO] Step 3150/10000; acc: 88.9; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  968/ 823/64; 33948/28884 tok/s;    175 sec;
[2024-03-11 10:12:22,035 INFO] Step 3200/10000; acc: 90.0; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  750/ 658/64; 35163/30843 tok/s;    176 sec;
[2024-03-11 10:12:25,553 INFO] valid stats calculation
                           took: 3.5175390243530273 s.
[2024-03-11 10:12:25,553 INFO] Train perplexity: 13.272
[2024-03-11 10:12:25,554 INFO] Train accuracy: 66.0148
[2024-03-11 10:12:25,554 INFO] Sentences processed: 204800
[2024-03-11 10:12:25,554 INFO] Average bsz:  872/ 759/64
[2024-03-11 10:12:25,554 INFO] Validation perplexity: 6.50542e+07
[2024-03-11 10:12:25,554 INFO] Validation accuracy: 8.98516
[2024-03-11 10:12:25,555 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_3200.pt
[2024-03-11 10:12:28,013 INFO] Step 3250/10000; acc: 89.1; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  910/ 781/64; 7613/6532 tok/s;    182 sec;
[2024-03-11 10:12:30,216 INFO] Step 3300/10000; acc: 89.9; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  896/ 772/64; 20335/17526 tok/s;    184 sec;
[2024-03-11 10:12:31,965 INFO] Step 3350/10000; acc: 90.8; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  855/ 758/64; 24446/21665 tok/s;    186 sec;
[2024-03-11 10:12:33,147 INFO] Step 3400/10000; acc: 90.1; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  891/ 777/64; 37674/32857 tok/s;    187 sec;
[2024-03-11 10:12:36,756 INFO] valid stats calculation
                           took: 3.608339309692383 s.
[2024-03-11 10:12:36,757 INFO] Train perplexity: 11.8693
[2024-03-11 10:12:36,757 INFO] Train accuracy: 67.4472
[2024-03-11 10:12:36,757 INFO] Sentences processed: 217600
[2024-03-11 10:12:36,757 INFO] Average bsz:  873/ 760/64
[2024-03-11 10:12:36,757 INFO] Validation perplexity: 4.0546e+07
[2024-03-11 10:12:36,757 INFO] Validation accuracy: 8.1428
[2024-03-11 10:12:36,758 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_3400.pt
[2024-03-11 10:12:39,073 INFO] Step 3450/10000; acc: 89.7; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  865/ 760/64; 7301/6410 tok/s;    193 sec;
[2024-03-11 10:12:41,356 INFO] Step 3500/10000; acc: 89.3; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  924/ 788/64; 20240/17261 tok/s;    195 sec;
[2024-03-11 10:12:43,528 INFO] Step 3550/10000; acc: 90.1; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  869/ 737/64; 20005/16963 tok/s;    198 sec;
[2024-03-11 10:12:44,836 INFO] Step 3600/10000; acc: 90.7; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  847/ 737/64; 32391/28163 tok/s;    199 sec;
[2024-03-11 10:12:48,494 INFO] valid stats calculation
                           took: 3.6568520069122314 s.
[2024-03-11 10:12:48,494 INFO] Train perplexity: 10.7861
[2024-03-11 10:12:48,494 INFO] Train accuracy: 68.6893
[2024-03-11 10:12:48,494 INFO] Sentences processed: 230400
[2024-03-11 10:12:48,494 INFO] Average bsz:  873/ 760/64
[2024-03-11 10:12:48,494 INFO] Validation perplexity: 5.327e+07
[2024-03-11 10:12:48,494 INFO] Validation accuracy: 7.78179
[2024-03-11 10:12:48,496 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_3600.pt
[2024-03-11 10:12:50,971 INFO] Step 3650/10000; acc: 90.0; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  923/ 823/64; 7522/6709 tok/s;    205 sec;
[2024-03-11 10:12:53,272 INFO] Step 3700/10000; acc: 89.8; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  959/ 832/64; 20829/18080 tok/s;    207 sec;
[2024-03-11 10:12:55,379 INFO] Step 3750/10000; acc: 89.4; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  856/ 766/64; 20328/18192 tok/s;    209 sec;
[2024-03-11 10:12:56,989 INFO] Step 3800/10000; acc: 88.8; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  874/ 756/64; 27136/23472 tok/s;    211 sec;
[2024-03-11 10:13:00,614 INFO] valid stats calculation
                           took: 3.6246864795684814 s.
[2024-03-11 10:13:00,614 INFO] Train perplexity: 9.86288
[2024-03-11 10:13:00,614 INFO] Train accuracy: 69.8339
[2024-03-11 10:13:00,614 INFO] Sentences processed: 243200
[2024-03-11 10:13:00,614 INFO] Average bsz:  875/ 762/64
[2024-03-11 10:13:00,614 INFO] Validation perplexity: 8.81572e+07
[2024-03-11 10:13:00,614 INFO] Validation accuracy: 7.86201
[2024-03-11 10:13:00,616 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_3800.pt
[2024-03-11 10:13:03,113 INFO] Step 3850/10000; acc: 89.7; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  965/ 843/64; 7879/6882 tok/s;    217 sec;
[2024-03-11 10:13:05,139 INFO] Step 3900/10000; acc: 90.7; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  832/ 736/64; 20537/18168 tok/s;    219 sec;
[2024-03-11 10:13:07,242 INFO] Step 3950/10000; acc: 91.1; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  849/ 760/64; 20189/18086 tok/s;    221 sec;
[2024-03-11 10:13:09,179 INFO] Step 4000/10000; acc: 90.5; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  902/ 778/64; 23295/20089 tok/s;    223 sec;
[2024-03-11 10:13:12,792 INFO] valid stats calculation
                           took: 3.6124160289764404 s.
[2024-03-11 10:13:12,792 INFO] Train perplexity: 9.0881
[2024-03-11 10:13:12,792 INFO] Train accuracy: 70.889
[2024-03-11 10:13:12,792 INFO] Sentences processed: 256000
[2024-03-11 10:13:12,792 INFO] Average bsz:  875/ 763/64
[2024-03-11 10:13:12,792 INFO] Validation perplexity: 8.79311e+07
[2024-03-11 10:13:12,792 INFO] Validation accuracy: 8.94505
[2024-03-11 10:13:12,794 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_4000.pt
[2024-03-11 10:13:15,117 INFO] Step 4050/10000; acc: 90.3; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  900/ 768/64; 7581/6471 tok/s;    229 sec;
[2024-03-11 10:13:17,294 INFO] Step 4100/10000; acc: 90.9; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  860/ 752/64; 19752/17258 tok/s;    231 sec;
[2024-03-11 10:13:19,413 INFO] Step 4150/10000; acc: 90.3; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  855/ 741/64; 20178/17492 tok/s;    233 sec;
[2024-03-11 10:13:21,633 INFO] Step 4200/10000; acc: 90.7; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  933/ 795/64; 21022/17899 tok/s;    236 sec;
[2024-03-11 10:13:25,198 INFO] valid stats calculation
                           took: 3.564852476119995 s.
[2024-03-11 10:13:25,199 INFO] Train perplexity: 8.4548
[2024-03-11 10:13:25,199 INFO] Train accuracy: 71.8281
[2024-03-11 10:13:25,199 INFO] Sentences processed: 268800
[2024-03-11 10:13:25,199 INFO] Average bsz:  876/ 763/64
[2024-03-11 10:13:25,199 INFO] Validation perplexity: 9.99018e+07
[2024-03-11 10:13:25,199 INFO] Validation accuracy: 8.06258
[2024-03-11 10:13:25,200 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_4200.pt
[2024-03-11 10:13:27,309 INFO] Step 4250/10000; acc: 91.0; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  916/ 803/64; 8074/7075 tok/s;    241 sec;
[2024-03-11 10:13:29,413 INFO] Step 4300/10000; acc: 91.4; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  819/ 721/64; 19464/17141 tok/s;    243 sec;
[2024-03-11 10:13:31,547 INFO] Step 4350/10000; acc: 91.2; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  863/ 759/64; 20213/17778 tok/s;    246 sec;
[2024-03-11 10:13:33,682 INFO] Step 4400/10000; acc: 91.3; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  840/ 751/64; 19670/17595 tok/s;    248 sec;
[2024-03-11 10:13:37,183 INFO] valid stats calculation
                           took: 3.5007991790771484 s.
[2024-03-11 10:13:37,184 INFO] Train perplexity: 7.89674
[2024-03-11 10:13:37,184 INFO] Train accuracy: 72.7058
[2024-03-11 10:13:37,184 INFO] Sentences processed: 281600
[2024-03-11 10:13:37,184 INFO] Average bsz:  875/ 762/64
[2024-03-11 10:13:37,184 INFO] Validation perplexity: 1.57334e+08
[2024-03-11 10:13:37,184 INFO] Validation accuracy: 8.4637
[2024-03-11 10:13:37,185 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_4400.pt
[2024-03-11 10:13:38,563 INFO] Step 4450/10000; acc: 91.4; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  800/ 700/64; 8196/7172 tok/s;    253 sec;
[2024-03-11 10:13:40,851 INFO] Step 4500/10000; acc: 90.6; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  887/ 788/64; 19385/17210 tok/s;    255 sec;
[2024-03-11 10:13:42,994 INFO] Step 4550/10000; acc: 91.4; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  886/ 759/64; 20674/17722 tok/s;    257 sec;
[2024-03-11 10:13:45,045 INFO] Step 4600/10000; acc: 91.0; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  846/ 724/64; 20622/17646 tok/s;    259 sec;
[2024-03-11 10:13:48,512 INFO] valid stats calculation
                           took: 3.4668657779693604 s.
[2024-03-11 10:13:48,513 INFO] Train perplexity: 7.43232
[2024-03-11 10:13:48,513 INFO] Train accuracy: 73.4859
[2024-03-11 10:13:48,513 INFO] Sentences processed: 294400
[2024-03-11 10:13:48,514 INFO] Average bsz:  874/ 762/64
[2024-03-11 10:13:48,514 INFO] Validation perplexity: 9.33774e+07
[2024-03-11 10:13:48,514 INFO] Validation accuracy: 8.82471
[2024-03-11 10:13:48,516 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_4600.pt
[2024-03-11 10:13:49,888 INFO] Step 4650/10000; acc: 91.3; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  861/ 748/64; 8895/7724 tok/s;    264 sec;
[2024-03-11 10:13:51,675 INFO] Step 4700/10000; acc: 91.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  850/ 746/64; 23779/20878 tok/s;    266 sec;
[2024-03-11 10:13:53,619 INFO] Step 4750/10000; acc: 91.1; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  762/ 673/64; 19598/17314 tok/s;    268 sec;
[2024-03-11 10:13:55,609 INFO] Step 4800/10000; acc: 90.9; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  824/ 682/64; 20715/17145 tok/s;    270 sec;
[2024-03-11 10:13:59,064 INFO] valid stats calculation
                           took: 3.4543631076812744 s.
[2024-03-11 10:13:59,064 INFO] Train perplexity: 7.04415
[2024-03-11 10:13:59,064 INFO] Train accuracy: 74.1788
[2024-03-11 10:13:59,064 INFO] Sentences processed: 307200
[2024-03-11 10:13:59,064 INFO] Average bsz:  872/ 760/64
[2024-03-11 10:13:59,064 INFO] Validation perplexity: 1.01623e+08
[2024-03-11 10:13:59,064 INFO] Validation accuracy: 8.10269
[2024-03-11 10:13:59,066 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_4800.pt
[2024-03-11 10:14:00,435 INFO] Step 4850/10000; acc: 91.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  901/ 777/64; 9336/8051 tok/s;    274 sec;
[2024-03-11 10:14:01,622 INFO] Step 4900/10000; acc: 92.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  833/ 736/64; 35113/31014 tok/s;    276 sec;
[2024-03-11 10:14:03,871 INFO] Step 4950/10000; acc: 91.5; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  882/ 778/64; 19615/17314 tok/s;    278 sec;
[2024-03-11 10:14:06,005 INFO] Step 5000/10000; acc: 91.8; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  860/ 753/64; 20154/17649 tok/s;    280 sec;
[2024-03-11 10:14:09,479 INFO] valid stats calculation
                           took: 3.473515748977661 s.
[2024-03-11 10:14:09,479 INFO] Train perplexity: 6.6646
[2024-03-11 10:14:09,479 INFO] Train accuracy: 74.8848
[2024-03-11 10:14:09,479 INFO] Sentences processed: 320000
[2024-03-11 10:14:09,479 INFO] Average bsz:  872/ 760/64
[2024-03-11 10:14:09,479 INFO] Validation perplexity: 2.41043e+08
[2024-03-11 10:14:09,479 INFO] Validation accuracy: 8.98516
[2024-03-11 10:14:09,481 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_5000.pt
[2024-03-11 10:14:10,740 INFO] Step 5050/10000; acc: 91.8; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  801/ 699/64; 8460/7380 tok/s;    285 sec;
[2024-03-11 10:14:11,906 INFO] Step 5100/10000; acc: 91.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  799/ 695/64; 34272/29824 tok/s;    286 sec;
[2024-03-11 10:14:13,477 INFO] Step 5150/10000; acc: 92.0; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  794/ 696/64; 25267/22173 tok/s;    287 sec;
[2024-03-11 10:14:15,529 INFO] Step 5200/10000; acc: 91.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  835/ 741/64; 20335/18058 tok/s;    290 sec;
[2024-03-11 10:14:18,984 INFO] valid stats calculation
                           took: 3.454371213912964 s.
[2024-03-11 10:14:18,984 INFO] Train perplexity: 6.35496
[2024-03-11 10:14:18,984 INFO] Train accuracy: 75.4913
[2024-03-11 10:14:18,984 INFO] Sentences processed: 332800
[2024-03-11 10:14:18,984 INFO] Average bsz:  870/ 758/64
[2024-03-11 10:14:18,984 INFO] Validation perplexity: 2.34603e+08
[2024-03-11 10:14:18,984 INFO] Validation accuracy: 7.98235
[2024-03-11 10:14:18,986 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_5200.pt
[2024-03-11 10:14:20,344 INFO] Step 5250/10000; acc: 91.7; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  836/ 735/64; 8680/7628 tok/s;    294 sec;
[2024-03-11 10:14:21,524 INFO] Step 5300/10000; acc: 91.2; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  883/ 750/64; 37386/31783 tok/s;    296 sec;
[2024-03-11 10:14:22,744 INFO] Step 5350/10000; acc: 91.6; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3173; bsz:  825/ 719/63; 33837/29503 tok/s;    297 sec;
[2024-03-11 10:14:24,798 INFO] Step 5400/10000; acc: 92.1; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  831/ 719/64; 20218/17505 tok/s;    299 sec;
[2024-03-11 10:14:28,209 INFO] valid stats calculation
                           took: 3.4103987216949463 s.
[2024-03-11 10:14:28,209 INFO] Train perplexity: 6.08261
[2024-03-11 10:14:28,209 INFO] Train accuracy: 76.0693
[2024-03-11 10:14:28,209 INFO] Sentences processed: 345573
[2024-03-11 10:14:28,209 INFO] Average bsz:  869/ 757/64
[2024-03-11 10:14:28,210 INFO] Validation perplexity: 1.02677e+09
[2024-03-11 10:14:28,210 INFO] Validation accuracy: 8.1428
[2024-03-11 10:14:28,211 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_5400.pt
[2024-03-11 10:14:30,309 INFO] Step 5450/10000; acc: 91.4; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  848/ 741/64; 7689/6726 tok/s;    304 sec;
[2024-03-11 10:14:31,433 INFO] Step 5500/10000; acc: 92.4; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  813/ 721/64; 36180/32078 tok/s;    305 sec;
[2024-03-11 10:14:32,610 INFO] Step 5550/10000; acc: 92.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  855/ 755/64; 36307/32086 tok/s;    307 sec;
[2024-03-11 10:14:33,830 INFO] Step 5600/10000; acc: 91.9; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  835/ 708/64; 34207/29026 tok/s;    308 sec;
[2024-03-11 10:14:37,280 INFO] valid stats calculation
                           took: 3.4496617317199707 s.
[2024-03-11 10:14:37,281 INFO] Train perplexity: 5.82829
[2024-03-11 10:14:37,281 INFO] Train accuracy: 76.619
[2024-03-11 10:14:37,281 INFO] Sentences processed: 358373
[2024-03-11 10:14:37,281 INFO] Average bsz:  868/ 756/64
[2024-03-11 10:14:37,281 INFO] Validation perplexity: 7.56673e+08
[2024-03-11 10:14:37,281 INFO] Validation accuracy: 9.42639
[2024-03-11 10:14:37,282 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_5600.pt
[2024-03-11 10:14:39,460 INFO] Step 5650/10000; acc: 93.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  831/ 727/64; 7379/6458 tok/s;    313 sec;
[2024-03-11 10:14:41,181 INFO] Step 5700/10000; acc: 92.1; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  890/ 784/64; 25841/22763 tok/s;    315 sec;
[2024-03-11 10:14:42,421 INFO] Step 5750/10000; acc: 92.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  964/ 830/64; 38889/33501 tok/s;    316 sec;
[2024-03-11 10:14:43,593 INFO] Step 5800/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  842/ 738/64; 35928/31475 tok/s;    318 sec;
[2024-03-11 10:14:47,134 INFO] valid stats calculation
                           took: 3.540886878967285 s.
[2024-03-11 10:14:47,135 INFO] Train perplexity: 5.58049
[2024-03-11 10:14:47,135 INFO] Train accuracy: 77.1752
[2024-03-11 10:14:47,135 INFO] Sentences processed: 371173
[2024-03-11 10:14:47,135 INFO] Average bsz:  868/ 756/64
[2024-03-11 10:14:47,135 INFO] Validation perplexity: 3.47081e+08
[2024-03-11 10:14:47,135 INFO] Validation accuracy: 8.42359
[2024-03-11 10:14:47,136 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_5800.pt
[2024-03-11 10:14:49,530 INFO] Step 5850/10000; acc: 93.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  863/ 775/64; 7266/6529 tok/s;    324 sec;
[2024-03-11 10:14:51,697 INFO] Step 5900/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  919/ 803/64; 21211/18542 tok/s;    326 sec;
[2024-03-11 10:14:52,903 INFO] Step 5950/10000; acc: 92.8; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  909/ 785/64; 37674/32538 tok/s;    327 sec;
[2024-03-11 10:14:54,059 INFO] Step 6000/10000; acc: 92.3; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  838/ 734/64; 36284/31781 tok/s;    328 sec;
[2024-03-11 10:14:57,585 INFO] valid stats calculation
                           took: 3.5262303352355957 s.
[2024-03-11 10:14:57,586 INFO] Train perplexity: 5.3576
[2024-03-11 10:14:57,586 INFO] Train accuracy: 77.703
[2024-03-11 10:14:57,586 INFO] Sentences processed: 383973
[2024-03-11 10:14:57,586 INFO] Average bsz:  869/ 757/64
[2024-03-11 10:14:57,586 INFO] Validation perplexity: 3.06528e+08
[2024-03-11 10:14:57,586 INFO] Validation accuracy: 8.50381
[2024-03-11 10:14:57,587 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_6000.pt
[2024-03-11 10:14:59,779 INFO] Step 6050/10000; acc: 92.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  803/ 701/64; 7015/6131 tok/s;    334 sec;
[2024-03-11 10:15:01,851 INFO] Step 6100/10000; acc: 92.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  835/ 726/64; 20149/17535 tok/s;    336 sec;
[2024-03-11 10:15:03,668 INFO] Step 6150/10000; acc: 92.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  873/ 753/64; 24023/20708 tok/s;    338 sec;
[2024-03-11 10:15:04,814 INFO] Step 6200/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  753/ 663/64; 32884/28976 tok/s;    339 sec;
[2024-03-11 10:15:08,314 INFO] valid stats calculation
                           took: 3.4999639987945557 s.
[2024-03-11 10:15:08,314 INFO] Train perplexity: 5.17171
[2024-03-11 10:15:08,314 INFO] Train accuracy: 78.1561
[2024-03-11 10:15:08,314 INFO] Sentences processed: 396773
[2024-03-11 10:15:08,314 INFO] Average bsz:  867/ 755/64
[2024-03-11 10:15:08,314 INFO] Validation perplexity: 8.64737e+08
[2024-03-11 10:15:08,314 INFO] Validation accuracy: 8.58404
[2024-03-11 10:15:08,316 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_6200.pt
[2024-03-11 10:15:10,571 INFO] Step 6250/10000; acc: 92.4; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  857/ 740/64; 7442/6423 tok/s;    345 sec;
[2024-03-11 10:15:12,737 INFO] Step 6300/10000; acc: 92.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  838/ 745/64; 19340/17196 tok/s;    347 sec;
[2024-03-11 10:15:14,753 INFO] Step 6350/10000; acc: 93.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  772/ 678/64; 19140/16823 tok/s;    349 sec;
[2024-03-11 10:15:16,182 INFO] Step 6400/10000; acc: 93.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  844/ 759/64; 29517/26553 tok/s;    350 sec;
[2024-03-11 10:15:19,827 INFO] valid stats calculation
                           took: 3.644512891769409 s.
[2024-03-11 10:15:19,828 INFO] Train perplexity: 4.99694
[2024-03-11 10:15:19,828 INFO] Train accuracy: 78.5991
[2024-03-11 10:15:19,828 INFO] Sentences processed: 409573
[2024-03-11 10:15:19,828 INFO] Average bsz:  866/ 755/64
[2024-03-11 10:15:19,828 INFO] Validation perplexity: 1.14413e+09
[2024-03-11 10:15:19,828 INFO] Validation accuracy: 8.22302
[2024-03-11 10:15:19,829 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_6400.pt
[2024-03-11 10:15:21,983 INFO] Step 6450/10000; acc: 93.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  849/ 730/64; 7315/6295 tok/s;    356 sec;
[2024-03-11 10:15:24,046 INFO] Step 6500/10000; acc: 93.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  850/ 723/64; 20608/17521 tok/s;    358 sec;
[2024-03-11 10:15:26,173 INFO] Step 6550/10000; acc: 93.1; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  858/ 735/64; 20176/17285 tok/s;    360 sec;
[2024-03-11 10:15:28,282 INFO] Step 6600/10000; acc: 93.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  881/ 760/64; 20887/18024 tok/s;    362 sec;
[2024-03-11 10:15:31,823 INFO] valid stats calculation
                           took: 3.5410985946655273 s.
[2024-03-11 10:15:31,823 INFO] Train perplexity: 4.83478
[2024-03-11 10:15:31,824 INFO] Train accuracy: 79.0315
[2024-03-11 10:15:31,824 INFO] Sentences processed: 422373
[2024-03-11 10:15:31,824 INFO] Average bsz:  865/ 754/64
[2024-03-11 10:15:31,824 INFO] Validation perplexity: 1.12053e+09
[2024-03-11 10:15:31,824 INFO] Validation accuracy: 8.58404
[2024-03-11 10:15:31,825 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_6600.pt
[2024-03-11 10:15:34,138 INFO] Step 6650/10000; acc: 92.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  879/ 749/64; 7508/6394 tok/s;    368 sec;
[2024-03-11 10:15:36,351 INFO] Step 6700/10000; acc: 92.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  899/ 769/64; 20308/17365 tok/s;    370 sec;
[2024-03-11 10:15:38,465 INFO] Step 6750/10000; acc: 93.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  817/ 740/64; 19319/17510 tok/s;    372 sec;
[2024-03-11 10:15:40,474 INFO] Step 6800/10000; acc: 93.7; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  824/ 709/64; 20517/17641 tok/s;    374 sec;
[2024-03-11 10:15:44,020 INFO] valid stats calculation
                           took: 3.5451598167419434 s.
[2024-03-11 10:15:44,020 INFO] Train perplexity: 4.68644
[2024-03-11 10:15:44,020 INFO] Train accuracy: 79.4409
[2024-03-11 10:15:44,020 INFO] Sentences processed: 435173
[2024-03-11 10:15:44,020 INFO] Average bsz:  865/ 754/64
[2024-03-11 10:15:44,020 INFO] Validation perplexity: 7.93427e+08
[2024-03-11 10:15:44,020 INFO] Validation accuracy: 8.42359
[2024-03-11 10:15:44,022 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_6800.pt
[2024-03-11 10:15:45,938 INFO] Step 6850/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  951/ 817/64; 8704/7475 tok/s;    380 sec;
[2024-03-11 10:15:48,031 INFO] Step 6900/10000; acc: 92.8; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  828/ 726/64; 19787/17344 tok/s;    382 sec;
[2024-03-11 10:15:50,166 INFO] Step 6950/10000; acc: 91.4; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3190; bsz:  807/ 722/64; 18899/16904 tok/s;    384 sec;
[2024-03-11 10:15:52,301 INFO] Step 7000/10000; acc: 93.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  837/ 742/64; 19609/17378 tok/s;    386 sec;
[2024-03-11 10:15:55,831 INFO] valid stats calculation
                           took: 3.529005289077759 s.
[2024-03-11 10:15:55,831 INFO] Train perplexity: 4.56001
[2024-03-11 10:15:55,831 INFO] Train accuracy: 79.812
[2024-03-11 10:15:55,831 INFO] Sentences processed: 447963
[2024-03-11 10:15:55,831 INFO] Average bsz:  865/ 754/64
[2024-03-11 10:15:55,831 INFO] Validation perplexity: 7.35849e+08
[2024-03-11 10:15:55,831 INFO] Validation accuracy: 8.34336
[2024-03-11 10:15:55,833 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_7000.pt
[2024-03-11 10:15:57,090 INFO] Step 7050/10000; acc: 92.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  827/ 689/64; 8634/7196 tok/s;    391 sec;
[2024-03-11 10:15:58,909 INFO] Step 7100/10000; acc: 93.3; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  771/ 683/64; 21187/18785 tok/s;    393 sec;
[2024-03-11 10:16:01,104 INFO] Step 7150/10000; acc: 93.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  920/ 784/64; 20961/17862 tok/s;    395 sec;
[2024-03-11 10:16:03,271 INFO] Step 7200/10000; acc: 93.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  901/ 763/64; 20792/17602 tok/s;    397 sec;
[2024-03-11 10:16:06,910 INFO] valid stats calculation
                           took: 3.6377508640289307 s.
[2024-03-11 10:16:06,910 INFO] Train perplexity: 4.43674
[2024-03-11 10:16:06,910 INFO] Train accuracy: 80.1672
[2024-03-11 10:16:06,910 INFO] Sentences processed: 460763
[2024-03-11 10:16:06,910 INFO] Average bsz:  865/ 753/64
[2024-03-11 10:16:06,910 INFO] Validation perplexity: 1.27371e+09
[2024-03-11 10:16:06,910 INFO] Validation accuracy: 8.66426
[2024-03-11 10:16:06,912 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_7200.pt
[2024-03-11 10:16:08,202 INFO] Step 7250/10000; acc: 93.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  851/ 733/64; 8632/7434 tok/s;    402 sec;
[2024-03-11 10:16:09,400 INFO] Step 7300/10000; acc: 93.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  861/ 746/64; 35978/31153 tok/s;    403 sec;
[2024-03-11 10:16:11,553 INFO] Step 7350/10000; acc: 93.5; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  887/ 776/64; 20593/18009 tok/s;    406 sec;
[2024-03-11 10:16:13,616 INFO] Step 7400/10000; acc: 94.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  837/ 732/64; 20298/17740 tok/s;    408 sec;
[2024-03-11 10:16:17,104 INFO] valid stats calculation
                           took: 3.487393856048584 s.
[2024-03-11 10:16:17,104 INFO] Train perplexity: 4.3132
[2024-03-11 10:16:17,104 INFO] Train accuracy: 80.5288
[2024-03-11 10:16:17,104 INFO] Sentences processed: 473563
[2024-03-11 10:16:17,104 INFO] Average bsz:  864/ 753/64
[2024-03-11 10:16:17,104 INFO] Validation perplexity: 2.46145e+09
[2024-03-11 10:16:17,104 INFO] Validation accuracy: 9.26594
[2024-03-11 10:16:17,106 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_7400.pt
[2024-03-11 10:16:18,459 INFO] Step 7450/10000; acc: 92.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  885/ 768/64; 9134/7928 tok/s;    412 sec;
[2024-03-11 10:16:19,528 INFO] Step 7500/10000; acc: 94.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  732/ 653/64; 34249/30537 tok/s;    414 sec;
[2024-03-11 10:16:21,173 INFO] Step 7550/10000; acc: 93.0; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  933/ 811/64; 28352/24651 tok/s;    415 sec;
[2024-03-11 10:16:23,415 INFO] Step 7600/10000; acc: 93.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  868/ 774/64; 19357/17272 tok/s;    417 sec;
[2024-03-11 10:16:26,861 INFO] valid stats calculation
                           took: 3.4457931518554688 s.
[2024-03-11 10:16:26,861 INFO] Train perplexity: 4.20285
[2024-03-11 10:16:26,861 INFO] Train accuracy: 80.868
[2024-03-11 10:16:26,861 INFO] Sentences processed: 486363
[2024-03-11 10:16:26,862 INFO] Average bsz:  864/ 753/64
[2024-03-11 10:16:26,862 INFO] Validation perplexity: 2.6346e+09
[2024-03-11 10:16:26,862 INFO] Validation accuracy: 8.86482
[2024-03-11 10:16:26,863 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_7600.pt
[2024-03-11 10:16:28,443 INFO] Step 7650/10000; acc: 93.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  920/ 775/64; 9153/7711 tok/s;    422 sec;
[2024-03-11 10:16:29,592 INFO] Step 7700/10000; acc: 93.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  841/ 727/64; 36586/31646 tok/s;    424 sec;
[2024-03-11 10:16:30,892 INFO] Step 7750/10000; acc: 93.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  945/ 809/64; 36356/31148 tok/s;    425 sec;
[2024-03-11 10:16:33,021 INFO] Step 7800/10000; acc: 92.9; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  914/ 783/64; 21466/18388 tok/s;    427 sec;
[2024-03-11 10:16:36,454 INFO] valid stats calculation
                           took: 3.4330873489379883 s.
[2024-03-11 10:16:36,455 INFO] Train perplexity: 4.09702
[2024-03-11 10:16:36,455 INFO] Train accuracy: 81.2006
[2024-03-11 10:16:36,455 INFO] Sentences processed: 499163
[2024-03-11 10:16:36,455 INFO] Average bsz:  865/ 753/64
[2024-03-11 10:16:36,455 INFO] Validation perplexity: 1.37404e+09
[2024-03-11 10:16:36,455 INFO] Validation accuracy: 9.14561
[2024-03-11 10:16:36,456 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_7800.pt
[2024-03-11 10:16:38,333 INFO] Step 7850/10000; acc: 93.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  867/ 759/64; 8157/7145 tok/s;    432 sec;
[2024-03-11 10:16:39,502 INFO] Step 7900/10000; acc: 93.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  909/ 769/64; 38880/32908 tok/s;    434 sec;
[2024-03-11 10:16:40,655 INFO] Step 7950/10000; acc: 93.6; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  860/ 739/64; 37297/32060 tok/s;    435 sec;
[2024-03-11 10:16:42,320 INFO] Step 8000/10000; acc: 93.4; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  923/ 797/64; 27714/23939 tok/s;    436 sec;
[2024-03-11 10:16:45,808 INFO] valid stats calculation
                           took: 3.4872686862945557 s.
[2024-03-11 10:16:45,808 INFO] Train perplexity: 4.00134
[2024-03-11 10:16:45,808 INFO] Train accuracy: 81.5137
[2024-03-11 10:16:45,809 INFO] Sentences processed: 511963
[2024-03-11 10:16:45,809 INFO] Average bsz:  866/ 754/64
[2024-03-11 10:16:45,809 INFO] Validation perplexity: 1.46772e+09
[2024-03-11 10:16:45,809 INFO] Validation accuracy: 8.66426
[2024-03-11 10:16:45,810 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_8000.pt
[2024-03-11 10:16:48,132 INFO] Step 8050/10000; acc: 93.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  883/ 783/64; 7599/6740 tok/s;    442 sec;
[2024-03-11 10:16:49,403 INFO] Step 8100/10000; acc: 94.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  901/ 778/64; 35436/30604 tok/s;    443 sec;
[2024-03-11 10:16:50,646 INFO] Step 8150/10000; acc: 93.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  906/ 810/64; 36481/32616 tok/s;    445 sec;
[2024-03-11 10:16:51,920 INFO] Step 8200/10000; acc: 94.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  883/ 782/64; 34633/30688 tok/s;    446 sec;
[2024-03-11 10:16:55,622 INFO] valid stats calculation
                           took: 3.701253652572632 s.
[2024-03-11 10:16:55,622 INFO] Train perplexity: 3.90534
[2024-03-11 10:16:55,622 INFO] Train accuracy: 81.8279
[2024-03-11 10:16:55,622 INFO] Sentences processed: 524763
[2024-03-11 10:16:55,622 INFO] Average bsz:  866/ 754/64
[2024-03-11 10:16:55,622 INFO] Validation perplexity: 2.25427e+09
[2024-03-11 10:16:55,622 INFO] Validation accuracy: 8.94505
[2024-03-11 10:16:55,624 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_8200.pt
[2024-03-11 10:16:57,808 INFO] Step 8250/10000; acc: 94.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  844/ 732/64; 7164/6214 tok/s;    452 sec;
[2024-03-11 10:16:59,380 INFO] Step 8300/10000; acc: 93.9; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  845/ 737/64; 26870/23442 tok/s;    453 sec;
[2024-03-11 10:17:00,517 INFO] Step 8350/10000; acc: 93.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  829/ 733/64; 36488/32265 tok/s;    455 sec;
[2024-03-11 10:17:01,707 INFO] Step 8400/10000; acc: 94.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  813/ 699/64; 34168/29405 tok/s;    456 sec;
[2024-03-11 10:17:05,367 INFO] valid stats calculation
                           took: 3.6596319675445557 s.
[2024-03-11 10:17:05,367 INFO] Train perplexity: 3.8196
[2024-03-11 10:17:05,367 INFO] Train accuracy: 82.1114
[2024-03-11 10:17:05,367 INFO] Sentences processed: 537563
[2024-03-11 10:17:05,367 INFO] Average bsz:  866/ 754/64
[2024-03-11 10:17:05,367 INFO] Validation perplexity: 3.89665e+09
[2024-03-11 10:17:05,367 INFO] Validation accuracy: 8.4637
[2024-03-11 10:17:05,369 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_8400.pt
[2024-03-11 10:17:07,588 INFO] Step 8450/10000; acc: 94.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  813/ 715/64; 6911/6083 tok/s;    462 sec;
[2024-03-11 10:17:09,753 INFO] Step 8500/10000; acc: 95.0; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  855/ 741/64; 19748/17117 tok/s;    464 sec;
[2024-03-11 10:17:10,924 INFO] Step 8550/10000; acc: 94.9; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  826/ 719/64; 35254/30710 tok/s;    465 sec;
[2024-03-11 10:17:12,197 INFO] Step 8600/10000; acc: 94.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  952/ 821/64; 37395/32226 tok/s;    466 sec;
[2024-03-11 10:17:15,740 INFO] valid stats calculation
                           took: 3.5421664714813232 s.
[2024-03-11 10:17:15,740 INFO] Train perplexity: 3.73466
[2024-03-11 10:17:15,740 INFO] Train accuracy: 82.4011
[2024-03-11 10:17:15,740 INFO] Sentences processed: 550363
[2024-03-11 10:17:15,741 INFO] Average bsz:  866/ 754/64
[2024-03-11 10:17:15,741 INFO] Validation perplexity: 2.08713e+09
[2024-03-11 10:17:15,741 INFO] Validation accuracy: 7.78179
[2024-03-11 10:17:15,742 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_8600.pt
[2024-03-11 10:17:17,965 INFO] Step 8650/10000; acc: 94.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  827/ 737/64; 7169/6391 tok/s;    472 sec;
[2024-03-11 10:17:19,967 INFO] Step 8700/10000; acc: 94.9; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  818/ 712/64; 20434/17792 tok/s;    474 sec;
[2024-03-11 10:17:21,666 INFO] Step 8750/10000; acc: 94.1; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  891/ 783/64; 26215/23048 tok/s;    476 sec;
[2024-03-11 10:17:22,852 INFO] Step 8800/10000; acc: 94.1; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  878/ 790/64; 37046/33332 tok/s;    477 sec;
[2024-03-11 10:17:26,464 INFO] valid stats calculation
                           took: 3.611546039581299 s.
[2024-03-11 10:17:26,464 INFO] Train perplexity: 3.65788
[2024-03-11 10:17:26,464 INFO] Train accuracy: 82.6756
[2024-03-11 10:17:26,464 INFO] Sentences processed: 563163
[2024-03-11 10:17:26,464 INFO] Average bsz:  865/ 754/64
[2024-03-11 10:17:26,464 INFO] Validation perplexity: 1.24084e+09
[2024-03-11 10:17:26,464 INFO] Validation accuracy: 8.18291
[2024-03-11 10:17:26,466 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_8800.pt
[2024-03-11 10:17:28,853 INFO] Step 8850/10000; acc: 93.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  902/ 817/64; 7518/6804 tok/s;    483 sec;
[2024-03-11 10:17:30,972 INFO] Step 8900/10000; acc: 94.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  861/ 760/64; 20325/17936 tok/s;    485 sec;
[2024-03-11 10:17:33,096 INFO] Step 8950/10000; acc: 94.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  827/ 744/64; 19470/17511 tok/s;    487 sec;
[2024-03-11 10:17:34,191 INFO] Step 9000/10000; acc: 94.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  760/ 667/64; 34723/30464 tok/s;    488 sec;
[2024-03-11 10:17:37,771 INFO] valid stats calculation
                           took: 3.579493284225464 s.
[2024-03-11 10:17:37,771 INFO] Train perplexity: 3.58748
[2024-03-11 10:17:37,771 INFO] Train accuracy: 82.9271
[2024-03-11 10:17:37,771 INFO] Sentences processed: 575963
[2024-03-11 10:17:37,771 INFO] Average bsz:  865/ 754/64
[2024-03-11 10:17:37,771 INFO] Validation perplexity: 3.16195e+09
[2024-03-11 10:17:37,771 INFO] Validation accuracy: 8.70437
[2024-03-11 10:17:37,773 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_9000.pt
[2024-03-11 10:17:40,053 INFO] Step 9050/10000; acc: 94.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  847/ 749/64; 7228/6386 tok/s;    494 sec;
[2024-03-11 10:17:42,123 INFO] Step 9100/10000; acc: 95.0; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  788/ 693/64; 19050/16754 tok/s;    496 sec;
[2024-03-11 10:17:44,256 INFO] Step 9150/10000; acc: 93.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  840/ 717/64; 19687/16812 tok/s;    498 sec;
[2024-03-11 10:17:46,203 INFO] Step 9200/10000; acc: 93.7; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  943/ 790/64; 24217/20283 tok/s;    500 sec;
[2024-03-11 10:17:49,765 INFO] valid stats calculation
                           took: 3.5608763694763184 s.
[2024-03-11 10:17:49,765 INFO] Train perplexity: 3.52295
[2024-03-11 10:17:49,765 INFO] Train accuracy: 83.1661
[2024-03-11 10:17:49,765 INFO] Sentences processed: 588763
[2024-03-11 10:17:49,765 INFO] Average bsz:  864/ 753/64
[2024-03-11 10:17:49,765 INFO] Validation perplexity: 1.76709e+09
[2024-03-11 10:17:49,765 INFO] Validation accuracy: 8.98516
[2024-03-11 10:17:49,767 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_9200.pt
[2024-03-11 10:17:52,019 INFO] Step 9250/10000; acc: 94.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  829/ 732/64; 7132/6292 tok/s;    506 sec;
[2024-03-11 10:17:54,061 INFO] Step 9300/10000; acc: 95.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  776/ 689/64; 18995/16863 tok/s;    508 sec;
[2024-03-11 10:17:56,148 INFO] Step 9350/10000; acc: 94.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  863/ 728/64; 20667/17449 tok/s;    510 sec;
[2024-03-11 10:17:58,242 INFO] Step 9400/10000; acc: 94.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  835/ 725/64; 19929/17318 tok/s;    512 sec;
[2024-03-11 10:18:01,926 INFO] valid stats calculation
                           took: 3.6831276416778564 s.
[2024-03-11 10:18:01,926 INFO] Train perplexity: 3.46008
[2024-03-11 10:18:01,926 INFO] Train accuracy: 83.3979
[2024-03-11 10:18:01,926 INFO] Sentences processed: 601563
[2024-03-11 10:18:01,926 INFO] Average bsz:  864/ 752/64
[2024-03-11 10:18:01,926 INFO] Validation perplexity: 3.57655e+09
[2024-03-11 10:18:01,926 INFO] Validation accuracy: 9.22583
[2024-03-11 10:18:01,928 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_9400.pt
[2024-03-11 10:18:03,967 INFO] Step 9450/10000; acc: 95.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  822/ 713/64; 7177/6231 tok/s;    518 sec;
[2024-03-11 10:18:06,053 INFO] Step 9500/10000; acc: 94.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  836/ 716/64; 20042/17165 tok/s;    520 sec;
[2024-03-11 10:18:08,184 INFO] Step 9550/10000; acc: 94.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  833/ 764/64; 19546/17928 tok/s;    522 sec;
[2024-03-11 10:18:10,416 INFO] Step 9600/10000; acc: 95.1; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  915/ 797/64; 20512/17858 tok/s;    524 sec;
[2024-03-11 10:18:13,968 INFO] valid stats calculation
                           took: 3.5519487857818604 s.
[2024-03-11 10:18:13,968 INFO] Train perplexity: 3.39805
[2024-03-11 10:18:13,968 INFO] Train accuracy: 83.6338
[2024-03-11 10:18:13,968 INFO] Sentences processed: 614363
[2024-03-11 10:18:13,968 INFO] Average bsz:  863/ 752/64
[2024-03-11 10:18:13,968 INFO] Validation perplexity: 5.93318e+09
[2024-03-11 10:18:13,969 INFO] Validation accuracy: 9.50662
[2024-03-11 10:18:13,970 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_9600.pt
[2024-03-11 10:18:15,852 INFO] Step 9650/10000; acc: 93.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  899/ 773/64; 8265/7106 tok/s;    530 sec;
[2024-03-11 10:18:18,086 INFO] Step 9700/10000; acc: 93.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  876/ 772/64; 19612/17287 tok/s;    532 sec;
[2024-03-11 10:18:19,951 INFO] Step 9750/10000; acc: 94.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  693/ 618/64; 18565/16556 tok/s;    534 sec;
[2024-03-11 10:18:22,078 INFO] Step 9800/10000; acc: 94.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  877/ 766/64; 20618/18023 tok/s;    536 sec;
[2024-03-11 10:18:25,507 INFO] valid stats calculation
                           took: 3.428464889526367 s.
[2024-03-11 10:18:25,507 INFO] Train perplexity: 3.34705
[2024-03-11 10:18:25,507 INFO] Train accuracy: 83.8433
[2024-03-11 10:18:25,507 INFO] Sentences processed: 627163
[2024-03-11 10:18:25,507 INFO] Average bsz:  863/ 752/64
[2024-03-11 10:18:25,507 INFO] Validation perplexity: 1.75425e+09
[2024-03-11 10:18:25,507 INFO] Validation accuracy: 8.82471
[2024-03-11 10:18:25,509 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_9800.pt
[2024-03-11 10:18:26,722 INFO] Step 9850/10000; acc: 94.1; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  756/ 642/64; 8144/6910 tok/s;    541 sec;
[2024-03-11 10:18:28,803 INFO] Step 9900/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz: 1010/ 877/64; 24280/21080 tok/s;    543 sec;
[2024-03-11 10:18:30,990 INFO] Step 9950/10000; acc: 93.8; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  914/ 786/64; 20894/17958 tok/s;    545 sec;
[2024-03-11 10:18:33,202 INFO] Step 10000/10000; acc: 94.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  919/ 808/64; 20779/18260 tok/s;    547 sec;
[2024-03-11 10:18:36,727 INFO] valid stats calculation
                           took: 3.5247018337249756 s.
[2024-03-11 10:18:36,727 INFO] Train perplexity: 3.29236
[2024-03-11 10:18:36,727 INFO] Train accuracy: 84.0589
[2024-03-11 10:18:36,727 INFO] Sentences processed: 639963
[2024-03-11 10:18:36,727 INFO] Average bsz:  864/ 752/64
[2024-03-11 10:18:36,727 INFO] Validation perplexity: 9.23711e+09
[2024-03-11 10:18:36,727 INFO] Validation accuracy: 8.62415
[2024-03-11 10:18:36,729 INFO] Saving checkpoint tg-pretrain/tg-pretrain_02_step_10000.pt
