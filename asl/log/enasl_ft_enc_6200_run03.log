[2024-03-12 10:12:40,438 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-12 10:12:40,438 INFO] Parsed 2 corpora from -data.
[2024-03-12 10:12:40,438 INFO] Loading checkpoint from tg-pt-enc/models/tg-pt-enc_02_step_6200.pt
[2024-03-12 10:12:40,503 INFO] Building model...
[2024-03-12 10:12:40,558 INFO] Switching model to float32 for amp/apex_amp
[2024-03-12 10:12:40,558 INFO] Non quantized layer compute is fp32
[2024-03-12 10:12:42,347 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-12 10:12:42,347 INFO] encoder: 8952800
[2024-03-12 10:12:42,347 INFO] decoder: 16687344
[2024-03-12 10:12:42,347 INFO] * number of parameters: 25640144
[2024-03-12 10:12:42,348 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 10:12:42,348 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 10:12:42,348 INFO]  * src vocab size = 17816
[2024-03-12 10:12:42,348 INFO]  * tgt vocab size = 14144
[2024-03-12 10:12:42,350 INFO] Starting training on GPU: [0]
[2024-03-12 10:12:42,350 INFO] Start training loop and validate every 200 steps...
[2024-03-12 10:12:42,350 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-12 10:12:49,451 INFO] Step 6250/11200; acc: 10.1; ppl: 264726.5; xent: 12.5; lr: 1.00000; sents:    2366; bsz:  591/ 513/47; 4159/3612 tok/s;      7 sec;
[2024-03-12 10:12:52,992 INFO] Step 6300/11200; acc: 11.1; ppl: 8961.3; xent: 9.1; lr: 1.00000; sents:    2273; bsz:  543/ 473/45; 7671/6676 tok/s;     11 sec;
[2024-03-12 10:12:56,533 INFO] Step 6350/11200; acc: 10.5; ppl: 5170.8; xent: 8.6; lr: 1.00000; sents:    2363; bsz:  585/ 508/47; 8262/7172 tok/s;     14 sec;
[2024-03-12 10:12:59,504 INFO] Step 6400/11200; acc: 9.4; ppl: 11615.0; xent: 9.4; lr: 1.00000; sents:    2365; bsz:  585/ 507/47; 9846/8537 tok/s;     17 sec;
[2024-03-12 10:13:03,140 INFO] valid stats calculation
                           took: 3.635601043701172 s.
[2024-03-12 10:13:03,141 INFO] Train perplexity: 19827.5
[2024-03-12 10:13:03,141 INFO] Train accuracy: 10.2659
[2024-03-12 10:13:03,141 INFO] Sentences processed: 9367
[2024-03-12 10:13:03,141 INFO] Average bsz:  576/ 500/47
[2024-03-12 10:13:03,141 INFO] Validation perplexity: 4343.32
[2024-03-12 10:13:03,141 INFO] Validation accuracy: 7.78179
[2024-03-12 10:13:03,142 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_6400.pt
[2024-03-12 10:13:06,764 INFO] Step 6450/11200; acc: 9.3; ppl: 13789.7; xent: 9.5; lr: 1.00000; sents:    2246; bsz:  524/ 455/45; 3611/3134 tok/s;     24 sec;
[2024-03-12 10:13:10,430 INFO] Step 6500/11200; acc: 10.6; ppl: 5820.2; xent: 8.7; lr: 1.00000; sents:    2372; bsz:  589/ 511/47; 8036/6968 tok/s;     28 sec;
[2024-03-12 10:13:14,110 INFO] Step 6550/11200; acc: 8.3; ppl: 8926.5; xent: 9.1; lr: 1.00000; sents:    2275; bsz:  561/ 487/46; 7625/6615 tok/s;     32 sec;
[2024-03-12 10:13:17,198 INFO] Step 6600/11200; acc: 10.4; ppl: 3528.2; xent: 8.2; lr: 1.00000; sents:    2383; bsz:  568/ 495/48; 9205/8015 tok/s;     35 sec;
[2024-03-12 10:13:20,734 INFO] valid stats calculation
                           took: 3.5348501205444336 s.
[2024-03-12 10:13:20,734 INFO] Train perplexity: 11844.1
[2024-03-12 10:13:20,734 INFO] Train accuracy: 9.98176
[2024-03-12 10:13:20,734 INFO] Sentences processed: 18643
[2024-03-12 10:13:20,734 INFO] Average bsz:  568/ 494/47
[2024-03-12 10:13:20,734 INFO] Validation perplexity: 2667.52
[2024-03-12 10:13:20,734 INFO] Validation accuracy: 5.65584
[2024-03-12 10:13:20,736 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_6600.pt
[2024-03-12 10:13:24,402 INFO] Step 6650/11200; acc: 9.9; ppl: 3632.2; xent: 8.2; lr: 1.00000; sents:    2381; bsz:  586/ 509/48; 4071/3536 tok/s;     42 sec;
[2024-03-12 10:13:28,002 INFO] Step 6700/11200; acc: 12.3; ppl: 1692.2; xent: 7.4; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 8045/6948 tok/s;     46 sec;
[2024-03-12 10:13:31,505 INFO] Step 6750/11200; acc: 15.4; ppl: 609.6; xent: 6.4; lr: 1.00000; sents:    2258; bsz:  537/ 467/45; 7664/6671 tok/s;     49 sec;
[2024-03-12 10:13:34,803 INFO] Step 6800/11200; acc: 17.2; ppl: 296.2; xent: 5.7; lr: 1.00000; sents:    2366; bsz:  578/ 500/47; 8762/7588 tok/s;     52 sec;
[2024-03-12 10:13:38,382 INFO] valid stats calculation
                           took: 3.5782721042633057 s.
[2024-03-12 10:13:38,382 INFO] Train perplexity: 5261.74
[2024-03-12 10:13:38,382 INFO] Train accuracy: 11.2139
[2024-03-12 10:13:38,382 INFO] Sentences processed: 28023
[2024-03-12 10:13:38,382 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:13:38,382 INFO] Validation perplexity: 566.672
[2024-03-12 10:13:38,382 INFO] Validation accuracy: 14.5608
[2024-03-12 10:13:38,384 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_6800.pt
[2024-03-12 10:13:42,033 INFO] Step 6850/11200; acc: 19.1; ppl: 206.1; xent: 5.3; lr: 1.00000; sents:    2271; bsz:  567/ 491/45; 3921/3393 tok/s;     60 sec;
[2024-03-12 10:13:45,455 INFO] Step 6900/11200; acc: 21.0; ppl: 146.0; xent: 5.0; lr: 1.00000; sents:    2364; bsz:  567/ 499/47; 8293/7299 tok/s;     63 sec;
[2024-03-12 10:13:49,069 INFO] Step 6950/11200; acc: 22.7; ppl: 112.4; xent: 4.7; lr: 1.00000; sents:    2367; bsz:  587/ 512/47; 8121/7087 tok/s;     67 sec;
[2024-03-12 10:13:52,565 INFO] Step 7000/11200; acc: 26.7; ppl:  73.3; xent: 4.3; lr: 1.00000; sents:    2261; bsz:  554/ 479/45; 7925/6845 tok/s;     70 sec;
[2024-03-12 10:13:56,142 INFO] valid stats calculation
                           took: 3.5764174461364746 s.
[2024-03-12 10:13:56,142 INFO] Train perplexity: 2065.18
[2024-03-12 10:13:56,142 INFO] Train accuracy: 14.0028
[2024-03-12 10:13:56,142 INFO] Sentences processed: 37286
[2024-03-12 10:13:56,142 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:13:56,142 INFO] Validation perplexity: 304.761
[2024-03-12 10:13:56,142 INFO] Validation accuracy: 19.0132
[2024-03-12 10:13:56,144 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_7000.pt
[2024-03-12 10:13:59,896 INFO] Step 7050/11200; acc: 29.5; ppl:  54.4; xent: 4.0; lr: 1.00000; sents:    2373; bsz:  575/ 499/47; 3925/3406 tok/s;     78 sec;
[2024-03-12 10:14:03,533 INFO] Step 7100/11200; acc: 31.8; ppl:  41.0; xent: 3.7; lr: 1.00000; sents:    2371; bsz:  563/ 491/47; 7745/6745 tok/s;     81 sec;
[2024-03-12 10:14:07,270 INFO] Step 7150/11200; acc: 34.4; ppl:  32.2; xent: 3.5; lr: 1.00000; sents:    2376; bsz:  565/ 495/48; 7566/6625 tok/s;     85 sec;
[2024-03-12 10:14:10,857 INFO] Step 7200/11200; acc: 36.3; ppl:  26.8; xent: 3.3; lr: 1.00000; sents:    2284; bsz:  563/ 486/46; 7849/6778 tok/s;     89 sec;
[2024-03-12 10:14:14,471 INFO] valid stats calculation
                           took: 3.6139371395111084 s.
[2024-03-12 10:14:14,472 INFO] Train perplexity: 927.114
[2024-03-12 10:14:14,472 INFO] Train accuracy: 17.788
[2024-03-12 10:14:14,472 INFO] Sentences processed: 46690
[2024-03-12 10:14:14,472 INFO] Average bsz:  568/ 494/47
[2024-03-12 10:14:14,472 INFO] Validation perplexity: 310.632
[2024-03-12 10:14:14,472 INFO] Validation accuracy: 23.6262
[2024-03-12 10:14:14,473 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_7200.pt
[2024-03-12 10:14:18,142 INFO] Step 7250/11200; acc: 37.9; ppl:  22.2; xent: 3.1; lr: 1.00000; sents:    2376; bsz:  581/ 505/48; 3986/3463 tok/s;     96 sec;
[2024-03-12 10:14:21,754 INFO] Step 7300/11200; acc: 40.3; ppl:  17.9; xent: 2.9; lr: 1.00000; sents:    2275; bsz:  561/ 484/46; 7770/6704 tok/s;     99 sec;
[2024-03-12 10:14:25,343 INFO] Step 7350/11200; acc: 42.2; ppl:  16.1; xent: 2.8; lr: 1.00000; sents:    2371; bsz:  578/ 498/47; 8055/6937 tok/s;    103 sec;
[2024-03-12 10:14:28,925 INFO] Step 7400/11200; acc: 44.4; ppl:  13.4; xent: 2.6; lr: 1.00000; sents:    2366; bsz:  563/ 491/47; 7864/6851 tok/s;    107 sec;
[2024-03-12 10:14:32,474 INFO] valid stats calculation
                           took: 3.548715591430664 s.
[2024-03-12 10:14:32,474 INFO] Train perplexity: 476.358
[2024-03-12 10:14:32,474 INFO] Train accuracy: 21.6891
[2024-03-12 10:14:32,474 INFO] Sentences processed: 56078
[2024-03-12 10:14:32,475 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:14:32,475 INFO] Validation perplexity: 306.166
[2024-03-12 10:14:32,475 INFO] Validation accuracy: 27.1961
[2024-03-12 10:14:32,476 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_7400.pt
[2024-03-12 10:14:36,043 INFO] Step 7450/11200; acc: 46.1; ppl:  11.8; xent: 2.5; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 3952/3427 tok/s;    114 sec;
[2024-03-12 10:14:39,516 INFO] Step 7500/11200; acc: 48.0; ppl:  10.2; xent: 2.3; lr: 1.00000; sents:    2462; bsz:  586/ 508/49; 8430/7317 tok/s;    117 sec;
[2024-03-12 10:14:43,070 INFO] Step 7550/11200; acc: 49.4; ppl:   9.1; xent: 2.2; lr: 1.00000; sents:    2269; bsz:  564/ 488/45; 7935/6867 tok/s;    121 sec;
[2024-03-12 10:14:46,566 INFO] Step 7600/11200; acc: 50.8; ppl:   8.2; xent: 2.1; lr: 1.00000; sents:    2367; bsz:  579/ 500/47; 8287/7150 tok/s;    124 sec;
[2024-03-12 10:14:50,091 INFO] valid stats calculation
                           took: 3.524108409881592 s.
[2024-03-12 10:14:50,091 INFO] Train perplexity: 272.725
[2024-03-12 10:14:50,091 INFO] Train accuracy: 25.5437
[2024-03-12 10:14:50,091 INFO] Sentences processed: 65444
[2024-03-12 10:14:50,091 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:14:50,091 INFO] Validation perplexity: 392.098
[2024-03-12 10:14:50,091 INFO] Validation accuracy: 27.6775
[2024-03-12 10:14:50,092 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_7600.pt
[2024-03-12 10:14:53,309 INFO] Step 7650/11200; acc: 53.9; ppl:   7.1; xent: 2.0; lr: 1.00000; sents:    2372; bsz:  564/ 489/47; 4184/3628 tok/s;    131 sec;
[2024-03-12 10:14:56,909 INFO] Step 7700/11200; acc: 55.2; ppl:   6.6; xent: 1.9; lr: 1.00000; sents:    2271; bsz:  562/ 485/45; 7806/6737 tok/s;    135 sec;
[2024-03-12 10:15:00,587 INFO] Step 7750/11200; acc: 57.0; ppl:   5.8; xent: 1.8; lr: 1.00000; sents:    2273; bsz:  560/ 486/45; 7611/6608 tok/s;    138 sec;
[2024-03-12 10:15:04,135 INFO] Step 7800/11200; acc: 59.0; ppl:   5.2; xent: 1.6; lr: 1.00000; sents:    2382; bsz:  566/ 493/48; 7978/6947 tok/s;    142 sec;
[2024-03-12 10:15:07,700 INFO] valid stats calculation
                           took: 3.564427137374878 s.
[2024-03-12 10:15:07,700 INFO] Train perplexity: 170.475
[2024-03-12 10:15:07,700 INFO] Train accuracy: 29.3469
[2024-03-12 10:15:07,700 INFO] Sentences processed: 74742
[2024-03-12 10:15:07,700 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:15:07,700 INFO] Validation perplexity: 550.17
[2024-03-12 10:15:07,700 INFO] Validation accuracy: 27.4769
[2024-03-12 10:15:07,702 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_7800.pt
[2024-03-12 10:15:10,742 INFO] Step 7850/11200; acc: 59.9; ppl:   4.9; xent: 1.6; lr: 1.00000; sents:    2376; bsz:  580/ 501/48; 4387/3791 tok/s;    148 sec;
[2024-03-12 10:15:14,330 INFO] Step 7900/11200; acc: 61.5; ppl:   4.4; xent: 1.5; lr: 1.00000; sents:    2376; bsz:  568/ 496/48; 7922/6913 tok/s;    152 sec;
[2024-03-12 10:15:17,973 INFO] Step 7950/11200; acc: 62.9; ppl:   4.2; xent: 1.4; lr: 1.00000; sents:    2272; bsz:  563/ 488/45; 7728/6703 tok/s;    156 sec;
[2024-03-12 10:15:21,563 INFO] Step 8000/11200; acc: 63.9; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    2366; bsz:  589/ 511/47; 8204/7118 tok/s;    159 sec;
[2024-03-12 10:15:25,095 INFO] valid stats calculation
                           took: 3.531541109085083 s.
[2024-03-12 10:15:25,096 INFO] Train perplexity: 112.941
[2024-03-12 10:15:25,096 INFO] Train accuracy: 33.0166
[2024-03-12 10:15:25,096 INFO] Sentences processed: 84132
[2024-03-12 10:15:25,096 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:15:25,096 INFO] Validation perplexity: 685.917
[2024-03-12 10:15:25,096 INFO] Validation accuracy: 27.9984
[2024-03-12 10:15:25,097 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_8000.pt
[2024-03-12 10:15:27,926 INFO] Step 8050/11200; acc: 65.4; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    2369; bsz:  587/ 508/47; 4613/3990 tok/s;    166 sec;
[2024-03-12 10:15:31,520 INFO] Step 8100/11200; acc: 67.4; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    2363; bsz:  565/ 492/47; 7856/6839 tok/s;    169 sec;
[2024-03-12 10:15:35,000 INFO] Step 8150/11200; acc: 68.9; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    2244; bsz:  547/ 474/45; 7863/6809 tok/s;    173 sec;
[2024-03-12 10:15:38,587 INFO] Step 8200/11200; acc: 69.2; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    2367; bsz:  579/ 502/47; 8074/6994 tok/s;    176 sec;
[2024-03-12 10:15:42,004 INFO] valid stats calculation
                           took: 3.4163830280303955 s.
[2024-03-12 10:15:42,004 INFO] Train perplexity: 79.3858
[2024-03-12 10:15:42,004 INFO] Train accuracy: 36.482
[2024-03-12 10:15:42,004 INFO] Sentences processed: 93475
[2024-03-12 10:15:42,004 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:15:42,004 INFO] Validation perplexity: 1009.4
[2024-03-12 10:15:42,004 INFO] Validation accuracy: 26.6747
[2024-03-12 10:15:42,006 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_8200.pt
[2024-03-12 10:15:44,559 INFO] Step 8250/11200; acc: 71.3; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    2268; bsz:  539/ 468/45; 4516/3919 tok/s;    182 sec;
[2024-03-12 10:15:48,265 INFO] Step 8300/11200; acc: 71.6; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    2379; bsz:  587/ 510/48; 7915/6883 tok/s;    186 sec;
[2024-03-12 10:15:51,937 INFO] Step 8350/11200; acc: 73.1; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    2383; bsz:  583/ 507/48; 7940/6900 tok/s;    190 sec;
[2024-03-12 10:15:55,494 INFO] Step 8400/11200; acc: 75.4; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2267; bsz:  539/ 469/45; 7579/6588 tok/s;    193 sec;
[2024-03-12 10:15:58,955 INFO] valid stats calculation
                           took: 3.4606380462646484 s.
[2024-03-12 10:15:58,955 INFO] Train perplexity: 58.4614
[2024-03-12 10:15:58,955 INFO] Train accuracy: 39.7522
[2024-03-12 10:15:58,955 INFO] Sentences processed: 102772
[2024-03-12 10:15:58,955 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:15:58,955 INFO] Validation perplexity: 1564
[2024-03-12 10:15:58,955 INFO] Validation accuracy: 26.5945
[2024-03-12 10:15:58,957 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_8400.pt
[2024-03-12 10:16:01,450 INFO] Step 8450/11200; acc: 75.5; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 4857/4197 tok/s;    199 sec;
[2024-03-12 10:16:04,936 INFO] Step 8500/11200; acc: 75.1; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2372; bsz:  586/ 513/47; 8407/7360 tok/s;    203 sec;
[2024-03-12 10:16:08,537 INFO] Step 8550/11200; acc: 77.8; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2270; bsz:  548/ 476/45; 7606/6609 tok/s;    206 sec;
[2024-03-12 10:16:12,110 INFO] Step 8600/11200; acc: 77.3; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2367; bsz:  588/ 515/47; 8224/7201 tok/s;    210 sec;
[2024-03-12 10:16:15,574 INFO] valid stats calculation
                           took: 3.46345591545105 s.
[2024-03-12 10:16:15,574 INFO] Train perplexity: 44.4689
[2024-03-12 10:16:15,574 INFO] Train accuracy: 42.8469
[2024-03-12 10:16:15,574 INFO] Sentences processed: 112156
[2024-03-12 10:16:15,575 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:16:15,575 INFO] Validation perplexity: 2174.31
[2024-03-12 10:16:15,575 INFO] Validation accuracy: 26.3538
[2024-03-12 10:16:15,576 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_8600.pt
[2024-03-12 10:16:18,016 INFO] Step 8650/11200; acc: 79.1; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2364; bsz:  561/ 487/47; 4746/4125 tok/s;    216 sec;
[2024-03-12 10:16:21,106 INFO] Step 8700/11200; acc: 79.1; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2263; bsz:  566/ 485/45; 9154/7854 tok/s;    219 sec;
[2024-03-12 10:16:24,542 INFO] Step 8750/11200; acc: 81.1; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2365; bsz:  562/ 489/47; 8171/7115 tok/s;    222 sec;
[2024-03-12 10:16:28,151 INFO] Step 8800/11200; acc: 80.9; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2373; bsz:  567/ 495/47; 7851/6865 tok/s;    226 sec;
[2024-03-12 10:16:31,655 INFO] valid stats calculation
                           took: 3.50301456451416 s.
[2024-03-12 10:16:31,655 INFO] Train perplexity: 35.0966
[2024-03-12 10:16:31,655 INFO] Train accuracy: 45.681
[2024-03-12 10:16:31,655 INFO] Sentences processed: 121521
[2024-03-12 10:16:31,655 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:16:31,655 INFO] Validation perplexity: 2637.09
[2024-03-12 10:16:31,655 INFO] Validation accuracy: 27.9984
[2024-03-12 10:16:31,656 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_8800.pt
[2024-03-12 10:16:34,523 INFO] Step 8850/11200; acc: 81.6; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2371; bsz:  580/ 506/47; 4552/3968 tok/s;    232 sec;
[2024-03-12 10:16:37,400 INFO] Step 8900/11200; acc: 83.1; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2279; bsz:  562/ 486/46; 9775/8442 tok/s;    235 sec;
[2024-03-12 10:16:40,950 INFO] Step 8950/11200; acc: 82.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2281; bsz:  563/ 486/46; 7926/6848 tok/s;    239 sec;
[2024-03-12 10:16:44,433 INFO] Step 9000/11200; acc: 84.0; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2476; bsz:  582/ 503/50; 8349/7226 tok/s;    242 sec;
[2024-03-12 10:16:47,907 INFO] valid stats calculation
                           took: 3.4730582237243652 s.
[2024-03-12 10:16:47,907 INFO] Train perplexity: 28.3723
[2024-03-12 10:16:47,907 INFO] Train accuracy: 48.3422
[2024-03-12 10:16:47,907 INFO] Sentences processed: 130928
[2024-03-12 10:16:47,907 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:16:47,907 INFO] Validation perplexity: 2776.36
[2024-03-12 10:16:47,907 INFO] Validation accuracy: 27.1961
[2024-03-12 10:16:47,909 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_9000.pt
[2024-03-12 10:16:51,007 INFO] Step 9050/11200; acc: 84.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2275; bsz:  562/ 485/46; 4276/3692 tok/s;    249 sec;
[2024-03-12 10:16:53,663 INFO] Step 9100/11200; acc: 84.4; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2371; bsz:  566/ 491/47; 10647/9239 tok/s;    251 sec;
[2024-03-12 10:16:57,319 INFO] Step 9150/11200; acc: 85.0; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2366; bsz:  584/ 506/47; 7989/6928 tok/s;    255 sec;
[2024-03-12 10:17:00,923 INFO] Step 9200/11200; acc: 85.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 7817/6776 tok/s;    259 sec;
[2024-03-12 10:17:04,393 INFO] valid stats calculation
                           took: 3.4692182540893555 s.
[2024-03-12 10:17:04,393 INFO] Train perplexity: 23.5015
[2024-03-12 10:17:04,393 INFO] Train accuracy: 50.7746
[2024-03-12 10:17:04,393 INFO] Sentences processed: 140208
[2024-03-12 10:17:04,393 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:17:04,393 INFO] Validation perplexity: 3341.46
[2024-03-12 10:17:04,393 INFO] Validation accuracy: 28.5199
[2024-03-12 10:17:04,395 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_9200.pt
[2024-03-12 10:17:07,511 INFO] Step 9250/11200; acc: 85.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2362; bsz:  579/ 499/47; 4392/3787 tok/s;    265 sec;
[2024-03-12 10:17:10,041 INFO] Step 9300/11200; acc: 86.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2267; bsz:  544/ 472/45; 10754/9334 tok/s;    268 sec;
[2024-03-12 10:17:13,593 INFO] Step 9350/11200; acc: 86.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2369; bsz:  580/ 501/47; 8171/7050 tok/s;    271 sec;
[2024-03-12 10:17:17,255 INFO] Step 9400/11200; acc: 86.7; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2372; bsz:  583/ 504/47; 7959/6886 tok/s;    275 sec;
[2024-03-12 10:17:20,676 INFO] valid stats calculation
                           took: 3.421159267425537 s.
[2024-03-12 10:17:20,677 INFO] Train perplexity: 19.8597
[2024-03-12 10:17:20,677 INFO] Train accuracy: 52.9995
[2024-03-12 10:17:20,677 INFO] Sentences processed: 149578
[2024-03-12 10:17:20,677 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:17:20,677 INFO] Validation perplexity: 4040.06
[2024-03-12 10:17:20,677 INFO] Validation accuracy: 27.8379
[2024-03-12 10:17:20,678 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_9400.pt
[2024-03-12 10:17:24,098 INFO] Step 9450/11200; acc: 87.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2269; bsz:  559/ 485/45; 4084/3543 tok/s;    282 sec;
[2024-03-12 10:17:26,532 INFO] Step 9500/11200; acc: 87.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  565/ 492/48; 11615/10117 tok/s;    284 sec;
[2024-03-12 10:17:29,963 INFO] Step 9550/11200; acc: 87.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2382; bsz:  589/ 510/48; 8581/7438 tok/s;    288 sec;
[2024-03-12 10:17:33,577 INFO] Step 9600/11200; acc: 88.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2376; bsz:  569/ 497/48; 7877/6879 tok/s;    291 sec;
[2024-03-12 10:17:37,401 INFO] valid stats calculation
                           took: 3.823730707168579 s.
[2024-03-12 10:17:37,401 INFO] Train perplexity: 17.0517
[2024-03-12 10:17:37,402 INFO] Train accuracy: 55.063
[2024-03-12 10:17:37,402 INFO] Sentences processed: 158980
[2024-03-12 10:17:37,402 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:17:37,402 INFO] Validation perplexity: 4603.12
[2024-03-12 10:17:37,402 INFO] Validation accuracy: 28.6402
[2024-03-12 10:17:37,403 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_9600.pt
[2024-03-12 10:17:40,979 INFO] Step 9650/11200; acc: 88.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2280; bsz:  565/ 490/46; 3817/3312 tok/s;    299 sec;
[2024-03-12 10:17:43,389 INFO] Step 9700/11200; acc: 89.3; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2247; bsz:  550/ 477/45; 11403/9889 tok/s;    301 sec;
[2024-03-12 10:17:45,918 INFO] Step 9750/11200; acc: 89.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2487; bsz:  601/ 520/50; 11880/10291 tok/s;    304 sec;
[2024-03-12 10:17:48,292 INFO] Step 9800/11200; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2248; bsz:  551/ 478/45; 11617/10078 tok/s;    306 sec;
[2024-03-12 10:17:52,560 INFO] valid stats calculation
                           took: 4.267729043960571 s.
[2024-03-12 10:17:52,560 INFO] Train perplexity: 14.8706
[2024-03-12 10:17:52,561 INFO] Train accuracy: 56.9658
[2024-03-12 10:17:52,561 INFO] Sentences processed: 168242
[2024-03-12 10:17:52,561 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:17:52,561 INFO] Validation perplexity: 5737.07
[2024-03-12 10:17:52,561 INFO] Validation accuracy: 27.3566
[2024-03-12 10:17:52,563 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_9800.pt
[2024-03-12 10:17:55,297 INFO] Step 9850/11200; acc: 89.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2363; bsz:  576/ 498/47; 4115/3554 tok/s;    313 sec;
[2024-03-12 10:17:58,332 INFO] Step 9900/11200; acc: 90.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2251; bsz:  552/ 480/45; 9096/7908 tok/s;    316 sec;
[2024-03-12 10:18:00,867 INFO] Step 9950/11200; acc: 90.5; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  566/ 492/47; 11162/9703 tok/s;    319 sec;
[2024-03-12 10:18:03,645 INFO] Step 10000/11200; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2274; bsz:  563/ 490/45; 10131/8811 tok/s;    321 sec;
[2024-03-12 10:18:07,408 INFO] valid stats calculation
                           took: 3.7626423835754395 s.
[2024-03-12 10:18:07,409 INFO] Train perplexity: 13.1449
[2024-03-12 10:18:07,409 INFO] Train accuracy: 58.6961
[2024-03-12 10:18:07,409 INFO] Sentences processed: 177502
[2024-03-12 10:18:07,409 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:18:07,409 INFO] Validation perplexity: 5872.9
[2024-03-12 10:18:07,409 INFO] Validation accuracy: 27.517
[2024-03-12 10:18:07,410 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_10000.pt
[2024-03-12 10:18:10,363 INFO] Step 10050/11200; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2482; bsz:  589/ 517/50; 4385/3849 tok/s;    328 sec;
[2024-03-12 10:18:13,171 INFO] Step 10100/11200; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2274; bsz:  555/ 478/45; 9888/8518 tok/s;    331 sec;
[2024-03-12 10:18:16,066 INFO] Step 10150/11200; acc: 91.1; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2277; bsz:  566/ 489/46; 9773/8448 tok/s;    334 sec;
[2024-03-12 10:18:19,088 INFO] Step 10200/11200; acc: 91.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  565/ 493/48; 9356/8160 tok/s;    337 sec;
[2024-03-12 10:18:23,131 INFO] valid stats calculation
                           took: 4.042378902435303 s.
[2024-03-12 10:18:23,131 INFO] Train perplexity: 11.7297
[2024-03-12 10:18:23,131 INFO] Train accuracy: 60.3208
[2024-03-12 10:18:23,131 INFO] Sentences processed: 186912
[2024-03-12 10:18:23,131 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:18:23,131 INFO] Validation perplexity: 7512.71
[2024-03-12 10:18:23,131 INFO] Validation accuracy: 26.8351
[2024-03-12 10:18:23,133 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_10200.pt
[2024-03-12 10:18:26,034 INFO] Step 10250/11200; acc: 91.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  587/ 515/47; 4228/3708 tok/s;    344 sec;
[2024-03-12 10:18:28,835 INFO] Step 10300/11200; acc: 91.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2264; bsz:  559/ 483/45; 9979/8626 tok/s;    346 sec;
[2024-03-12 10:18:31,263 INFO] Step 10350/11200; acc: 92.0; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  561/ 488/47; 11558/10062 tok/s;    349 sec;
[2024-03-12 10:18:33,711 INFO] Step 10400/11200; acc: 91.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2364; bsz:  572/ 494/47; 11679/10085 tok/s;    351 sec;
[2024-03-12 10:18:37,961 INFO] valid stats calculation
                           took: 4.250022649765015 s.
[2024-03-12 10:18:37,961 INFO] Train perplexity: 10.5714
[2024-03-12 10:18:37,962 INFO] Train accuracy: 61.8196
[2024-03-12 10:18:37,962 INFO] Sentences processed: 196278
[2024-03-12 10:18:37,962 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:18:37,962 INFO] Validation perplexity: 7803.07
[2024-03-12 10:18:37,962 INFO] Validation accuracy: 26.3538
[2024-03-12 10:18:37,963 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_10400.pt
[2024-03-12 10:18:40,909 INFO] Step 10450/11200; acc: 91.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  578/ 503/47; 4015/3495 tok/s;    359 sec;
[2024-03-12 10:18:43,793 INFO] Step 10500/11200; acc: 92.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2268; bsz:  561/ 485/45; 9730/8407 tok/s;    361 sec;
[2024-03-12 10:18:46,642 INFO] Step 10550/11200; acc: 91.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2373; bsz:  566/ 495/47; 9933/8688 tok/s;    364 sec;
[2024-03-12 10:18:49,208 INFO] Step 10600/11200; acc: 92.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2271; bsz:  564/ 489/45; 10999/9526 tok/s;    367 sec;
[2024-03-12 10:18:53,162 INFO] valid stats calculation
                           took: 3.953047513961792 s.
[2024-03-12 10:18:53,162 INFO] Train perplexity: 9.61345
[2024-03-12 10:18:53,162 INFO] Train accuracy: 63.1958
[2024-03-12 10:18:53,163 INFO] Sentences processed: 205557
[2024-03-12 10:18:53,163 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:18:53,163 INFO] Validation perplexity: 9049.05
[2024-03-12 10:18:53,163 INFO] Validation accuracy: 27.3566
[2024-03-12 10:18:53,165 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_10600.pt
[2024-03-12 10:18:55,815 INFO] Step 10650/11200; acc: 92.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  563/ 488/48; 4264/3696 tok/s;    373 sec;
[2024-03-12 10:18:58,383 INFO] Step 10700/11200; acc: 92.8; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2382; bsz:  577/ 497/48; 11230/9686 tok/s;    376 sec;
[2024-03-12 10:19:01,334 INFO] Step 10750/11200; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2376; bsz:  567/ 491/48; 9610/8325 tok/s;    379 sec;
[2024-03-12 10:19:04,326 INFO] Step 10800/11200; acc: 92.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  586/ 508/48; 9801/8493 tok/s;    382 sec;
[2024-03-12 10:19:08,101 INFO] valid stats calculation
                           took: 3.774226427078247 s.
[2024-03-12 10:19:08,101 INFO] Train perplexity: 8.80387
[2024-03-12 10:19:08,101 INFO] Train accuracy: 64.486
[2024-03-12 10:19:08,101 INFO] Sentences processed: 215065
[2024-03-12 10:19:08,101 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:19:08,101 INFO] Validation perplexity: 9378.45
[2024-03-12 10:19:08,101 INFO] Validation accuracy: 27.3566
[2024-03-12 10:19:08,103 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_10800.pt
[2024-03-12 10:19:11,000 INFO] Step 10850/11200; acc: 93.0; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2273; bsz:  564/ 489/45; 4229/3663 tok/s;    389 sec;
[2024-03-12 10:19:13,541 INFO] Step 10900/11200; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2366; bsz:  579/ 500/47; 11395/9832 tok/s;    391 sec;
[2024-03-12 10:19:16,286 INFO] Step 10950/11200; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2366; bsz:  563/ 489/47; 10258/8909 tok/s;    394 sec;
[2024-03-12 10:19:19,298 INFO] Step 11000/11200; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 9298/8018 tok/s;    397 sec;
[2024-03-12 10:19:23,143 INFO] valid stats calculation
                           took: 3.8445687294006348 s.
[2024-03-12 10:19:23,143 INFO] Train perplexity: 8.12573
[2024-03-12 10:19:23,143 INFO] Train accuracy: 65.6696
[2024-03-12 10:19:23,143 INFO] Sentences processed: 224332
[2024-03-12 10:19:23,143 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:19:23,143 INFO] Validation perplexity: 10365.5
[2024-03-12 10:19:23,143 INFO] Validation accuracy: 26.8351
[2024-03-12 10:19:23,145 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_11000.pt
[2024-03-12 10:19:25,592 INFO] Step 11050/11200; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2267; bsz:  560/ 486/45; 4450/3860 tok/s;    403 sec;
[2024-03-12 10:19:28,092 INFO] Step 11100/11200; acc: 93.2; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  564/ 493/47; 11286/9857 tok/s;    406 sec;
[2024-03-12 10:19:31,471 INFO] Step 11150/11200; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2372; bsz:  582/ 503/47; 8610/7450 tok/s;    409 sec;
[2024-03-12 10:19:34,109 INFO] Step 11200/11200; acc: 93.4; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2371; bsz:  567/ 494/47; 10756/9361 tok/s;    412 sec;
[2024-03-12 10:19:38,141 INFO] valid stats calculation
                           took: 4.031805753707886 s.
[2024-03-12 10:19:38,142 INFO] Train perplexity: 7.54256
[2024-03-12 10:19:38,142 INFO] Train accuracy: 66.7689
[2024-03-12 10:19:38,142 INFO] Sentences processed: 233709
[2024-03-12 10:19:38,142 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:19:38,142 INFO] Validation perplexity: 13899.4
[2024-03-12 10:19:38,142 INFO] Validation accuracy: 27.5572
[2024-03-12 10:19:38,144 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_03_step_11200.pt
