[2024-03-11 10:00:05,442 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-11 10:00:05,442 INFO] Parsed 2 corpora from -data.
[2024-03-11 10:00:05,442 INFO] Get special vocabs from Transforms: {'src': [], 'tgt': []}.
[2024-03-11 10:00:05,476 INFO] The first 10 tokens of the vocabs are:['<unk>', '<blank>', '<s>', '</s>', '.', 'the', ',', 'of', 'to', 'is']
[2024-03-11 10:00:05,477 INFO] The decoder start token is: <s>
[2024-03-11 10:00:05,477 INFO] Building model...
[2024-03-11 10:00:05,714 INFO] Switching model to float32 for amp/apex_amp
[2024-03-11 10:00:05,714 INFO] Non quantized layer compute is fp32
[2024-03-11 10:00:07,474 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(500, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(1000, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-11 10:00:07,474 INFO] encoder: 12916000
[2024-03-11 10:00:07,474 INFO] decoder: 19916144
[2024-03-11 10:00:07,474 INFO] * number of parameters: 32832144
[2024-03-11 10:00:07,475 INFO] Trainable parameters = {'torch.float32': 32832144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-11 10:00:07,475 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-11 10:00:07,475 INFO]  * src vocab size = 17816
[2024-03-11 10:00:07,475 INFO]  * tgt vocab size = 14144
[2024-03-11 10:00:07,475 INFO] Starting training on GPU: [0]
[2024-03-11 10:00:07,476 INFO] Start training loop and validate every 200 steps...
[2024-03-11 10:00:07,476 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-11 10:00:25,077 INFO] Step 50/10000; acc: 5.6; ppl: 125586.7; xent: 11.7; lr: 1.00000; sents:    3200; bsz:  798/ 681/64; 2266/1935 tok/s;     18 sec;
[2024-03-11 10:00:27,097 INFO] Step 100/10000; acc: 6.3; ppl: 6746.2; xent: 8.8; lr: 1.00000; sents:    3200; bsz:  856/ 735/64; 21191/18182 tok/s;     20 sec;
[2024-03-11 10:00:29,099 INFO] Step 150/10000; acc: 6.9; ppl: 1823.5; xent: 7.5; lr: 1.00000; sents:    3200; bsz:  824/ 702/64; 20587/17523 tok/s;     22 sec;
[2024-03-11 10:00:30,907 INFO] Step 200/10000; acc: 7.7; ppl: 1022.1; xent: 6.9; lr: 1.00000; sents:    3200; bsz:  904/ 794/64; 25002/21956 tok/s;     23 sec;
[2024-03-11 10:00:34,466 INFO] valid stats calculation
                           took: 3.55837345123291 s.
[2024-03-11 10:00:34,466 INFO] Train perplexity: 5831.21
[2024-03-11 10:00:34,466 INFO] Train accuracy: 6.6603
[2024-03-11 10:00:34,466 INFO] Sentences processed: 12800
[2024-03-11 10:00:34,466 INFO] Average bsz:  845/ 728/64
[2024-03-11 10:00:34,466 INFO] Validation perplexity: 8079.91
[2024-03-11 10:00:34,466 INFO] Validation accuracy: 10.4292
[2024-03-11 10:00:34,468 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_200.pt
[2024-03-11 10:00:36,780 INFO] Step 250/10000; acc: 8.0; ppl: 916.9; xent: 6.8; lr: 1.00000; sents:    3200; bsz:  946/ 803/64; 8053/6838 tok/s;     29 sec;
[2024-03-11 10:00:38,815 INFO] Step 300/10000; acc: 9.1; ppl: 781.6; xent: 6.7; lr: 1.00000; sents:    3200; bsz:  861/ 750/64; 21172/18436 tok/s;     31 sec;
[2024-03-11 10:00:40,704 INFO] Step 350/10000; acc: 11.9; ppl: 585.5; xent: 6.4; lr: 1.00000; sents:    3200; bsz:  767/ 679/64; 20311/17968 tok/s;     33 sec;
[2024-03-11 10:00:42,654 INFO] Step 400/10000; acc: 12.9; ppl: 541.0; xent: 6.3; lr: 1.00000; sents:    3200; bsz:  800/ 697/64; 20514/17867 tok/s;     35 sec;
[2024-03-11 10:00:46,191 INFO] valid stats calculation
                           took: 3.536693811416626 s.
[2024-03-11 10:00:46,192 INFO] Train perplexity: 2013.41
[2024-03-11 10:00:46,192 INFO] Train accuracy: 8.50711
[2024-03-11 10:00:46,192 INFO] Sentences processed: 25600
[2024-03-11 10:00:46,192 INFO] Average bsz:  845/ 730/64
[2024-03-11 10:00:46,192 INFO] Validation perplexity: 7787.78
[2024-03-11 10:00:46,192 INFO] Validation accuracy: 6.29763
[2024-03-11 10:00:46,193 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_400.pt
[2024-03-11 10:00:48,144 INFO] Step 450/10000; acc: 14.4; ppl: 467.5; xent: 6.1; lr: 1.00000; sents:    3200; bsz:  870/ 750/64; 7928/6830 tok/s;     41 sec;
[2024-03-11 10:00:50,317 INFO] Step 500/10000; acc: 14.3; ppl: 421.0; xent: 6.0; lr: 1.00000; sents:    3200; bsz:  960/ 832/64; 22088/19140 tok/s;     43 sec;
[2024-03-11 10:00:52,458 INFO] Step 550/10000; acc: 16.7; ppl: 337.1; xent: 5.8; lr: 1.00000; sents:    3200; bsz:  910/ 816/64; 21251/19058 tok/s;     45 sec;
[2024-03-11 10:00:54,468 INFO] Step 600/10000; acc: 19.7; ppl: 296.9; xent: 5.7; lr: 1.00000; sents:    3200; bsz:  803/ 700/64; 19972/17426 tok/s;     47 sec;
[2024-03-11 10:00:57,990 INFO] valid stats calculation
                           took: 3.5220229625701904 s.
[2024-03-11 10:00:57,990 INFO] Train perplexity: 1125.83
[2024-03-11 10:00:57,990 INFO] Train accuracy: 11.1657
[2024-03-11 10:00:57,991 INFO] Sentences processed: 38400
[2024-03-11 10:00:57,991 INFO] Average bsz:  858/ 745/64
[2024-03-11 10:00:57,991 INFO] Validation perplexity: 13689.5
[2024-03-11 10:00:57,991 INFO] Validation accuracy: 9.02527
[2024-03-11 10:00:57,992 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_600.pt
[2024-03-11 10:00:59,685 INFO] Step 650/10000; acc: 21.5; ppl: 257.2; xent: 5.5; lr: 1.00000; sents:    3200; bsz:  925/ 800/64; 8869/7662 tok/s;     52 sec;
[2024-03-11 10:01:01,740 INFO] Step 700/10000; acc: 27.8; ppl: 169.6; xent: 5.1; lr: 1.00000; sents:    3200; bsz:  823/ 731/64; 20046/17804 tok/s;     54 sec;
[2024-03-11 10:01:03,724 INFO] Step 750/10000; acc: 32.6; ppl: 134.1; xent: 4.9; lr: 1.00000; sents:    3200; bsz:  822/ 704/64; 20712/17735 tok/s;     56 sec;
[2024-03-11 10:01:05,795 INFO] Step 800/10000; acc: 39.6; ppl:  79.6; xent: 4.4; lr: 1.00000; sents:    3200; bsz:  918/ 800/64; 22160/19320 tok/s;     58 sec;
[2024-03-11 10:01:09,185 INFO] valid stats calculation
                           took: 3.3898329734802246 s.
[2024-03-11 10:01:09,186 INFO] Train perplexity: 671.77
[2024-03-11 10:01:09,186 INFO] Train accuracy: 16.0354
[2024-03-11 10:01:09,186 INFO] Sentences processed: 51200
[2024-03-11 10:01:09,186 INFO] Average bsz:  862/ 748/64
[2024-03-11 10:01:09,186 INFO] Validation perplexity: 63057.7
[2024-03-11 10:01:09,186 INFO] Validation accuracy: 10.349
[2024-03-11 10:01:09,188 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_800.pt
[2024-03-11 10:01:10,491 INFO] Step 850/10000; acc: 47.1; ppl:  47.4; xent: 3.9; lr: 1.00000; sents:    3200; bsz:  841/ 716/64; 8954/7624 tok/s;     63 sec;
[2024-03-11 10:01:12,236 INFO] Step 900/10000; acc: 54.6; ppl:  25.7; xent: 3.2; lr: 1.00000; sents:    3200; bsz:  897/ 768/64; 25713/22008 tok/s;     65 sec;
[2024-03-11 10:01:14,212 INFO] Step 950/10000; acc: 59.0; ppl:  18.3; xent: 2.9; lr: 1.00000; sents:    3200; bsz:  780/ 702/64; 19729/17761 tok/s;     67 sec;
[2024-03-11 10:01:16,265 INFO] Step 1000/10000; acc: 65.5; ppl:  11.6; xent: 2.5; lr: 1.00000; sents:    3200; bsz:  842/ 733/64; 20511/17841 tok/s;     69 sec;
[2024-03-11 10:01:19,750 INFO] valid stats calculation
                           took: 3.4849185943603516 s.
[2024-03-11 10:01:19,751 INFO] Train perplexity: 345.374
[2024-03-11 10:01:19,751 INFO] Train accuracy: 23.9761
[2024-03-11 10:01:19,751 INFO] Sentences processed: 64000
[2024-03-11 10:01:19,751 INFO] Average bsz:  857/ 745/64
[2024-03-11 10:01:19,751 INFO] Validation perplexity: 548290
[2024-03-11 10:01:19,751 INFO] Validation accuracy: 7.8219
[2024-03-11 10:01:19,752 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_1000.pt
[2024-03-11 10:01:21,071 INFO] Step 1050/10000; acc: 67.3; ppl:  10.2; xent: 2.3; lr: 1.00000; sents:    3200; bsz:  876/ 751/64; 9109/7817 tok/s;     74 sec;
[2024-03-11 10:01:22,331 INFO] Step 1100/10000; acc: 70.0; ppl:   8.5; xent: 2.1; lr: 1.00000; sents:    3200; bsz:  924/ 812/64; 36687/32230 tok/s;     75 sec;
[2024-03-11 10:01:24,392 INFO] Step 1150/10000; acc: 72.5; ppl:   7.1; xent: 2.0; lr: 1.00000; sents:    3200; bsz:  923/ 800/64; 22396/19419 tok/s;     77 sec;
[2024-03-11 10:01:26,675 INFO] Step 1200/10000; acc: 75.8; ppl:   5.5; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  918/ 817/64; 20102/17887 tok/s;     79 sec;
[2024-03-11 10:01:30,104 INFO] valid stats calculation
                           took: 3.4287290573120117 s.
[2024-03-11 10:01:30,105 INFO] Train perplexity: 176.417
[2024-03-11 10:01:30,105 INFO] Train accuracy: 32.3358
[2024-03-11 10:01:30,105 INFO] Sentences processed: 76800
[2024-03-11 10:01:30,105 INFO] Average bsz:  866/ 753/64
[2024-03-11 10:01:30,105 INFO] Validation perplexity: 1.72697e+06
[2024-03-11 10:01:30,105 INFO] Validation accuracy: 7.86201
[2024-03-11 10:01:30,107 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_1200.pt
[2024-03-11 10:01:31,475 INFO] Step 1250/10000; acc: 75.9; ppl:   5.4; xent: 1.7; lr: 1.00000; sents:    3200; bsz:  923/ 777/64; 9613/8089 tok/s;     84 sec;
[2024-03-11 10:01:32,577 INFO] Step 1300/10000; acc: 78.0; ppl:   4.7; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  809/ 701/64; 36720/31818 tok/s;     85 sec;
[2024-03-11 10:01:34,066 INFO] Step 1350/10000; acc: 78.8; ppl:   4.5; xent: 1.5; lr: 1.00000; sents:    3200; bsz:  892/ 761/64; 29950/25567 tok/s;     87 sec;
[2024-03-11 10:01:36,057 INFO] Step 1400/10000; acc: 80.5; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  812/ 722/64; 20378/18128 tok/s;     89 sec;
[2024-03-11 10:01:39,556 INFO] valid stats calculation
                           took: 3.497899055480957 s.
[2024-03-11 10:01:39,556 INFO] Train perplexity: 105.645
[2024-03-11 10:01:39,556 INFO] Train accuracy: 38.8047
[2024-03-11 10:01:39,556 INFO] Sentences processed: 89600
[2024-03-11 10:01:39,556 INFO] Average bsz:  865/ 751/64
[2024-03-11 10:01:39,556 INFO] Validation perplexity: 1.15894e+07
[2024-03-11 10:01:39,556 INFO] Validation accuracy: 8.58404
[2024-03-11 10:01:39,558 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_1400.pt
[2024-03-11 10:01:41,219 INFO] Step 1450/10000; acc: 80.2; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    3200; bsz:  849/ 724/64; 8228/7018 tok/s;     94 sec;
[2024-03-11 10:01:42,466 INFO] Step 1500/10000; acc: 81.9; ppl:   3.5; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  877/ 786/64; 35525/31836 tok/s;     95 sec;
[2024-03-11 10:01:43,643 INFO] Step 1550/10000; acc: 82.3; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  824/ 728/64; 35020/30942 tok/s;     96 sec;
[2024-03-11 10:01:45,336 INFO] Step 1600/10000; acc: 82.9; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  858/ 758/64; 25325/22377 tok/s;     98 sec;
[2024-03-11 10:01:48,795 INFO] valid stats calculation
                           took: 3.4582107067108154 s.
[2024-03-11 10:01:48,795 INFO] Train perplexity: 69.2322
[2024-03-11 10:01:48,795 INFO] Train accuracy: 44.1703
[2024-03-11 10:01:48,795 INFO] Sentences processed: 102400
[2024-03-11 10:01:48,795 INFO] Average bsz:  863/ 751/64
[2024-03-11 10:01:48,795 INFO] Validation perplexity: 3.01932e+06
[2024-03-11 10:01:48,795 INFO] Validation accuracy: 8.7846
[2024-03-11 10:01:48,797 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_1600.pt
[2024-03-11 10:01:51,042 INFO] Step 1650/10000; acc: 82.4; ppl:   3.5; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  900/ 769/64; 7886/6739 tok/s;    104 sec;
[2024-03-11 10:01:52,230 INFO] Step 1700/10000; acc: 83.5; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    3200; bsz:  832/ 739/64; 35005/31104 tok/s;    105 sec;
[2024-03-11 10:01:53,359 INFO] Step 1750/10000; acc: 84.2; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  825/ 723/64; 36528/32042 tok/s;    106 sec;
[2024-03-11 10:01:54,537 INFO] Step 1800/10000; acc: 84.5; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  846/ 738/64; 35937/31366 tok/s;    107 sec;
[2024-03-11 10:01:58,054 INFO] valid stats calculation
                           took: 3.516944646835327 s.
[2024-03-11 10:01:58,054 INFO] Train perplexity: 49.3622
[2024-03-11 10:01:58,054 INFO] Train accuracy: 48.5103
[2024-03-11 10:01:58,054 INFO] Sentences processed: 115200
[2024-03-11 10:01:58,054 INFO] Average bsz:  862/ 750/64
[2024-03-11 10:01:58,054 INFO] Validation perplexity: 6.88022e+06
[2024-03-11 10:01:58,055 INFO] Validation accuracy: 8.30325
[2024-03-11 10:01:58,056 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_1800.pt
[2024-03-11 10:02:00,291 INFO] Step 1850/10000; acc: 84.5; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    3200; bsz:  841/ 752/64; 7307/6538 tok/s;    113 sec;
[2024-03-11 10:02:02,179 INFO] Step 1900/10000; acc: 85.6; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  923/ 815/64; 24449/21591 tok/s;    115 sec;
[2024-03-11 10:02:03,243 INFO] Step 1950/10000; acc: 85.2; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  805/ 695/64; 37826/32634 tok/s;    116 sec;
[2024-03-11 10:02:04,455 INFO] Step 2000/10000; acc: 85.7; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  904/ 792/64; 37301/32684 tok/s;    117 sec;
[2024-03-11 10:02:07,973 INFO] valid stats calculation
                           took: 3.5175743103027344 s.
[2024-03-11 10:02:07,973 INFO] Train perplexity: 36.9039
[2024-03-11 10:02:07,973 INFO] Train accuracy: 52.2477
[2024-03-11 10:02:07,973 INFO] Sentences processed: 128000
[2024-03-11 10:02:07,973 INFO] Average bsz:  863/ 751/64
[2024-03-11 10:02:07,973 INFO] Validation perplexity: 5.41106e+06
[2024-03-11 10:02:07,973 INFO] Validation accuracy: 8.7846
[2024-03-11 10:02:07,975 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_2000.pt
[2024-03-11 10:02:10,412 INFO] Step 2050/10000; acc: 82.6; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    3200; bsz:  974/ 832/64; 8173/6980 tok/s;    123 sec;
[2024-03-11 10:02:12,509 INFO] Step 2100/10000; acc: 86.4; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  863/ 765/64; 20575/18255 tok/s;    125 sec;
[2024-03-11 10:02:13,747 INFO] Step 2150/10000; acc: 85.8; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    3200; bsz:  845/ 717/64; 34107/28957 tok/s;    126 sec;
[2024-03-11 10:02:14,861 INFO] Step 2200/10000; acc: 87.3; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  817/ 705/64; 36661/31646 tok/s;    127 sec;
[2024-03-11 10:02:18,356 INFO] valid stats calculation
                           took: 3.49420428276062 s.
[2024-03-11 10:02:18,356 INFO] Train perplexity: 29.1928
[2024-03-11 10:02:18,356 INFO] Train accuracy: 55.2775
[2024-03-11 10:02:18,356 INFO] Sentences processed: 140800
[2024-03-11 10:02:18,356 INFO] Average bsz:  864/ 752/64
[2024-03-11 10:02:18,356 INFO] Validation perplexity: 1.07356e+07
[2024-03-11 10:02:18,356 INFO] Validation accuracy: 8.42359
[2024-03-11 10:02:18,358 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_2200.pt
[2024-03-11 10:02:20,655 INFO] Step 2250/10000; acc: 87.2; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  870/ 758/64; 7512/6544 tok/s;    133 sec;
[2024-03-11 10:02:22,707 INFO] Step 2300/10000; acc: 87.3; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  864/ 747/64; 21057/18210 tok/s;    135 sec;
[2024-03-11 10:02:24,430 INFO] Step 2350/10000; acc: 87.6; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    3200; bsz:  827/ 739/64; 23987/21425 tok/s;    137 sec;
[2024-03-11 10:02:25,635 INFO] Step 2400/10000; acc: 88.0; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  893/ 793/64; 37088/32912 tok/s;    138 sec;
[2024-03-11 10:02:29,184 INFO] valid stats calculation
                           took: 3.548393726348877 s.
[2024-03-11 10:02:29,184 INFO] Train perplexity: 23.6743
[2024-03-11 10:02:29,184 INFO] Train accuracy: 57.9902
[2024-03-11 10:02:29,184 INFO] Sentences processed: 153600
[2024-03-11 10:02:29,184 INFO] Average bsz:  864/ 752/64
[2024-03-11 10:02:29,184 INFO] Validation perplexity: 2.30885e+07
[2024-03-11 10:02:29,185 INFO] Validation accuracy: 8.86482
[2024-03-11 10:02:29,186 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_2400.pt
[2024-03-11 10:02:31,424 INFO] Step 2450/10000; acc: 88.5; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  878/ 746/64; 7585/6446 tok/s;    144 sec;
[2024-03-11 10:02:33,613 INFO] Step 2500/10000; acc: 88.4; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  886/ 765/64; 20232/17483 tok/s;    146 sec;
[2024-03-11 10:02:35,948 INFO] Step 2550/10000; acc: 88.4; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  994/ 865/64; 21297/18518 tok/s;    148 sec;
[2024-03-11 10:02:36,980 INFO] Step 2600/10000; acc: 89.6; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  710/ 634/64; 34448/30736 tok/s;    150 sec;
[2024-03-11 10:02:40,612 INFO] valid stats calculation
                           took: 3.631953716278076 s.
[2024-03-11 10:02:40,612 INFO] Train perplexity: 19.743
[2024-03-11 10:02:40,612 INFO] Train accuracy: 60.3506
[2024-03-11 10:02:40,612 INFO] Sentences processed: 166400
[2024-03-11 10:02:40,612 INFO] Average bsz:  864/ 752/64
[2024-03-11 10:02:40,612 INFO] Validation perplexity: 2.85345e+07
[2024-03-11 10:02:40,613 INFO] Validation accuracy: 8.50381
[2024-03-11 10:02:40,614 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_2600.pt
[2024-03-11 10:02:42,793 INFO] Step 2650/10000; acc: 89.7; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  785/ 704/64; 6749/6053 tok/s;    155 sec;
[2024-03-11 10:02:44,944 INFO] Step 2700/10000; acc: 88.9; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  883/ 779/64; 20533/18117 tok/s;    157 sec;
[2024-03-11 10:02:46,850 INFO] Step 2750/10000; acc: 89.9; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  780/ 663/64; 20443/17388 tok/s;    159 sec;
[2024-03-11 10:02:48,897 INFO] Step 2800/10000; acc: 89.0; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  864/ 730/64; 21114/17830 tok/s;    161 sec;
[2024-03-11 10:02:52,528 INFO] valid stats calculation
                           took: 3.6313281059265137 s.
[2024-03-11 10:02:52,529 INFO] Train perplexity: 16.9466
[2024-03-11 10:02:52,529 INFO] Train accuracy: 62.3362
[2024-03-11 10:02:52,529 INFO] Sentences processed: 179200
[2024-03-11 10:02:52,529 INFO] Average bsz:  861/ 750/64
[2024-03-11 10:02:52,529 INFO] Validation perplexity: 1.82566e+07
[2024-03-11 10:02:52,529 INFO] Validation accuracy: 8.34336
[2024-03-11 10:02:52,530 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_2800.pt
[2024-03-11 10:02:54,784 INFO] Step 2850/10000; acc: 89.9; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  831/ 721/64; 7055/6122 tok/s;    167 sec;
[2024-03-11 10:02:56,911 INFO] Step 2900/10000; acc: 90.0; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  835/ 742/64; 19623/17449 tok/s;    169 sec;
[2024-03-11 10:02:58,945 INFO] Step 2950/10000; acc: 90.1; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  822/ 738/64; 20208/18153 tok/s;    171 sec;
[2024-03-11 10:03:01,172 INFO] Step 3000/10000; acc: 90.4; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  919/ 810/64; 20628/18190 tok/s;    174 sec;
[2024-03-11 10:03:04,822 INFO] valid stats calculation
                           took: 3.648998498916626 s.
[2024-03-11 10:03:04,822 INFO] Train perplexity: 14.6863
[2024-03-11 10:03:04,822 INFO] Train accuracy: 64.1943
[2024-03-11 10:03:04,822 INFO] Sentences processed: 192000
[2024-03-11 10:03:04,822 INFO] Average bsz:  861/ 750/64
[2024-03-11 10:03:04,823 INFO] Validation perplexity: 4.9481e+07
[2024-03-11 10:03:04,823 INFO] Validation accuracy: 9.22583
[2024-03-11 10:03:04,825 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_3000.pt
[2024-03-11 10:03:06,855 INFO] Step 3050/10000; acc: 90.5; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  828/ 737/64; 7287/6487 tok/s;    179 sec;
[2024-03-11 10:03:08,971 INFO] Step 3100/10000; acc: 90.5; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  895/ 768/64; 21151/18156 tok/s;    181 sec;
[2024-03-11 10:03:11,211 INFO] Step 3150/10000; acc: 89.6; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  969/ 839/64; 21627/18715 tok/s;    184 sec;
[2024-03-11 10:03:13,421 INFO] Step 3200/10000; acc: 90.4; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  912/ 789/64; 20630/17849 tok/s;    186 sec;
[2024-03-11 10:03:16,985 INFO] valid stats calculation
                           took: 3.5632524490356445 s.
[2024-03-11 10:03:16,985 INFO] Train perplexity: 12.8916
[2024-03-11 10:03:16,985 INFO] Train accuracy: 65.8899
[2024-03-11 10:03:16,985 INFO] Sentences processed: 204800
[2024-03-11 10:03:16,985 INFO] Average bsz:  863/ 752/64
[2024-03-11 10:03:16,985 INFO] Validation perplexity: 4.09298e+07
[2024-03-11 10:03:16,985 INFO] Validation accuracy: 8.86482
[2024-03-11 10:03:16,987 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_3200.pt
[2024-03-11 10:03:18,756 INFO] Step 3250/10000; acc: 88.4; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  859/ 739/64; 8052/6931 tok/s;    191 sec;
[2024-03-11 10:03:20,802 INFO] Step 3300/10000; acc: 89.7; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  886/ 745/64; 21642/18202 tok/s;    193 sec;
[2024-03-11 10:03:22,881 INFO] Step 3350/10000; acc: 90.8; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  852/ 753/64; 20513/18108 tok/s;    195 sec;
[2024-03-11 10:03:25,030 INFO] Step 3400/10000; acc: 89.6; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  913/ 807/64; 21240/18763 tok/s;    198 sec;
[2024-03-11 10:03:28,569 INFO] valid stats calculation
                           took: 3.5385875701904297 s.
[2024-03-11 10:03:28,569 INFO] Train perplexity: 11.5791
[2024-03-11 10:03:28,569 INFO] Train accuracy: 67.3009
[2024-03-11 10:03:28,569 INFO] Sentences processed: 217600
[2024-03-11 10:03:28,569 INFO] Average bsz:  864/ 753/64
[2024-03-11 10:03:28,569 INFO] Validation perplexity: 1.04952e+08
[2024-03-11 10:03:28,570 INFO] Validation accuracy: 9.34617
[2024-03-11 10:03:28,571 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_3400.pt
[2024-03-11 10:03:30,008 INFO] Step 3450/10000; acc: 89.3; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  898/ 763/64; 9015/7662 tok/s;    203 sec;
[2024-03-11 10:03:31,788 INFO] Step 3500/10000; acc: 89.6; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    3200; bsz:  790/ 694/64; 22206/19486 tok/s;    204 sec;
[2024-03-11 10:03:34,035 INFO] Step 3550/10000; acc: 90.8; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  951/ 825/64; 21162/18360 tok/s;    207 sec;
[2024-03-11 10:03:36,119 INFO] Step 3600/10000; acc: 91.4; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  846/ 726/64; 20306/17419 tok/s;    209 sec;
[2024-03-11 10:03:39,564 INFO] valid stats calculation
                           took: 3.4451067447662354 s.
[2024-03-11 10:03:39,565 INFO] Train perplexity: 10.505
[2024-03-11 10:03:39,565 INFO] Train accuracy: 68.5759
[2024-03-11 10:03:39,565 INFO] Sentences processed: 230400
[2024-03-11 10:03:39,565 INFO] Average bsz:  865/ 753/64
[2024-03-11 10:03:39,565 INFO] Validation perplexity: 1.16171e+08
[2024-03-11 10:03:39,565 INFO] Validation accuracy: 9.14561
[2024-03-11 10:03:39,566 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_3600.pt
[2024-03-11 10:03:40,827 INFO] Step 3650/10000; acc: 90.4; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  785/ 686/64; 8333/7286 tok/s;    213 sec;
[2024-03-11 10:03:42,202 INFO] Step 3700/10000; acc: 91.3; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  844/ 745/64; 30696/27101 tok/s;    215 sec;
[2024-03-11 10:03:44,144 INFO] Step 3750/10000; acc: 90.8; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  812/ 716/64; 20902/18429 tok/s;    217 sec;
[2024-03-11 10:03:46,275 INFO] Step 3800/10000; acc: 91.0; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    3200; bsz:  929/ 809/64; 21802/18979 tok/s;    219 sec;
[2024-03-11 10:03:49,646 INFO] valid stats calculation
                           took: 3.3702123165130615 s.
[2024-03-11 10:03:49,647 INFO] Train perplexity: 9.62074
[2024-03-11 10:03:49,647 INFO] Train accuracy: 69.7311
[2024-03-11 10:03:49,647 INFO] Sentences processed: 243200
[2024-03-11 10:03:49,647 INFO] Average bsz:  863/ 752/64
[2024-03-11 10:03:49,647 INFO] Validation perplexity: 1.38331e+08
[2024-03-11 10:03:49,647 INFO] Validation accuracy: 8.38347
[2024-03-11 10:03:49,649 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_3800.pt
[2024-03-11 10:03:50,949 INFO] Step 3850/10000; acc: 91.5; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  828/ 735/64; 8861/7859 tok/s;    223 sec;
[2024-03-11 10:03:52,085 INFO] Step 3900/10000; acc: 91.4; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  824/ 712/64; 36275/31361 tok/s;    225 sec;
[2024-03-11 10:03:53,789 INFO] Step 3950/10000; acc: 90.2; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    3173; bsz:  888/ 768/63; 26055/22542 tok/s;    226 sec;
[2024-03-11 10:03:56,067 INFO] Step 4000/10000; acc: 91.5; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  963/ 846/64; 21129/18579 tok/s;    229 sec;
[2024-03-11 10:03:59,474 INFO] valid stats calculation
                           took: 3.4069368839263916 s.
[2024-03-11 10:03:59,474 INFO] Train perplexity: 8.85867
[2024-03-11 10:03:59,474 INFO] Train accuracy: 70.8208
[2024-03-11 10:03:59,474 INFO] Sentences processed: 255973
[2024-03-11 10:03:59,474 INFO] Average bsz:  864/ 753/64
[2024-03-11 10:03:59,474 INFO] Validation perplexity: 8.99387e+07
[2024-03-11 10:03:59,474 INFO] Validation accuracy: 9.22583
[2024-03-11 10:03:59,476 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_4000.pt
[2024-03-11 10:04:01,013 INFO] Step 4050/10000; acc: 92.1; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  797/ 713/64; 8061/7207 tok/s;    234 sec;
[2024-03-11 10:04:02,218 INFO] Step 4100/10000; acc: 92.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  860/ 757/64; 35701/31408 tok/s;    235 sec;
[2024-03-11 10:04:03,482 INFO] Step 4150/10000; acc: 92.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  892/ 798/64; 35294/31566 tok/s;    236 sec;
[2024-03-11 10:04:05,434 INFO] Step 4200/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  837/ 731/64; 21449/18736 tok/s;    238 sec;
[2024-03-11 10:04:08,856 INFO] valid stats calculation
                           took: 3.4211909770965576 s.
[2024-03-11 10:04:08,856 INFO] Train perplexity: 8.19385
[2024-03-11 10:04:08,856 INFO] Train accuracy: 71.8365
[2024-03-11 10:04:08,856 INFO] Sentences processed: 268773
[2024-03-11 10:04:08,856 INFO] Average bsz:  863/ 752/64
[2024-03-11 10:04:08,856 INFO] Validation perplexity: 9.91118e+07
[2024-03-11 10:04:08,856 INFO] Validation accuracy: 8.58404
[2024-03-11 10:04:08,858 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_4200.pt
[2024-03-11 10:04:10,929 INFO] Step 4250/10000; acc: 92.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  867/ 760/64; 7885/6918 tok/s;    243 sec;
[2024-03-11 10:04:12,030 INFO] Step 4300/10000; acc: 91.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  815/ 696/64; 37042/31641 tok/s;    245 sec;
[2024-03-11 10:04:13,279 INFO] Step 4350/10000; acc: 92.2; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  882/ 767/64; 35326/30707 tok/s;    246 sec;
[2024-03-11 10:04:14,694 INFO] Step 4400/10000; acc: 92.4; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  878/ 773/64; 31026/27327 tok/s;    247 sec;
[2024-03-11 10:04:18,120 INFO] valid stats calculation
                           took: 3.4261460304260254 s.
[2024-03-11 10:04:18,121 INFO] Train perplexity: 7.63649
[2024-03-11 10:04:18,121 INFO] Train accuracy: 72.7581
[2024-03-11 10:04:18,121 INFO] Sentences processed: 281573
[2024-03-11 10:04:18,121 INFO] Average bsz:  863/ 752/64
[2024-03-11 10:04:18,121 INFO] Validation perplexity: 4.23107e+08
[2024-03-11 10:04:18,121 INFO] Validation accuracy: 9.26594
[2024-03-11 10:04:18,122 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_4400.pt
[2024-03-11 10:04:20,540 INFO] Step 4450/10000; acc: 92.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  910/ 799/64; 7784/6831 tok/s;    253 sec;
[2024-03-11 10:04:22,211 INFO] Step 4500/10000; acc: 92.0; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  919/ 770/64; 27510/23038 tok/s;    255 sec;
[2024-03-11 10:04:23,371 INFO] Step 4550/10000; acc: 91.6; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  906/ 769/64; 39064/33133 tok/s;    256 sec;
[2024-03-11 10:04:24,517 INFO] Step 4600/10000; acc: 92.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  840/ 731/64; 36637/31894 tok/s;    257 sec;
[2024-03-11 10:04:27,968 INFO] valid stats calculation
                           took: 3.450251340866089 s.
[2024-03-11 10:04:27,968 INFO] Train perplexity: 7.16406
[2024-03-11 10:04:27,968 INFO] Train accuracy: 73.6097
[2024-03-11 10:04:27,968 INFO] Sentences processed: 294373
[2024-03-11 10:04:27,968 INFO] Average bsz:  864/ 753/64
[2024-03-11 10:04:27,968 INFO] Validation perplexity: 5.05093e+08
[2024-03-11 10:04:27,968 INFO] Validation accuracy: 7.74168
[2024-03-11 10:04:27,970 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_4600.pt
[2024-03-11 10:04:30,402 INFO] Step 4650/10000; acc: 92.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  922/ 790/64; 7831/6711 tok/s;    263 sec;
[2024-03-11 10:04:32,525 INFO] Step 4700/10000; acc: 92.8; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  806/ 722/64; 18995/17005 tok/s;    265 sec;
[2024-03-11 10:04:33,847 INFO] Step 4750/10000; acc: 92.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  913/ 783/64; 34516/29627 tok/s;    266 sec;
[2024-03-11 10:04:34,993 INFO] Step 4800/10000; acc: 92.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  844/ 730/64; 36787/31827 tok/s;    268 sec;
[2024-03-11 10:04:38,461 INFO] valid stats calculation
                           took: 3.4667224884033203 s.
[2024-03-11 10:04:38,461 INFO] Train perplexity: 6.75133
[2024-03-11 10:04:38,461 INFO] Train accuracy: 74.3949
[2024-03-11 10:04:38,461 INFO] Sentences processed: 307173
[2024-03-11 10:04:38,461 INFO] Average bsz:  865/ 753/64
[2024-03-11 10:04:38,461 INFO] Validation perplexity: 1.33754e+08
[2024-03-11 10:04:38,461 INFO] Validation accuracy: 8.58404
[2024-03-11 10:04:38,463 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_4800.pt
[2024-03-11 10:04:40,610 INFO] Step 4850/10000; acc: 92.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  792/ 695/64; 7054/6184 tok/s;    273 sec;
[2024-03-11 10:04:42,520 INFO] Step 4900/10000; acc: 92.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  741/ 632/64; 19394/16542 tok/s;    275 sec;
[2024-03-11 10:04:44,606 INFO] Step 4950/10000; acc: 92.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  925/ 820/64; 22188/19667 tok/s;    277 sec;
[2024-03-11 10:04:45,754 INFO] Step 5000/10000; acc: 92.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  833/ 730/64; 36291/31775 tok/s;    278 sec;
[2024-03-11 10:04:49,280 INFO] valid stats calculation
                           took: 3.525444269180298 s.
[2024-03-11 10:04:49,280 INFO] Train perplexity: 6.40346
[2024-03-11 10:04:49,281 INFO] Train accuracy: 75.0932
[2024-03-11 10:04:49,281 INFO] Sentences processed: 319973
[2024-03-11 10:04:49,281 INFO] Average bsz:  863/ 752/64
[2024-03-11 10:04:49,281 INFO] Validation perplexity: 3.43083e+08
[2024-03-11 10:04:49,281 INFO] Validation accuracy: 9.30606
[2024-03-11 10:04:49,282 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_5000.pt
[2024-03-11 10:04:51,608 INFO] Step 5050/10000; acc: 93.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  915/ 786/64; 7818/6713 tok/s;    284 sec;
[2024-03-11 10:04:53,663 INFO] Step 5100/10000; acc: 92.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  861/ 716/64; 20960/17432 tok/s;    286 sec;
[2024-03-11 10:04:55,692 INFO] Step 5150/10000; acc: 93.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  795/ 690/64; 19593/17015 tok/s;    288 sec;
[2024-03-11 10:04:57,310 INFO] Step 5200/10000; acc: 93.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  867/ 782/64; 26773/24146 tok/s;    290 sec;
[2024-03-11 10:05:00,878 INFO] valid stats calculation
                           took: 3.567528247833252 s.
[2024-03-11 10:05:00,879 INFO] Train perplexity: 6.07903
[2024-03-11 10:05:00,879 INFO] Train accuracy: 75.7783
[2024-03-11 10:05:00,879 INFO] Sentences processed: 332773
[2024-03-11 10:05:00,879 INFO] Average bsz:  863/ 751/64
[2024-03-11 10:05:00,879 INFO] Validation perplexity: 4.17494e+08
[2024-03-11 10:05:00,879 INFO] Validation accuracy: 8.90493
[2024-03-11 10:05:00,880 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_5200.pt
[2024-03-11 10:05:03,202 INFO] Step 5250/10000; acc: 93.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  914/ 773/64; 7757/6558 tok/s;    296 sec;
[2024-03-11 10:05:05,365 INFO] Step 5300/10000; acc: 93.1; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  834/ 739/64; 19285/17071 tok/s;    298 sec;
[2024-03-11 10:05:07,526 INFO] Step 5350/10000; acc: 93.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  859/ 753/64; 19884/17418 tok/s;    300 sec;
[2024-03-11 10:05:09,493 INFO] Step 5400/10000; acc: 93.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  849/ 735/64; 21589/18693 tok/s;    302 sec;
[2024-03-11 10:05:13,081 INFO] valid stats calculation
                           took: 3.5881848335266113 s.
[2024-03-11 10:05:13,082 INFO] Train perplexity: 5.79021
[2024-03-11 10:05:13,082 INFO] Train accuracy: 76.425
[2024-03-11 10:05:13,082 INFO] Sentences processed: 345573
[2024-03-11 10:05:13,082 INFO] Average bsz:  863/ 751/64
[2024-03-11 10:05:13,082 INFO] Validation perplexity: 6.9497e+08
[2024-03-11 10:05:13,082 INFO] Validation accuracy: 7.78179
[2024-03-11 10:05:13,083 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_5400.pt
[2024-03-11 10:05:15,256 INFO] Step 5450/10000; acc: 92.3; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  778/ 686/64; 6752/5952 tok/s;    308 sec;
[2024-03-11 10:05:17,470 INFO] Step 5500/10000; acc: 93.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  905/ 794/64; 20441/17944 tok/s;    310 sec;
[2024-03-11 10:05:19,669 INFO] Step 5550/10000; acc: 93.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  918/ 796/64; 20869/18091 tok/s;    312 sec;
[2024-03-11 10:05:21,852 INFO] Step 5600/10000; acc: 92.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  865/ 747/64; 19827/17107 tok/s;    314 sec;
[2024-03-11 10:05:25,407 INFO] valid stats calculation
                           took: 3.5553648471832275 s.
[2024-03-11 10:05:25,408 INFO] Train perplexity: 5.53523
[2024-03-11 10:05:25,408 INFO] Train accuracy: 77.0201
[2024-03-11 10:05:25,408 INFO] Sentences processed: 358373
[2024-03-11 10:05:25,408 INFO] Average bsz:  863/ 751/64
[2024-03-11 10:05:25,408 INFO] Validation perplexity: 4.48867e+08
[2024-03-11 10:05:25,408 INFO] Validation accuracy: 8.1428
[2024-03-11 10:05:25,409 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_5600.pt
[2024-03-11 10:05:27,296 INFO] Step 5650/10000; acc: 93.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  882/ 763/64; 8100/7004 tok/s;    320 sec;
[2024-03-11 10:05:29,427 INFO] Step 5700/10000; acc: 93.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  876/ 759/64; 20541/17808 tok/s;    322 sec;
[2024-03-11 10:05:31,558 INFO] Step 5750/10000; acc: 93.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  858/ 750/64; 20123/17600 tok/s;    324 sec;
[2024-03-11 10:05:33,630 INFO] Step 5800/10000; acc: 91.7; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    3190; bsz:  825/ 720/64; 19914/17376 tok/s;    326 sec;
[2024-03-11 10:05:37,144 INFO] valid stats calculation
                           took: 3.5131947994232178 s.
[2024-03-11 10:05:37,144 INFO] Train perplexity: 5.31566
[2024-03-11 10:05:37,144 INFO] Train accuracy: 77.566
[2024-03-11 10:05:37,144 INFO] Sentences processed: 371163
[2024-03-11 10:05:37,144 INFO] Average bsz:  863/ 751/64
[2024-03-11 10:05:37,144 INFO] Validation perplexity: 1.61505e+09
[2024-03-11 10:05:37,144 INFO] Validation accuracy: 8.7846
[2024-03-11 10:05:37,146 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_5800.pt
[2024-03-11 10:05:38,537 INFO] Step 5850/10000; acc: 93.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  876/ 763/64; 8922/7774 tok/s;    331 sec;
[2024-03-11 10:05:40,565 INFO] Step 5900/10000; acc: 93.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  887/ 774/64; 21873/19081 tok/s;    333 sec;
[2024-03-11 10:05:42,671 INFO] Step 5950/10000; acc: 93.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  899/ 787/64; 21338/18693 tok/s;    335 sec;
[2024-03-11 10:05:44,712 INFO] Step 6000/10000; acc: 93.4; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  824/ 719/64; 20190/17605 tok/s;    337 sec;
[2024-03-11 10:05:48,184 INFO] valid stats calculation
                           took: 3.4713306427001953 s.
[2024-03-11 10:05:48,185 INFO] Train perplexity: 5.10115
[2024-03-11 10:05:48,185 INFO] Train accuracy: 78.103
[2024-03-11 10:05:48,185 INFO] Sentences processed: 383963
[2024-03-11 10:05:48,185 INFO] Average bsz:  863/ 752/64
[2024-03-11 10:05:48,185 INFO] Validation perplexity: 1.08218e+09
[2024-03-11 10:05:48,185 INFO] Validation accuracy: 8.50381
[2024-03-11 10:05:48,186 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_6000.pt
[2024-03-11 10:05:49,539 INFO] Step 6050/10000; acc: 93.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  876/ 757/64; 9070/7840 tok/s;    342 sec;
[2024-03-11 10:05:51,343 INFO] Step 6100/10000; acc: 93.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  873/ 765/64; 24203/21202 tok/s;    344 sec;
[2024-03-11 10:05:53,453 INFO] Step 6150/10000; acc: 93.6; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  841/ 738/64; 19931/17481 tok/s;    346 sec;
[2024-03-11 10:05:55,602 INFO] Step 6200/10000; acc: 93.0; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  872/ 769/64; 20279/17883 tok/s;    348 sec;
[2024-03-11 10:05:59,143 INFO] valid stats calculation
                           took: 3.540724992752075 s.
[2024-03-11 10:05:59,143 INFO] Train perplexity: 4.91379
[2024-03-11 10:05:59,144 INFO] Train accuracy: 78.6009
[2024-03-11 10:05:59,144 INFO] Sentences processed: 396763
[2024-03-11 10:05:59,144 INFO] Average bsz:  863/ 752/64
[2024-03-11 10:05:59,144 INFO] Validation perplexity: 1.10857e+09
[2024-03-11 10:05:59,144 INFO] Validation accuracy: 8.18291
[2024-03-11 10:05:59,145 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_6200.pt
[2024-03-11 10:06:00,489 INFO] Step 6250/10000; acc: 93.0; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  873/ 773/64; 8931/7906 tok/s;    353 sec;
[2024-03-11 10:06:01,824 INFO] Step 6300/10000; acc: 93.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  820/ 733/64; 30737/27452 tok/s;    354 sec;
[2024-03-11 10:06:03,956 INFO] Step 6350/10000; acc: 93.7; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  869/ 765/64; 20383/17940 tok/s;    356 sec;
[2024-03-11 10:06:06,053 INFO] Step 6400/10000; acc: 93.6; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  845/ 732/64; 20150/17471 tok/s;    359 sec;
[2024-03-11 10:06:09,509 INFO] valid stats calculation
                           took: 3.4558663368225098 s.
[2024-03-11 10:06:09,510 INFO] Train perplexity: 4.7431
[2024-03-11 10:06:09,510 INFO] Train accuracy: 79.0657
[2024-03-11 10:06:09,510 INFO] Sentences processed: 409563
[2024-03-11 10:06:09,510 INFO] Average bsz:  863/ 752/64
[2024-03-11 10:06:09,510 INFO] Validation perplexity: 5.2503e+08
[2024-03-11 10:06:09,510 INFO] Validation accuracy: 8.70437
[2024-03-11 10:06:09,511 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_6400.pt
[2024-03-11 10:06:10,781 INFO] Step 6450/10000; acc: 93.4; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  855/ 722/64; 9039/7638 tok/s;    363 sec;
[2024-03-11 10:06:11,942 INFO] Step 6500/10000; acc: 94.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  858/ 746/64; 36927/32117 tok/s;    364 sec;
[2024-03-11 10:06:13,665 INFO] Step 6550/10000; acc: 93.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  901/ 769/64; 26151/22303 tok/s;    366 sec;
[2024-03-11 10:06:15,870 INFO] Step 6600/10000; acc: 93.1; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  932/ 796/64; 21134/18042 tok/s;    368 sec;
[2024-03-11 10:06:19,589 INFO] valid stats calculation
                           took: 3.7182931900024414 s.
[2024-03-11 10:06:19,589 INFO] Train perplexity: 4.59179
[2024-03-11 10:06:19,589 INFO] Train accuracy: 79.5064
[2024-03-11 10:06:19,589 INFO] Sentences processed: 422363
[2024-03-11 10:06:19,589 INFO] Average bsz:  864/ 752/64
[2024-03-11 10:06:19,589 INFO] Validation perplexity: 6.76554e+08
[2024-03-11 10:06:19,590 INFO] Validation accuracy: 8.1428
[2024-03-11 10:06:19,591 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_6600.pt
[2024-03-11 10:06:21,103 INFO] Step 6650/10000; acc: 93.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  945/ 812/64; 9028/7755 tok/s;    374 sec;
[2024-03-11 10:06:22,253 INFO] Step 6700/10000; acc: 93.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  856/ 736/64; 37209/31980 tok/s;    375 sec;
[2024-03-11 10:06:23,528 INFO] Step 6750/10000; acc: 93.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  928/ 805/64; 36444/31603 tok/s;    376 sec;
[2024-03-11 10:06:25,740 INFO] Step 6800/10000; acc: 94.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  923/ 809/64; 20855/18272 tok/s;    378 sec;
[2024-03-11 10:06:29,252 INFO] valid stats calculation
                           took: 3.510873794555664 s.
[2024-03-11 10:06:29,252 INFO] Train perplexity: 4.44168
[2024-03-11 10:06:29,252 INFO] Train accuracy: 79.9459
[2024-03-11 10:06:29,252 INFO] Sentences processed: 435163
[2024-03-11 10:06:29,252 INFO] Average bsz:  865/ 753/64
[2024-03-11 10:06:29,252 INFO] Validation perplexity: 8.7325e+08
[2024-03-11 10:06:29,252 INFO] Validation accuracy: 8.70437
[2024-03-11 10:06:29,254 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_6800.pt
[2024-03-11 10:06:31,198 INFO] Step 6850/10000; acc: 94.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  856/ 748/64; 7845/6849 tok/s;    384 sec;
[2024-03-11 10:06:32,403 INFO] Step 6900/10000; acc: 94.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  886/ 784/64; 36771/32526 tok/s;    385 sec;
[2024-03-11 10:06:33,549 INFO] Step 6950/10000; acc: 93.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  848/ 729/64; 36997/31803 tok/s;    386 sec;
[2024-03-11 10:06:35,057 INFO] Step 7000/10000; acc: 94.1; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  857/ 745/64; 28408/24705 tok/s;    388 sec;
[2024-03-11 10:06:38,475 INFO] valid stats calculation
                           took: 3.4179234504699707 s.
[2024-03-11 10:06:38,475 INFO] Train perplexity: 4.30947
[2024-03-11 10:06:38,475 INFO] Train accuracy: 80.3436
[2024-03-11 10:06:38,475 INFO] Sentences processed: 447963
[2024-03-11 10:06:38,475 INFO] Average bsz:  865/ 753/64
[2024-03-11 10:06:38,475 INFO] Validation perplexity: 1.30093e+09
[2024-03-11 10:06:38,475 INFO] Validation accuracy: 8.94505
[2024-03-11 10:06:38,477 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_7000.pt
[2024-03-11 10:06:40,661 INFO] Step 7050/10000; acc: 93.2; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    3200; bsz:  800/ 686/64; 7138/6120 tok/s;    393 sec;
[2024-03-11 10:06:42,073 INFO] Step 7100/10000; acc: 94.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  873/ 761/64; 30918/26964 tok/s;    395 sec;
[2024-03-11 10:06:43,175 INFO] Step 7150/10000; acc: 94.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  813/ 714/64; 36869/32405 tok/s;    396 sec;
[2024-03-11 10:06:44,289 INFO] Step 7200/10000; acc: 94.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  820/ 737/64; 36838/33110 tok/s;    397 sec;
[2024-03-11 10:06:47,930 INFO] valid stats calculation
                           took: 3.6399295330047607 s.
[2024-03-11 10:06:47,930 INFO] Train perplexity: 4.19561
[2024-03-11 10:06:47,930 INFO] Train accuracy: 80.7094
[2024-03-11 10:06:47,930 INFO] Sentences processed: 460763
[2024-03-11 10:06:47,930 INFO] Average bsz:  864/ 752/64
[2024-03-11 10:06:47,930 INFO] Validation perplexity: 7.68531e+08
[2024-03-11 10:06:47,930 INFO] Validation accuracy: 8.1428
[2024-03-11 10:06:47,932 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_7200.pt
[2024-03-11 10:06:50,385 INFO] Step 7250/10000; acc: 93.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  926/ 819/64; 7593/6720 tok/s;    403 sec;
[2024-03-11 10:06:52,434 INFO] Step 7300/10000; acc: 93.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  852/ 756/64; 20792/18461 tok/s;    405 sec;
[2024-03-11 10:06:53,571 INFO] Step 7350/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  849/ 732/64; 37321/32199 tok/s;    406 sec;
[2024-03-11 10:06:54,789 INFO] Step 7400/10000; acc: 93.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  908/ 771/64; 37282/31658 tok/s;    407 sec;
[2024-03-11 10:06:58,576 INFO] valid stats calculation
                           took: 3.7867093086242676 s.
[2024-03-11 10:06:58,577 INFO] Train perplexity: 4.08282
[2024-03-11 10:06:58,577 INFO] Train accuracy: 81.0721
[2024-03-11 10:06:58,577 INFO] Sentences processed: 473563
[2024-03-11 10:06:58,577 INFO] Average bsz:  864/ 753/64
[2024-03-11 10:06:58,577 INFO] Validation perplexity: 1.57508e+09
[2024-03-11 10:06:58,577 INFO] Validation accuracy: 8.26314
[2024-03-11 10:06:58,579 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_7400.pt
[2024-03-11 10:07:00,911 INFO] Step 7450/10000; acc: 94.5; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  845/ 743/64; 6905/6069 tok/s;    413 sec;
[2024-03-11 10:07:02,975 INFO] Step 7500/10000; acc: 94.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  854/ 719/64; 20684/17417 tok/s;    415 sec;
[2024-03-11 10:07:04,592 INFO] Step 7550/10000; acc: 94.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  890/ 746/64; 27508/23075 tok/s;    417 sec;
[2024-03-11 10:07:05,725 INFO] Step 7600/10000; acc: 94.8; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  836/ 718/64; 36917/31727 tok/s;    418 sec;
[2024-03-11 10:07:09,422 INFO] valid stats calculation
                           took: 3.696876287460327 s.
[2024-03-11 10:07:09,422 INFO] Train perplexity: 3.97595
[2024-03-11 10:07:09,422 INFO] Train accuracy: 81.4182
[2024-03-11 10:07:09,422 INFO] Sentences processed: 486363
[2024-03-11 10:07:09,422 INFO] Average bsz:  864/ 752/64
[2024-03-11 10:07:09,422 INFO] Validation perplexity: 1.63775e+09
[2024-03-11 10:07:09,423 INFO] Validation accuracy: 9.22583
[2024-03-11 10:07:09,424 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_7600.pt
[2024-03-11 10:07:11,820 INFO] Step 7650/10000; acc: 93.2; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    3163; bsz:  911/ 788/63; 7471/6463 tok/s;    424 sec;
[2024-03-11 10:07:13,891 INFO] Step 7700/10000; acc: 94.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  827/ 732/64; 19966/17672 tok/s;    426 sec;
[2024-03-11 10:07:15,812 INFO] Step 7750/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  877/ 777/64; 22833/20233 tok/s;    428 sec;
[2024-03-11 10:07:17,011 INFO] Step 7800/10000; acc: 95.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  886/ 787/64; 36948/32836 tok/s;    430 sec;
[2024-03-11 10:07:20,611 INFO] valid stats calculation
                           took: 3.6002228260040283 s.
[2024-03-11 10:07:20,612 INFO] Train perplexity: 3.87796
[2024-03-11 10:07:20,612 INFO] Train accuracy: 81.7593
[2024-03-11 10:07:20,612 INFO] Sentences processed: 499126
[2024-03-11 10:07:20,612 INFO] Average bsz:  864/ 753/64
[2024-03-11 10:07:20,612 INFO] Validation perplexity: 3.03945e+09
[2024-03-11 10:07:20,612 INFO] Validation accuracy: 8.86482
[2024-03-11 10:07:20,613 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_7800.pt
[2024-03-11 10:07:22,825 INFO] Step 7850/10000; acc: 94.8; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  831/ 723/64; 7144/6216 tok/s;    435 sec;
[2024-03-11 10:07:24,873 INFO] Step 7900/10000; acc: 94.8; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  796/ 688/64; 19439/16805 tok/s;    437 sec;
[2024-03-11 10:07:26,890 INFO] Step 7950/10000; acc: 95.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  782/ 691/64; 19392/17138 tok/s;    439 sec;
[2024-03-11 10:07:28,432 INFO] Step 8000/10000; acc: 95.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  870/ 759/64; 28220/24635 tok/s;    441 sec;
[2024-03-11 10:07:32,078 INFO] valid stats calculation
                           took: 3.6457111835479736 s.
[2024-03-11 10:07:32,078 INFO] Train perplexity: 3.78596
[2024-03-11 10:07:32,078 INFO] Train accuracy: 82.072
[2024-03-11 10:07:32,078 INFO] Sentences processed: 511926
[2024-03-11 10:07:32,078 INFO] Average bsz:  863/ 752/64
[2024-03-11 10:07:32,078 INFO] Validation perplexity: 4.68331e+09
[2024-03-11 10:07:32,078 INFO] Validation accuracy: 8.74448
[2024-03-11 10:07:32,080 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_8000.pt
[2024-03-11 10:07:34,272 INFO] Step 8050/10000; acc: 95.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  817/ 722/64; 6992/6178 tok/s;    447 sec;
[2024-03-11 10:07:36,485 INFO] Step 8100/10000; acc: 95.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  900/ 768/64; 20334/17358 tok/s;    449 sec;
[2024-03-11 10:07:38,561 INFO] Step 8150/10000; acc: 95.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  806/ 697/64; 19422/16776 tok/s;    451 sec;
[2024-03-11 10:07:40,568 INFO] Step 8200/10000; acc: 94.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  876/ 740/64; 21816/18431 tok/s;    453 sec;
[2024-03-11 10:07:44,151 INFO] valid stats calculation
                           took: 3.582554817199707 s.
[2024-03-11 10:07:44,151 INFO] Train perplexity: 3.69851
[2024-03-11 10:07:44,151 INFO] Train accuracy: 82.3809
[2024-03-11 10:07:44,151 INFO] Sentences processed: 524726
[2024-03-11 10:07:44,151 INFO] Average bsz:  863/ 751/64
[2024-03-11 10:07:44,151 INFO] Validation perplexity: 2.06761e+09
[2024-03-11 10:07:44,151 INFO] Validation accuracy: 8.90493
[2024-03-11 10:07:44,153 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_8200.pt
[2024-03-11 10:07:46,442 INFO] Step 8250/10000; acc: 95.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  829/ 735/64; 7057/6255 tok/s;    459 sec;
[2024-03-11 10:07:48,544 INFO] Step 8300/10000; acc: 94.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  835/ 738/64; 19861/17546 tok/s;    461 sec;
[2024-03-11 10:07:50,767 INFO] Step 8350/10000; acc: 95.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  905/ 794/64; 20360/17855 tok/s;    463 sec;
[2024-03-11 10:07:52,972 INFO] Step 8400/10000; acc: 94.8; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  886/ 772/64; 20092/17501 tok/s;    465 sec;
[2024-03-11 10:07:56,567 INFO] valid stats calculation
                           took: 3.594508647918701 s.
[2024-03-11 10:07:56,567 INFO] Train perplexity: 3.61398
[2024-03-11 10:07:56,567 INFO] Train accuracy: 82.6849
[2024-03-11 10:07:56,567 INFO] Sentences processed: 537526
[2024-03-11 10:07:56,567 INFO] Average bsz:  863/ 751/64
[2024-03-11 10:07:56,567 INFO] Validation perplexity: 2.91805e+09
[2024-03-11 10:07:56,567 INFO] Validation accuracy: 8.74448
[2024-03-11 10:07:56,569 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_8400.pt
[2024-03-11 10:07:58,415 INFO] Step 8450/10000; acc: 95.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  810/ 722/64; 7443/6628 tok/s;    471 sec;
[2024-03-11 10:08:00,579 INFO] Step 8500/10000; acc: 94.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  901/ 775/64; 20825/17913 tok/s;    473 sec;
[2024-03-11 10:08:02,902 INFO] Step 8550/10000; acc: 95.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  974/ 834/64; 20968/17955 tok/s;    475 sec;
[2024-03-11 10:08:05,178 INFO] Step 8600/10000; acc: 95.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  915/ 806/64; 20106/17708 tok/s;    478 sec;
[2024-03-11 10:08:08,798 INFO] valid stats calculation
                           took: 3.6193134784698486 s.
[2024-03-11 10:08:08,798 INFO] Train perplexity: 3.53202
[2024-03-11 10:08:08,798 INFO] Train accuracy: 82.9842
[2024-03-11 10:08:08,798 INFO] Sentences processed: 550326
[2024-03-11 10:08:08,798 INFO] Average bsz:  864/ 752/64
[2024-03-11 10:08:08,798 INFO] Validation perplexity: 3.83388e+09
[2024-03-11 10:08:08,798 INFO] Validation accuracy: 8.82471
[2024-03-11 10:08:08,800 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_8600.pt
[2024-03-11 10:08:10,297 INFO] Step 8650/10000; acc: 95.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  902/ 760/64; 8814/7427 tok/s;    483 sec;
[2024-03-11 10:08:12,349 INFO] Step 8700/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  884/ 751/64; 21563/18303 tok/s;    485 sec;
[2024-03-11 10:08:14,434 INFO] Step 8750/10000; acc: 95.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  835/ 728/64; 20010/17463 tok/s;    487 sec;
[2024-03-11 10:08:16,540 INFO] Step 8800/10000; acc: 94.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  804/ 715/64; 19086/16984 tok/s;    489 sec;
[2024-03-11 10:08:20,024 INFO] valid stats calculation
                           took: 3.4837300777435303 s.
[2024-03-11 10:08:20,025 INFO] Train perplexity: 3.46144
[2024-03-11 10:08:20,025 INFO] Train accuracy: 83.2499
[2024-03-11 10:08:20,025 INFO] Sentences processed: 563126
[2024-03-11 10:08:20,025 INFO] Average bsz:  864/ 752/64
[2024-03-11 10:08:20,025 INFO] Validation perplexity: 4.92565e+09
[2024-03-11 10:08:20,025 INFO] Validation accuracy: 9.02527
[2024-03-11 10:08:20,026 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_8800.pt
[2024-03-11 10:08:21,397 INFO] Step 8850/10000; acc: 94.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  913/ 777/64; 9396/7999 tok/s;    494 sec;
[2024-03-11 10:08:23,235 INFO] Step 8900/10000; acc: 94.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  925/ 788/64; 25168/21425 tok/s;    496 sec;
[2024-03-11 10:08:25,323 INFO] Step 8950/10000; acc: 94.8; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  837/ 721/64; 20058/17274 tok/s;    498 sec;
[2024-03-11 10:08:27,530 INFO] Step 9000/10000; acc: 94.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  891/ 767/64; 20190/17384 tok/s;    500 sec;
[2024-03-11 10:08:30,976 INFO] valid stats calculation
                           took: 3.4462649822235107 s.
[2024-03-11 10:08:30,977 INFO] Train perplexity: 3.39381
[2024-03-11 10:08:30,977 INFO] Train accuracy: 83.5074
[2024-03-11 10:08:30,977 INFO] Sentences processed: 575926
[2024-03-11 10:08:30,977 INFO] Average bsz:  864/ 752/64
[2024-03-11 10:08:30,977 INFO] Validation perplexity: 4.54185e+09
[2024-03-11 10:08:30,977 INFO] Validation accuracy: 8.7846
[2024-03-11 10:08:30,978 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_9000.pt
[2024-03-11 10:08:32,293 INFO] Step 9050/10000; acc: 95.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  864/ 756/64; 9071/7942 tok/s;    505 sec;
[2024-03-11 10:08:33,613 INFO] Step 9100/10000; acc: 95.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  829/ 730/64; 31413/27631 tok/s;    506 sec;
[2024-03-11 10:08:35,813 INFO] Step 9150/10000; acc: 94.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  914/ 789/64; 20779/17925 tok/s;    508 sec;
[2024-03-11 10:08:38,096 INFO] Step 9200/10000; acc: 94.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  946/ 818/64; 20716/17923 tok/s;    511 sec;
[2024-03-11 10:08:41,503 INFO] valid stats calculation
                           took: 3.406304121017456 s.
[2024-03-11 10:08:41,503 INFO] Train perplexity: 3.3287
[2024-03-11 10:08:41,504 INFO] Train accuracy: 83.7601
[2024-03-11 10:08:41,504 INFO] Sentences processed: 588726
[2024-03-11 10:08:41,504 INFO] Average bsz:  865/ 753/64
[2024-03-11 10:08:41,504 INFO] Validation perplexity: 2.43907e+09
[2024-03-11 10:08:41,504 INFO] Validation accuracy: 9.26594
[2024-03-11 10:08:41,505 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_9200.pt
[2024-03-11 10:08:42,804 INFO] Step 9250/10000; acc: 95.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  837/ 736/64; 8891/7817 tok/s;    515 sec;
[2024-03-11 10:08:44,029 INFO] Step 9300/10000; acc: 95.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  900/ 781/64; 36739/31893 tok/s;    517 sec;
[2024-03-11 10:08:45,848 INFO] Step 9350/10000; acc: 94.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  849/ 751/64; 23350/20637 tok/s;    518 sec;
[2024-03-11 10:08:47,974 INFO] Step 9400/10000; acc: 95.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  818/ 709/64; 19234/16673 tok/s;    520 sec;
[2024-03-11 10:08:51,497 INFO] valid stats calculation
                           took: 3.5225563049316406 s.
[2024-03-11 10:08:51,498 INFO] Train perplexity: 3.26819
[2024-03-11 10:08:51,498 INFO] Train accuracy: 84.001
[2024-03-11 10:08:51,498 INFO] Sentences processed: 601526
[2024-03-11 10:08:51,498 INFO] Average bsz:  865/ 752/64
[2024-03-11 10:08:51,498 INFO] Validation perplexity: 4.89811e+09
[2024-03-11 10:08:51,498 INFO] Validation accuracy: 8.22302
[2024-03-11 10:08:51,499 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_9400.pt
[2024-03-11 10:08:52,898 INFO] Step 9450/10000; acc: 95.0; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  962/ 824/64; 9769/8364 tok/s;    525 sec;
[2024-03-11 10:08:54,131 INFO] Step 9500/10000; acc: 95.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  872/ 788/64; 35377/31976 tok/s;    527 sec;
[2024-03-11 10:08:55,845 INFO] Step 9550/10000; acc: 95.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  897/ 796/64; 26179/23219 tok/s;    528 sec;
[2024-03-11 10:08:57,930 INFO] Step 9600/10000; acc: 95.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  865/ 763/64; 20747/18305 tok/s;    530 sec;
[2024-03-11 10:09:01,420 INFO] valid stats calculation
                           took: 3.4893972873687744 s.
[2024-03-11 10:09:01,420 INFO] Train perplexity: 3.20653
[2024-03-11 10:09:01,420 INFO] Train accuracy: 84.2502
[2024-03-11 10:09:01,420 INFO] Sentences processed: 614326
[2024-03-11 10:09:01,420 INFO] Average bsz:  865/ 753/64
[2024-03-11 10:09:01,420 INFO] Validation perplexity: 4.46089e+09
[2024-03-11 10:09:01,420 INFO] Validation accuracy: 8.54392
[2024-03-11 10:09:01,422 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_9600.pt
[2024-03-11 10:09:02,956 INFO] Step 9650/10000; acc: 95.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  801/ 714/64; 7972/7101 tok/s;    535 sec;
[2024-03-11 10:09:04,156 INFO] Step 9700/10000; acc: 95.1; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  916/ 774/64; 38191/32270 tok/s;    537 sec;
[2024-03-11 10:09:05,397 INFO] Step 9750/10000; acc: 95.2; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  876/ 783/64; 35295/31540 tok/s;    538 sec;
[2024-03-11 10:09:07,398 INFO] Step 9800/10000; acc: 95.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  888/ 802/64; 22201/20050 tok/s;    540 sec;
[2024-03-11 10:09:10,832 INFO] valid stats calculation
                           took: 3.433417320251465 s.
[2024-03-11 10:09:10,832 INFO] Train perplexity: 3.15196
[2024-03-11 10:09:10,832 INFO] Train accuracy: 84.4801
[2024-03-11 10:09:10,833 INFO] Sentences processed: 627126
[2024-03-11 10:09:10,833 INFO] Average bsz:  865/ 754/64
[2024-03-11 10:09:10,833 INFO] Validation perplexity: 1.06861e+10
[2024-03-11 10:09:10,833 INFO] Validation accuracy: 8.50381
[2024-03-11 10:09:10,835 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_9800.pt
[2024-03-11 10:09:12,654 INFO] Step 9850/10000; acc: 95.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    3200; bsz:  758/ 663/64; 7210/6305 tok/s;    545 sec;
[2024-03-11 10:09:13,918 INFO] Step 9900/10000; acc: 95.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  925/ 826/64; 36636/32718 tok/s;    546 sec;
[2024-03-11 10:09:15,157 INFO] Step 9950/10000; acc: 94.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    3200; bsz:  929/ 804/64; 37506/32451 tok/s;    548 sec;
[2024-03-11 10:09:16,819 INFO] Step 10000/10000; acc: 94.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    3200; bsz:  906/ 777/64; 27253/23368 tok/s;    549 sec;
[2024-03-11 10:09:20,294 INFO] valid stats calculation
                           took: 3.4746570587158203 s.
[2024-03-11 10:09:20,294 INFO] Train perplexity: 3.10352
[2024-03-11 10:09:20,294 INFO] Train accuracy: 84.6918
[2024-03-11 10:09:20,294 INFO] Sentences processed: 639926
[2024-03-11 10:09:20,294 INFO] Average bsz:  866/ 754/64
[2024-03-11 10:09:20,294 INFO] Validation perplexity: 6.31591e+09
[2024-03-11 10:09:20,294 INFO] Validation accuracy: 9.38628
[2024-03-11 10:09:20,296 INFO] Saving checkpoint tg-pretrain/tg-pretrain_01_step_10000.pt
