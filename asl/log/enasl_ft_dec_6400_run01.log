[2024-03-12 15:26:04,606 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-12 15:26:04,606 INFO] Parsed 2 corpora from -data.
[2024-03-12 15:26:04,606 INFO] Loading checkpoint from tg-pt-dec/models/tg-pt-dec_03_step_6400.pt
[2024-03-12 15:26:04,680 INFO] Building model...
[2024-03-12 15:26:04,737 INFO] Switching model to float32 for amp/apex_amp
[2024-03-12 15:26:04,737 INFO] Non quantized layer compute is fp32
[2024-03-12 15:26:06,612 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-12 15:26:06,613 INFO] encoder: 8952800
[2024-03-12 15:26:06,613 INFO] decoder: 16687344
[2024-03-12 15:26:06,613 INFO] * number of parameters: 25640144
[2024-03-12 15:26:06,613 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 15:26:06,613 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 15:26:06,613 INFO]  * src vocab size = 17816
[2024-03-12 15:26:06,613 INFO]  * tgt vocab size = 14144
[2024-03-12 15:26:06,615 INFO] Starting training on GPU: [0]
[2024-03-12 15:26:06,615 INFO] Start training loop and validate every 200 steps...
[2024-03-12 15:26:06,615 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-12 15:26:13,457 INFO] Step 6450/11400; acc: 9.3; ppl: 795131.3; xent: 13.6; lr: 1.00000; sents:    2366; bsz:  569/ 497/47; 4161/3633 tok/s;      7 sec;
[2024-03-12 15:26:16,154 INFO] Step 6500/11400; acc: 8.8; ppl: 29652.2; xent: 10.3; lr: 1.00000; sents:    2273; bsz:  586/ 505/45; 10868/9365 tok/s;     10 sec;
[2024-03-12 15:26:18,567 INFO] Step 6550/11400; acc: 8.6; ppl: 18180.2; xent: 9.8; lr: 1.00000; sents:    2363; bsz:  564/ 491/47; 11676/10181 tok/s;     12 sec;
[2024-03-12 15:26:20,978 INFO] Step 6600/11400; acc: 9.9; ppl: 11849.5; xent: 9.4; lr: 1.00000; sents:    2244; bsz:  546/ 472/45; 11325/9799 tok/s;     14 sec;
[2024-03-12 15:26:24,890 INFO] valid stats calculation
                           took: 3.9113550186157227 s.
[2024-03-12 15:26:24,890 INFO] Train perplexity: 48360.3
[2024-03-12 15:26:24,890 INFO] Train accuracy: 9.14954
[2024-03-12 15:26:24,890 INFO] Sentences processed: 9246
[2024-03-12 15:26:24,890 INFO] Average bsz:  566/ 492/46
[2024-03-12 15:26:24,890 INFO] Validation perplexity: 26073.6
[2024-03-12 15:26:24,891 INFO] Validation accuracy: 9.90774
[2024-03-12 15:26:24,892 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_6600.pt
[2024-03-12 15:26:27,758 INFO] Step 6650/11400; acc: 9.2; ppl: 12149.9; xent: 9.4; lr: 1.00000; sents:    2488; bsz:  603/ 526/50; 4451/3878 tok/s;     21 sec;
[2024-03-12 15:26:30,522 INFO] Step 6700/11400; acc: 10.0; ppl: 12110.7; xent: 9.4; lr: 1.00000; sents:    2251; bsz:  549/ 475/45; 9933/8590 tok/s;     24 sec;
[2024-03-12 15:26:33,233 INFO] Step 6750/11400; acc: 8.7; ppl: 4000.0; xent: 8.3; lr: 1.00000; sents:    2378; bsz:  586/ 509/48; 10803/9392 tok/s;     27 sec;
[2024-03-12 15:26:35,947 INFO] Step 6800/11400; acc: 8.8; ppl: 6676.4; xent: 8.8; lr: 1.00000; sents:    2280; bsz:  562/ 488/46; 10364/8983 tok/s;     29 sec;
[2024-03-12 15:26:39,274 INFO] valid stats calculation
                           took: 3.3267011642456055 s.
[2024-03-12 15:26:39,274 INFO] Train perplexity: 19410.3
[2024-03-12 15:26:39,274 INFO] Train accuracy: 9.15114
[2024-03-12 15:26:39,274 INFO] Sentences processed: 18643
[2024-03-12 15:26:39,274 INFO] Average bsz:  571/ 495/47
[2024-03-12 15:26:39,274 INFO] Validation perplexity: 10500.9
[2024-03-12 15:26:39,274 INFO] Validation accuracy: 2.68753
[2024-03-12 15:26:39,276 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_6800.pt
[2024-03-12 15:26:41,705 INFO] Step 6850/11400; acc: 11.2; ppl: 3706.9; xent: 8.2; lr: 1.00000; sents:    2381; bsz:  568/ 495/48; 4932/4295 tok/s;     35 sec;
[2024-03-12 15:26:44,031 INFO] Step 6900/11400; acc: 14.0; ppl: 1218.0; xent: 7.1; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 12110/10515 tok/s;     37 sec;
[2024-03-12 15:26:46,352 INFO] Step 6950/11400; acc: 17.0; ppl: 403.6; xent: 6.0; lr: 1.00000; sents:    2372; bsz:  580/ 502/47; 12488/10822 tok/s;     40 sec;
[2024-03-12 15:26:48,663 INFO] Step 7000/11400; acc: 19.3; ppl: 242.6; xent: 5.5; lr: 1.00000; sents:    2252; bsz:  551/ 477/45; 11927/10314 tok/s;     42 sec;
[2024-03-12 15:26:51,964 INFO] valid stats calculation
                           took: 3.300577163696289 s.
[2024-03-12 15:26:51,965 INFO] Train perplexity: 6809.67
[2024-03-12 15:26:51,965 INFO] Train accuracy: 11.2024
[2024-03-12 15:26:51,965 INFO] Sentences processed: 28023
[2024-03-12 15:26:51,965 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:26:51,965 INFO] Validation perplexity: 544.03
[2024-03-12 15:26:51,965 INFO] Validation accuracy: 15.4031
[2024-03-12 15:26:51,966 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_7000.pt
[2024-03-12 15:26:54,384 INFO] Step 7050/11400; acc: 22.3; ppl: 151.9; xent: 5.0; lr: 1.00000; sents:    2367; bsz:  587/ 513/47; 5132/4480 tok/s;     48 sec;
[2024-03-12 15:26:56,655 INFO] Step 7100/11400; acc: 24.9; ppl: 102.7; xent: 4.6; lr: 1.00000; sents:    2268; bsz:  547/ 478/45; 12051/10515 tok/s;     50 sec;
[2024-03-12 15:26:58,975 INFO] Step 7150/11400; acc: 27.3; ppl:  77.0; xent: 4.3; lr: 1.00000; sents:    2367; bsz:  587/ 512/47; 12648/11037 tok/s;     52 sec;
[2024-03-12 15:27:01,270 INFO] Step 7200/11400; acc: 30.9; ppl:  52.7; xent: 4.0; lr: 1.00000; sents:    2365; bsz:  561/ 487/47; 12221/10605 tok/s;     55 sec;
[2024-03-12 15:27:04,574 INFO] valid stats calculation
                           took: 3.3043315410614014 s.
[2024-03-12 15:27:04,575 INFO] Train perplexity: 2293.34
[2024-03-12 15:27:04,575 INFO] Train accuracy: 15.0007
[2024-03-12 15:27:04,575 INFO] Sentences processed: 37390
[2024-03-12 15:27:04,575 INFO] Average bsz:  569/ 495/47
[2024-03-12 15:27:04,575 INFO] Validation perplexity: 253.349
[2024-03-12 15:27:04,575 INFO] Validation accuracy: 24.9499
[2024-03-12 15:27:04,576 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_7200.pt
[2024-03-12 15:27:07,048 INFO] Step 7250/11400; acc: 32.1; ppl:  44.4; xent: 3.8; lr: 1.00000; sents:    2269; bsz:  569/ 491/45; 4921/4252 tok/s;     60 sec;
[2024-03-12 15:27:09,377 INFO] Step 7300/11400; acc: 35.9; ppl:  32.1; xent: 3.5; lr: 1.00000; sents:    2371; bsz:  563/ 491/47; 12102/10540 tok/s;     63 sec;
[2024-03-12 15:27:11,771 INFO] Step 7350/11400; acc: 38.0; ppl:  25.5; xent: 3.2; lr: 1.00000; sents:    2376; bsz:  565/ 495/48; 11808/10339 tok/s;     65 sec;
[2024-03-12 15:27:14,088 INFO] Step 7400/11400; acc: 39.3; ppl:  21.8; xent: 3.1; lr: 1.00000; sents:    2284; bsz:  563/ 486/46; 12149/10492 tok/s;     67 sec;
[2024-03-12 15:27:17,403 INFO] valid stats calculation
                           took: 3.3143842220306396 s.
[2024-03-12 15:27:17,403 INFO] Train perplexity: 967.652
[2024-03-12 15:27:17,404 INFO] Train accuracy: 19.2363
[2024-03-12 15:27:17,404 INFO] Sentences processed: 46690
[2024-03-12 15:27:17,404 INFO] Average bsz:  568/ 494/47
[2024-03-12 15:27:17,404 INFO] Validation perplexity: 290.244
[2024-03-12 15:27:17,404 INFO] Validation accuracy: 26.1933
[2024-03-12 15:27:17,405 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_7400.pt
[2024-03-12 15:27:19,895 INFO] Step 7450/11400; acc: 41.5; ppl:  18.0; xent: 2.9; lr: 1.00000; sents:    2376; bsz:  581/ 505/48; 5001/4345 tok/s;     73 sec;
[2024-03-12 15:27:22,183 INFO] Step 7500/11400; acc: 43.6; ppl:  15.3; xent: 2.7; lr: 1.00000; sents:    2375; bsz:  579/ 498/48; 12648/10883 tok/s;     76 sec;
[2024-03-12 15:27:24,499 INFO] Step 7550/11400; acc: 45.6; ppl:  12.9; xent: 2.6; lr: 1.00000; sents:    2271; bsz:  547/ 474/45; 11805/10231 tok/s;     78 sec;
[2024-03-12 15:27:26,860 INFO] Step 7600/11400; acc: 47.8; ppl:  11.3; xent: 2.4; lr: 1.00000; sents:    2366; bsz:  577/ 501/47; 12225/10612 tok/s;     80 sec;
[2024-03-12 15:27:30,174 INFO] valid stats calculation
                           took: 3.3132965564727783 s.
[2024-03-12 15:27:30,174 INFO] Train perplexity: 478.376
[2024-03-12 15:27:30,175 INFO] Train accuracy: 23.4659
[2024-03-12 15:27:30,175 INFO] Sentences processed: 56078
[2024-03-12 15:27:30,175 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:27:30,175 INFO] Validation perplexity: 364.716
[2024-03-12 15:27:30,175 INFO] Validation accuracy: 26.8753
[2024-03-12 15:27:30,176 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_7600.pt
[2024-03-12 15:27:32,598 INFO] Step 7650/11400; acc: 48.2; ppl:  10.4; xent: 2.3; lr: 1.00000; sents:    2366; bsz:  584/ 506/47; 5091/4412 tok/s;     86 sec;
[2024-03-12 15:27:34,887 INFO] Step 7700/11400; acc: 51.7; ppl:   8.3; xent: 2.1; lr: 1.00000; sents:    2264; bsz:  542/ 471/45; 11831/10286 tok/s;     88 sec;
[2024-03-12 15:27:37,219 INFO] Step 7750/11400; acc: 52.1; ppl:   8.1; xent: 2.1; lr: 1.00000; sents:    2369; bsz:  586/ 507/47; 12574/10872 tok/s;     91 sec;
[2024-03-12 15:27:39,552 INFO] Step 7800/11400; acc: 53.8; ppl:   7.3; xent: 2.0; lr: 1.00000; sents:    2267; bsz:  561/ 483/45; 12024/10357 tok/s;     93 sec;
[2024-03-12 15:27:42,890 INFO] valid stats calculation
                           took: 3.337296724319458 s.
[2024-03-12 15:27:42,891 INFO] Train perplexity: 269.444
[2024-03-12 15:27:42,891 INFO] Train accuracy: 27.4476
[2024-03-12 15:27:42,891 INFO] Sentences processed: 65344
[2024-03-12 15:27:42,891 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:27:42,891 INFO] Validation perplexity: 406.191
[2024-03-12 15:27:42,891 INFO] Validation accuracy: 28.3995
[2024-03-12 15:27:42,892 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_7800.pt
[2024-03-12 15:27:45,298 INFO] Step 7850/11400; acc: 56.2; ppl:   6.3; xent: 1.8; lr: 1.00000; sents:    2372; bsz:  563/ 489/47; 4903/4254 tok/s;     99 sec;
[2024-03-12 15:27:47,652 INFO] Step 7900/11400; acc: 57.5; ppl:   5.8; xent: 1.8; lr: 1.00000; sents:    2371; bsz:  581/ 502/47; 12343/10664 tok/s;    101 sec;
[2024-03-12 15:27:50,006 INFO] Step 7950/11400; acc: 59.1; ppl:   5.2; xent: 1.7; lr: 1.00000; sents:    2273; bsz:  560/ 486/45; 11891/10325 tok/s;    103 sec;
[2024-03-12 15:27:52,337 INFO] Step 8000/11400; acc: 60.9; ppl:   4.8; xent: 1.6; lr: 1.00000; sents:    2382; bsz:  582/ 504/48; 12494/10817 tok/s;    106 sec;
[2024-03-12 15:27:55,631 INFO] valid stats calculation
                           took: 3.294048547744751 s.
[2024-03-12 15:27:55,632 INFO] Train perplexity: 165.406
[2024-03-12 15:27:55,632 INFO] Train accuracy: 31.3356
[2024-03-12 15:27:55,632 INFO] Sentences processed: 74742
[2024-03-12 15:27:55,632 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:27:55,632 INFO] Validation perplexity: 534.998
[2024-03-12 15:27:55,632 INFO] Validation accuracy: 29.643
[2024-03-12 15:27:55,633 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_8000.pt
[2024-03-12 15:27:58,034 INFO] Step 8050/11400; acc: 62.6; ppl:   4.3; xent: 1.5; lr: 1.00000; sents:    2376; bsz:  564/ 490/48; 4947/4299 tok/s;    111 sec;
[2024-03-12 15:28:00,401 INFO] Step 8100/11400; acc: 63.5; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    2280; bsz:  563/ 487/46; 11897/10285 tok/s;    114 sec;
[2024-03-12 15:28:02,733 INFO] Step 8150/11400; acc: 65.0; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    2368; bsz:  568/ 498/47; 12186/10667 tok/s;    116 sec;
[2024-03-12 15:28:05,050 INFO] Step 8200/11400; acc: 66.7; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    2366; bsz:  589/ 511/47; 12714/11031 tok/s;    118 sec;
[2024-03-12 15:28:08,350 INFO] valid stats calculation
                           took: 3.2993929386138916 s.
[2024-03-12 15:28:08,350 INFO] Train perplexity: 108.939
[2024-03-12 15:28:08,350 INFO] Train accuracy: 35.0327
[2024-03-12 15:28:08,350 INFO] Sentences processed: 84132
[2024-03-12 15:28:08,350 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:28:08,350 INFO] Validation perplexity: 674.916
[2024-03-12 15:28:08,350 INFO] Validation accuracy: 29.5227
[2024-03-12 15:28:08,352 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_8200.pt
[2024-03-12 15:28:10,716 INFO] Step 8250/11400; acc: 67.9; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    2248; bsz:  550/ 476/45; 4853/4198 tok/s;    124 sec;
[2024-03-12 15:28:13,019 INFO] Step 8300/11400; acc: 68.9; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    2363; bsz:  585/ 507/47; 12697/11009 tok/s;    126 sec;
[2024-03-12 15:28:15,262 INFO] Step 8350/11400; acc: 70.2; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    2365; bsz:  564/ 490/47; 12580/10939 tok/s;    129 sec;
[2024-03-12 15:28:17,562 INFO] Step 8400/11400; acc: 71.2; ppl:   2.9; xent: 1.0; lr: 1.00000; sents:    2367; bsz:  579/ 502/47; 12589/10906 tok/s;    131 sec;
[2024-03-12 15:28:20,856 INFO] valid stats calculation
                           took: 3.29356050491333 s.
[2024-03-12 15:28:20,857 INFO] Train perplexity: 76.3485
[2024-03-12 15:28:20,857 INFO] Train accuracy: 38.4834
[2024-03-12 15:28:20,857 INFO] Sentences processed: 93475
[2024-03-12 15:28:20,857 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:28:20,857 INFO] Validation perplexity: 813.652
[2024-03-12 15:28:20,857 INFO] Validation accuracy: 28.5199
[2024-03-12 15:28:20,858 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_8400.pt
[2024-03-12 15:28:23,323 INFO] Step 8450/11400; acc: 72.9; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    2372; bsz:  564/ 491/47; 4897/4262 tok/s;    137 sec;
[2024-03-12 15:28:25,758 INFO] Step 8500/11400; acc: 74.1; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    2275; bsz:  562/ 487/46; 11538/10006 tok/s;    139 sec;
[2024-03-12 15:28:28,118 INFO] Step 8550/11400; acc: 74.6; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2383; bsz:  567/ 495/48; 12023/10484 tok/s;    142 sec;
[2024-03-12 15:28:30,493 INFO] Step 8600/11400; acc: 75.0; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2381; bsz:  582/ 504/48; 12247/10610 tok/s;    144 sec;
[2024-03-12 15:28:33,785 INFO] valid stats calculation
                           took: 3.292022705078125 s.
[2024-03-12 15:28:33,786 INFO] Train perplexity: 55.9981
[2024-03-12 15:28:33,786 INFO] Train accuracy: 41.7259
[2024-03-12 15:28:33,786 INFO] Sentences processed: 102886
[2024-03-12 15:28:33,786 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:28:33,786 INFO] Validation perplexity: 1140.9
[2024-03-12 15:28:33,786 INFO] Validation accuracy: 27.9583
[2024-03-12 15:28:33,787 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_8600.pt
[2024-03-12 15:28:36,219 INFO] Step 8650/11400; acc: 76.5; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2261; bsz:  552/ 476/45; 4817/4161 tok/s;    150 sec;
[2024-03-12 15:28:38,589 INFO] Step 8700/11400; acc: 77.6; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2275; bsz:  567/ 492/46; 11971/10372 tok/s;    152 sec;
[2024-03-12 15:28:40,907 INFO] Step 8750/11400; acc: 78.6; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    2367; bsz:  566/ 498/47; 12223/10734 tok/s;    154 sec;
[2024-03-12 15:28:43,256 INFO] Step 8800/11400; acc: 78.5; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2367; bsz:  588/ 515/47; 12509/10953 tok/s;    157 sec;
[2024-03-12 15:28:46,551 INFO] valid stats calculation
                           took: 3.294431447982788 s.
[2024-03-12 15:28:46,551 INFO] Train perplexity: 42.71
[2024-03-12 15:28:46,552 INFO] Train accuracy: 44.7387
[2024-03-12 15:28:46,552 INFO] Sentences processed: 112156
[2024-03-12 15:28:46,552 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:28:46,552 INFO] Validation perplexity: 1742.27
[2024-03-12 15:28:46,552 INFO] Validation accuracy: 26.7549
[2024-03-12 15:28:46,553 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_8800.pt
[2024-03-12 15:28:48,875 INFO] Step 8850/11400; acc: 79.3; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2364; bsz:  561/ 487/47; 4988/4335 tok/s;    162 sec;
[2024-03-12 15:28:51,260 INFO] Step 8900/11400; acc: 80.2; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2263; bsz:  566/ 485/45; 11862/10177 tok/s;    165 sec;
[2024-03-12 15:28:53,515 INFO] Step 8950/11400; acc: 81.4; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2365; bsz:  562/ 489/47; 12456/10846 tok/s;    167 sec;
[2024-03-12 15:28:55,850 INFO] Step 9000/11400; acc: 81.9; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2276; bsz:  563/ 487/46; 12055/10420 tok/s;    169 sec;
[2024-03-12 15:28:59,136 INFO] valid stats calculation
                           took: 3.2859907150268555 s.
[2024-03-12 15:28:59,136 INFO] Train perplexity: 33.7978
[2024-03-12 15:28:59,136 INFO] Train accuracy: 47.4666
[2024-03-12 15:28:59,137 INFO] Sentences processed: 121424
[2024-03-12 15:28:59,137 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:28:59,137 INFO] Validation perplexity: 2076.65
[2024-03-12 15:28:59,137 INFO] Validation accuracy: 27.6775
[2024-03-12 15:28:59,138 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_9000.pt
[2024-03-12 15:29:01,641 INFO] Step 9050/11400; acc: 81.7; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2372; bsz:  581/ 506/47; 5018/4367 tok/s;    175 sec;
[2024-03-12 15:29:04,047 INFO] Step 9100/11400; acc: 82.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2375; bsz:  565/ 494/48; 11745/10279 tok/s;    177 sec;
[2024-03-12 15:29:06,335 INFO] Step 9150/11400; acc: 83.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2381; bsz:  579/ 499/48; 12654/10909 tok/s;    180 sec;
[2024-03-12 15:29:08,657 INFO] Step 9200/11400; acc: 83.8; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    2276; bsz:  548/ 477/46; 11809/10274 tok/s;    182 sec;
[2024-03-12 15:29:11,965 INFO] valid stats calculation
                           took: 3.3079795837402344 s.
[2024-03-12 15:29:11,966 INFO] Train perplexity: 27.4208
[2024-03-12 15:29:11,966 INFO] Train accuracy: 49.9932
[2024-03-12 15:29:11,966 INFO] Sentences processed: 130828
[2024-03-12 15:29:11,966 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:29:11,966 INFO] Validation perplexity: 2421.5
[2024-03-12 15:29:11,966 INFO] Validation accuracy: 28.7204
[2024-03-12 15:29:11,967 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_9200.pt
[2024-03-12 15:29:14,415 INFO] Step 9250/11400; acc: 84.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2375; bsz:  579/ 499/48; 5028/4330 tok/s;    188 sec;
[2024-03-12 15:29:16,799 INFO] Step 9300/11400; acc: 84.1; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 12291/10653 tok/s;    190 sec;
[2024-03-12 15:29:19,092 INFO] Step 9350/11400; acc: 85.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2366; bsz:  564/ 489/47; 12292/10674 tok/s;    192 sec;
[2024-03-12 15:29:21,449 INFO] Step 9400/11400; acc: 85.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 11954/10363 tok/s;    195 sec;
[2024-03-12 15:29:24,784 INFO] valid stats calculation
                           took: 3.3346362113952637 s.
[2024-03-12 15:29:24,784 INFO] Train perplexity: 22.7381
[2024-03-12 15:29:24,784 INFO] Train accuracy: 52.3285
[2024-03-12 15:29:24,784 INFO] Sentences processed: 140208
[2024-03-12 15:29:24,784 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:29:24,784 INFO] Validation perplexity: 2370.8
[2024-03-12 15:29:24,784 INFO] Validation accuracy: 27.9984
[2024-03-12 15:29:24,786 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_9400.pt
[2024-03-12 15:29:27,171 INFO] Step 9450/11400; acc: 86.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2362; bsz:  579/ 499/47; 5056/4360 tok/s;    201 sec;
[2024-03-12 15:29:29,486 INFO] Step 9500/11400; acc: 86.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2267; bsz:  544/ 472/45; 11752/10200 tok/s;    203 sec;
[2024-03-12 15:29:31,790 INFO] Step 9550/11400; acc: 86.9; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2369; bsz:  580/ 501/47; 12595/10866 tok/s;    205 sec;
[2024-03-12 15:29:34,174 INFO] Step 9600/11400; acc: 87.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2270; bsz:  559/ 485/45; 11731/10176 tok/s;    208 sec;
[2024-03-12 15:29:37,472 INFO] valid stats calculation
                           took: 3.2975447177886963 s.
[2024-03-12 15:29:37,472 INFO] Train perplexity: 19.2717
[2024-03-12 15:29:37,472 INFO] Train accuracy: 54.4588
[2024-03-12 15:29:37,472 INFO] Sentences processed: 149476
[2024-03-12 15:29:37,472 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:29:37,472 INFO] Validation perplexity: 3063.09
[2024-03-12 15:29:37,473 INFO] Validation accuracy: 27.5973
[2024-03-12 15:29:37,474 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_9600.pt
[2024-03-12 15:29:39,958 INFO] Step 9650/11400; acc: 87.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2371; bsz:  583/ 504/47; 5036/4358 tok/s;    213 sec;
[2024-03-12 15:29:42,281 INFO] Step 9700/11400; acc: 88.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  565/ 492/48; 12171/10600 tok/s;    216 sec;
[2024-03-12 15:29:44,630 INFO] Step 9750/11400; acc: 88.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2382; bsz:  589/ 510/48; 12536/10866 tok/s;    218 sec;
[2024-03-12 15:29:46,984 INFO] Step 9800/11400; acc: 89.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2275; bsz:  542/ 473/46; 11517/10040 tok/s;    220 sec;
[2024-03-12 15:29:50,322 INFO] valid stats calculation
                           took: 3.337662696838379 s.
[2024-03-12 15:29:50,323 INFO] Train perplexity: 16.5761
[2024-03-12 15:29:50,323 INFO] Train accuracy: 56.4502
[2024-03-12 15:29:50,323 INFO] Sentences processed: 158879
[2024-03-12 15:29:50,323 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:29:50,323 INFO] Validation perplexity: 3254.65
[2024-03-12 15:29:50,323 INFO] Validation accuracy: 27.7577
[2024-03-12 15:29:50,324 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_9800.pt
[2024-03-12 15:29:52,779 INFO] Step 9850/11400; acc: 88.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2381; bsz:  592/ 515/48; 5111/4442 tok/s;    226 sec;
[2024-03-12 15:29:55,093 INFO] Step 9900/11400; acc: 89.1; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2368; bsz:  565/ 491/47; 12204/10608 tok/s;    228 sec;
[2024-03-12 15:29:57,375 INFO] Step 9950/11400; acc: 89.3; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2246; bsz:  550/ 476/45; 12049/10427 tok/s;    231 sec;
[2024-03-12 15:29:59,697 INFO] Step 10000/11400; acc: 89.4; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2368; bsz:  587/ 509/47; 12645/10952 tok/s;    233 sec;
[2024-03-12 15:30:03,049 INFO] valid stats calculation
                           took: 3.351700782775879 s.
[2024-03-12 15:30:03,050 INFO] Train perplexity: 14.462
[2024-03-12 15:30:03,050 INFO] Train accuracy: 58.277
[2024-03-12 15:30:03,050 INFO] Sentences processed: 168242
[2024-03-12 15:30:03,050 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:30:03,050 INFO] Validation perplexity: 4272.47
[2024-03-12 15:30:03,050 INFO] Validation accuracy: 28.3193
[2024-03-12 15:30:03,051 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_10000.pt
[2024-03-12 15:30:05,435 INFO] Step 10050/11400; acc: 89.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2249; bsz:  551/ 478/45; 4802/4169 tok/s;    239 sec;
[2024-03-12 15:30:07,732 INFO] Step 10100/11400; acc: 89.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2365; bsz:  578/ 500/47; 12578/10876 tok/s;    241 sec;
[2024-03-12 15:30:10,012 INFO] Step 10150/11400; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  566/ 492/47; 12408/10786 tok/s;    243 sec;
[2024-03-12 15:30:12,326 INFO] Step 10200/11400; acc: 90.5; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  569/ 497/48; 12285/10745 tok/s;    246 sec;
[2024-03-12 15:30:15,644 INFO] valid stats calculation
                           took: 3.317438840866089 s.
[2024-03-12 15:30:15,645 INFO] Train perplexity: 12.8002
[2024-03-12 15:30:15,645 INFO] Train accuracy: 59.9429
[2024-03-12 15:30:15,645 INFO] Sentences processed: 177605
[2024-03-12 15:30:15,645 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:30:15,645 INFO] Validation perplexity: 4847.46
[2024-03-12 15:30:15,645 INFO] Validation accuracy: 27.6775
[2024-03-12 15:30:15,646 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_10200.pt
[2024-03-12 15:30:18,167 INFO] Step 10250/11400; acc: 90.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2272; bsz:  574/ 498/45; 4913/4263 tok/s;    252 sec;
[2024-03-12 15:30:20,448 INFO] Step 10300/11400; acc: 91.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  565/ 490/48; 12383/10738 tok/s;    254 sec;
[2024-03-12 15:30:22,797 INFO] Step 10350/11400; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  583/ 509/48; 12419/10830 tok/s;    256 sec;
[2024-03-12 15:30:25,162 INFO] Step 10400/11400; acc: 91.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2278; bsz:  568/ 492/46; 12002/10403 tok/s;    259 sec;
[2024-03-12 15:30:28,466 INFO] valid stats calculation
                           took: 3.3045027256011963 s.
[2024-03-12 15:30:28,467 INFO] Train perplexity: 11.4373
[2024-03-12 15:30:28,467 INFO] Train accuracy: 61.5019
[2024-03-12 15:30:28,467 INFO] Sentences processed: 186912
[2024-03-12 15:30:28,467 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:30:28,467 INFO] Validation perplexity: 6132.77
[2024-03-12 15:30:28,467 INFO] Validation accuracy: 27.9583
[2024-03-12 15:30:28,468 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_10400.pt
[2024-03-12 15:30:30,894 INFO] Step 10450/11400; acc: 91.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  568/ 497/47; 4950/4332 tok/s;    264 sec;
[2024-03-12 15:30:33,241 INFO] Step 10500/11400; acc: 91.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  578/ 498/47; 12307/10608 tok/s;    267 sec;
[2024-03-12 15:30:35,560 INFO] Step 10550/11400; acc: 91.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2263; bsz:  542/ 474/45; 11699/10218 tok/s;    269 sec;
[2024-03-12 15:30:37,813 INFO] Step 10600/11400; acc: 91.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2364; bsz:  572/ 494/47; 12686/10955 tok/s;    271 sec;
[2024-03-12 15:30:41,108 INFO] valid stats calculation
                           took: 3.29388689994812 s.
[2024-03-12 15:30:41,108 INFO] Train perplexity: 10.3295
[2024-03-12 15:30:41,108 INFO] Train accuracy: 62.9315
[2024-03-12 15:30:41,108 INFO] Sentences processed: 196278
[2024-03-12 15:30:41,108 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:30:41,108 INFO] Validation perplexity: 6317.69
[2024-03-12 15:30:41,108 INFO] Validation accuracy: 27.4368
[2024-03-12 15:30:41,109 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_10600.pt
[2024-03-12 15:30:43,532 INFO] Step 10650/11400; acc: 91.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2268; bsz:  558/ 481/45; 4876/4209 tok/s;    277 sec;
[2024-03-12 15:30:45,893 INFO] Step 10700/11400; acc: 91.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  581/ 506/47; 12314/10727 tok/s;    279 sec;
[2024-03-12 15:30:48,262 INFO] Step 10750/11400; acc: 91.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2373; bsz:  566/ 495/47; 11949/10451 tok/s;    282 sec;
[2024-03-12 15:30:50,651 INFO] Step 10800/11400; acc: 92.1; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  585/ 503/47; 12235/10535 tok/s;    284 sec;
[2024-03-12 15:30:53,958 INFO] valid stats calculation
                           took: 3.306666135787964 s.
[2024-03-12 15:30:53,959 INFO] Train perplexity: 9.40108
[2024-03-12 15:30:53,959 INFO] Train accuracy: 64.2583
[2024-03-12 15:30:53,959 INFO] Sentences processed: 205658
[2024-03-12 15:30:53,959 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:30:53,959 INFO] Validation perplexity: 6221.64
[2024-03-12 15:30:53,959 INFO] Validation accuracy: 27.517
[2024-03-12 15:30:53,960 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_10800.pt
[2024-03-12 15:30:56,373 INFO] Step 10850/11400; acc: 92.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  561/ 487/48; 4904/4258 tok/s;    290 sec;
[2024-03-12 15:30:58,725 INFO] Step 10900/11400; acc: 92.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2281; bsz:  559/ 484/46; 11873/10284 tok/s;    292 sec;
[2024-03-12 15:31:01,042 INFO] Step 10950/11400; acc: 92.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  567/ 491/48; 12245/10607 tok/s;    294 sec;
[2024-03-12 15:31:03,508 INFO] Step 11000/11400; acc: 92.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2277; bsz:  586/ 506/46; 11874/10261 tok/s;    297 sec;
[2024-03-12 15:31:06,837 INFO] valid stats calculation
                           took: 3.328688383102417 s.
[2024-03-12 15:31:06,837 INFO] Train perplexity: 8.62766
[2024-03-12 15:31:06,837 INFO] Train accuracy: 65.4835
[2024-03-12 15:31:06,837 INFO] Sentences processed: 214967
[2024-03-12 15:31:06,837 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:31:06,837 INFO] Validation perplexity: 7259.7
[2024-03-12 15:31:06,837 INFO] Validation accuracy: 27.8379
[2024-03-12 15:31:06,839 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_11000.pt
[2024-03-12 15:31:09,274 INFO] Step 11050/11400; acc: 92.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2371; bsz:  565/ 491/47; 4902/4258 tok/s;    303 sec;
[2024-03-12 15:31:11,592 INFO] Step 11100/11400; acc: 93.3; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2366; bsz:  579/ 500/47; 12494/10780 tok/s;    305 sec;
[2024-03-12 15:31:13,924 INFO] Step 11150/11400; acc: 93.2; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2263; bsz:  559/ 483/45; 11990/10349 tok/s;    307 sec;
[2024-03-12 15:31:16,188 INFO] Step 11200/11400; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2365; bsz:  564/ 489/47; 12456/10809 tok/s;    310 sec;
[2024-03-12 15:31:19,490 INFO] valid stats calculation
                           took: 3.3019144535064697 s.
[2024-03-12 15:31:19,490 INFO] Train perplexity: 7.96913
[2024-03-12 15:31:19,490 INFO] Train accuracy: 66.63
[2024-03-12 15:31:19,490 INFO] Sentences processed: 224332
[2024-03-12 15:31:19,490 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:31:19,490 INFO] Validation perplexity: 7390.48
[2024-03-12 15:31:19,491 INFO] Validation accuracy: 27.5973
[2024-03-12 15:31:19,492 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_11200.pt
[2024-03-12 15:31:21,897 INFO] Step 11250/11400; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  586/ 507/47; 5129/4440 tok/s;    315 sec;
[2024-03-12 15:31:24,198 INFO] Step 11300/11400; acc: 93.2; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2267; bsz:  557/ 483/45; 12095/10488 tok/s;    318 sec;
[2024-03-12 15:31:26,508 INFO] Step 11350/11400; acc: 93.3; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2372; bsz:  564/ 492/47; 12205/10659 tok/s;    320 sec;
[2024-03-12 15:31:28,833 INFO] Step 11400/11400; acc: 93.5; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2371; bsz:  567/ 494/47; 12202/10620 tok/s;    322 sec;
[2024-03-12 15:31:32,143 INFO] valid stats calculation
                           took: 3.308765411376953 s.
[2024-03-12 15:31:32,143 INFO] Train perplexity: 7.4024
[2024-03-12 15:31:32,143 INFO] Train accuracy: 67.6962
[2024-03-12 15:31:32,143 INFO] Sentences processed: 233709
[2024-03-12 15:31:32,143 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:31:32,143 INFO] Validation perplexity: 9182.81
[2024-03-12 15:31:32,143 INFO] Validation accuracy: 27.8781
[2024-03-12 15:31:32,145 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_01_step_11400.pt
