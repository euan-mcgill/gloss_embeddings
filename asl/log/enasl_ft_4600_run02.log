[2024-03-11 15:09:09,274 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-11 15:09:09,274 INFO] Parsed 2 corpora from -data.
[2024-03-11 15:09:09,274 INFO] Loading checkpoint from tg-pretrain/models/tg-pretrain_03_step_4600.pt
[2024-03-11 15:09:09,353 INFO] Building model...
[2024-03-11 15:09:09,413 INFO] Switching model to float32 for amp/apex_amp
[2024-03-11 15:09:09,413 INFO] Non quantized layer compute is fp32
[2024-03-11 15:09:11,192 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(500, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(1000, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-11 15:09:11,193 INFO] encoder: 12916000
[2024-03-11 15:09:11,193 INFO] decoder: 19916144
[2024-03-11 15:09:11,193 INFO] * number of parameters: 32832144
[2024-03-11 15:09:11,193 INFO] Trainable parameters = {'torch.float32': 32832144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-11 15:09:11,193 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-11 15:09:11,193 INFO]  * src vocab size = 17816
[2024-03-11 15:09:11,193 INFO]  * tgt vocab size = 14144
[2024-03-11 15:09:11,195 INFO] Starting training on GPU: [0]
[2024-03-11 15:09:11,195 INFO] Start training loop and validate every 200 steps...
[2024-03-11 15:09:11,195 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-11 15:09:17,035 INFO] Step 4650/ 9600; acc: 8.3; ppl: 1011153.8; xent: 13.8; lr: 1.00000; sents:    2270; bsz:  565/ 490/45; 4839/4193 tok/s;      6 sec;
[2024-03-11 15:09:19,349 INFO] Step 4700/ 9600; acc: 8.5; ppl: 32021.5; xent: 10.4; lr: 1.00000; sents:    2369; bsz:  569/ 496/47; 12289/10719 tok/s;      8 sec;
[2024-03-11 15:09:21,686 INFO] Step 4750/ 9600; acc: 8.7; ppl: 57309.1; xent: 11.0; lr: 1.00000; sents:    2363; bsz:  585/ 508/47; 12523/10870 tok/s;     10 sec;
[2024-03-11 15:09:23,971 INFO] Step 4800/ 9600; acc: 8.8; ppl: 25074.9; xent: 10.1; lr: 1.00000; sents:    2365; bsz:  585/ 507/47; 12797/11095 tok/s;     13 sec;
[2024-03-11 15:09:27,308 INFO] valid stats calculation
                           took: 3.33620023727417 s.
[2024-03-11 15:09:27,308 INFO] Train perplexity: 81226.8
[2024-03-11 15:09:27,309 INFO] Train accuracy: 8.56957
[2024-03-11 15:09:27,309 INFO] Sentences processed: 9367
[2024-03-11 15:09:27,309 INFO] Average bsz:  576/ 500/47
[2024-03-11 15:09:27,309 INFO] Validation perplexity: 8369.95
[2024-03-11 15:09:27,309 INFO] Validation accuracy: 4.73325
[2024-03-11 15:09:27,310 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_4800.pt
[2024-03-11 15:09:29,774 INFO] Step 4850/ 9600; acc: 8.1; ppl: 9039.4; xent: 9.1; lr: 1.00000; sents:    2367; bsz:  564/ 491/47; 4863/4231 tok/s;     19 sec;
[2024-03-11 15:09:32,166 INFO] Step 4900/ 9600; acc: 11.4; ppl: 7571.2; xent: 8.9; lr: 1.00000; sents:    2251; bsz:  549/ 475/45; 11477/9925 tok/s;     21 sec;
[2024-03-11 15:09:34,569 INFO] Step 4950/ 9600; acc: 12.5; ppl: 1554.9; xent: 7.3; lr: 1.00000; sents:    2378; bsz:  568/ 494/48; 11815/10291 tok/s;     23 sec;
[2024-03-11 15:09:36,949 INFO] Step 5000/ 9600; acc: 15.6; ppl: 450.5; xent: 6.1; lr: 1.00000; sents:    2384; bsz:  587/ 510/48; 12339/10718 tok/s;     26 sec;
[2024-03-11 15:09:40,261 INFO] valid stats calculation
                           took: 3.311671257019043 s.
[2024-03-11 15:09:40,261 INFO] Train perplexity: 14619.1
[2024-03-11 15:09:40,261 INFO] Train accuracy: 10.2472
[2024-03-11 15:09:40,261 INFO] Sentences processed: 18747
[2024-03-11 15:09:40,261 INFO] Average bsz:  572/ 496/47
[2024-03-11 15:09:40,261 INFO] Validation perplexity: 543.835
[2024-03-11 15:09:40,261 INFO] Validation accuracy: 16.446
[2024-03-11 15:09:40,263 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_5000.pt
[2024-03-11 15:09:42,795 INFO] Step 5050/ 9600; acc: 18.8; ppl: 236.3; xent: 5.5; lr: 1.00000; sents:    2277; bsz:  561/ 487/46; 4801/4164 tok/s;     32 sec;
[2024-03-11 15:09:45,122 INFO] Step 5100/ 9600; acc: 22.2; ppl: 154.9; xent: 5.0; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 12104/10510 tok/s;     34 sec;
[2024-03-11 15:09:47,473 INFO] Step 5150/ 9600; acc: 24.4; ppl: 106.8; xent: 4.7; lr: 1.00000; sents:    2258; bsz:  569/ 490/45; 12090/10414 tok/s;     36 sec;
[2024-03-11 15:09:49,799 INFO] Step 5200/ 9600; acc: 29.0; ppl:  68.5; xent: 4.2; lr: 1.00000; sents:    2366; bsz:  562/ 489/47; 12089/10519 tok/s;     39 sec;
[2024-03-11 15:09:53,101 INFO] valid stats calculation
                           took: 3.3021507263183594 s.
[2024-03-11 15:09:53,102 INFO] Train perplexity: 3061.44
[2024-03-11 15:09:53,102 INFO] Train accuracy: 14.6507
[2024-03-11 15:09:53,102 INFO] Sentences processed: 28023
[2024-03-11 15:09:53,102 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:09:53,102 INFO] Validation perplexity: 342.113
[2024-03-11 15:09:53,102 INFO] Validation accuracy: 15.7641
[2024-03-11 15:09:53,103 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_5200.pt
[2024-03-11 15:09:55,652 INFO] Step 5250/ 9600; acc: 29.8; ppl:  56.1; xent: 4.0; lr: 1.00000; sents:    2271; bsz:  567/ 491/45; 4843/4192 tok/s;     44 sec;
[2024-03-11 15:09:57,966 INFO] Step 5300/ 9600; acc: 32.7; ppl:  43.9; xent: 3.8; lr: 1.00000; sents:    2364; bsz:  587/ 513/47; 12689/11088 tok/s;     47 sec;
[2024-03-11 15:10:00,276 INFO] Step 5350/ 9600; acc: 35.3; ppl:  33.5; xent: 3.5; lr: 1.00000; sents:    2367; bsz:  567/ 499/47; 12278/10792 tok/s;     49 sec;
[2024-03-11 15:10:02,656 INFO] Step 5400/ 9600; acc: 37.4; ppl:  26.5; xent: 3.3; lr: 1.00000; sents:    2261; bsz:  554/ 479/45; 11645/10058 tok/s;     51 sec;
[2024-03-11 15:10:05,960 INFO] valid stats calculation
                           took: 3.3037948608398438 s.
[2024-03-11 15:10:05,960 INFO] Train perplexity: 1023.37
[2024-03-11 15:10:05,960 INFO] Train accuracy: 19.4442
[2024-03-11 15:10:05,960 INFO] Sentences processed: 37286
[2024-03-11 15:10:05,960 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:10:05,960 INFO] Validation perplexity: 239.875
[2024-03-11 15:10:05,960 INFO] Validation accuracy: 25.8323
[2024-03-11 15:10:05,962 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_5400.pt
[2024-03-11 15:10:08,399 INFO] Step 5450/ 9600; acc: 40.1; ppl:  21.3; xent: 3.1; lr: 1.00000; sents:    2476; bsz:  582/ 508/50; 5064/4418 tok/s;     57 sec;
[2024-03-11 15:10:10,786 INFO] Step 5500/ 9600; acc: 40.6; ppl:  19.3; xent: 3.0; lr: 1.00000; sents:    2268; bsz:  557/ 483/45; 11676/10113 tok/s;     60 sec;
[2024-03-11 15:10:13,186 INFO] Step 5550/ 9600; acc: 44.0; ppl:  15.2; xent: 2.7; lr: 1.00000; sents:    2279; bsz:  563/ 487/46; 11753/10161 tok/s;     62 sec;
[2024-03-11 15:10:15,542 INFO] Step 5600/ 9600; acc: 46.5; ppl:  12.2; xent: 2.5; lr: 1.00000; sents:    2381; bsz:  566/ 495/48; 12004/10499 tok/s;     64 sec;
[2024-03-11 15:10:18,830 INFO] valid stats calculation
                           took: 3.2876570224761963 s.
[2024-03-11 15:10:18,831 INFO] Train perplexity: 449.815
[2024-03-11 15:10:18,831 INFO] Train accuracy: 24.1075
[2024-03-11 15:10:18,831 INFO] Sentences processed: 46690
[2024-03-11 15:10:18,831 INFO] Average bsz:  568/ 494/47
[2024-03-11 15:10:18,831 INFO] Validation perplexity: 327.344
[2024-03-11 15:10:18,831 INFO] Validation accuracy: 27.8379
[2024-03-11 15:10:18,832 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_5600.pt
[2024-03-11 15:10:21,400 INFO] Step 5650/ 9600; acc: 47.8; ppl:  11.3; xent: 2.4; lr: 1.00000; sents:    2376; bsz:  581/ 505/48; 4958/4307 tok/s;     70 sec;
[2024-03-11 15:10:23,715 INFO] Step 5700/ 9600; acc: 49.4; ppl:   9.9; xent: 2.3; lr: 1.00000; sents:    2375; bsz:  579/ 498/48; 12499/10755 tok/s;     73 sec;
[2024-03-11 15:10:26,065 INFO] Step 5750/ 9600; acc: 52.2; ppl:   8.0; xent: 2.1; lr: 1.00000; sents:    2371; bsz:  565/ 491/47; 12024/10438 tok/s;     75 sec;
[2024-03-11 15:10:28,430 INFO] Step 5800/ 9600; acc: 53.2; ppl:   7.5; xent: 2.0; lr: 1.00000; sents:    2266; bsz:  559/ 484/45; 11815/10241 tok/s;     77 sec;
[2024-03-11 15:10:31,727 INFO] valid stats calculation
                           took: 3.296143054962158 s.
[2024-03-11 15:10:31,728 INFO] Train perplexity: 234.594
[2024-03-11 15:10:31,728 INFO] Train accuracy: 28.5277
[2024-03-11 15:10:31,728 INFO] Sentences processed: 56078
[2024-03-11 15:10:31,728 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:10:31,728 INFO] Validation perplexity: 477.17
[2024-03-11 15:10:31,728 INFO] Validation accuracy: 25.2306
[2024-03-11 15:10:31,729 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_5800.pt
[2024-03-11 15:10:34,240 INFO] Step 5850/ 9600; acc: 54.4; ppl:   6.9; xent: 1.9; lr: 1.00000; sents:    2366; bsz:  584/ 506/47; 5028/4357 tok/s;     83 sec;
[2024-03-11 15:10:36,520 INFO] Step 5900/ 9600; acc: 57.6; ppl:   5.9; xent: 1.8; lr: 1.00000; sents:    2364; bsz:  564/ 490/47; 12370/10744 tok/s;     85 sec;
[2024-03-11 15:10:38,900 INFO] Step 5950/ 9600; acc: 58.5; ppl:   5.5; xent: 1.7; lr: 1.00000; sents:    2269; bsz:  564/ 488/45; 11850/10254 tok/s;     88 sec;
[2024-03-11 15:10:41,261 INFO] Step 6000/ 9600; acc: 60.1; ppl:   5.0; xent: 1.6; lr: 1.00000; sents:    2267; bsz:  561/ 483/45; 11884/10236 tok/s;     90 sec;
[2024-03-11 15:10:44,561 INFO] valid stats calculation
                           took: 3.2999637126922607 s.
[2024-03-11 15:10:44,562 INFO] Train perplexity: 138.564
[2024-03-11 15:10:44,562 INFO] Train accuracy: 32.6688
[2024-03-11 15:10:44,562 INFO] Sentences processed: 65344
[2024-03-11 15:10:44,562 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:10:44,562 INFO] Validation perplexity: 497.482
[2024-03-11 15:10:44,562 INFO] Validation accuracy: 27.5973
[2024-03-11 15:10:44,563 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_6000.pt
[2024-03-11 15:10:47,072 INFO] Step 6050/ 9600; acc: 62.1; ppl:   4.6; xent: 1.5; lr: 1.00000; sents:    2372; bsz:  563/ 489/47; 4848/4206 tok/s;     96 sec;
[2024-03-11 15:10:49,451 INFO] Step 6100/ 9600; acc: 62.5; ppl:   4.4; xent: 1.5; lr: 1.00000; sents:    2371; bsz:  581/ 502/47; 12214/10553 tok/s;     98 sec;
[2024-03-11 15:10:51,812 INFO] Step 6150/ 9600; acc: 64.6; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    2375; bsz:  583/ 505/48; 12347/10687 tok/s;    101 sec;
[2024-03-11 15:10:54,158 INFO] Step 6200/ 9600; acc: 66.4; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    2382; bsz:  565/ 492/48; 12048/10487 tok/s;    103 sec;
[2024-03-11 15:10:57,458 INFO] valid stats calculation
                           took: 3.299562454223633 s.
[2024-03-11 15:10:57,458 INFO] Train perplexity: 89.1514
[2024-03-11 15:10:57,458 INFO] Train accuracy: 36.5942
[2024-03-11 15:10:57,458 INFO] Sentences processed: 74844
[2024-03-11 15:10:57,458 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:10:57,458 INFO] Validation perplexity: 702.078
[2024-03-11 15:10:57,458 INFO] Validation accuracy: 28.3995
[2024-03-11 15:10:57,460 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_6200.pt
[2024-03-11 15:11:00,038 INFO] Step 6250/ 9600; acc: 68.1; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    2274; bsz:  557/ 483/45; 4740/4110 tok/s;    109 sec;
[2024-03-11 15:11:02,421 INFO] Step 6300/ 9600; acc: 69.2; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    2376; bsz:  568/ 496/48; 11926/10407 tok/s;    111 sec;
[2024-03-11 15:11:04,864 INFO] Step 6350/ 9600; acc: 70.6; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    2272; bsz:  563/ 488/45; 11530/10000 tok/s;    114 sec;
[2024-03-11 15:11:07,238 INFO] Step 6400/ 9600; acc: 70.7; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    2366; bsz:  589/ 511/47; 12406/10764 tok/s;    116 sec;
[2024-03-11 15:11:10,538 INFO] valid stats calculation
                           took: 3.299575090408325 s.
[2024-03-11 15:11:10,538 INFO] Train perplexity: 61.3722
[2024-03-11 15:11:10,539 INFO] Train accuracy: 40.2735
[2024-03-11 15:11:10,539 INFO] Sentences processed: 84132
[2024-03-11 15:11:10,539 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:11:10,539 INFO] Validation perplexity: 951.073
[2024-03-11 15:11:10,539 INFO] Validation accuracy: 27.9984
[2024-03-11 15:11:10,540 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_6400.pt
[2024-03-11 15:11:13,005 INFO] Step 6450/ 9600; acc: 72.9; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    2369; bsz:  566/ 492/47; 4912/4266 tok/s;    122 sec;
[2024-03-11 15:11:15,306 INFO] Step 6500/ 9600; acc: 74.0; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    2242; bsz:  547/ 474/45; 11889/10290 tok/s;    124 sec;
[2024-03-11 15:11:17,633 INFO] Step 6550/ 9600; acc: 74.8; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2365; bsz:  585/ 508/47; 12578/10913 tok/s;    126 sec;
[2024-03-11 15:11:19,965 INFO] Step 6600/ 9600; acc: 75.6; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2367; bsz:  579/ 502/47; 12420/10760 tok/s;    129 sec;
[2024-03-11 15:11:23,271 INFO] valid stats calculation
                           took: 3.306502103805542 s.
[2024-03-11 15:11:23,272 INFO] Train perplexity: 44.6448
[2024-03-11 15:11:23,272 INFO] Train accuracy: 43.6781
[2024-03-11 15:11:23,272 INFO] Sentences processed: 93475
[2024-03-11 15:11:23,272 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:11:23,272 INFO] Validation perplexity: 1512.17
[2024-03-11 15:11:23,272 INFO] Validation accuracy: 27.1159
[2024-03-11 15:11:23,273 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_6600.pt
[2024-03-11 15:11:25,809 INFO] Step 6650/ 9600; acc: 76.8; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2268; bsz:  558/ 484/45; 4773/4138 tok/s;    135 sec;
[2024-03-11 15:11:28,178 INFO] Step 6700/ 9600; acc: 77.9; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2379; bsz:  568/ 494/48; 11990/10440 tok/s;    137 sec;
[2024-03-11 15:11:30,559 INFO] Step 6750/ 9600; acc: 78.4; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2274; bsz:  558/ 483/45; 11712/10150 tok/s;    139 sec;
[2024-03-11 15:11:32,900 INFO] Step 6800/ 9600; acc: 79.7; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2376; bsz:  580/ 503/48; 12391/10742 tok/s;    142 sec;
[2024-03-11 15:11:36,227 INFO] valid stats calculation
                           took: 3.326035737991333 s.
[2024-03-11 15:11:36,227 INFO] Train perplexity: 33.9733
[2024-03-11 15:11:36,227 INFO] Train accuracy: 46.8012
[2024-03-11 15:11:36,227 INFO] Sentences processed: 102772
[2024-03-11 15:11:36,227 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:11:36,227 INFO] Validation perplexity: 1770.23
[2024-03-11 15:11:36,227 INFO] Validation accuracy: 27.6775
[2024-03-11 15:11:36,228 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_6800.pt
[2024-03-11 15:11:38,703 INFO] Step 6850/ 9600; acc: 80.0; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 4852/4214 tok/s;    148 sec;
[2024-03-11 15:11:41,028 INFO] Step 6900/ 9600; acc: 81.2; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2372; bsz:  566/ 496/47; 12186/10677 tok/s;    150 sec;
[2024-03-11 15:11:43,457 INFO] Step 6950/ 9600; acc: 80.3; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2270; bsz:  587/ 508/45; 12085/10451 tok/s;    152 sec;
[2024-03-11 15:11:45,839 INFO] Step 7000/ 9600; acc: 81.5; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2367; bsz:  568/ 500/47; 11926/10491 tok/s;    155 sec;
[2024-03-11 15:11:49,128 INFO] valid stats calculation
                           took: 3.288360834121704 s.
[2024-03-11 15:11:49,128 INFO] Train perplexity: 26.7296
[2024-03-11 15:11:49,128 INFO] Train accuracy: 49.6545
[2024-03-11 15:11:49,128 INFO] Sentences processed: 112156
[2024-03-11 15:11:49,128 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:11:49,128 INFO] Validation perplexity: 2406.64
[2024-03-11 15:11:49,128 INFO] Validation accuracy: 27.3566
[2024-03-11 15:11:49,130 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_7000.pt
[2024-03-11 15:11:51,597 INFO] Step 7050/ 9600; acc: 82.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2260; bsz:  555/ 480/45; 4823/4172 tok/s;    160 sec;
[2024-03-11 15:11:53,932 INFO] Step 7100/ 9600; acc: 83.3; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2367; bsz:  571/ 492/47; 12228/10541 tok/s;    163 sec;
[2024-03-11 15:11:56,236 INFO] Step 7150/ 9600; acc: 84.2; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    2365; bsz:  562/ 489/47; 12186/10611 tok/s;    165 sec;
[2024-03-11 15:11:58,620 INFO] Step 7200/ 9600; acc: 84.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2276; bsz:  563/ 487/46; 11808/10207 tok/s;    167 sec;
[2024-03-11 15:12:01,948 INFO] valid stats calculation
                           took: 3.327159881591797 s.
[2024-03-11 15:12:01,948 INFO] Train perplexity: 21.747
[2024-03-11 15:12:01,948 INFO] Train accuracy: 52.23
[2024-03-11 15:12:01,948 INFO] Sentences processed: 121424
[2024-03-11 15:12:01,948 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:12:01,948 INFO] Validation perplexity: 3606.49
[2024-03-11 15:12:01,948 INFO] Validation accuracy: 27.4368
[2024-03-11 15:12:01,950 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_7200.pt
[2024-03-11 15:12:04,559 INFO] Step 7250/ 9600; acc: 84.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2468; bsz:  584/ 514/49; 4915/4332 tok/s;    173 sec;
[2024-03-11 15:12:06,966 INFO] Step 7300/ 9600; acc: 85.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2279; bsz:  562/ 486/46; 11681/10089 tok/s;    176 sec;
[2024-03-11 15:12:09,285 INFO] Step 7350/ 9600; acc: 85.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2381; bsz:  579/ 499/48; 12488/10765 tok/s;    178 sec;
[2024-03-11 15:12:11,663 INFO] Step 7400/ 9600; acc: 86.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2276; bsz:  562/ 485/46; 11807/10192 tok/s;    180 sec;
[2024-03-11 15:12:14,947 INFO] valid stats calculation
                           took: 3.283240795135498 s.
[2024-03-11 15:12:14,947 INFO] Train perplexity: 18.0671
[2024-03-11 15:12:14,947 INFO] Train accuracy: 54.617
[2024-03-11 15:12:14,947 INFO] Sentences processed: 130828
[2024-03-11 15:12:14,948 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:12:14,948 INFO] Validation perplexity: 2667.14
[2024-03-11 15:12:14,948 INFO] Validation accuracy: 28.0385
[2024-03-11 15:12:14,949 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_7400.pt
[2024-03-11 15:12:17,450 INFO] Step 7450/ 9600; acc: 86.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2375; bsz:  566/ 491/48; 4889/4241 tok/s;    186 sec;
[2024-03-11 15:12:19,897 INFO] Step 7500/ 9600; acc: 86.8; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2273; bsz:  565/ 489/45; 11551/9995 tok/s;    189 sec;
[2024-03-11 15:12:22,237 INFO] Step 7550/ 9600; acc: 87.4; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2366; bsz:  563/ 490/47; 12035/10475 tok/s;    191 sec;
[2024-03-11 15:12:24,583 INFO] Step 7600/ 9600; acc: 87.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2366; bsz:  585/ 507/47; 12463/10797 tok/s;    193 sec;
[2024-03-11 15:12:27,917 INFO] valid stats calculation
                           took: 3.334249973297119 s.
[2024-03-11 15:12:27,918 INFO] Train perplexity: 15.3471
[2024-03-11 15:12:27,918 INFO] Train accuracy: 56.7788
[2024-03-11 15:12:27,918 INFO] Sentences processed: 140208
[2024-03-11 15:12:27,918 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:12:27,918 INFO] Validation perplexity: 3563.83
[2024-03-11 15:12:27,918 INFO] Validation accuracy: 27.7577
[2024-03-11 15:12:27,919 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_7600.pt
[2024-03-11 15:12:30,452 INFO] Step 7650/ 9600; acc: 88.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 4770/4112 tok/s;    199 sec;
[2024-03-11 15:12:32,713 INFO] Step 7700/ 9600; acc: 88.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2469; bsz:  583/ 505/49; 12888/11180 tok/s;    202 sec;
[2024-03-11 15:12:35,076 INFO] Step 7750/ 9600; acc: 88.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2267; bsz:  561/ 484/45; 11863/10237 tok/s;    204 sec;
[2024-03-11 15:12:37,470 INFO] Step 7800/ 9600; acc: 88.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2270; bsz:  559/ 485/45; 11682/10134 tok/s;    206 sec;
[2024-03-11 15:12:40,769 INFO] valid stats calculation
                           took: 3.2985775470733643 s.
[2024-03-11 15:12:40,769 INFO] Train perplexity: 13.2802
[2024-03-11 15:12:40,769 INFO] Train accuracy: 58.7413
[2024-03-11 15:12:40,770 INFO] Sentences processed: 149476
[2024-03-11 15:12:40,770 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:12:40,770 INFO] Validation perplexity: 4195.12
[2024-03-11 15:12:40,770 INFO] Validation accuracy: 27.5572
[2024-03-11 15:12:40,771 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_7800.pt
[2024-03-11 15:12:43,315 INFO] Step 7850/ 9600; acc: 89.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2371; bsz:  583/ 504/47; 4983/4313 tok/s;    212 sec;
[2024-03-11 15:12:45,651 INFO] Step 7900/ 9600; acc: 89.2; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  565/ 492/48; 12103/10542 tok/s;    214 sec;
[2024-03-11 15:12:48,041 INFO] Step 7950/ 9600; acc: 89.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2279; bsz:  561/ 487/46; 11743/10187 tok/s;    217 sec;
[2024-03-11 15:12:50,385 INFO] Step 8000/ 9600; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2378; bsz:  570/ 496/48; 12156/10586 tok/s;    219 sec;
[2024-03-11 15:12:53,695 INFO] valid stats calculation
                           took: 3.310251474380493 s.
[2024-03-11 15:12:53,696 INFO] Train perplexity: 11.6468
[2024-03-11 15:12:53,696 INFO] Train accuracy: 60.5545
[2024-03-11 15:12:53,696 INFO] Sentences processed: 158879
[2024-03-11 15:12:53,696 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:12:53,696 INFO] Validation perplexity: 4748.34
[2024-03-11 15:12:53,696 INFO] Validation accuracy: 28.2792
[2024-03-11 15:12:53,698 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_8000.pt
[2024-03-11 15:12:56,240 INFO] Step 8050/ 9600; acc: 89.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  592/ 515/48; 5058/4396 tok/s;    225 sec;
[2024-03-11 15:12:58,634 INFO] Step 8100/ 9600; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2368; bsz:  585/ 506/47; 12227/10580 tok/s;    227 sec;
[2024-03-11 15:13:00,934 INFO] Step 8150/ 9600; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  565/ 490/47; 12285/10666 tok/s;    230 sec;
[2024-03-11 15:13:03,221 INFO] Step 8200/ 9600; acc: 90.5; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2248; bsz:  551/ 478/45; 12055/10458 tok/s;    232 sec;
[2024-03-11 15:13:06,551 INFO] valid stats calculation
                           took: 3.3296985626220703 s.
[2024-03-11 15:13:06,552 INFO] Train perplexity: 10.3408
[2024-03-11 15:13:06,552 INFO] Train accuracy: 62.224
[2024-03-11 15:13:06,552 INFO] Sentences processed: 168242
[2024-03-11 15:13:06,552 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:13:06,552 INFO] Validation perplexity: 4237.97
[2024-03-11 15:13:06,552 INFO] Validation accuracy: 27.9583
[2024-03-11 15:13:06,553 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_8200.pt
[2024-03-11 15:13:09,000 INFO] Step 8250/ 9600; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2363; bsz:  562/ 488/47; 4859/4224 tok/s;    238 sec;
[2024-03-11 15:13:11,371 INFO] Step 8300/ 9600; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2251; bsz:  567/ 490/45; 11962/10329 tok/s;    240 sec;
[2024-03-11 15:13:13,669 INFO] Step 8350/ 9600; acc: 91.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  566/ 492/47; 12309/10700 tok/s;    242 sec;
[2024-03-11 15:13:16,009 INFO] Step 8400/ 9600; acc: 91.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  569/ 497/48; 12154/10630 tok/s;    245 sec;
[2024-03-11 15:13:19,299 INFO] valid stats calculation
                           took: 3.289806842803955 s.
[2024-03-11 15:13:19,299 INFO] Train perplexity: 9.29904
[2024-03-11 15:13:19,299 INFO] Train accuracy: 63.7331
[2024-03-11 15:13:19,299 INFO] Sentences processed: 177605
[2024-03-11 15:13:19,299 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:13:19,299 INFO] Validation perplexity: 7195.57
[2024-03-11 15:13:19,300 INFO] Validation accuracy: 27.156
[2024-03-11 15:13:19,301 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_8400.pt
[2024-03-11 15:13:21,946 INFO] Step 8450/ 9600; acc: 91.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2272; bsz:  574/ 498/45; 4834/4193 tok/s;    251 sec;
[2024-03-11 15:13:24,270 INFO] Step 8500/ 9600; acc: 92.0; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  565/ 490/48; 12152/10537 tok/s;    253 sec;
[2024-03-11 15:13:26,612 INFO] Step 8550/ 9600; acc: 91.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  564/ 492/48; 12041/10503 tok/s;    255 sec;
[2024-03-11 15:13:29,017 INFO] Step 8600/ 9600; acc: 92.1; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2278; bsz:  567/ 490/46; 11794/10196 tok/s;    258 sec;
[2024-03-11 15:13:32,361 INFO] valid stats calculation
                           took: 3.342968463897705 s.
[2024-03-11 15:13:32,361 INFO] Train perplexity: 8.43811
[2024-03-11 15:13:32,361 INFO] Train accuracy: 65.1358
[2024-03-11 15:13:32,361 INFO] Sentences processed: 186912
[2024-03-11 15:13:32,361 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:13:32,361 INFO] Validation perplexity: 7569.7
[2024-03-11 15:13:32,361 INFO] Validation accuracy: 27.8781
[2024-03-11 15:13:32,363 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_8600.pt
[2024-03-11 15:13:34,889 INFO] Step 8650/ 9600; acc: 91.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  587/ 515/47; 5001/4387 tok/s;    264 sec;
[2024-03-11 15:13:37,251 INFO] Step 8700/ 9600; acc: 92.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2264; bsz:  559/ 483/45; 11836/10232 tok/s;    266 sec;
[2024-03-11 15:13:39,560 INFO] Step 8750/ 9600; acc: 92.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  575/ 495/47; 12448/10731 tok/s;    268 sec;
[2024-03-11 15:13:41,807 INFO] Step 8800/ 9600; acc: 92.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2364; bsz:  558/ 487/47; 12416/10828 tok/s;    271 sec;
[2024-03-11 15:13:45,139 INFO] valid stats calculation
                           took: 3.3313801288604736 s.
[2024-03-11 15:13:45,140 INFO] Train perplexity: 7.71818
[2024-03-11 15:13:45,140 INFO] Train accuracy: 66.4331
[2024-03-11 15:13:45,140 INFO] Sentences processed: 196278
[2024-03-11 15:13:45,140 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:13:45,140 INFO] Validation perplexity: 8174.4
[2024-03-11 15:13:45,140 INFO] Validation accuracy: 27.4368
[2024-03-11 15:13:45,141 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_8800.pt
[2024-03-11 15:13:47,649 INFO] Step 8850/ 9600; acc: 92.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2268; bsz:  558/ 481/45; 4774/4121 tok/s;    276 sec;
[2024-03-11 15:13:50,052 INFO] Step 8900/ 9600; acc: 92.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2464; bsz:  586/ 516/49; 12189/10738 tok/s;    279 sec;
[2024-03-11 15:13:52,438 INFO] Step 8950/ 9600; acc: 92.7; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2276; bsz:  562/ 486/46; 11770/10176 tok/s;    281 sec;
[2024-03-11 15:13:54,792 INFO] Step 9000/ 9600; acc: 92.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  565/ 491/47; 12013/10432 tok/s;    284 sec;
[2024-03-11 15:13:58,085 INFO] valid stats calculation
                           took: 3.2927067279815674 s.
[2024-03-11 15:13:58,085 INFO] Train perplexity: 7.11619
[2024-03-11 15:13:58,085 INFO] Train accuracy: 67.622
[2024-03-11 15:13:58,085 INFO] Sentences processed: 205658
[2024-03-11 15:13:58,085 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:13:58,085 INFO] Validation perplexity: 6526.54
[2024-03-11 15:13:58,085 INFO] Validation accuracy: 28.0385
[2024-03-11 15:13:58,087 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_9000.pt
[2024-03-11 15:14:00,705 INFO] Step 9050/ 9600; acc: 92.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2274; bsz:  578/ 496/45; 4888/4196 tok/s;    290 sec;
[2024-03-11 15:14:03,005 INFO] Step 9100/ 9600; acc: 92.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2382; bsz:  561/ 487/48; 12194/10596 tok/s;    292 sec;
[2024-03-11 15:14:05,341 INFO] Step 9150/ 9600; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2376; bsz:  567/ 491/48; 12142/10518 tok/s;    294 sec;
[2024-03-11 15:14:07,826 INFO] Step 9200/ 9600; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2277; bsz:  586/ 506/46; 11786/10184 tok/s;    297 sec;
[2024-03-11 15:14:11,115 INFO] valid stats calculation
                           took: 3.289238452911377 s.
[2024-03-11 15:14:11,116 INFO] Train perplexity: 6.6033
[2024-03-11 15:14:11,116 INFO] Train accuracy: 68.7233
[2024-03-11 15:14:11,116 INFO] Sentences processed: 214967
[2024-03-11 15:14:11,116 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:14:11,116 INFO] Validation perplexity: 8752.05
[2024-03-11 15:14:11,116 INFO] Validation accuracy: 26.8351
[2024-03-11 15:14:11,117 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_9200.pt
[2024-03-11 15:14:13,624 INFO] Step 9250/ 9600; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2371; bsz:  565/ 491/47; 4874/4234 tok/s;    302 sec;
[2024-03-11 15:14:15,954 INFO] Step 9300/ 9600; acc: 93.5; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2366; bsz:  579/ 500/47; 12428/10723 tok/s;    305 sec;
[2024-03-11 15:14:18,248 INFO] Step 9350/ 9600; acc: 93.3; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2366; bsz:  563/ 489/47; 12272/10659 tok/s;    307 sec;
[2024-03-11 15:14:20,596 INFO] Step 9400/ 9600; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 11931/10289 tok/s;    309 sec;
[2024-03-11 15:14:23,918 INFO] valid stats calculation
                           took: 3.321610689163208 s.
[2024-03-11 15:14:23,918 INFO] Train perplexity: 6.16672
[2024-03-11 15:14:23,918 INFO] Train accuracy: 69.7417
[2024-03-11 15:14:23,918 INFO] Sentences processed: 224332
[2024-03-11 15:14:23,918 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:14:23,918 INFO] Validation perplexity: 8847.29
[2024-03-11 15:14:23,918 INFO] Validation accuracy: 27.3566
[2024-03-11 15:14:23,919 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_9400.pt
[2024-03-11 15:14:26,383 INFO] Step 9450/ 9600; acc: 93.3; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  566/ 494/47; 4890/4271 tok/s;    315 sec;
[2024-03-11 15:14:28,755 INFO] Step 9500/ 9600; acc: 93.6; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2267; bsz:  576/ 495/45; 12148/10442 tok/s;    318 sec;
[2024-03-11 15:14:31,117 INFO] Step 9550/ 9600; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2372; bsz:  564/ 492/47; 11933/10422 tok/s;    320 sec;
[2024-03-11 15:14:33,492 INFO] Step 9600/ 9600; acc: 93.5; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2371; bsz:  567/ 494/47; 11946/10397 tok/s;    322 sec;
[2024-03-11 15:14:36,784 INFO] valid stats calculation
                           took: 3.29152250289917 s.
[2024-03-11 15:14:36,784 INFO] Train perplexity: 5.78686
[2024-03-11 15:14:36,784 INFO] Train accuracy: 70.6901
[2024-03-11 15:14:36,785 INFO] Sentences processed: 233709
[2024-03-11 15:14:36,785 INFO] Average bsz:  569/ 494/47
[2024-03-11 15:14:36,785 INFO] Validation perplexity: 11681
[2024-03-11 15:14:36,785 INFO] Validation accuracy: 28.7204
[2024-03-11 15:14:36,786 INFO] Saving checkpoint tg-finetune/tg-finetune_4600_02_step_9600.pt
