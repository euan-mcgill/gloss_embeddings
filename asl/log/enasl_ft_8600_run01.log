[2024-03-11 14:11:11,385 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-11 14:11:11,385 INFO] Parsed 2 corpora from -data.
[2024-03-11 14:11:11,385 INFO] Loading checkpoint from tg-pretrain/models/tg-pretrain_02_step_8600.pt
[2024-03-11 14:11:11,466 INFO] Building model...
[2024-03-11 14:11:11,526 INFO] Switching model to float32 for amp/apex_amp
[2024-03-11 14:11:11,526 INFO] Non quantized layer compute is fp32
[2024-03-11 14:11:13,604 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(500, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 500, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(1000, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-11 14:11:13,604 INFO] encoder: 12916000
[2024-03-11 14:11:13,604 INFO] decoder: 19916144
[2024-03-11 14:11:13,604 INFO] * number of parameters: 32832144
[2024-03-11 14:11:13,605 INFO] Trainable parameters = {'torch.float32': 32832144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-11 14:11:13,605 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-11 14:11:13,605 INFO]  * src vocab size = 17816
[2024-03-11 14:11:13,605 INFO]  * tgt vocab size = 14144
[2024-03-11 14:11:13,606 INFO] Starting training on GPU: [0]
[2024-03-11 14:11:13,606 INFO] Start training loop and validate every 200 steps...
[2024-03-11 14:11:13,606 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-11 14:11:20,740 INFO] Step 8650/13600; acc: 9.3; ppl: 1734905.4; xent: 14.4; lr: 1.00000; sents:    2270; bsz:  565/ 490/45; 3961/3432 tok/s;      7 sec;
[2024-03-11 14:11:24,451 INFO] Step 8700/13600; acc: 9.9; ppl: 68521.5; xent: 11.1; lr: 1.00000; sents:    2369; bsz:  590/ 512/47; 7955/6907 tok/s;     11 sec;
[2024-03-11 14:11:27,389 INFO] Step 8750/13600; acc: 11.8; ppl: 26405.1; xent: 10.2; lr: 1.00000; sents:    2363; bsz:  564/ 491/47; 9591/8363 tok/s;     14 sec;
[2024-03-11 14:11:29,899 INFO] Step 8800/13600; acc: 10.7; ppl: 5331.5; xent: 8.6; lr: 1.00000; sents:    2365; bsz:  563/ 489/47; 11211/9739 tok/s;     16 sec;
[2024-03-11 14:11:33,309 INFO] valid stats calculation
                           took: 3.4095354080200195 s.
[2024-03-11 14:11:33,309 INFO] Train perplexity: 64045.1
[2024-03-11 14:11:33,309 INFO] Train accuracy: 10.4321
[2024-03-11 14:11:33,309 INFO] Sentences processed: 9367
[2024-03-11 14:11:33,309 INFO] Average bsz:  570/ 496/47
[2024-03-11 14:11:33,309 INFO] Validation perplexity: 2564.79
[2024-03-11 14:11:33,309 INFO] Validation accuracy: 13.9992
[2024-03-11 14:11:33,310 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_8800.pt
[2024-03-11 14:11:37,189 INFO] Step 8850/13600; acc: 10.2; ppl: 4514.1; xent: 8.4; lr: 1.00000; sents:    2246; bsz:  570/ 493/45; 3908/3383 tok/s;     24 sec;
[2024-03-11 14:11:40,839 INFO] Step 8900/13600; acc: 9.8; ppl: 13681.6; xent: 9.5; lr: 1.00000; sents:    2372; bsz:  566/ 491/47; 7755/6727 tok/s;     27 sec;
[2024-03-11 14:11:43,938 INFO] Step 8950/13600; acc: 9.7; ppl: 5220.8; xent: 8.6; lr: 1.00000; sents:    2378; bsz:  586/ 509/48; 9448/8214 tok/s;     30 sec;
[2024-03-11 14:11:46,475 INFO] Step 9000/13600; acc: 10.6; ppl: 3652.5; xent: 8.2; lr: 1.00000; sents:    2384; bsz:  569/ 495/48; 11216/9761 tok/s;     33 sec;
[2024-03-11 14:11:49,876 INFO] valid stats calculation
                           took: 3.400369882583618 s.
[2024-03-11 14:11:49,877 INFO] Train perplexity: 19309.4
[2024-03-11 14:11:49,877 INFO] Train accuracy: 10.2523
[2024-03-11 14:11:49,877 INFO] Sentences processed: 18747
[2024-03-11 14:11:49,877 INFO] Average bsz:  572/ 496/47
[2024-03-11 14:11:49,877 INFO] Validation perplexity: 1776.41
[2024-03-11 14:11:49,877 INFO] Validation accuracy: 12.0337
[2024-03-11 14:11:49,878 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_9000.pt
[2024-03-11 14:11:53,718 INFO] Step 9050/13600; acc: 10.0; ppl: 4482.0; xent: 8.4; lr: 1.00000; sents:    2277; bsz:  561/ 487/46; 3875/3361 tok/s;     40 sec;
[2024-03-11 14:11:57,388 INFO] Step 9100/13600; acc: 8.5; ppl: 8043.3; xent: 9.0; lr: 1.00000; sents:    2261; bsz:  552/ 477/45; 7521/6498 tok/s;     44 sec;
[2024-03-11 14:12:00,738 INFO] Step 9150/13600; acc: 10.1; ppl: 159266.1; xent: 12.0; lr: 1.00000; sents:    2372; bsz:  564/ 491/47; 8422/7325 tok/s;     47 sec;
[2024-03-11 14:12:03,433 INFO] Step 9200/13600; acc: 9.8; ppl: 18402.0; xent: 9.8; lr: 1.00000; sents:    2366; bsz:  578/ 500/47; 10723/9286 tok/s;     50 sec;
[2024-03-11 14:12:07,399 INFO] valid stats calculation
                           took: 3.9653711318969727 s.
[2024-03-11 14:12:07,399 INFO] Train perplexity: 18930.4
[2024-03-11 14:12:07,399 INFO] Train accuracy: 10.0363
[2024-03-11 14:12:07,399 INFO] Sentences processed: 28023
[2024-03-11 14:12:07,399 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:12:07,399 INFO] Validation perplexity: 19654
[2024-03-11 14:12:07,399 INFO] Validation accuracy: 2.96831
[2024-03-11 14:12:07,401 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_9200.pt
[2024-03-11 14:12:11,386 INFO] Step 9250/13600; acc: 7.8; ppl: 15779.1; xent: 9.7; lr: 1.00000; sents:    2367; bsz:  587/ 513/47; 3691/3222 tok/s;     58 sec;
[2024-03-11 14:12:15,042 INFO] Step 9300/13600; acc: 8.1; ppl: 12558.4; xent: 9.4; lr: 1.00000; sents:    2364; bsz:  568/ 500/47; 7762/6838 tok/s;     61 sec;
[2024-03-11 14:12:18,559 INFO] Step 9350/13600; acc: 8.9; ppl: 98442.7; xent: 11.5; lr: 1.00000; sents:    2271; bsz:  567/ 490/45; 8059/6964 tok/s;     65 sec;
[2024-03-11 14:12:21,262 INFO] Step 9400/13600; acc: 6.8; ppl: 13315.0; xent: 9.5; lr: 1.00000; sents:    2261; bsz:  554/ 479/45; 10253/8856 tok/s;     68 sec;
[2024-03-11 14:12:25,272 INFO] valid stats calculation
                           took: 4.010215759277344 s.
[2024-03-11 14:12:25,273 INFO] Train perplexity: 19763.7
[2024-03-11 14:12:25,273 INFO] Train accuracy: 9.498
[2024-03-11 14:12:25,273 INFO] Sentences processed: 37286
[2024-03-11 14:12:25,273 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:12:25,273 INFO] Validation perplexity: 3387.08
[2024-03-11 14:12:25,273 INFO] Validation accuracy: 6.61853
[2024-03-11 14:12:25,274 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_9400.pt
[2024-03-11 14:12:29,198 INFO] Step 9450/13600; acc: 9.3; ppl: 25624.5; xent: 10.2; lr: 1.00000; sents:    2373; bsz:  563/ 490/47; 3549/3086 tok/s;     76 sec;
[2024-03-11 14:12:32,983 INFO] Step 9500/13600; acc: 10.0; ppl: 13445.0; xent: 9.5; lr: 1.00000; sents:    2371; bsz:  576/ 500/47; 7603/6610 tok/s;     79 sec;
[2024-03-11 14:12:36,597 INFO] Step 9550/13600; acc: 8.7; ppl: 5782.2; xent: 8.7; lr: 1.00000; sents:    2376; bsz:  581/ 506/48; 8042/6998 tok/s;     83 sec;
[2024-03-11 14:12:39,150 INFO] Step 9600/13600; acc: 9.3; ppl: 15912.4; xent: 9.7; lr: 1.00000; sents:    2381; bsz:  566/ 495/48; 11088/9695 tok/s;     86 sec;
[2024-03-11 14:12:42,886 INFO] valid stats calculation
                           took: 3.7356159687042236 s.
[2024-03-11 14:12:42,886 INFO] Train perplexity: 18239.4
[2024-03-11 14:12:42,886 INFO] Train accuracy: 9.462
[2024-03-11 14:12:42,886 INFO] Sentences processed: 46787
[2024-03-11 14:12:42,886 INFO] Average bsz:  569/ 495/47
[2024-03-11 14:12:42,886 INFO] Validation perplexity: 4341.08
[2024-03-11 14:12:42,886 INFO] Validation accuracy: 3.93101
[2024-03-11 14:12:42,888 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_9600.pt
[2024-03-11 14:12:46,715 INFO] Step 9650/13600; acc: 10.9; ppl: 7091.5; xent: 8.9; lr: 1.00000; sents:    2279; bsz:  562/ 485/46; 3714/3206 tok/s;     93 sec;
[2024-03-11 14:12:50,398 INFO] Step 9700/13600; acc: 9.7; ppl: 15287.4; xent: 9.6; lr: 1.00000; sents:    2375; bsz:  565/ 490/48; 7674/6659 tok/s;     97 sec;
[2024-03-11 14:12:54,107 INFO] Step 9750/13600; acc: 7.9; ppl: 8446.9; xent: 9.0; lr: 1.00000; sents:    2271; bsz:  574/ 492/45; 7738/6628 tok/s;    101 sec;
[2024-03-11 14:12:56,585 INFO] Step 9800/13600; acc: 9.8; ppl: 7477.6; xent: 8.9; lr: 1.00000; sents:    2366; bsz:  563/ 491/47; 11370/9905 tok/s;    103 sec;
[2024-03-11 14:13:00,247 INFO] valid stats calculation
                           took: 3.6612536907196045 s.
[2024-03-11 14:13:00,248 INFO] Train perplexity: 16261.3
[2024-03-11 14:13:00,248 INFO] Train accuracy: 9.48341
[2024-03-11 14:13:00,248 INFO] Sentences processed: 56078
[2024-03-11 14:13:00,248 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:13:00,248 INFO] Validation perplexity: 2766.28
[2024-03-11 14:13:00,248 INFO] Validation accuracy: 6.13718
[2024-03-11 14:13:00,249 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_9800.pt
[2024-03-11 14:13:03,977 INFO] Step 9850/13600; acc: 10.4; ppl: 3947.4; xent: 8.3; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 3817/3318 tok/s;    110 sec;
[2024-03-11 14:13:07,667 INFO] Step 9900/13600; acc: 8.9; ppl: 11604.8; xent: 9.4; lr: 1.00000; sents:    2264; bsz:  562/ 487/45; 7609/6594 tok/s;    114 sec;
[2024-03-11 14:13:11,400 INFO] Step 9950/13600; acc: 8.7; ppl: 7111.3; xent: 8.9; lr: 1.00000; sents:    2369; bsz:  586/ 507/47; 7854/6792 tok/s;    118 sec;
[2024-03-11 14:13:14,065 INFO] Step 10000/13600; acc: 9.6; ppl: 26417.3; xent: 10.2; lr: 1.00000; sents:    2267; bsz:  561/ 483/45; 10529/9069 tok/s;    120 sec;
[2024-03-11 14:13:17,685 INFO] valid stats calculation
                           took: 3.6191015243530273 s.
[2024-03-11 14:13:17,685 INFO] Train perplexity: 15079
[2024-03-11 14:13:17,685 INFO] Train accuracy: 9.4693
[2024-03-11 14:13:17,685 INFO] Sentences processed: 65344
[2024-03-11 14:13:17,685 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:13:17,685 INFO] Validation perplexity: 7765.89
[2024-03-11 14:13:17,685 INFO] Validation accuracy: 6.57842
[2024-03-11 14:13:17,687 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_10000.pt
[2024-03-11 14:13:21,418 INFO] Step 10050/13600; acc: 9.9; ppl: 7708.2; xent: 9.0; lr: 1.00000; sents:    2372; bsz:  563/ 489/47; 3831/3324 tok/s;    128 sec;
[2024-03-11 14:13:25,184 INFO] Step 10100/13600; acc: 10.1; ppl: 3058.9; xent: 8.0; lr: 1.00000; sents:    2371; bsz:  581/ 502/47; 7716/6666 tok/s;    132 sec;
[2024-03-11 14:13:28,954 INFO] Step 10150/13600; acc: 9.6; ppl: 5742.0; xent: 8.7; lr: 1.00000; sents:    2375; bsz:  583/ 505/48; 7732/6693 tok/s;    135 sec;
[2024-03-11 14:13:31,779 INFO] Step 10200/13600; acc: 9.7; ppl: 4281.2; xent: 8.4; lr: 1.00000; sents:    2382; bsz:  565/ 492/48; 10004/8708 tok/s;    138 sec;
[2024-03-11 14:13:35,575 INFO] valid stats calculation
                           took: 3.7951924800872803 s.
[2024-03-11 14:13:35,575 INFO] Train perplexity: 13090.8
[2024-03-11 14:13:35,575 INFO] Train accuracy: 9.51373
[2024-03-11 14:13:35,575 INFO] Sentences processed: 74844
[2024-03-11 14:13:35,575 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:13:35,575 INFO] Validation perplexity: 1115.2
[2024-03-11 14:13:35,575 INFO] Validation accuracy: 13.197
[2024-03-11 14:13:35,577 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_10200.pt
[2024-03-11 14:13:39,487 INFO] Step 10250/13600; acc: 11.2; ppl: 1132.0; xent: 7.0; lr: 1.00000; sents:    2274; bsz:  557/ 483/45; 3616/3135 tok/s;    146 sec;
[2024-03-11 14:13:43,260 INFO] Step 10300/13600; acc: 10.9; ppl: 1550.3; xent: 7.3; lr: 1.00000; sents:    2376; bsz:  589/ 510/48; 7804/6764 tok/s;    150 sec;
[2024-03-11 14:13:47,076 INFO] Step 10350/13600; acc: 10.9; ppl: 2302.8; xent: 7.7; lr: 1.00000; sents:    2272; bsz:  563/ 489/45; 7380/6403 tok/s;    153 sec;
[2024-03-11 14:13:50,040 INFO] Step 10400/13600; acc: 11.0; ppl: 9744.0; xent: 9.2; lr: 1.00000; sents:    2366; bsz:  569/ 497/47; 9594/8379 tok/s;    156 sec;
[2024-03-11 14:13:53,640 INFO] valid stats calculation
                           took: 3.599865198135376 s.
[2024-03-11 14:13:53,640 INFO] Train perplexity: 10894.1
[2024-03-11 14:13:53,640 INFO] Train accuracy: 9.67981
[2024-03-11 14:13:53,640 INFO] Sentences processed: 84132
[2024-03-11 14:13:53,641 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:13:53,641 INFO] Validation perplexity: 124216
[2024-03-11 14:13:53,641 INFO] Validation accuracy: 10.4693
[2024-03-11 14:13:53,642 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_10400.pt
[2024-03-11 14:13:57,607 INFO] Step 10450/13600; acc: 9.5; ppl: 3040.1; xent: 8.0; lr: 1.00000; sents:    2369; bsz:  587/ 508/47; 3878/3355 tok/s;    164 sec;
[2024-03-11 14:14:01,227 INFO] Step 10500/13600; acc: 8.9; ppl: 2091.2; xent: 7.6; lr: 1.00000; sents:    2363; bsz:  565/ 492/47; 7802/6792 tok/s;    168 sec;
[2024-03-11 14:14:04,833 INFO] Step 10550/13600; acc: 10.0; ppl: 2255.5; xent: 7.7; lr: 1.00000; sents:    2244; bsz:  547/ 474/45; 7588/6572 tok/s;    171 sec;
[2024-03-11 14:14:07,922 INFO] Step 10600/13600; acc: 10.0; ppl: 3588.0; xent: 8.2; lr: 1.00000; sents:    2367; bsz:  561/ 488/47; 9078/7896 tok/s;    174 sec;
[2024-03-11 14:14:11,529 INFO] valid stats calculation
                           took: 3.6064212322235107 s.
[2024-03-11 14:14:11,529 INFO] Train perplexity: 9479.28
[2024-03-11 14:14:11,529 INFO] Train accuracy: 9.67372
[2024-03-11 14:14:11,529 INFO] Sentences processed: 93475
[2024-03-11 14:14:11,529 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:14:11,529 INFO] Validation perplexity: 5181.27
[2024-03-11 14:14:11,529 INFO] Validation accuracy: 4.8937
[2024-03-11 14:14:11,531 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_10600.pt
[2024-03-11 14:14:15,449 INFO] Step 10650/13600; acc: 10.8; ppl: 3498.3; xent: 8.2; lr: 1.00000; sents:    2268; bsz:  576/ 498/45; 3828/3306 tok/s;    182 sec;
[2024-03-11 14:14:19,122 INFO] Step 10700/13600; acc: 10.2; ppl: 5566.6; xent: 8.6; lr: 1.00000; sents:    2379; bsz:  568/ 494/48; 7733/6733 tok/s;    186 sec;
[2024-03-11 14:14:22,884 INFO] Step 10750/13600; acc: 10.7; ppl: 5456.3; xent: 8.6; lr: 1.00000; sents:    2383; bsz:  583/ 507/48; 7750/6736 tok/s;    189 sec;
[2024-03-11 14:14:26,374 INFO] Step 10800/13600; acc: 11.9; ppl: 1392.0; xent: 7.2; lr: 1.00000; sents:    2267; bsz:  539/ 469/45; 7724/6714 tok/s;    193 sec;
[2024-03-11 14:14:30,036 INFO] valid stats calculation
                           took: 3.66145396232605 s.
[2024-03-11 14:14:30,037 INFO] Train perplexity: 8669.97
[2024-03-11 14:14:30,037 INFO] Train accuracy: 9.78488
[2024-03-11 14:14:30,037 INFO] Sentences processed: 102772
[2024-03-11 14:14:30,037 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:14:30,037 INFO] Validation perplexity: 68488.9
[2024-03-11 14:14:30,037 INFO] Validation accuracy: 12.2744
[2024-03-11 14:14:30,038 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_10800.pt
[2024-03-11 14:14:33,908 INFO] Step 10850/13600; acc: 9.7; ppl: 4025.7; xent: 8.3; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 3840/3318 tok/s;    200 sec;
[2024-03-11 14:14:37,653 INFO] Step 10900/13600; acc: 11.0; ppl: 4633.1; xent: 8.4; lr: 1.00000; sents:    2275; bsz:  567/ 492/46; 7574/6562 tok/s;    204 sec;
[2024-03-11 14:14:41,498 INFO] Step 10950/13600; acc: 10.5; ppl: 4510.9; xent: 8.4; lr: 1.00000; sents:    2463; bsz:  586/ 519/49; 7620/6746 tok/s;    208 sec;
[2024-03-11 14:14:45,012 INFO] Step 11000/13600; acc: 7.4; ppl: 4192.9; xent: 8.3; lr: 1.00000; sents:    2271; bsz:  568/ 493/45; 8089/7022 tok/s;    211 sec;
[2024-03-11 14:14:48,623 INFO] valid stats calculation
                           took: 3.610424518585205 s.
[2024-03-11 14:14:48,623 INFO] Train perplexity: 8176.94
[2024-03-11 14:14:48,623 INFO] Train accuracy: 9.77301
[2024-03-11 14:14:48,623 INFO] Sentences processed: 112156
[2024-03-11 14:14:48,623 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:14:48,623 INFO] Validation perplexity: 2320.21
[2024-03-11 14:14:48,623 INFO] Validation accuracy: 9.1055
[2024-03-11 14:14:48,624 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_11000.pt
[2024-03-11 14:14:52,473 INFO] Step 11050/13600; acc: 9.0; ppl: 2937.5; xent: 8.0; lr: 1.00000; sents:    2260; bsz:  555/ 480/45; 3722/3220 tok/s;    219 sec;
[2024-03-11 14:14:56,227 INFO] Step 11100/13600; acc: 10.7; ppl: 6727.0; xent: 8.8; lr: 1.00000; sents:    2367; bsz:  559/ 485/47; 7450/6459 tok/s;    223 sec;
[2024-03-11 14:14:59,884 INFO] Step 11150/13600; acc: 10.4; ppl: 2142.2; xent: 7.7; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 7836/6783 tok/s;    226 sec;
[2024-03-11 14:15:03,598 INFO] Step 11200/13600; acc: 8.8; ppl: 35283.0; xent: 10.5; lr: 1.00000; sents:    2373; bsz:  582/ 507/47; 7833/6824 tok/s;    230 sec;
[2024-03-11 14:15:07,200 INFO] valid stats calculation
                           took: 3.6015474796295166 s.
[2024-03-11 14:15:07,201 INFO] Train perplexity: 8016.19
[2024-03-11 14:15:07,201 INFO] Train accuracy: 9.76776
[2024-03-11 14:15:07,201 INFO] Sentences processed: 121521
[2024-03-11 14:15:07,201 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:15:07,201 INFO] Validation perplexity: 1392.25
[2024-03-11 14:15:07,201 INFO] Validation accuracy: 13.4777
[2024-03-11 14:15:07,202 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_11200.pt
[2024-03-11 14:15:11,381 INFO] Step 11250/13600; acc: 9.6; ppl: 5778.1; xent: 8.7; lr: 1.00000; sents:    2275; bsz:  562/ 486/46; 3613/3119 tok/s;    238 sec;
[2024-03-11 14:15:15,344 INFO] Step 11300/13600; acc: 10.8; ppl: 3070.5; xent: 8.0; lr: 1.00000; sents:    2375; bsz:  565/ 494/48; 7129/6239 tok/s;    242 sec;
[2024-03-11 14:15:19,070 INFO] Step 11350/13600; acc: 10.5; ppl: 2149.1; xent: 7.7; lr: 1.00000; sents:    2281; bsz:  563/ 486/46; 7549/6522 tok/s;    245 sec;
[2024-03-11 14:15:22,747 INFO] Step 11400/13600; acc: 12.3; ppl: 1291.9; xent: 7.2; lr: 1.00000; sents:    2476; bsz:  582/ 503/50; 7912/6847 tok/s;    249 sec;
[2024-03-11 14:15:26,356 INFO] valid stats calculation
                           took: 3.609098434448242 s.
[2024-03-11 14:15:26,357 INFO] Train perplexity: 7405.4
[2024-03-11 14:15:26,357 INFO] Train accuracy: 9.84259
[2024-03-11 14:15:26,357 INFO] Sentences processed: 130928
[2024-03-11 14:15:26,357 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:15:26,357 INFO] Validation perplexity: 1296.2
[2024-03-11 14:15:26,357 INFO] Validation accuracy: 8.22302
[2024-03-11 14:15:26,358 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_11400.pt
[2024-03-11 14:15:30,239 INFO] Step 11450/13600; acc: 10.2; ppl: 1953.1; xent: 7.6; lr: 1.00000; sents:    2275; bsz:  562/ 485/46; 3752/3239 tok/s;    257 sec;
[2024-03-11 14:15:34,078 INFO] Step 11500/13600; acc: 11.2; ppl: 1262.5; xent: 7.1; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 7634/6617 tok/s;    260 sec;
[2024-03-11 14:15:37,848 INFO] Step 11550/13600; acc: 9.0; ppl: 2694.2; xent: 7.9; lr: 1.00000; sents:    2268; bsz:  563/ 487/45; 7461/6463 tok/s;    264 sec;
[2024-03-11 14:15:41,491 INFO] Step 11600/13600; acc: 11.2; ppl: 1182.8; xent: 7.1; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 7747/6732 tok/s;    268 sec;
[2024-03-11 14:15:45,158 INFO] valid stats calculation
                           took: 3.6670286655426025 s.
[2024-03-11 14:15:45,159 INFO] Train perplexity: 6706.37
[2024-03-11 14:15:45,159 INFO] Train accuracy: 9.87997
[2024-03-11 14:15:45,159 INFO] Sentences processed: 140208
[2024-03-11 14:15:45,159 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:15:45,159 INFO] Validation perplexity: 1724.5
[2024-03-11 14:15:45,159 INFO] Validation accuracy: 14.7212
[2024-03-11 14:15:45,160 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_11600.pt
[2024-03-11 14:15:48,861 INFO] Step 11650/13600; acc: 9.0; ppl: 6139.6; xent: 8.7; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 3799/3275 tok/s;    275 sec;
[2024-03-11 14:15:52,453 INFO] Step 11700/13600; acc: 9.8; ppl: 4376.8; xent: 8.4; lr: 1.00000; sents:    2469; bsz:  583/ 505/49; 8110/7035 tok/s;    279 sec;
[2024-03-11 14:15:56,164 INFO] Step 11750/13600; acc: 10.5; ppl: 2729.0; xent: 7.9; lr: 1.00000; sents:    2267; bsz:  561/ 484/45; 7554/6519 tok/s;    283 sec;
[2024-03-11 14:15:59,968 INFO] Step 11800/13600; acc: 10.8; ppl: 2273.1; xent: 7.7; lr: 1.00000; sents:    2372; bsz:  583/ 504/47; 7662/6630 tok/s;    286 sec;
[2024-03-11 14:16:03,616 INFO] valid stats calculation
                           took: 3.6479859352111816 s.
[2024-03-11 14:16:03,617 INFO] Train perplexity: 6448.57
[2024-03-11 14:16:03,617 INFO] Train accuracy: 9.88981
[2024-03-11 14:16:03,617 INFO] Sentences processed: 149578
[2024-03-11 14:16:03,617 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:16:03,617 INFO] Validation perplexity: 1350.7
[2024-03-11 14:16:03,617 INFO] Validation accuracy: 10.349
[2024-03-11 14:16:03,618 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_11800.pt
[2024-03-11 14:16:07,024 INFO] Step 11850/13600; acc: 10.5; ppl: 1718.4; xent: 7.4; lr: 1.00000; sents:    2269; bsz:  542/ 474/45; 3841/3357 tok/s;    293 sec;
[2024-03-11 14:16:10,768 INFO] Step 11900/13600; acc: 10.7; ppl: 877.7; xent: 6.8; lr: 1.00000; sents:    2375; bsz:  582/ 503/48; 7774/6725 tok/s;    297 sec;
[2024-03-11 14:16:14,517 INFO] Step 11950/13600; acc: 11.2; ppl: 1959.3; xent: 7.6; lr: 1.00000; sents:    2279; bsz:  561/ 487/46; 7487/6495 tok/s;    301 sec;
[2024-03-11 14:16:18,306 INFO] Step 12000/13600; acc: 11.4; ppl: 8281.4; xent: 9.0; lr: 1.00000; sents:    2378; bsz:  590/ 512/48; 7786/6753 tok/s;    305 sec;
[2024-03-11 14:16:21,841 INFO] valid stats calculation
                           took: 3.5338995456695557 s.
[2024-03-11 14:16:21,841 INFO] Train perplexity: 6060.77
[2024-03-11 14:16:21,841 INFO] Train accuracy: 9.95278
[2024-03-11 14:16:21,841 INFO] Sentences processed: 158879
[2024-03-11 14:16:21,842 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:16:21,842 INFO] Validation perplexity: 2545.66
[2024-03-11 14:16:21,842 INFO] Validation accuracy: 7.62134
[2024-03-11 14:16:21,843 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_12000.pt
[2024-03-11 14:16:25,057 INFO] Step 12050/13600; acc: 10.2; ppl: 2744.8; xent: 7.9; lr: 1.00000; sents:    2381; bsz:  572/ 499/48; 4236/3698 tok/s;    311 sec;
[2024-03-11 14:16:28,735 INFO] Step 12100/13600; acc: 10.4; ppl: 2928.4; xent: 8.0; lr: 1.00000; sents:    2247; bsz:  550/ 477/45; 7472/6479 tok/s;    315 sec;
[2024-03-11 14:16:32,560 INFO] Step 12150/13600; acc: 9.8; ppl: 3868.2; xent: 8.3; lr: 1.00000; sents:    2487; bsz:  601/ 520/50; 7854/6803 tok/s;    319 sec;
[2024-03-11 14:16:36,138 INFO] Step 12200/13600; acc: 9.8; ppl: 2125.4; xent: 7.7; lr: 1.00000; sents:    2248; bsz:  551/ 478/45; 7708/6687 tok/s;    323 sec;
[2024-03-11 14:16:39,695 INFO] valid stats calculation
                           took: 3.5568554401397705 s.
[2024-03-11 14:16:39,695 INFO] Train perplexity: 5814.16
[2024-03-11 14:16:39,695 INFO] Train accuracy: 9.95677
[2024-03-11 14:16:39,696 INFO] Sentences processed: 168242
[2024-03-11 14:16:39,696 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:16:39,696 INFO] Validation perplexity: 4584.37
[2024-03-11 14:16:39,696 INFO] Validation accuracy: 5.13438
[2024-03-11 14:16:39,697 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_12200.pt
[2024-03-11 14:16:42,594 INFO] Step 12250/13600; acc: 9.9; ppl: 1876.9; xent: 7.5; lr: 1.00000; sents:    2363; bsz:  576/ 498/47; 4465/3855 tok/s;    329 sec;
[2024-03-11 14:16:46,393 INFO] Step 12300/13600; acc: 7.2; ppl: 16424.9; xent: 9.7; lr: 1.00000; sents:    2251; bsz:  552/ 480/45; 7269/6320 tok/s;    333 sec;
[2024-03-11 14:16:50,079 INFO] Step 12350/13600; acc: 9.3; ppl: 25739.8; xent: 10.2; lr: 1.00000; sents:    2372; bsz:  566/ 492/47; 7673/6670 tok/s;    336 sec;
[2024-03-11 14:16:53,986 INFO] Step 12400/13600; acc: 9.3; ppl: 6408.0; xent: 8.8; lr: 1.00000; sents:    2377; bsz:  587/ 513/48; 7511/6568 tok/s;    340 sec;
[2024-03-11 14:16:58,023 INFO] valid stats calculation
                           took: 4.036264896392822 s.
[2024-03-11 14:16:58,024 INFO] Train perplexity: 5926.29
[2024-03-11 14:16:58,024 INFO] Train accuracy: 9.90414
[2024-03-11 14:16:58,024 INFO] Sentences processed: 177605
[2024-03-11 14:16:58,024 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:16:58,024 INFO] Validation perplexity: 1638.27
[2024-03-11 14:16:58,024 INFO] Validation accuracy: 12.5953
[2024-03-11 14:16:58,025 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_12400.pt
[2024-03-11 14:17:00,930 INFO] Step 12450/13600; acc: 10.1; ppl: 5823.1; xent: 8.7; lr: 1.00000; sents:    2379; bsz:  565/ 493/48; 4070/3553 tok/s;    347 sec;
[2024-03-11 14:17:04,698 INFO] Step 12500/13600; acc: 8.5; ppl: 2051.8; xent: 7.6; lr: 1.00000; sents:    2274; bsz:  555/ 478/45; 7371/6350 tok/s;    351 sec;
[2024-03-11 14:17:08,473 INFO] Step 12550/13600; acc: 9.3; ppl: 2447.1; xent: 7.8; lr: 1.00000; sents:    2376; bsz:  564/ 492/48; 7469/6515 tok/s;    355 sec;
[2024-03-11 14:17:12,288 INFO] Step 12600/13600; acc: 9.8; ppl: 4835.4; xent: 8.5; lr: 1.00000; sents:    2278; bsz:  567/ 490/46; 7434/6427 tok/s;    359 sec;
[2024-03-11 14:17:16,257 INFO] valid stats calculation
                           took: 3.9684858322143555 s.
[2024-03-11 14:17:16,258 INFO] Train perplexity: 5770.67
[2024-03-11 14:17:16,258 INFO] Train accuracy: 9.88068
[2024-03-11 14:17:16,258 INFO] Sentences processed: 186912
[2024-03-11 14:17:16,258 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:17:16,258 INFO] Validation perplexity: 1384.75
[2024-03-11 14:17:16,258 INFO] Validation accuracy: 15.724
[2024-03-11 14:17:16,259 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_12600.pt
[2024-03-11 14:17:19,086 INFO] Step 12650/13600; acc: 10.7; ppl: 2281.2; xent: 7.7; lr: 1.00000; sents:    2372; bsz:  587/ 515/47; 4320/3789 tok/s;    365 sec;
[2024-03-11 14:17:22,842 INFO] Step 12700/13600; acc: 8.5; ppl: 4190.5; xent: 8.3; lr: 1.00000; sents:    2367; bsz:  578/ 498/47; 7690/6629 tok/s;    369 sec;
[2024-03-11 14:17:26,635 INFO] Step 12750/13600; acc: 7.2; ppl: 25147.1; xent: 10.1; lr: 1.00000; sents:    2263; bsz:  556/ 481/45; 7332/6340 tok/s;    373 sec;
[2024-03-11 14:17:30,275 INFO] Step 12800/13600; acc: 9.6; ppl: 25333.7; xent: 10.1; lr: 1.00000; sents:    2364; bsz:  558/ 487/47; 7665/6685 tok/s;    377 sec;
[2024-03-11 14:17:34,105 INFO] valid stats calculation
                           took: 3.8288872241973877 s.
[2024-03-11 14:17:34,105 INFO] Train perplexity: 5881.7
[2024-03-11 14:17:34,105 INFO] Train accuracy: 9.83983
[2024-03-11 14:17:34,105 INFO] Sentences processed: 196278
[2024-03-11 14:17:34,105 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:17:34,105 INFO] Validation perplexity: 10130.5
[2024-03-11 14:17:34,105 INFO] Validation accuracy: 9.34617
[2024-03-11 14:17:34,107 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_12800.pt
[2024-03-11 14:17:36,852 INFO] Step 12850/13600; acc: 9.0; ppl: 3767.5; xent: 8.2; lr: 1.00000; sents:    2367; bsz:  563/ 492/47; 4284/3740 tok/s;    383 sec;
[2024-03-11 14:17:40,413 INFO] Step 12900/13600; acc: 10.8; ppl: 2608.0; xent: 7.9; lr: 1.00000; sents:    2365; bsz:  580/ 505/47; 8144/7097 tok/s;    387 sec;
[2024-03-11 14:17:44,241 INFO] Step 12950/13600; acc: 10.5; ppl: 2166.9; xent: 7.7; lr: 1.00000; sents:    2276; bsz:  562/ 486/46; 7339/6345 tok/s;    391 sec;
[2024-03-11 14:17:48,137 INFO] Step 13000/13600; acc: 10.0; ppl: 1818.4; xent: 7.5; lr: 1.00000; sents:    2271; bsz:  564/ 489/45; 7244/6274 tok/s;    395 sec;
[2024-03-11 14:17:51,934 INFO] valid stats calculation
                           took: 3.796097755432129 s.
[2024-03-11 14:17:51,934 INFO] Train perplexity: 5657.45
[2024-03-11 14:17:51,934 INFO] Train accuracy: 9.85098
[2024-03-11 14:17:51,934 INFO] Sentences processed: 205557
[2024-03-11 14:17:51,934 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:17:51,934 INFO] Validation perplexity: 2236.88
[2024-03-11 14:17:51,934 INFO] Validation accuracy: 11.3117
[2024-03-11 14:17:51,936 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_13000.pt
[2024-03-11 14:17:54,685 INFO] Step 13050/13600; acc: 9.8; ppl: 49341.3; xent: 10.8; lr: 1.00000; sents:    2375; bsz:  579/ 498/48; 4422/3805 tok/s;    401 sec;
[2024-03-11 14:17:57,884 INFO] Step 13100/13600; acc: 6.8; ppl: 25656.9; xent: 10.2; lr: 1.00000; sents:    2382; bsz:  561/ 487/48; 8768/7619 tok/s;    404 sec;
[2024-03-11 14:18:01,744 INFO] Step 13150/13600; acc: 7.4; ppl: 26914.8; xent: 10.2; lr: 1.00000; sents:    2376; bsz:  589/ 509/48; 7627/6596 tok/s;    408 sec;
[2024-03-11 14:18:05,493 INFO] Step 13200/13600; acc: 9.8; ppl: 10193.6; xent: 9.2; lr: 1.00000; sents:    2375; bsz:  565/ 490/48; 7535/6541 tok/s;    412 sec;
[2024-03-11 14:18:09,237 INFO] valid stats calculation
                           took: 3.7430543899536133 s.
[2024-03-11 14:18:09,237 INFO] Train perplexity: 6030.21
[2024-03-11 14:18:09,237 INFO] Train accuracy: 9.78938
[2024-03-11 14:18:09,237 INFO] Sentences processed: 215065
[2024-03-11 14:18:09,237 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:18:09,237 INFO] Validation perplexity: 4686.97
[2024-03-11 14:18:09,237 INFO] Validation accuracy: 15.0421
[2024-03-11 14:18:09,239 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_13200.pt
[2024-03-11 14:18:12,049 INFO] Step 13250/13600; acc: 11.9; ppl: 6876.4; xent: 8.8; lr: 1.00000; sents:    2273; bsz:  564/ 489/45; 4305/3729 tok/s;    418 sec;
[2024-03-11 14:18:15,326 INFO] Step 13300/13600; acc: 8.7; ppl: 3015.4; xent: 8.0; lr: 1.00000; sents:    2260; bsz:  558/ 482/45; 8510/7349 tok/s;    422 sec;
[2024-03-11 14:18:18,992 INFO] Step 13350/13600; acc: 8.2; ppl: 4206.9; xent: 8.3; lr: 1.00000; sents:    2369; bsz:  565/ 490/47; 7701/6690 tok/s;    425 sec;
[2024-03-11 14:18:22,634 INFO] Step 13400/13600; acc: 9.0; ppl: 12128.7; xent: 9.4; lr: 1.00000; sents:    2365; bsz:  580/ 500/47; 7961/6859 tok/s;    429 sec;
[2024-03-11 14:18:26,297 INFO] valid stats calculation
                           took: 3.66176176071167 s.
[2024-03-11 14:18:26,297 INFO] Train perplexity: 6017.88
[2024-03-11 14:18:26,297 INFO] Train accuracy: 9.7744
[2024-03-11 14:18:26,297 INFO] Sentences processed: 224332
[2024-03-11 14:18:26,297 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:18:26,297 INFO] Validation perplexity: 2264.47
[2024-03-11 14:18:26,297 INFO] Validation accuracy: 11.8732
[2024-03-11 14:18:26,299 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_13400.pt
[2024-03-11 14:18:29,187 INFO] Step 13450/13600; acc: 9.9; ppl: 3789.3; xent: 8.2; lr: 1.00000; sents:    2367; bsz:  566/ 494/47; 4319/3772 tok/s;    436 sec;
[2024-03-11 14:18:31,680 INFO] Step 13500/13600; acc: 11.1; ppl: 1709.7; xent: 7.4; lr: 1.00000; sents:    2267; bsz:  558/ 484/45; 11197/9713 tok/s;    438 sec;
[2024-03-11 14:18:34,241 INFO] Step 13550/13600; acc: 9.2; ppl: 4796.9; xent: 8.5; lr: 1.00000; sents:    2372; bsz:  582/ 503/47; 11361/9832 tok/s;    441 sec;
[2024-03-11 14:18:36,816 INFO] Step 13600/13600; acc: 9.0; ppl: 2786.6; xent: 7.9; lr: 1.00000; sents:    2257; bsz:  556/ 481/45; 10802/9341 tok/s;    443 sec;
[2024-03-11 14:18:40,566 INFO] valid stats calculation
                           took: 3.748379945755005 s.
[2024-03-11 14:18:40,566 INFO] Train perplexity: 5858.75
[2024-03-11 14:18:40,566 INFO] Train accuracy: 9.77599
[2024-03-11 14:18:40,566 INFO] Sentences processed: 233595
[2024-03-11 14:18:40,566 INFO] Average bsz:  569/ 494/47
[2024-03-11 14:18:40,566 INFO] Validation perplexity: 3601.71
[2024-03-11 14:18:40,566 INFO] Validation accuracy: 8.66426
[2024-03-11 14:18:40,567 INFO] Saving checkpoint tg-finetune/tg-finetune_8600_01_step_13600.pt
