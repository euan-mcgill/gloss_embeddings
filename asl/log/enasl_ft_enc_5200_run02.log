[2024-03-12 09:35:28,157 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-12 09:35:28,157 INFO] Parsed 2 corpora from -data.
[2024-03-12 09:35:28,157 INFO] Loading checkpoint from tg-pt-enc/models/tg-pt-enc_01_step_5200.pt
[2024-03-12 09:35:28,222 INFO] Building model...
[2024-03-12 09:35:28,277 INFO] Switching model to float32 for amp/apex_amp
[2024-03-12 09:35:28,278 INFO] Non quantized layer compute is fp32
[2024-03-12 09:35:30,253 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-12 09:35:30,253 INFO] encoder: 8952800
[2024-03-12 09:35:30,253 INFO] decoder: 16687344
[2024-03-12 09:35:30,253 INFO] * number of parameters: 25640144
[2024-03-12 09:35:30,253 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 09:35:30,253 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 09:35:30,253 INFO]  * src vocab size = 17816
[2024-03-12 09:35:30,253 INFO]  * tgt vocab size = 14144
[2024-03-12 09:35:30,255 INFO] Starting training on GPU: [0]
[2024-03-12 09:35:30,255 INFO] Start training loop and validate every 200 steps...
[2024-03-12 09:35:30,255 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-12 09:35:37,522 INFO] Step 5250/10200; acc: 9.4; ppl: 338984.2; xent: 12.7; lr: 1.00000; sents:    2366; bsz:  569/ 497/47; 3917/3421 tok/s;      7 sec;
[2024-03-12 09:35:41,161 INFO] Step 5300/10200; acc: 11.5; ppl: 9472.7; xent: 9.2; lr: 1.00000; sents:    2273; bsz:  586/ 505/45; 8054/6940 tok/s;     11 sec;
[2024-03-12 09:35:44,774 INFO] Step 5350/10200; acc: 12.0; ppl: 2782.7; xent: 7.9; lr: 1.00000; sents:    2363; bsz:  564/ 491/47; 7799/6801 tok/s;     15 sec;
[2024-03-12 09:35:48,042 INFO] Step 5400/10200; acc: 15.2; ppl: 585.3; xent: 6.4; lr: 1.00000; sents:    2365; bsz:  563/ 489/47; 8608/7478 tok/s;     18 sec;
[2024-03-12 09:35:51,639 INFO] valid stats calculation
                           took: 3.5964889526367188 s.
[2024-03-12 09:35:51,640 INFO] Train perplexity: 8634.3
[2024-03-12 09:35:51,640 INFO] Train accuracy: 12.0322
[2024-03-12 09:35:51,640 INFO] Sentences processed: 9367
[2024-03-12 09:35:51,640 INFO] Average bsz:  570/ 496/47
[2024-03-12 09:35:51,640 INFO] Validation perplexity: 429.968
[2024-03-12 09:35:51,640 INFO] Validation accuracy: 14.7212
[2024-03-12 09:35:51,641 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_5400.pt
[2024-03-12 09:35:55,314 INFO] Step 5450/10200; acc: 18.2; ppl: 298.7; xent: 5.7; lr: 1.00000; sents:    2246; bsz:  547/ 473/45; 3759/3255 tok/s;     25 sec;
[2024-03-12 09:35:58,938 INFO] Step 5500/10200; acc: 20.5; ppl: 187.9; xent: 5.2; lr: 1.00000; sents:    2372; bsz:  589/ 511/47; 8130/7049 tok/s;     29 sec;
[2024-03-12 09:36:02,573 INFO] Step 5550/10200; acc: 24.8; ppl: 110.7; xent: 4.7; lr: 1.00000; sents:    2378; bsz:  568/ 494/48; 7808/6801 tok/s;     32 sec;
[2024-03-12 09:36:06,046 INFO] Step 5600/10200; acc: 27.6; ppl:  78.5; xent: 4.4; lr: 1.00000; sents:    2280; bsz:  581/ 502/46; 8359/7232 tok/s;     36 sec;
[2024-03-12 09:36:09,669 INFO] valid stats calculation
                           took: 3.622671127319336 s.
[2024-03-12 09:36:09,669 INFO] Train perplexity: 1129.13
[2024-03-12 09:36:09,669 INFO] Train accuracy: 17.4404
[2024-03-12 09:36:09,669 INFO] Sentences processed: 18643
[2024-03-12 09:36:09,669 INFO] Average bsz:  571/ 495/47
[2024-03-12 09:36:09,669 INFO] Validation perplexity: 245.098
[2024-03-12 09:36:09,669 INFO] Validation accuracy: 21.3398
[2024-03-12 09:36:09,671 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_5600.pt
[2024-03-12 09:36:13,351 INFO] Step 5650/10200; acc: 31.2; ppl:  52.0; xent: 4.0; lr: 1.00000; sents:    2381; bsz:  568/ 495/48; 3888/3386 tok/s;     43 sec;
[2024-03-12 09:36:16,883 INFO] Step 5700/10200; acc: 34.0; ppl:  37.9; xent: 3.6; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 7974/6923 tok/s;     47 sec;
[2024-03-12 09:36:20,452 INFO] Step 5750/10200; acc: 35.6; ppl:  32.9; xent: 3.5; lr: 1.00000; sents:    2258; bsz:  553/ 478/45; 7747/6704 tok/s;     50 sec;
[2024-03-12 09:36:24,069 INFO] Step 5800/10200; acc: 38.3; ppl:  25.3; xent: 3.2; lr: 1.00000; sents:    2366; bsz:  578/ 500/47; 7988/6918 tok/s;     54 sec;
[2024-03-12 09:36:27,572 INFO] valid stats calculation
                           took: 3.502470016479492 s.
[2024-03-12 09:36:27,573 INFO] Train perplexity: 359.807
[2024-03-12 09:36:27,573 INFO] Train accuracy: 23.1787
[2024-03-12 09:36:27,573 INFO] Sentences processed: 28023
[2024-03-12 09:36:27,573 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:36:27,573 INFO] Validation perplexity: 246.542
[2024-03-12 09:36:27,573 INFO] Validation accuracy: 26.9956
[2024-03-12 09:36:27,574 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_5800.pt
[2024-03-12 09:36:31,323 INFO] Step 5850/10200; acc: 39.5; ppl:  22.4; xent: 3.1; lr: 1.00000; sents:    2271; bsz:  567/ 491/45; 3908/3382 tok/s;     61 sec;
[2024-03-12 09:36:34,834 INFO] Step 5900/10200; acc: 41.9; ppl:  17.6; xent: 2.9; lr: 1.00000; sents:    2364; bsz:  567/ 499/47; 8081/7113 tok/s;     65 sec;
[2024-03-12 09:36:38,426 INFO] Step 5950/10200; acc: 43.9; ppl:  15.2; xent: 2.7; lr: 1.00000; sents:    2367; bsz:  587/ 512/47; 8171/7131 tok/s;     68 sec;
[2024-03-12 09:36:41,924 INFO] Step 6000/10200; acc: 46.6; ppl:  12.2; xent: 2.5; lr: 1.00000; sents:    2365; bsz:  561/ 487/47; 8016/6957 tok/s;     72 sec;
[2024-03-12 09:36:45,477 INFO] valid stats calculation
                           took: 3.5527586936950684 s.
[2024-03-12 09:36:45,477 INFO] Train perplexity: 165.709
[2024-03-12 09:36:45,477 INFO] Train accuracy: 28.1456
[2024-03-12 09:36:45,477 INFO] Sentences processed: 37390
[2024-03-12 09:36:45,477 INFO] Average bsz:  569/ 495/47
[2024-03-12 09:36:45,477 INFO] Validation perplexity: 273.242
[2024-03-12 09:36:45,477 INFO] Validation accuracy: 29.7633
[2024-03-12 09:36:45,478 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_6000.pt
[2024-03-12 09:36:49,112 INFO] Step 6050/10200; acc: 48.7; ppl:  10.6; xent: 2.4; lr: 1.00000; sents:    2372; bsz:  575/ 500/47; 4000/3475 tok/s;     79 sec;
[2024-03-12 09:36:52,712 INFO] Step 6100/10200; acc: 49.7; ppl:   9.6; xent: 2.3; lr: 1.00000; sents:    2268; bsz:  557/ 483/45; 7737/6702 tok/s;     82 sec;
[2024-03-12 09:36:56,399 INFO] Step 6150/10200; acc: 52.0; ppl:   8.1; xent: 2.1; lr: 1.00000; sents:    2279; bsz:  563/ 487/46; 7633/6599 tok/s;     86 sec;
[2024-03-12 09:37:00,061 INFO] Step 6200/10200; acc: 53.6; ppl:   7.5; xent: 2.0; lr: 1.00000; sents:    2381; bsz:  582/ 506/48; 7945/6910 tok/s;     90 sec;
[2024-03-12 09:37:03,656 INFO] valid stats calculation
                           took: 3.5936484336853027 s.
[2024-03-12 09:37:03,656 INFO] Train perplexity: 92.3048
[2024-03-12 09:37:03,656 INFO] Train accuracy: 32.7135
[2024-03-12 09:37:03,656 INFO] Sentences processed: 46690
[2024-03-12 09:37:03,656 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:37:03,656 INFO] Validation perplexity: 383.984
[2024-03-12 09:37:03,656 INFO] Validation accuracy: 30.365
[2024-03-12 09:37:03,658 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_6200.pt
[2024-03-12 09:37:07,298 INFO] Step 6250/10200; acc: 56.1; ppl:   6.5; xent: 1.9; lr: 1.00000; sents:    2376; bsz:  564/ 493/48; 3900/3407 tok/s;     97 sec;
[2024-03-12 09:37:10,812 INFO] Step 6300/10200; acc: 57.6; ppl:   5.8; xent: 1.8; lr: 1.00000; sents:    2375; bsz:  565/ 490/48; 8044/6979 tok/s;    101 sec;
[2024-03-12 09:37:14,448 INFO] Step 6350/10200; acc: 59.5; ppl:   5.3; xent: 1.7; lr: 1.00000; sents:    2371; bsz:  579/ 498/47; 7957/6850 tok/s;    104 sec;
[2024-03-12 09:37:18,090 INFO] Step 6400/10200; acc: 60.1; ppl:   5.0; xent: 1.6; lr: 1.00000; sents:    2266; bsz:  559/ 484/45; 7673/6651 tok/s;    108 sec;
[2024-03-12 09:37:21,652 INFO] valid stats calculation
                           took: 3.5621497631073 s.
[2024-03-12 09:37:21,653 INFO] Train perplexity: 58.0118
[2024-03-12 09:37:21,653 INFO] Train accuracy: 36.9606
[2024-03-12 09:37:21,653 INFO] Sentences processed: 56078
[2024-03-12 09:37:21,653 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:37:21,653 INFO] Validation perplexity: 454.757
[2024-03-12 09:37:21,653 INFO] Validation accuracy: 30.9266
[2024-03-12 09:37:21,654 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_6400.pt
[2024-03-12 09:37:24,893 INFO] Step 6450/10200; acc: 62.1; ppl:   4.5; xent: 1.5; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 4147/3605 tok/s;    115 sec;
[2024-03-12 09:37:28,375 INFO] Step 6500/10200; acc: 63.4; ppl:   4.2; xent: 1.4; lr: 1.00000; sents:    2364; bsz:  584/ 506/47; 8385/7261 tok/s;    118 sec;
[2024-03-12 09:37:31,888 INFO] Step 6550/10200; acc: 64.7; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    2269; bsz:  564/ 488/45; 8029/6948 tok/s;    122 sec;
[2024-03-12 09:37:35,430 INFO] Step 6600/10200; acc: 65.9; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    2267; bsz:  561/ 483/45; 7920/6822 tok/s;    125 sec;
[2024-03-12 09:37:38,947 INFO] valid stats calculation
                           took: 3.516629695892334 s.
[2024-03-12 09:37:38,947 INFO] Train perplexity: 39.7517
[2024-03-12 09:37:38,947 INFO] Train accuracy: 40.8097
[2024-03-12 09:37:38,947 INFO] Sentences processed: 65344
[2024-03-12 09:37:38,948 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:37:38,948 INFO] Validation perplexity: 630.03
[2024-03-12 09:37:38,948 INFO] Validation accuracy: 29.4826
[2024-03-12 09:37:38,949 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_6600.pt
[2024-03-12 09:37:41,892 INFO] Step 6650/10200; acc: 67.7; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    2472; bsz:  583/ 506/49; 4508/3914 tok/s;    132 sec;
[2024-03-12 09:37:45,608 INFO] Step 6700/10200; acc: 69.4; ppl:   3.2; xent: 1.1; lr: 1.00000; sents:    2271; bsz:  562/ 485/45; 7562/6526 tok/s;    135 sec;
[2024-03-12 09:37:49,241 INFO] Step 6750/10200; acc: 69.9; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    2375; bsz:  583/ 505/48; 8025/6946 tok/s;    139 sec;
[2024-03-12 09:37:52,807 INFO] Step 6800/10200; acc: 72.2; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    2280; bsz:  543/ 474/46; 7613/6653 tok/s;    143 sec;
[2024-03-12 09:37:56,308 INFO] valid stats calculation
                           took: 3.4998295307159424 s.
[2024-03-12 09:37:56,308 INFO] Train perplexity: 28.9005
[2024-03-12 09:37:56,308 INFO] Train accuracy: 44.4213
[2024-03-12 09:37:56,308 INFO] Sentences processed: 74742
[2024-03-12 09:37:56,308 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:37:56,308 INFO] Validation perplexity: 914.473
[2024-03-12 09:37:56,308 INFO] Validation accuracy: 29.0413
[2024-03-12 09:37:56,310 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_6800.pt
[2024-03-12 09:37:59,291 INFO] Step 6850/10200; acc: 72.8; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    2376; bsz:  580/ 501/48; 4470/3862 tok/s;    149 sec;
[2024-03-12 09:38:02,911 INFO] Step 6900/10200; acc: 73.8; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2280; bsz:  563/ 487/46; 7779/6725 tok/s;    153 sec;
[2024-03-12 09:38:06,542 INFO] Step 6950/10200; acc: 74.0; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2368; bsz:  589/ 512/47; 8111/7053 tok/s;    156 sec;
[2024-03-12 09:38:10,081 INFO] Step 7000/10200; acc: 75.9; ppl:   2.3; xent: 0.9; lr: 1.00000; sents:    2366; bsz:  569/ 497/47; 8033/7016 tok/s;    160 sec;
[2024-03-12 09:38:13,525 INFO] valid stats calculation
                           took: 3.4438557624816895 s.
[2024-03-12 09:38:13,526 INFO] Train perplexity: 21.983
[2024-03-12 09:38:13,526 INFO] Train accuracy: 47.7546
[2024-03-12 09:38:13,526 INFO] Sentences processed: 84132
[2024-03-12 09:38:13,526 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:38:13,526 INFO] Validation perplexity: 1185.53
[2024-03-12 09:38:13,526 INFO] Validation accuracy: 27.6775
[2024-03-12 09:38:13,527 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_7000.pt
[2024-03-12 09:38:16,077 INFO] Step 7050/10200; acc: 77.2; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2369; bsz:  566/ 492/47; 4724/4103 tok/s;    166 sec;
[2024-03-12 09:38:19,605 INFO] Step 7100/10200; acc: 78.1; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2242; bsz:  547/ 474/45; 7753/6710 tok/s;    169 sec;
[2024-03-12 09:38:23,207 INFO] Step 7150/10200; acc: 78.3; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    2365; bsz:  585/ 508/47; 8126/7050 tok/s;    173 sec;
[2024-03-12 09:38:26,809 INFO] Step 7200/10200; acc: 79.2; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2367; bsz:  579/ 502/47; 8041/6966 tok/s;    177 sec;
[2024-03-12 09:38:30,306 INFO] valid stats calculation
                           took: 3.496422529220581 s.
[2024-03-12 09:38:30,306 INFO] Train perplexity: 17.4281
[2024-03-12 09:38:30,306 INFO] Train accuracy: 50.7986
[2024-03-12 09:38:30,306 INFO] Sentences processed: 93475
[2024-03-12 09:38:30,306 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:38:30,306 INFO] Validation perplexity: 1756.84
[2024-03-12 09:38:30,306 INFO] Validation accuracy: 29.5628
[2024-03-12 09:38:30,307 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_7200.pt
[2024-03-12 09:38:32,866 INFO] Step 7250/10200; acc: 80.9; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2268; bsz:  539/ 468/45; 4452/3864 tok/s;    183 sec;
[2024-03-12 09:38:36,468 INFO] Step 7300/10200; acc: 80.6; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2379; bsz:  587/ 510/48; 8144/7082 tok/s;    186 sec;
[2024-03-12 09:38:40,049 INFO] Step 7350/10200; acc: 81.5; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2274; bsz:  558/ 483/45; 7788/6749 tok/s;    190 sec;
[2024-03-12 09:38:43,572 INFO] Step 7400/10200; acc: 82.4; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2376; bsz:  580/ 503/48; 8230/7135 tok/s;    193 sec;
[2024-03-12 09:38:47,010 INFO] valid stats calculation
                           took: 3.4367852210998535 s.
[2024-03-12 09:38:47,011 INFO] Train perplexity: 14.2689
[2024-03-12 09:38:47,011 INFO] Train accuracy: 53.5596
[2024-03-12 09:38:47,011 INFO] Sentences processed: 102772
[2024-03-12 09:38:47,011 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:38:47,011 INFO] Validation perplexity: 2144.86
[2024-03-12 09:38:47,011 INFO] Validation accuracy: 28.6001
[2024-03-12 09:38:47,013 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_7400.pt
[2024-03-12 09:38:49,543 INFO] Step 7450/10200; acc: 83.5; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 4716/4096 tok/s;    199 sec;
[2024-03-12 09:38:52,861 INFO] Step 7500/10200; acc: 83.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2372; bsz:  566/ 496/47; 8537/7480 tok/s;    203 sec;
[2024-03-12 09:38:56,596 INFO] Step 7550/10200; acc: 83.7; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    2270; bsz:  587/ 508/45; 7859/6796 tok/s;    206 sec;
[2024-03-12 09:39:00,148 INFO] Step 7600/10200; acc: 84.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2367; bsz:  568/ 500/47; 7998/7036 tok/s;    210 sec;
[2024-03-12 09:39:03,584 INFO] valid stats calculation
                           took: 3.436417579650879 s.
[2024-03-12 09:39:03,585 INFO] Train perplexity: 11.9578
[2024-03-12 09:39:03,585 INFO] Train accuracy: 56.0952
[2024-03-12 09:39:03,585 INFO] Sentences processed: 112156
[2024-03-12 09:39:03,585 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:39:03,585 INFO] Validation perplexity: 3078.66
[2024-03-12 09:39:03,585 INFO] Validation accuracy: 27.7176
[2024-03-12 09:39:03,586 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_7600.pt
[2024-03-12 09:39:06,080 INFO] Step 7650/10200; acc: 85.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2364; bsz:  561/ 487/47; 4725/4107 tok/s;    216 sec;
[2024-03-12 09:39:09,222 INFO] Step 7700/10200; acc: 85.4; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2263; bsz:  566/ 485/45; 9002/7724 tok/s;    219 sec;
[2024-03-12 09:39:12,775 INFO] Step 7750/10200; acc: 85.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2365; bsz:  562/ 489/47; 7902/6881 tok/s;    223 sec;
[2024-03-12 09:39:16,462 INFO] Step 7800/10200; acc: 86.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2373; bsz:  567/ 495/47; 7685/6720 tok/s;    226 sec;
[2024-03-12 09:39:19,888 INFO] valid stats calculation
                           took: 3.425238847732544 s.
[2024-03-12 09:39:19,888 INFO] Train perplexity: 10.277
[2024-03-12 09:39:19,888 INFO] Train accuracy: 58.353
[2024-03-12 09:39:19,888 INFO] Sentences processed: 121521
[2024-03-12 09:39:19,888 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:39:19,888 INFO] Validation perplexity: 2822.61
[2024-03-12 09:39:19,888 INFO] Validation accuracy: 28.6001
[2024-03-12 09:39:19,890 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_7800.pt
[2024-03-12 09:39:22,646 INFO] Step 7850/10200; acc: 86.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2371; bsz:  580/ 506/47; 4691/4088 tok/s;    232 sec;
[2024-03-12 09:39:25,751 INFO] Step 7900/10200; acc: 87.2; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2279; bsz:  562/ 486/46; 9059/7824 tok/s;    235 sec;
[2024-03-12 09:39:29,291 INFO] Step 7950/10200; acc: 87.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2381; bsz:  566/ 491/48; 7996/6937 tok/s;    239 sec;
[2024-03-12 09:39:32,911 INFO] Step 8000/10200; acc: 87.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2276; bsz:  561/ 485/46; 7753/6700 tok/s;    243 sec;
[2024-03-12 09:39:36,441 INFO] valid stats calculation
                           took: 3.5295636653900146 s.
[2024-03-12 09:39:36,441 INFO] Train perplexity: 8.98274
[2024-03-12 09:39:36,441 INFO] Train accuracy: 60.4047
[2024-03-12 09:39:36,441 INFO] Sentences processed: 130828
[2024-03-12 09:39:36,441 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:39:36,442 INFO] Validation perplexity: 3615.44
[2024-03-12 09:39:36,442 INFO] Validation accuracy: 28.3995
[2024-03-12 09:39:36,443 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_8000.pt
[2024-03-12 09:39:39,158 INFO] Step 8050/10200; acc: 88.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  579/ 499/48; 4634/3990 tok/s;    249 sec;
[2024-03-12 09:39:42,295 INFO] Step 8100/10200; acc: 88.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2273; bsz:  565/ 489/45; 9009/7796 tok/s;    252 sec;
[2024-03-12 09:39:45,952 INFO] Step 8150/10200; acc: 88.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2366; bsz:  583/ 506/47; 7978/6922 tok/s;    256 sec;
[2024-03-12 09:39:49,463 INFO] Step 8200/10200; acc: 89.2; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 8039/6986 tok/s;    259 sec;
[2024-03-12 09:39:52,923 INFO] valid stats calculation
                           took: 3.4599223136901855 s.
[2024-03-12 09:39:52,923 INFO] Train perplexity: 7.95909
[2024-03-12 09:39:52,924 INFO] Train accuracy: 62.29
[2024-03-12 09:39:52,924 INFO] Sentences processed: 140208
[2024-03-12 09:39:52,924 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:39:52,924 INFO] Validation perplexity: 3765.31
[2024-03-12 09:39:52,924 INFO] Validation accuracy: 29.4023
[2024-03-12 09:39:52,925 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_8200.pt
[2024-03-12 09:39:55,732 INFO] Step 8250/10200; acc: 89.4; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2362; bsz:  562/ 488/47; 4484/3893 tok/s;    265 sec;
[2024-03-12 09:39:58,428 INFO] Step 8300/10200; acc: 89.3; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2267; bsz:  560/ 483/45; 10397/8961 tok/s;    268 sec;
[2024-03-12 09:40:01,994 INFO] Step 8350/10200; acc: 89.4; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2369; bsz:  580/ 501/47; 8138/7022 tok/s;    272 sec;
[2024-03-12 09:40:05,617 INFO] Step 8400/10200; acc: 89.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  566/ 494/47; 7814/6818 tok/s;    275 sec;
[2024-03-12 09:40:09,063 INFO] valid stats calculation
                           took: 3.4461662769317627 s.
[2024-03-12 09:40:09,063 INFO] Train perplexity: 7.15428
[2024-03-12 09:40:09,063 INFO] Train accuracy: 63.981
[2024-03-12 09:40:09,064 INFO] Sentences processed: 149578
[2024-03-12 09:40:09,064 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:40:09,064 INFO] Validation perplexity: 4804.46
[2024-03-12 09:40:09,064 INFO] Validation accuracy: 28.921
[2024-03-12 09:40:09,065 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_8400.pt
[2024-03-12 09:40:12,340 INFO] Step 8450/10200; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2269; bsz:  576/ 495/45; 4281/3684 tok/s;    282 sec;
[2024-03-12 09:40:15,012 INFO] Step 8500/10200; acc: 90.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  565/ 492/48; 10580/9215 tok/s;    285 sec;
[2024-03-12 09:40:18,602 INFO] Step 8550/10200; acc: 90.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2382; bsz:  568/ 496/48; 7916/6915 tok/s;    288 sec;
[2024-03-12 09:40:22,244 INFO] Step 8600/10200; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  590/ 511/48; 8097/7017 tok/s;    292 sec;
[2024-03-12 09:40:25,754 INFO] valid stats calculation
                           took: 3.509366035461426 s.
[2024-03-12 09:40:25,754 INFO] Train perplexity: 6.49329
[2024-03-12 09:40:25,754 INFO] Train accuracy: 65.537
[2024-03-12 09:40:25,755 INFO] Sentences processed: 158980
[2024-03-12 09:40:25,755 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:40:25,755 INFO] Validation perplexity: 5309.59
[2024-03-12 09:40:25,755 INFO] Validation accuracy: 27.9583
[2024-03-12 09:40:25,756 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_8600.pt
[2024-03-12 09:40:28,953 INFO] Step 8650/10200; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2280; bsz:  565/ 490/46; 4212/3654 tok/s;    299 sec;
[2024-03-12 09:40:31,433 INFO] Step 8700/10200; acc: 91.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2368; bsz:  565/ 491/47; 11388/9899 tok/s;    301 sec;
[2024-03-12 09:40:35,137 INFO] Step 8750/10200; acc: 91.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2246; bsz:  570/ 491/45; 7698/6631 tok/s;    305 sec;
[2024-03-12 09:40:38,710 INFO] Step 8800/10200; acc: 91.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2368; bsz:  567/ 493/47; 7931/6902 tok/s;    308 sec;
[2024-03-12 09:40:42,160 INFO] valid stats calculation
                           took: 3.4490983486175537 s.
[2024-03-12 09:40:42,160 INFO] Train perplexity: 5.95522
[2024-03-12 09:40:42,160 INFO] Train accuracy: 66.951
[2024-03-12 09:40:42,160 INFO] Sentences processed: 168242
[2024-03-12 09:40:42,160 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:40:42,160 INFO] Validation perplexity: 7061.1
[2024-03-12 09:40:42,160 INFO] Validation accuracy: 29.3221
[2024-03-12 09:40:42,162 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_8800.pt
[2024-03-12 09:40:45,384 INFO] Step 8850/10200; acc: 91.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2363; bsz:  562/ 488/47; 4208/3658 tok/s;    315 sec;
[2024-03-12 09:40:47,823 INFO] Step 8900/10200; acc: 92.0; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2365; bsz:  577/ 500/47; 11838/10246 tok/s;    318 sec;
[2024-03-12 09:40:51,252 INFO] Step 8950/10200; acc: 91.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2258; bsz:  555/ 482/45; 8101/7026 tok/s;    321 sec;
[2024-03-12 09:40:54,913 INFO] Step 9000/10200; acc: 91.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2274; bsz:  563/ 490/45; 7687/6685 tok/s;    325 sec;
[2024-03-12 09:40:58,392 INFO] valid stats calculation
                           took: 3.478224754333496 s.
[2024-03-12 09:40:58,392 INFO] Train perplexity: 5.50724
[2024-03-12 09:40:58,392 INFO] Train accuracy: 68.2439
[2024-03-12 09:40:58,392 INFO] Sentences processed: 177502
[2024-03-12 09:40:58,392 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:40:58,392 INFO] Validation perplexity: 6365.82
[2024-03-12 09:40:58,392 INFO] Validation accuracy: 28.8408
[2024-03-12 09:40:58,394 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_9000.pt
[2024-03-12 09:41:01,902 INFO] Step 9050/10200; acc: 92.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  563/ 491/48; 4027/3512 tok/s;    332 sec;
[2024-03-12 09:41:04,330 INFO] Step 9100/10200; acc: 92.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  582/ 505/48; 11978/10393 tok/s;    334 sec;
[2024-03-12 09:41:07,770 INFO] Step 9150/10200; acc: 92.0; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2277; bsz:  566/ 489/46; 8223/7109 tok/s;    338 sec;
[2024-03-12 09:41:11,309 INFO] Step 9200/10200; acc: 92.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  565/ 493/48; 7989/6967 tok/s;    341 sec;
[2024-03-12 09:41:14,754 INFO] valid stats calculation
                           took: 3.4443912506103516 s.
[2024-03-12 09:41:14,754 INFO] Train perplexity: 5.1241
[2024-03-12 09:41:14,754 INFO] Train accuracy: 69.4448
[2024-03-12 09:41:14,754 INFO] Sentences processed: 186912
[2024-03-12 09:41:14,754 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:41:14,754 INFO] Validation perplexity: 8164.11
[2024-03-12 09:41:14,754 INFO] Validation accuracy: 27.7176
[2024-03-12 09:41:14,756 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_9200.pt
[2024-03-12 09:41:18,371 INFO] Step 9250/10200; acc: 92.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  587/ 515/47; 4158/3647 tok/s;    348 sec;
[2024-03-12 09:41:20,865 INFO] Step 9300/10200; acc: 92.7; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2264; bsz:  559/ 483/45; 11209/9690 tok/s;    351 sec;
[2024-03-12 09:41:24,242 INFO] Step 9350/10200; acc: 92.8; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2366; bsz:  575/ 495/47; 8509/7336 tok/s;    354 sec;
[2024-03-12 09:41:27,703 INFO] Step 9400/10200; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2364; bsz:  558/ 487/47; 8063/7031 tok/s;    357 sec;
[2024-03-12 09:41:31,174 INFO] valid stats calculation
                           took: 3.4708471298217773 s.
[2024-03-12 09:41:31,175 INFO] Train perplexity: 4.79602
[2024-03-12 09:41:31,175 INFO] Train accuracy: 70.5543
[2024-03-12 09:41:31,175 INFO] Sentences processed: 196278
[2024-03-12 09:41:31,175 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:41:31,175 INFO] Validation perplexity: 10187.7
[2024-03-12 09:41:31,175 INFO] Validation accuracy: 27.7176
[2024-03-12 09:41:31,176 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_9400.pt
[2024-03-12 09:41:34,883 INFO] Step 9450/10200; acc: 93.3; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  563/ 492/47; 3924/3426 tok/s;    365 sec;
[2024-03-12 09:41:37,364 INFO] Step 9500/10200; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2365; bsz:  580/ 505/47; 11687/10185 tok/s;    367 sec;
[2024-03-12 09:41:40,528 INFO] Step 9550/10200; acc: 92.7; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2276; bsz:  562/ 486/46; 8879/7676 tok/s;    370 sec;
[2024-03-12 09:41:44,037 INFO] Step 9600/10200; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2372; bsz:  565/ 491/47; 8056/6996 tok/s;    374 sec;
[2024-03-12 09:41:47,480 INFO] valid stats calculation
                           took: 3.442098379135132 s.
[2024-03-12 09:41:47,480 INFO] Train perplexity: 4.51575
[2024-03-12 09:41:47,480 INFO] Train accuracy: 71.5739
[2024-03-12 09:41:47,480 INFO] Sentences processed: 205658
[2024-03-12 09:41:47,480 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:41:47,480 INFO] Validation perplexity: 9815.78
[2024-03-12 09:41:47,480 INFO] Validation accuracy: 28.6803
[2024-03-12 09:41:47,482 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_9600.pt
[2024-03-12 09:41:51,272 INFO] Step 9650/10200; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2274; bsz:  578/ 496/45; 3995/3429 tok/s;    381 sec;
[2024-03-12 09:41:53,872 INFO] Step 9700/10200; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2382; bsz:  561/ 487/48; 10788/9374 tok/s;    384 sec;
[2024-03-12 09:41:56,789 INFO] Step 9750/10200; acc: 93.5; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2376; bsz:  567/ 491/48; 9723/8423 tok/s;    387 sec;
[2024-03-12 09:42:00,390 INFO] Step 9800/10200; acc: 93.2; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2277; bsz:  565/ 489/46; 7851/6795 tok/s;    390 sec;
[2024-03-12 09:42:03,853 INFO] valid stats calculation
                           took: 3.463423013687134 s.
[2024-03-12 09:42:03,854 INFO] Train perplexity: 4.2734
[2024-03-12 09:42:03,854 INFO] Train accuracy: 72.5128
[2024-03-12 09:42:03,854 INFO] Sentences processed: 214967
[2024-03-12 09:42:03,854 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:42:03,854 INFO] Validation perplexity: 10858.5
[2024-03-12 09:42:03,854 INFO] Validation accuracy: 29.7633
[2024-03-12 09:42:03,855 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_9800.pt
[2024-03-12 09:42:07,580 INFO] Step 9850/10200; acc: 94.0; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 4072/3532 tok/s;    397 sec;
[2024-03-12 09:42:10,268 INFO] Step 9900/10200; acc: 93.7; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2366; bsz:  563/ 489/47; 10469/9101 tok/s;    400 sec;
[2024-03-12 09:42:12,978 INFO] Step 9950/10200; acc: 93.9; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2366; bsz:  579/ 499/47; 10691/9216 tok/s;    403 sec;
[2024-03-12 09:42:16,585 INFO] Step 10000/10200; acc: 94.1; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 7764/6695 tok/s;    406 sec;
[2024-03-12 09:42:20,080 INFO] valid stats calculation
                           took: 3.494633674621582 s.
[2024-03-12 09:42:20,080 INFO] Train perplexity: 4.05735
[2024-03-12 09:42:20,080 INFO] Train accuracy: 73.4066
[2024-03-12 09:42:20,080 INFO] Sentences processed: 224332
[2024-03-12 09:42:20,080 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:42:20,080 INFO] Validation perplexity: 12801.8
[2024-03-12 09:42:20,080 INFO] Validation accuracy: 28.3193
[2024-03-12 09:42:20,082 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_10000.pt
[2024-03-12 09:42:23,725 INFO] Step 10050/10200; acc: 93.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  566/ 494/47; 3963/3462 tok/s;    413 sec;
[2024-03-12 09:42:26,701 INFO] Step 10100/10200; acc: 94.0; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2267; bsz:  558/ 484/45; 9381/8137 tok/s;    416 sec;
[2024-03-12 09:42:29,247 INFO] Step 10150/10200; acc: 93.9; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2372; bsz:  582/ 503/47; 11427/9888 tok/s;    419 sec;
[2024-03-12 09:42:31,730 INFO] Step 10200/10200; acc: 94.0; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2371; bsz:  590/ 510/47; 11878/10279 tok/s;    421 sec;
[2024-03-12 09:42:35,290 INFO] valid stats calculation
                           took: 3.559535026550293 s.
[2024-03-12 09:42:35,290 INFO] Train perplexity: 3.86678
[2024-03-12 09:42:35,290 INFO] Train accuracy: 74.2344
[2024-03-12 09:42:35,290 INFO] Sentences processed: 233709
[2024-03-12 09:42:35,290 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:42:35,290 INFO] Validation perplexity: 13661.5
[2024-03-12 09:42:35,290 INFO] Validation accuracy: 28.3995
[2024-03-12 09:42:35,292 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_02_step_10200.pt
