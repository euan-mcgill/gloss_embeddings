[2024-03-13 10:13:24,679 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-13 10:13:24,679 INFO] Parsed 2 corpora from -data.
[2024-03-13 10:13:24,679 INFO] Loading checkpoint from gt-pt-both/models/gt-pt-both_03_step_9000.pt
[2024-03-13 10:13:24,753 INFO] Building model...
[2024-03-13 10:13:24,809 INFO] Switching model to float32 for amp/apex_amp
[2024-03-13 10:13:24,809 INFO] Non quantized layer compute is fp32
[2024-03-13 10:13:26,584 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=17816, bias=True)
)
[2024-03-13 10:13:26,584 INFO] encoder: 7851200
[2024-03-13 10:13:26,585 INFO] decoder: 19628616
[2024-03-13 10:13:26,585 INFO] * number of parameters: 27479816
[2024-03-13 10:13:26,585 INFO] Trainable parameters = {'torch.float32': 27479816, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 10:13:26,585 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 10:13:26,585 INFO]  * src vocab size = 14144
[2024-03-13 10:13:26,585 INFO]  * tgt vocab size = 17816
[2024-03-13 10:13:26,586 INFO] Starting training on GPU: [0]
[2024-03-13 10:13:26,586 INFO] Start training loop and validate every 200 steps...
[2024-03-13 10:13:26,586 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-13 10:13:32,614 INFO] Step 9050/14000; acc: 20.8; ppl: 353.5; xent: 5.9; lr: 1.00000; sents:    2297; bsz:  449/ 612/46; 3724/5078 tok/s;      6 sec;
[2024-03-13 10:13:35,091 INFO] Step 9100/14000; acc: 30.0; ppl:  71.7; xent: 4.3; lr: 1.00000; sents:    2392; bsz:  468/ 640/48; 9453/12923 tok/s;      9 sec;
[2024-03-13 10:13:37,482 INFO] Step 9150/14000; acc: 36.8; ppl:  36.3; xent: 3.6; lr: 1.00000; sents:    2391; bsz:  443/ 619/48; 9271/12947 tok/s;     11 sec;
[2024-03-13 10:13:39,925 INFO] Step 9200/14000; acc: 41.3; ppl:  23.7; xent: 3.2; lr: 1.00000; sents:    2391; bsz:  462/ 632/48; 9461/12936 tok/s;     13 sec;
[2024-03-13 10:13:43,244 INFO] valid stats calculation
                           took: 3.318331003189087 s.
[2024-03-13 10:13:43,244 INFO] Train perplexity: 67.6958
[2024-03-13 10:13:43,244 INFO] Train accuracy: 32.2909
[2024-03-13 10:13:43,244 INFO] Sentences processed: 9471
[2024-03-13 10:13:43,244 INFO] Average bsz:  456/ 626/47
[2024-03-13 10:13:43,244 INFO] Validation perplexity: 58.9914
[2024-03-13 10:13:43,244 INFO] Validation accuracy: 32.7109
[2024-03-13 10:13:43,246 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_9200.pt
[2024-03-13 10:13:45,771 INFO] Step 9250/14000; acc: 46.5; ppl:  15.8; xent: 2.8; lr: 1.00000; sents:    2392; bsz:  441/ 618/48; 3771/5282 tok/s;     19 sec;
[2024-03-13 10:13:48,213 INFO] Step 9300/14000; acc: 48.9; ppl:  12.8; xent: 2.6; lr: 1.00000; sents:    2288; bsz:  438/ 603/46; 8966/12353 tok/s;     22 sec;
[2024-03-13 10:13:50,693 INFO] Step 9350/14000; acc: 52.3; ppl:  10.0; xent: 2.3; lr: 1.00000; sents:    2302; bsz:  446/ 609/46; 8988/12276 tok/s;     24 sec;
[2024-03-13 10:13:53,048 INFO] Step 9400/14000; acc: 55.0; ppl:   8.1; xent: 2.1; lr: 1.00000; sents:    2509; bsz:  465/ 651/50; 9884/13831 tok/s;     26 sec;
[2024-03-13 10:13:56,387 INFO] valid stats calculation
                           took: 3.3384859561920166 s.
[2024-03-13 10:13:56,387 INFO] Train perplexity: 27.7488
[2024-03-13 10:13:56,387 INFO] Train accuracy: 41.4672
[2024-03-13 10:13:56,387 INFO] Sentences processed: 18962
[2024-03-13 10:13:56,387 INFO] Average bsz:  452/ 623/47
[2024-03-13 10:13:56,387 INFO] Validation perplexity: 48.0996
[2024-03-13 10:13:56,387 INFO] Validation accuracy: 38.2486
[2024-03-13 10:13:56,389 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_9400.pt
[2024-03-13 10:13:58,935 INFO] Step 9450/14000; acc: 58.1; ppl:   6.6; xent: 1.9; lr: 1.00000; sents:    2301; bsz:  445/ 609/46; 3784/5170 tok/s;     32 sec;
[2024-03-13 10:14:01,356 INFO] Step 9500/14000; acc: 60.0; ppl:   5.8; xent: 1.8; lr: 1.00000; sents:    2288; bsz:  436/ 601/46; 9015/12411 tok/s;     35 sec;
[2024-03-13 10:14:03,740 INFO] Step 9550/14000; acc: 62.7; ppl:   5.0; xent: 1.6; lr: 1.00000; sents:    2396; bsz:  457/ 629/48; 9581/13197 tok/s;     37 sec;
[2024-03-13 10:14:06,107 INFO] Step 9600/14000; acc: 65.4; ppl:   4.2; xent: 1.4; lr: 1.00000; sents:    2392; bsz:  442/ 616/48; 9331/13017 tok/s;     40 sec;
[2024-03-13 10:14:09,430 INFO] valid stats calculation
                           took: 3.3233227729797363 s.
[2024-03-13 10:14:09,431 INFO] Train perplexity: 16.0882
[2024-03-13 10:14:09,431 INFO] Train accuracy: 48.1088
[2024-03-13 10:14:09,431 INFO] Sentences processed: 28339
[2024-03-13 10:14:09,431 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:14:09,431 INFO] Validation perplexity: 71.8331
[2024-03-13 10:14:09,431 INFO] Validation accuracy: 38.4739
[2024-03-13 10:14:09,432 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_9600.pt
[2024-03-13 10:14:12,013 INFO] Step 9650/14000; acc: 66.5; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    2393; bsz:  469/ 637/48; 3973/5389 tok/s;     45 sec;
[2024-03-13 10:14:14,484 INFO] Step 9700/14000; acc: 68.4; ppl:   3.5; xent: 1.3; lr: 1.00000; sents:    2295; bsz:  450/ 614/46; 9113/12432 tok/s;     48 sec;
[2024-03-13 10:14:16,958 INFO] Step 9750/14000; acc: 70.3; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    2391; bsz:  449/ 623/48; 9083/12583 tok/s;     50 sec;
[2024-03-13 10:14:19,366 INFO] Step 9800/14000; acc: 72.4; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    2290; bsz:  439/ 602/46; 9113/12503 tok/s;     53 sec;
[2024-03-13 10:14:22,681 INFO] valid stats calculation
                           took: 3.314899206161499 s.
[2024-03-13 10:14:22,682 INFO] Train perplexity: 10.9171
[2024-03-13 10:14:22,682 INFO] Train accuracy: 53.4149
[2024-03-13 10:14:22,682 INFO] Sentences processed: 37708
[2024-03-13 10:14:22,682 INFO] Average bsz:  450/ 620/47
[2024-03-13 10:14:22,682 INFO] Validation perplexity: 44.5866
[2024-03-13 10:14:22,682 INFO] Validation accuracy: 44.3657
[2024-03-13 10:14:22,683 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_9800.pt
[2024-03-13 10:14:25,218 INFO] Step 9850/14000; acc: 74.6; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    2400; bsz:  443/ 617/48; 3785/5272 tok/s;     59 sec;
[2024-03-13 10:14:27,681 INFO] Step 9900/14000; acc: 75.9; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2399; bsz:  454/ 628/48; 9220/12747 tok/s;     61 sec;
[2024-03-13 10:14:30,110 INFO] Step 9950/14000; acc: 76.4; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2401; bsz:  459/ 634/48; 9440/13051 tok/s;     64 sec;
[2024-03-13 10:14:32,463 INFO] Step 10000/14000; acc: 78.7; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2404; bsz:  444/ 620/48; 9445/13182 tok/s;     66 sec;
[2024-03-13 10:14:35,790 INFO] valid stats calculation
                           took: 3.3262007236480713 s.
[2024-03-13 10:14:35,790 INFO] Train perplexity: 8.06771
[2024-03-13 10:14:35,790 INFO] Train accuracy: 58.0379
[2024-03-13 10:14:35,790 INFO] Sentences processed: 47312
[2024-03-13 10:14:35,790 INFO] Average bsz:  450/ 621/47
[2024-03-13 10:14:35,790 INFO] Validation perplexity: 63.9133
[2024-03-13 10:14:35,791 INFO] Validation accuracy: 42.3374
[2024-03-13 10:14:35,792 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_10000.pt
[2024-03-13 10:14:38,319 INFO] Step 10050/14000; acc: 79.3; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2302; bsz:  447/ 607/46; 3821/5181 tok/s;     72 sec;
[2024-03-13 10:14:40,723 INFO] Step 10100/14000; acc: 81.2; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2399; bsz:  452/ 629/48; 9410/13087 tok/s;     74 sec;
[2024-03-13 10:14:43,200 INFO] Step 10150/14000; acc: 81.5; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2299; bsz:  444/ 610/46; 8956/12309 tok/s;     77 sec;
[2024-03-13 10:14:45,570 INFO] Step 10200/14000; acc: 83.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2393; bsz:  444/ 616/48; 9360/13009 tok/s;     79 sec;
[2024-03-13 10:14:48,886 INFO] valid stats calculation
                           took: 3.3158528804779053 s.
[2024-03-13 10:14:48,886 INFO] Train perplexity: 6.38072
[2024-03-13 10:14:48,886 INFO] Train accuracy: 61.8929
[2024-03-13 10:14:48,886 INFO] Sentences processed: 56705
[2024-03-13 10:14:48,886 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:14:48,886 INFO] Validation perplexity: 78.7839
[2024-03-13 10:14:48,886 INFO] Validation accuracy: 41.8223
[2024-03-13 10:14:48,888 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_10200.pt
[2024-03-13 10:14:51,413 INFO] Step 10250/14000; acc: 83.5; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2392; bsz:  444/ 617/48; 3800/5281 tok/s;     85 sec;
[2024-03-13 10:14:53,867 INFO] Step 10300/14000; acc: 84.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2295; bsz:  447/ 610/46; 9100/12434 tok/s;     87 sec;
[2024-03-13 10:14:56,308 INFO] Step 10350/14000; acc: 85.4; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2391; bsz:  460/ 637/48; 9430/13048 tok/s;     90 sec;
[2024-03-13 10:14:58,661 INFO] Step 10400/14000; acc: 86.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2391; bsz:  442/ 615/48; 9384/13064 tok/s;     92 sec;
[2024-03-13 10:15:02,001 INFO] valid stats calculation
                           took: 3.3393547534942627 s.
[2024-03-13 10:15:02,001 INFO] Train perplexity: 5.2772
[2024-03-13 10:15:02,001 INFO] Train accuracy: 65.1833
[2024-03-13 10:15:02,001 INFO] Sentences processed: 66174
[2024-03-13 10:15:02,001 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:15:02,001 INFO] Validation perplexity: 83.3044
[2024-03-13 10:15:02,001 INFO] Validation accuracy: 43.3677
[2024-03-13 10:15:02,003 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_10400.pt
[2024-03-13 10:15:04,519 INFO] Step 10450/14000; acc: 86.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2400; bsz:  456/ 633/48; 3890/5402 tok/s;     98 sec;
[2024-03-13 10:15:07,023 INFO] Step 10500/14000; acc: 87.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2302; bsz:  444/ 612/46; 8864/12228 tok/s;    100 sec;
[2024-03-13 10:15:09,377 INFO] Step 10550/14000; acc: 88.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2401; bsz:  459/ 633/48; 9751/13453 tok/s;    103 sec;
[2024-03-13 10:15:11,707 INFO] Step 10600/14000; acc: 88.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2403; bsz:  444/ 618/48; 9531/13253 tok/s;    105 sec;
[2024-03-13 10:15:15,032 INFO] valid stats calculation
                           took: 3.324744462966919 s.
[2024-03-13 10:15:15,033 INFO] Train perplexity: 4.5133
[2024-03-13 10:15:15,033 INFO] Train accuracy: 68.0221
[2024-03-13 10:15:15,033 INFO] Sentences processed: 75680
[2024-03-13 10:15:15,033 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:15:15,033 INFO] Validation perplexity: 117.532
[2024-03-13 10:15:15,033 INFO] Validation accuracy: 42.6272
[2024-03-13 10:15:15,034 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_10600.pt
[2024-03-13 10:15:17,577 INFO] Step 10650/14000; acc: 88.9; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2304; bsz:  443/ 608/46; 3772/5177 tok/s;    111 sec;
[2024-03-13 10:15:20,023 INFO] Step 10700/14000; acc: 89.4; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2303; bsz:  446/ 610/46; 9114/12464 tok/s;    113 sec;
[2024-03-13 10:15:22,422 INFO] Step 10750/14000; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2394; bsz:  448/ 624/48; 9340/13006 tok/s;    116 sec;
[2024-03-13 10:15:24,886 INFO] Step 10800/14000; acc: 89.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2393; bsz:  468/ 639/48; 9498/12973 tok/s;    118 sec;
[2024-03-13 10:15:28,212 INFO] valid stats calculation
                           took: 3.325300931930542 s.
[2024-03-13 10:15:28,212 INFO] Train perplexity: 3.9703
[2024-03-13 10:15:28,212 INFO] Train accuracy: 70.4163
[2024-03-13 10:15:28,212 INFO] Sentences processed: 85074
[2024-03-13 10:15:28,212 INFO] Average bsz:  450/ 620/47
[2024-03-13 10:15:28,212 INFO] Validation perplexity: 119.763
[2024-03-13 10:15:28,212 INFO] Validation accuracy: 42.6272
[2024-03-13 10:15:28,213 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_10800.pt
[2024-03-13 10:15:30,720 INFO] Step 10850/14000; acc: 90.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2392; bsz:  442/ 619/48; 3790/5304 tok/s;    124 sec;
[2024-03-13 10:15:33,204 INFO] Step 10900/14000; acc: 90.5; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2279; bsz:  458/ 616/46; 9227/12397 tok/s;    127 sec;
[2024-03-13 10:15:35,584 INFO] Step 10950/14000; acc: 91.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2391; bsz:  441/ 617/48; 9260/12971 tok/s;    129 sec;
[2024-03-13 10:15:37,956 INFO] Step 11000/14000; acc: 91.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2392; bsz:  440/ 614/48; 9283/12937 tok/s;    131 sec;
[2024-03-13 10:15:41,309 INFO] valid stats calculation
                           took: 3.352416515350342 s.
[2024-03-13 10:15:41,310 INFO] Train perplexity: 3.5673
[2024-03-13 10:15:41,310 INFO] Train accuracy: 72.4714
[2024-03-13 10:15:41,310 INFO] Sentences processed: 94528
[2024-03-13 10:15:41,310 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:15:41,310 INFO] Validation perplexity: 128.827
[2024-03-13 10:15:41,310 INFO] Validation accuracy: 42.1764
[2024-03-13 10:15:41,311 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_11000.pt
[2024-03-13 10:15:43,876 INFO] Step 11050/14000; acc: 91.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2400; bsz:  460/ 635/48; 3883/5363 tok/s;    137 sec;
[2024-03-13 10:15:46,348 INFO] Step 11100/14000; acc: 92.0; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2302; bsz:  447/ 610/46; 9037/12344 tok/s;    140 sec;
[2024-03-13 10:15:48,730 INFO] Step 11150/14000; acc: 92.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2298; bsz:  442/ 605/46; 9284/12710 tok/s;    142 sec;
[2024-03-13 10:15:51,100 INFO] Step 11200/14000; acc: 92.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2401; bsz:  458/ 631/48; 9662/13310 tok/s;    145 sec;
[2024-03-13 10:15:54,424 INFO] valid stats calculation
                           took: 3.323716402053833 s.
[2024-03-13 10:15:54,424 INFO] Train perplexity: 3.25584
[2024-03-13 10:15:54,424 INFO] Train accuracy: 74.2609
[2024-03-13 10:15:54,424 INFO] Sentences processed: 103929
[2024-03-13 10:15:54,424 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:15:54,424 INFO] Validation perplexity: 142.679
[2024-03-13 10:15:54,424 INFO] Validation accuracy: 42.8847
[2024-03-13 10:15:54,426 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_11200.pt
[2024-03-13 10:15:56,976 INFO] Step 11250/14000; acc: 92.6; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2399; bsz:  441/ 617/48; 3751/5247 tok/s;    150 sec;
[2024-03-13 10:15:59,438 INFO] Step 11300/14000; acc: 92.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2396; bsz:  469/ 637/48; 9537/12934 tok/s;    153 sec;
[2024-03-13 10:16:01,869 INFO] Step 11350/14000; acc: 93.3; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2296; bsz:  429/ 599/46; 8825/12321 tok/s;    155 sec;
[2024-03-13 10:16:04,336 INFO] Step 11400/14000; acc: 93.0; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2393; bsz:  471/ 638/48; 9557/12932 tok/s;    158 sec;
[2024-03-13 10:16:07,656 INFO] valid stats calculation
                           took: 3.319793939590454 s.
[2024-03-13 10:16:07,656 INFO] Train perplexity: 3.0099
[2024-03-13 10:16:07,656 INFO] Train accuracy: 75.8158
[2024-03-13 10:16:07,657 INFO] Sentences processed: 113413
[2024-03-13 10:16:07,657 INFO] Average bsz:  450/ 620/47
[2024-03-13 10:16:07,657 INFO] Validation perplexity: 153.417
[2024-03-13 10:16:07,657 INFO] Validation accuracy: 42.112
[2024-03-13 10:16:07,658 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_11400.pt
[2024-03-13 10:16:10,186 INFO] Step 11450/14000; acc: 93.6; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2391; bsz:  448/ 624/48; 3831/5331 tok/s;    164 sec;
[2024-03-13 10:16:12,605 INFO] Step 11500/14000; acc: 93.6; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2391; bsz:  439/ 612/48; 9083/12659 tok/s;    166 sec;
[2024-03-13 10:16:15,026 INFO] Step 11550/14000; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2290; bsz:  441/ 604/46; 9103/12471 tok/s;    168 sec;
[2024-03-13 10:16:17,408 INFO] Step 11600/14000; acc: 94.1; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2400; bsz:  446/ 622/48; 9355/13051 tok/s;    171 sec;
[2024-03-13 10:16:20,730 INFO] valid stats calculation
                           took: 3.3215739727020264 s.
[2024-03-13 10:16:20,730 INFO] Train perplexity: 2.81313
[2024-03-13 10:16:20,730 INFO] Train accuracy: 77.1795
[2024-03-13 10:16:20,730 INFO] Sentences processed: 122885
[2024-03-13 10:16:20,730 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:16:20,730 INFO] Validation perplexity: 128.18
[2024-03-13 10:16:20,730 INFO] Validation accuracy: 44.6877
[2024-03-13 10:16:20,732 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_11600.pt
[2024-03-13 10:16:23,360 INFO] Step 11650/14000; acc: 94.0; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2302; bsz:  449/ 608/46; 3775/5104 tok/s;    177 sec;
[2024-03-13 10:16:25,799 INFO] Step 11700/14000; acc: 94.2; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2400; bsz:  458/ 634/48; 9389/12993 tok/s;    179 sec;
[2024-03-13 10:16:28,188 INFO] Step 11750/14000; acc: 94.0; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2403; bsz:  453/ 630/48; 9484/13179 tok/s;    182 sec;
[2024-03-13 10:16:30,654 INFO] Step 11800/14000; acc: 94.2; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2305; bsz:  443/ 611/46; 8989/12391 tok/s;    184 sec;
[2024-03-13 10:16:33,970 INFO] valid stats calculation
                           took: 3.315467596054077 s.
[2024-03-13 10:16:33,970 INFO] Train perplexity: 2.64984
[2024-03-13 10:16:33,970 INFO] Train accuracy: 78.3912
[2024-03-13 10:16:33,970 INFO] Sentences processed: 132295
[2024-03-13 10:16:33,970 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:16:33,970 INFO] Validation perplexity: 188.876
[2024-03-13 10:16:33,970 INFO] Validation accuracy: 42.8203
[2024-03-13 10:16:33,972 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_11800.pt
[2024-03-13 10:16:36,471 INFO] Step 11850/14000; acc: 94.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2399; bsz:  444/ 618/48; 3818/5314 tok/s;    190 sec;
[2024-03-13 10:16:38,912 INFO] Step 11900/14000; acc: 94.4; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2395; bsz:  462/ 638/48; 9457/13069 tok/s;    192 sec;
[2024-03-13 10:16:41,340 INFO] Step 11950/14000; acc: 94.2; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2297; bsz:  447/ 610/46; 9201/12571 tok/s;    195 sec;
[2024-03-13 10:16:43,708 INFO] Step 12000/14000; acc: 94.6; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2392; bsz:  444/ 617/48; 9377/13033 tok/s;    197 sec;
[2024-03-13 10:16:47,027 INFO] valid stats calculation
                           took: 3.3181509971618652 s.
[2024-03-13 10:16:47,027 INFO] Train perplexity: 2.51412
[2024-03-13 10:16:47,027 INFO] Train accuracy: 79.4686
[2024-03-13 10:16:47,027 INFO] Sentences processed: 141778
[2024-03-13 10:16:47,027 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:16:47,027 INFO] Validation perplexity: 187.268
[2024-03-13 10:16:47,027 INFO] Validation accuracy: 43.5287
[2024-03-13 10:16:47,029 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_12000.pt
[2024-03-13 10:16:49,586 INFO] Step 12050/14000; acc: 94.7; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2391; bsz:  454/ 630/48; 3865/5359 tok/s;    203 sec;
[2024-03-13 10:16:51,970 INFO] Step 12100/14000; acc: 94.9; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2391; bsz:  442/ 615/48; 9275/12905 tok/s;    205 sec;
[2024-03-13 10:16:54,466 INFO] Step 12150/14000; acc: 94.5; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2294; bsz:  442/ 610/46; 8858/12223 tok/s;    208 sec;
[2024-03-13 10:16:56,875 INFO] Step 12200/14000; acc: 95.0; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2400; bsz:  460/ 634/48; 9544/13153 tok/s;    210 sec;
[2024-03-13 10:17:00,190 INFO] valid stats calculation
                           took: 3.314303398132324 s.
[2024-03-13 10:17:00,190 INFO] Train perplexity: 2.39975
[2024-03-13 10:17:00,190 INFO] Train accuracy: 80.4285
[2024-03-13 10:17:00,190 INFO] Sentences processed: 151254
[2024-03-13 10:17:00,191 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:17:00,191 INFO] Validation perplexity: 183.514
[2024-03-13 10:17:00,191 INFO] Validation accuracy: 43.1423
[2024-03-13 10:17:00,192 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_12200.pt
[2024-03-13 10:17:02,763 INFO] Step 12250/14000; acc: 95.2; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2303; bsz:  431/ 596/46; 3659/5065 tok/s;    216 sec;
[2024-03-13 10:17:05,142 INFO] Step 12300/14000; acc: 95.4; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2401; bsz:  458/ 632/48; 9638/13290 tok/s;    219 sec;
[2024-03-13 10:17:07,568 INFO] Step 12350/14000; acc: 94.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2403; bsz:  467/ 637/48; 9620/13138 tok/s;    221 sec;
[2024-03-13 10:17:10,041 INFO] Step 12400/14000; acc: 95.1; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2301; bsz:  447/ 611/46; 9041/12354 tok/s;    223 sec;
[2024-03-13 10:17:13,357 INFO] valid stats calculation
                           took: 3.3156790733337402 s.
[2024-03-13 10:17:13,357 INFO] Train perplexity: 2.30181
[2024-03-13 10:17:13,357 INFO] Train accuracy: 81.2918
[2024-03-13 10:17:13,357 INFO] Sentences processed: 160662
[2024-03-13 10:17:13,357 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:17:13,357 INFO] Validation perplexity: 225.391
[2024-03-13 10:17:13,357 INFO] Validation accuracy: 42.0476
[2024-03-13 10:17:13,358 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_12400.pt
[2024-03-13 10:17:15,844 INFO] Step 12450/14000; acc: 95.2; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2402; bsz:  449/ 626/48; 3870/5398 tok/s;    229 sec;
[2024-03-13 10:17:18,256 INFO] Step 12500/14000; acc: 95.3; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2394; bsz:  460/ 635/48; 9534/13151 tok/s;    232 sec;
[2024-03-13 10:17:20,601 INFO] Step 12550/14000; acc: 95.6; ppl:   1.2; xent: 0.1; lr: 1.00000; sents:    2281; bsz:  420/ 585/46; 8968/12473 tok/s;    234 sec;
[2024-03-13 10:17:23,014 INFO] Step 12600/14000; acc: 95.4; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2392; bsz:  463/ 636/48; 9590/13181 tok/s;    236 sec;
[2024-03-13 10:17:26,337 INFO] valid stats calculation
                           took: 3.323244333267212 s.
[2024-03-13 10:17:26,338 INFO] Train perplexity: 2.21676
[2024-03-13 10:17:26,338 INFO] Train accuracy: 82.0749
[2024-03-13 10:17:26,338 INFO] Sentences processed: 170131
[2024-03-13 10:17:26,338 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:17:26,338 INFO] Validation perplexity: 254.442
[2024-03-13 10:17:26,338 INFO] Validation accuracy: 42.434
[2024-03-13 10:17:26,339 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_12600.pt
[2024-03-13 10:17:28,840 INFO] Step 12650/14000; acc: 95.5; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2391; bsz:  442/ 615/48; 3791/5276 tok/s;    242 sec;
[2024-03-13 10:17:31,244 INFO] Step 12700/14000; acc: 95.6; ppl:   1.2; xent: 0.1; lr: 1.00000; sents:    2391; bsz:  454/ 628/48; 9454/13062 tok/s;    245 sec;
[2024-03-13 10:17:33,640 INFO] Step 12750/14000; acc: 95.5; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2286; bsz:  441/ 604/46; 9201/12608 tok/s;    247 sec;
[2024-03-13 10:17:36,111 INFO] Step 12800/14000; acc: 95.7; ppl:   1.2; xent: 0.1; lr: 1.00000; sents:    2302; bsz:  449/ 611/46; 9079/12370 tok/s;    250 sec;
[2024-03-13 10:17:39,452 INFO] valid stats calculation
                           took: 3.340630054473877 s.
[2024-03-13 10:17:39,452 INFO] Train perplexity: 2.14342
[2024-03-13 10:17:39,452 INFO] Train accuracy: 82.7783
[2024-03-13 10:17:39,452 INFO] Sentences processed: 179501
[2024-03-13 10:17:39,453 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:17:39,453 INFO] Validation perplexity: 250.461
[2024-03-13 10:17:39,453 INFO] Validation accuracy: 42.5628
[2024-03-13 10:17:39,454 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_12800.pt
[2024-03-13 10:17:41,969 INFO] Step 12850/14000; acc: 95.7; ppl:   1.2; xent: 0.1; lr: 1.00000; sents:    2400; bsz:  443/ 617/48; 3781/5268 tok/s;    255 sec;
[2024-03-13 10:17:44,349 INFO] Step 12900/14000; acc: 95.6; ppl:   1.2; xent: 0.1; lr: 1.00000; sents:    2404; bsz:  459/ 632/48; 9652/13287 tok/s;    258 sec;
[2024-03-13 10:17:46,708 INFO] Step 12950/14000; acc: 95.6; ppl:   1.2; xent: 0.1; lr: 1.00000; sents:    2401; bsz:  442/ 618/48; 9382/13103 tok/s;    260 sec;
[2024-03-13 10:17:49,152 INFO] Step 13000/14000; acc: 95.6; ppl:   1.2; xent: 0.1; lr: 1.00000; sents:    2399; bsz:  468/ 636/48; 9573/13002 tok/s;    263 sec;
[2024-03-13 10:17:52,467 INFO] valid stats calculation
                           took: 3.3152048587799072 s.
[2024-03-13 10:17:52,468 INFO] Train perplexity: 2.0779
[2024-03-13 10:17:52,468 INFO] Train accuracy: 83.4274
[2024-03-13 10:17:52,468 INFO] Sentences processed: 189105
[2024-03-13 10:17:52,468 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:17:52,468 INFO] Validation perplexity: 250.165
[2024-03-13 10:17:52,468 INFO] Validation accuracy: 42.6594
[2024-03-13 10:17:52,469 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_13000.pt
[2024-03-13 10:17:55,068 INFO] Step 13050/14000; acc: 95.8; ppl:   1.2; xent: 0.1; lr: 1.00000; sents:    2299; bsz:  453/ 617/46; 3825/5212 tok/s;    268 sec;
[2024-03-13 10:17:57,514 INFO] Step 13100/14000; acc: 95.9; ppl:   1.2; xent: 0.1; lr: 1.00000; sents:    2293; bsz:  443/ 608/46; 9062/12423 tok/s;    271 sec;
[2024-03-13 10:17:59,927 INFO] Step 13150/14000; acc: 95.7; ppl:   1.2; xent: 0.1; lr: 1.00000; sents:    2392; bsz:  449/ 625/48; 9299/12956 tok/s;    273 sec;
[2024-03-13 10:18:02,311 INFO] Step 13200/14000; acc: 95.8; ppl:   1.2; xent: 0.1; lr: 1.00000; sents:    2391; bsz:  441/ 611/48; 9241/12827 tok/s;    276 sec;
[2024-03-13 10:18:05,704 INFO] valid stats calculation
                           took: 3.3928773403167725 s.
[2024-03-13 10:18:05,705 INFO] Train perplexity: 2.02095
[2024-03-13 10:18:05,705 INFO] Train accuracy: 84.012
[2024-03-13 10:18:05,705 INFO] Sentences processed: 198480
[2024-03-13 10:18:05,705 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:18:05,705 INFO] Validation perplexity: 224.353
[2024-03-13 10:18:05,705 INFO] Validation accuracy: 44.5911
[2024-03-13 10:18:05,706 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_13200.pt
[2024-03-13 10:18:08,333 INFO] Step 13250/14000; acc: 95.9; ppl:   1.2; xent: 0.1; lr: 1.00000; sents:    2391; bsz:  455/ 630/48; 3782/5230 tok/s;    282 sec;
[2024-03-13 10:18:10,786 INFO] Step 13300/14000; acc: 96.0; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    2391; bsz:  444/ 620/48; 9057/12642 tok/s;    284 sec;
[2024-03-13 10:18:13,615 INFO] Step 13350/14000; acc: 96.2; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    2303; bsz:  449/ 608/46; 7940/10740 tok/s;    287 sec;
[2024-03-13 10:18:17,330 INFO] Step 13400/14000; acc: 96.1; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    2399; bsz:  457/ 635/48; 6153/8546 tok/s;    291 sec;
[2024-03-13 10:18:20,802 INFO] valid stats calculation
                           took: 3.4711997509002686 s.
[2024-03-13 10:18:20,802 INFO] Train perplexity: 1.96941
[2024-03-13 10:18:20,802 INFO] Train accuracy: 84.5609
[2024-03-13 10:18:20,802 INFO] Sentences processed: 207964
[2024-03-13 10:18:20,803 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:18:20,803 INFO] Validation perplexity: 230.709
[2024-03-13 10:18:20,803 INFO] Validation accuracy: 44.5267
[2024-03-13 10:18:20,804 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_13400.pt
[2024-03-13 10:18:24,631 INFO] Step 13450/14000; acc: 96.1; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    2304; bsz:  443/ 610/46; 3035/4178 tok/s;    298 sec;
[2024-03-13 10:18:27,166 INFO] Step 13500/14000; acc: 96.2; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    2403; bsz:  440/ 613/48; 8689/12090 tok/s;    301 sec;
[2024-03-13 10:18:30,254 INFO] Step 13550/14000; acc: 96.1; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    2305; bsz:  448/ 614/46; 7259/9939 tok/s;    304 sec;
[2024-03-13 10:18:33,891 INFO] Step 13600/14000; acc: 96.2; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    2399; bsz:  445/ 619/48; 6112/8510 tok/s;    307 sec;
[2024-03-13 10:18:37,344 INFO] valid stats calculation
                           took: 3.452538251876831 s.
[2024-03-13 10:18:37,344 INFO] Train perplexity: 1.9237
[2024-03-13 10:18:37,344 INFO] Train accuracy: 85.0597
[2024-03-13 10:18:37,344 INFO] Sentences processed: 217375
[2024-03-13 10:18:37,344 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:18:37,344 INFO] Validation perplexity: 261.54
[2024-03-13 10:18:37,345 INFO] Validation accuracy: 43.1745
[2024-03-13 10:18:37,346 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_13600.pt
[2024-03-13 10:18:41,140 INFO] Step 13650/14000; acc: 96.0; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    2395; bsz:  461/ 637/48; 3183/4397 tok/s;    315 sec;
[2024-03-13 10:18:43,606 INFO] Step 13700/14000; acc: 96.3; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    2393; bsz:  454/ 629/48; 9215/12764 tok/s;    317 sec;
[2024-03-13 10:18:46,869 INFO] Step 13750/14000; acc: 96.5; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    2294; bsz:  442/ 610/46; 6770/9349 tok/s;    320 sec;
[2024-03-13 10:18:50,428 INFO] Step 13800/14000; acc: 96.5; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    2391; bsz:  443/ 616/48; 6224/8654 tok/s;    324 sec;
[2024-03-13 10:18:53,919 INFO] valid stats calculation
                           took: 3.490199565887451 s.
[2024-03-13 10:18:53,919 INFO] Train perplexity: 1.88158
[2024-03-13 10:18:53,919 INFO] Train accuracy: 85.5317
[2024-03-13 10:18:53,920 INFO] Sentences processed: 226848
[2024-03-13 10:18:53,920 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:18:53,920 INFO] Validation perplexity: 263.264
[2024-03-13 10:18:53,920 INFO] Validation accuracy: 43.3033
[2024-03-13 10:18:53,921 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_13800.pt
[2024-03-13 10:18:57,593 INFO] Step 13850/14000; acc: 96.3; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    2295; bsz:  446/ 609/46; 3111/4251 tok/s;    331 sec;
[2024-03-13 10:19:00,036 INFO] Step 13900/14000; acc: 96.3; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    2392; bsz:  444/ 618/48; 9088/12652 tok/s;    333 sec;
[2024-03-13 10:19:03,460 INFO] Step 13950/14000; acc: 96.3; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    2400; bsz:  459/ 632/48; 6706/9232 tok/s;    337 sec;
[2024-03-13 10:19:07,282 INFO] Step 14000/14000; acc: 96.2; ppl:   1.1; xent: 0.1; lr: 1.00000; sents:    2399; bsz:  466/ 639/48; 6102/8356 tok/s;    341 sec;
[2024-03-13 10:19:10,716 INFO] valid stats calculation
                           took: 3.4327943325042725 s.
[2024-03-13 10:19:10,716 INFO] Train perplexity: 1.84377
[2024-03-13 10:19:10,716 INFO] Train accuracy: 85.9649
[2024-03-13 10:19:10,716 INFO] Sentences processed: 236334
[2024-03-13 10:19:10,716 INFO] Average bsz:  449/ 620/47
[2024-03-13 10:19:10,716 INFO] Validation perplexity: 258.228
[2024-03-13 10:19:10,716 INFO] Validation accuracy: 43.6896
[2024-03-13 10:19:10,718 INFO] Saving checkpoint gt-ft-both/gt-ft-both_9000_02_step_14000.pt
