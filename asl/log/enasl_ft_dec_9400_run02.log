[2024-03-12 14:08:55,506 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-12 14:08:55,507 INFO] Parsed 2 corpora from -data.
[2024-03-12 14:08:55,507 INFO] Loading checkpoint from tg-pt-dec/models/tg-pt-dec_01_step_9400.pt
[2024-03-12 14:08:55,572 INFO] Building model...
[2024-03-12 14:08:55,627 INFO] Switching model to float32 for amp/apex_amp
[2024-03-12 14:08:55,627 INFO] Non quantized layer compute is fp32
[2024-03-12 14:08:57,618 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-12 14:08:57,619 INFO] encoder: 8952800
[2024-03-12 14:08:57,620 INFO] decoder: 16687344
[2024-03-12 14:08:57,620 INFO] * number of parameters: 25640144
[2024-03-12 14:08:57,620 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 14:08:57,620 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 14:08:57,620 INFO]  * src vocab size = 17816
[2024-03-12 14:08:57,620 INFO]  * tgt vocab size = 14144
[2024-03-12 14:08:57,622 INFO] Starting training on GPU: [0]
[2024-03-12 14:08:57,622 INFO] Start training loop and validate every 200 steps...
[2024-03-12 14:08:57,622 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-12 14:09:04,721 INFO] Step 9450/14400; acc: 9.1; ppl: 2804998.6; xent: 14.8; lr: 1.00000; sents:    2270; bsz:  565/ 490/45; 3980/3449 tok/s;      7 sec;
[2024-03-12 14:09:08,308 INFO] Step 9500/14400; acc: 8.9; ppl: 332278.9; xent: 12.7; lr: 1.00000; sents:    2369; bsz:  590/ 512/47; 8231/7146 tok/s;     11 sec;
[2024-03-12 14:09:11,197 INFO] Step 9550/14400; acc: 8.1; ppl: 90215.4; xent: 11.4; lr: 1.00000; sents:    2363; bsz:  564/ 491/47; 9752/8504 tok/s;     14 sec;
[2024-03-12 14:09:13,788 INFO] Step 9600/14400; acc: 8.9; ppl: 38014.9; xent: 10.5; lr: 1.00000; sents:    2365; bsz:  585/ 507/47; 11289/9788 tok/s;     16 sec;
[2024-03-12 14:09:17,217 INFO] valid stats calculation
                           took: 3.4277517795562744 s.
[2024-03-12 14:09:17,217 INFO] Train perplexity: 234709
[2024-03-12 14:09:17,217 INFO] Train accuracy: 8.7505
[2024-03-12 14:09:17,217 INFO] Sentences processed: 9367
[2024-03-12 14:09:17,217 INFO] Average bsz:  576/ 500/47
[2024-03-12 14:09:17,217 INFO] Validation perplexity: 35787.8
[2024-03-12 14:09:17,217 INFO] Validation accuracy: 11.4721
[2024-03-12 14:09:17,218 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_9600.pt
[2024-03-12 14:09:20,893 INFO] Step 9650/14400; acc: 9.1; ppl: 48071.7; xent: 10.8; lr: 1.00000; sents:    2367; bsz:  564/ 491/47; 3972/3456 tok/s;     23 sec;
[2024-03-12 14:09:24,538 INFO] Step 9700/14400; acc: 9.8; ppl: 28347.6; xent: 10.3; lr: 1.00000; sents:    2251; bsz:  549/ 475/45; 7532/6513 tok/s;     27 sec;
[2024-03-12 14:09:27,759 INFO] Step 9750/14400; acc: 10.1; ppl: 22313.8; xent: 10.0; lr: 1.00000; sents:    2378; bsz:  568/ 494/48; 8811/7675 tok/s;     30 sec;
[2024-03-12 14:09:30,283 INFO] Step 9800/14400; acc: 9.5; ppl: 58907.1; xent: 11.0; lr: 1.00000; sents:    2280; bsz:  562/ 487/46; 11136/9658 tok/s;     33 sec;
[2024-03-12 14:09:33,774 INFO] valid stats calculation
                           took: 3.4904158115386963 s.
[2024-03-12 14:09:33,774 INFO] Train perplexity: 93850.7
[2024-03-12 14:09:33,774 INFO] Train accuracy: 9.18043
[2024-03-12 14:09:33,774 INFO] Sentences processed: 18643
[2024-03-12 14:09:33,774 INFO] Average bsz:  568/ 494/47
[2024-03-12 14:09:33,774 INFO] Validation perplexity: 6413.12
[2024-03-12 14:09:33,774 INFO] Validation accuracy: 5.05415
[2024-03-12 14:09:33,776 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_9800.pt
[2024-03-12 14:09:37,483 INFO] Step 9850/14400; acc: 7.0; ppl: 125234.0; xent: 11.7; lr: 1.00000; sents:    2381; bsz:  586/ 509/48; 4073/3538 tok/s;     40 sec;
[2024-03-12 14:09:41,048 INFO] Step 9900/14400; acc: 7.2; ppl: 864893.5; xent: 13.7; lr: 1.00000; sents:    2261; bsz:  552/ 477/45; 7740/6688 tok/s;     43 sec;
[2024-03-12 14:09:44,167 INFO] Step 9950/14400; acc: 6.9; ppl: 84798.5; xent: 11.3; lr: 1.00000; sents:    2372; bsz:  564/ 491/47; 9046/7867 tok/s;     47 sec;
[2024-03-12 14:09:46,633 INFO] Step 10000/14400; acc: 9.3; ppl: 13621.7; xent: 9.5; lr: 1.00000; sents:    2366; bsz:  578/ 500/47; 11718/10147 tok/s;     49 sec;
[2024-03-12 14:09:50,097 INFO] valid stats calculation
                           took: 3.4628758430480957 s.
[2024-03-12 14:09:50,097 INFO] Train perplexity: 96915.1
[2024-03-12 14:09:50,097 INFO] Train accuracy: 8.64853
[2024-03-12 14:09:50,097 INFO] Sentences processed: 28023
[2024-03-12 14:09:50,097 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:09:50,097 INFO] Validation perplexity: 374275
[2024-03-12 14:09:50,097 INFO] Validation accuracy: 10.5495
[2024-03-12 14:09:50,099 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_10000.pt
[2024-03-12 14:09:53,874 INFO] Step 10050/14400; acc: 7.7; ppl: 450904.1; xent: 13.0; lr: 1.00000; sents:    2367; bsz:  587/ 513/47; 4054/3539 tok/s;     56 sec;
[2024-03-12 14:09:57,434 INFO] Step 10100/14400; acc: 7.2; ppl: 41303.4; xent: 10.6; lr: 1.00000; sents:    2268; bsz:  567/ 491/45; 7965/6899 tok/s;     60 sec;
[2024-03-12 14:10:00,892 INFO] Step 10150/14400; acc: 10.0; ppl: 35690.8; xent: 10.5; lr: 1.00000; sents:    2367; bsz:  567/ 499/47; 8203/7210 tok/s;     63 sec;
[2024-03-12 14:10:03,303 INFO] Step 10200/14400; acc: 8.7; ppl: 16581.4; xent: 9.7; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 11878/10294 tok/s;     66 sec;
[2024-03-12 14:10:06,779 INFO] valid stats calculation
                           took: 3.475341558456421 s.
[2024-03-12 14:10:06,779 INFO] Train perplexity: 85369.8
[2024-03-12 14:10:06,779 INFO] Train accuracy: 8.58313
[2024-03-12 14:10:06,779 INFO] Sentences processed: 37390
[2024-03-12 14:10:06,779 INFO] Average bsz:  570/ 495/47
[2024-03-12 14:10:06,779 INFO] Validation perplexity: 13303.7
[2024-03-12 14:10:06,779 INFO] Validation accuracy: 10.7501
[2024-03-12 14:10:06,780 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_10200.pt
[2024-03-12 14:10:10,552 INFO] Step 10250/14400; acc: 7.9; ppl: 90273.0; xent: 11.4; lr: 1.00000; sents:    2269; bsz:  557/ 482/45; 3841/3323 tok/s;     73 sec;
[2024-03-12 14:10:14,205 INFO] Step 10300/14400; acc: 9.2; ppl: 5333.1; xent: 8.6; lr: 1.00000; sents:    2371; bsz:  563/ 491/47; 7712/6717 tok/s;     77 sec;
[2024-03-12 14:10:17,695 INFO] Step 10350/14400; acc: 9.3; ppl: 19372.1; xent: 9.9; lr: 1.00000; sents:    2279; bsz:  563/ 487/46; 8064/6972 tok/s;     80 sec;
[2024-03-12 14:10:20,222 INFO] Step 10400/14400; acc: 9.1; ppl: 13612.9; xent: 9.5; lr: 1.00000; sents:    2381; bsz:  566/ 495/48; 11190/9786 tok/s;     83 sec;
[2024-03-12 14:10:23,782 INFO] valid stats calculation
                           took: 3.5592143535614014 s.
[2024-03-12 14:10:23,782 INFO] Train perplexity: 63241.8
[2024-03-12 14:10:23,782 INFO] Train accuracy: 8.63859
[2024-03-12 14:10:23,782 INFO] Sentences processed: 46690
[2024-03-12 14:10:23,782 INFO] Average bsz:  568/ 494/47
[2024-03-12 14:10:23,783 INFO] Validation perplexity: 2581.95
[2024-03-12 14:10:23,783 INFO] Validation accuracy: 14.5207
[2024-03-12 14:10:23,784 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_10400.pt
[2024-03-12 14:10:27,606 INFO] Step 10450/14400; acc: 9.1; ppl: 19673.7; xent: 9.9; lr: 1.00000; sents:    2376; bsz:  581/ 505/48; 3933/3417 tok/s;     90 sec;
[2024-03-12 14:10:31,161 INFO] Step 10500/14400; acc: 9.8; ppl: 33028.5; xent: 10.4; lr: 1.00000; sents:    2375; bsz:  565/ 490/48; 7949/6897 tok/s;     94 sec;
[2024-03-12 14:10:34,610 INFO] Step 10550/14400; acc: 8.4; ppl: 5190.7; xent: 8.6; lr: 1.00000; sents:    2271; bsz:  574/ 492/45; 8324/7130 tok/s;     97 sec;
[2024-03-12 14:10:36,994 INFO] Step 10600/14400; acc: 8.7; ppl: 6085.9; xent: 8.7; lr: 1.00000; sents:    2366; bsz:  563/ 491/47; 11814/10292 tok/s;     99 sec;
[2024-03-12 14:10:40,511 INFO] valid stats calculation
                           took: 3.5156095027923584 s.
[2024-03-12 14:10:40,511 INFO] Train perplexity: 47932.8
[2024-03-12 14:10:40,511 INFO] Train accuracy: 8.70065
[2024-03-12 14:10:40,511 INFO] Sentences processed: 56078
[2024-03-12 14:10:40,511 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:10:40,511 INFO] Validation perplexity: 3453.03
[2024-03-12 14:10:40,511 INFO] Validation accuracy: 11.5122
[2024-03-12 14:10:40,513 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_10600.pt
[2024-03-12 14:10:44,179 INFO] Step 10650/14400; acc: 10.2; ppl: 8579.1; xent: 9.1; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 3927/3414 tok/s;    107 sec;
[2024-03-12 14:10:47,787 INFO] Step 10700/14400; acc: 9.3; ppl: 60591.3; xent: 11.0; lr: 1.00000; sents:    2364; bsz:  584/ 506/47; 8092/7007 tok/s;    110 sec;
[2024-03-12 14:10:51,398 INFO] Step 10750/14400; acc: 9.7; ppl: 4115.8; xent: 8.3; lr: 1.00000; sents:    2269; bsz:  564/ 488/45; 7810/6758 tok/s;    114 sec;
[2024-03-12 14:10:53,815 INFO] Step 10800/14400; acc: 7.8; ppl: 10440.9; xent: 9.3; lr: 1.00000; sents:    2367; bsz:  579/ 500/47; 11987/10342 tok/s;    116 sec;
[2024-03-12 14:10:57,372 INFO] valid stats calculation
                           took: 3.555933713912964 s.
[2024-03-12 14:10:57,372 INFO] Train perplexity: 39478.8
[2024-03-12 14:10:57,372 INFO] Train accuracy: 8.7801
[2024-03-12 14:10:57,372 INFO] Sentences processed: 65444
[2024-03-12 14:10:57,372 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:10:57,372 INFO] Validation perplexity: 1991.11
[2024-03-12 14:10:57,372 INFO] Validation accuracy: 9.7874
[2024-03-12 14:10:57,374 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_10800.pt
[2024-03-12 14:11:00,988 INFO] Step 10850/14400; acc: 8.0; ppl: 31256.5; xent: 10.3; lr: 1.00000; sents:    2272; bsz:  545/ 472/45; 3799/3291 tok/s;    123 sec;
[2024-03-12 14:11:04,565 INFO] Step 10900/14400; acc: 8.8; ppl: 7388.0; xent: 8.9; lr: 1.00000; sents:    2371; bsz:  581/ 502/47; 8125/7020 tok/s;    127 sec;
[2024-03-12 14:11:08,236 INFO] Step 10950/14400; acc: 9.6; ppl: 9932.4; xent: 9.2; lr: 1.00000; sents:    2375; bsz:  566/ 493/48; 7713/6715 tok/s;    131 sec;
[2024-03-12 14:11:10,812 INFO] Step 11000/14400; acc: 8.3; ppl: 12902.8; xent: 9.5; lr: 1.00000; sents:    2382; bsz:  582/ 504/48; 11296/9777 tok/s;    133 sec;
[2024-03-12 14:11:14,272 INFO] valid stats calculation
                           took: 3.458995819091797 s.
[2024-03-12 14:11:14,272 INFO] Train perplexity: 34361
[2024-03-12 14:11:14,272 INFO] Train accuracy: 8.76738
[2024-03-12 14:11:14,272 INFO] Sentences processed: 74844
[2024-03-12 14:11:14,272 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:11:14,272 INFO] Validation perplexity: 1.11735e+06
[2024-03-12 14:11:14,272 INFO] Validation accuracy: 4.29202
[2024-03-12 14:11:14,273 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_11000.pt
[2024-03-12 14:11:17,946 INFO] Step 11050/14400; acc: 7.2; ppl: 22985.9; xent: 10.0; lr: 1.00000; sents:    2274; bsz:  557/ 483/45; 3907/3388 tok/s;    140 sec;
[2024-03-12 14:11:21,599 INFO] Step 11100/14400; acc: 9.0; ppl: 14062.6; xent: 9.6; lr: 1.00000; sents:    2280; bsz:  563/ 487/46; 7708/6663 tok/s;    144 sec;
[2024-03-12 14:11:25,205 INFO] Step 11150/14400; acc: 10.2; ppl: 4324.7; xent: 8.4; lr: 1.00000; sents:    2464; bsz:  595/ 521/49; 8245/7232 tok/s;    148 sec;
[2024-03-12 14:11:27,956 INFO] Step 11200/14400; acc: 7.7; ppl: 46630.0; xent: 10.8; lr: 1.00000; sents:    2270; bsz:  563/ 487/45; 10230/8853 tok/s;    150 sec;
[2024-03-12 14:11:31,588 INFO] valid stats calculation
                           took: 3.631277561187744 s.
[2024-03-12 14:11:31,588 INFO] Train perplexity: 31473.8
[2024-03-12 14:11:31,588 INFO] Train accuracy: 8.74137
[2024-03-12 14:11:31,589 INFO] Sentences processed: 84132
[2024-03-12 14:11:31,589 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:11:31,589 INFO] Validation perplexity: 2320.08
[2024-03-12 14:11:31,589 INFO] Validation accuracy: 12.5552
[2024-03-12 14:11:31,590 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_11200.pt
[2024-03-12 14:11:35,162 INFO] Step 11250/14400; acc: 10.5; ppl: 8904.9; xent: 9.1; lr: 1.00000; sents:    2369; bsz:  566/ 492/47; 3931/3414 tok/s;    158 sec;
[2024-03-12 14:11:38,713 INFO] Step 11300/14400; acc: 9.8; ppl: 6896.6; xent: 8.8; lr: 1.00000; sents:    2242; bsz:  568/ 491/45; 8003/6912 tok/s;    161 sec;
[2024-03-12 14:11:42,216 INFO] Step 11350/14400; acc: 8.3; ppl: 5470.2; xent: 8.6; lr: 1.00000; sents:    2365; bsz:  564/ 490/47; 8054/7003 tok/s;    165 sec;
[2024-03-12 14:11:45,160 INFO] Step 11400/14400; acc: 9.4; ppl: 6725.0; xent: 8.8; lr: 1.00000; sents:    2367; bsz:  561/ 488/47; 9526/8285 tok/s;    168 sec;
[2024-03-12 14:11:48,696 INFO] valid stats calculation
                           took: 3.535660982131958 s.
[2024-03-12 14:11:48,696 INFO] Train perplexity: 27069.4
[2024-03-12 14:11:48,697 INFO] Train accuracy: 8.81762
[2024-03-12 14:11:48,697 INFO] Sentences processed: 93475
[2024-03-12 14:11:48,697 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:11:48,697 INFO] Validation perplexity: 16767.3
[2024-03-12 14:11:48,697 INFO] Validation accuracy: 9.86763
[2024-03-12 14:11:48,698 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_11400.pt
[2024-03-12 14:11:52,388 INFO] Step 11450/14400; acc: 10.5; ppl: 10062.6; xent: 9.2; lr: 1.00000; sents:    2268; bsz:  558/ 482/45; 3858/3335 tok/s;    175 sec;
[2024-03-12 14:11:56,029 INFO] Step 11500/14400; acc: 9.2; ppl: 3433.9; xent: 8.1; lr: 1.00000; sents:    2379; bsz:  587/ 510/48; 8056/7006 tok/s;    178 sec;
[2024-03-12 14:11:59,598 INFO] Step 11550/14400; acc: 11.3; ppl: 1555.7; xent: 7.3; lr: 1.00000; sents:    2383; bsz:  583/ 507/48; 8170/7101 tok/s;    182 sec;
[2024-03-12 14:12:02,765 INFO] Step 11600/14400; acc: 10.4; ppl: 2233.2; xent: 7.7; lr: 1.00000; sents:    2381; bsz:  566/ 492/48; 8936/7767 tok/s;    185 sec;
[2024-03-12 14:12:06,338 INFO] valid stats calculation
                           took: 3.5722062587738037 s.
[2024-03-12 14:12:06,338 INFO] Train perplexity: 22308.7
[2024-03-12 14:12:06,338 INFO] Train accuracy: 8.9561
[2024-03-12 14:12:06,338 INFO] Sentences processed: 102886
[2024-03-12 14:12:06,338 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:12:06,338 INFO] Validation perplexity: 9161.3
[2024-03-12 14:12:06,338 INFO] Validation accuracy: 1.84517
[2024-03-12 14:12:06,340 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_11600.pt
[2024-03-12 14:12:09,993 INFO] Step 11650/14400; acc: 8.2; ppl: 9836.6; xent: 9.2; lr: 1.00000; sents:    2261; bsz:  552/ 476/45; 3816/3296 tok/s;    192 sec;
[2024-03-12 14:12:13,639 INFO] Step 11700/14400; acc: 7.9; ppl: 9378.7; xent: 9.1; lr: 1.00000; sents:    2372; bsz:  586/ 513/47; 8040/7038 tok/s;    196 sec;
[2024-03-12 14:12:17,297 INFO] Step 11750/14400; acc: 8.9; ppl: 4401.8; xent: 8.4; lr: 1.00000; sents:    2270; bsz:  567/ 491/45; 7754/6708 tok/s;    200 sec;
[2024-03-12 14:12:20,639 INFO] Step 11800/14400; acc: 11.0; ppl: 2095.5; xent: 7.6; lr: 1.00000; sents:    2367; bsz:  568/ 500/47; 8499/7477 tok/s;    203 sec;
[2024-03-12 14:12:24,180 INFO] valid stats calculation
                           took: 3.540351629257202 s.
[2024-03-12 14:12:24,181 INFO] Train perplexity: 19813.9
[2024-03-12 14:12:24,181 INFO] Train accuracy: 8.9604
[2024-03-12 14:12:24,181 INFO] Sentences processed: 112156
[2024-03-12 14:12:24,181 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:12:24,181 INFO] Validation perplexity: 2070.43
[2024-03-12 14:12:24,181 INFO] Validation accuracy: 14.1596
[2024-03-12 14:12:24,182 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_11800.pt
[2024-03-12 14:12:27,886 INFO] Step 11850/14400; acc: 10.6; ppl: 3133.6; xent: 8.0; lr: 1.00000; sents:    2364; bsz:  573/ 494/47; 3954/3408 tok/s;    210 sec;
[2024-03-12 14:12:31,393 INFO] Step 11900/14400; acc: 10.4; ppl: 2721.8; xent: 7.9; lr: 1.00000; sents:    2367; bsz:  559/ 486/47; 7976/6936 tok/s;    214 sec;
[2024-03-12 14:12:34,975 INFO] Step 11950/14400; acc: 11.6; ppl: 1879.9; xent: 7.5; lr: 1.00000; sents:    2261; bsz:  556/ 481/45; 7753/6716 tok/s;    217 sec;
[2024-03-12 14:12:38,653 INFO] Step 12000/14400; acc: 11.9; ppl: 4345.8; xent: 8.4; lr: 1.00000; sents:    2373; bsz:  567/ 495/47; 7704/6737 tok/s;    221 sec;
[2024-03-12 14:12:42,318 INFO] valid stats calculation
                           took: 3.66424560546875 s.
[2024-03-12 14:12:42,318 INFO] Train perplexity: 17114
[2024-03-12 14:12:42,318 INFO] Train accuracy: 9.1254
[2024-03-12 14:12:42,318 INFO] Sentences processed: 121521
[2024-03-12 14:12:42,318 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:12:42,318 INFO] Validation perplexity: 2745.77
[2024-03-12 14:12:42,318 INFO] Validation accuracy: 10.5495
[2024-03-12 14:12:42,319 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_12000.pt
[2024-03-12 14:12:46,129 INFO] Step 12050/14400; acc: 10.9; ppl: 3623.3; xent: 8.2; lr: 1.00000; sents:    2371; bsz:  580/ 506/47; 3880/3382 tok/s;    229 sec;
[2024-03-12 14:12:49,809 INFO] Step 12100/14400; acc: 9.6; ppl: 3674.7; xent: 8.2; lr: 1.00000; sents:    2279; bsz:  562/ 486/46; 7644/6602 tok/s;    232 sec;
[2024-03-12 14:12:53,315 INFO] Step 12150/14400; acc: 10.8; ppl: 3148.7; xent: 8.1; lr: 1.00000; sents:    2381; bsz:  566/ 491/48; 8073/7004 tok/s;    236 sec;
[2024-03-12 14:12:56,961 INFO] Step 12200/14400; acc: 11.5; ppl: 2451.1; xent: 7.8; lr: 1.00000; sents:    2276; bsz:  574/ 493/46; 7880/6760 tok/s;    239 sec;
[2024-03-12 14:13:00,554 INFO] valid stats calculation
                           took: 3.592970848083496 s.
[2024-03-12 14:13:00,554 INFO] Train perplexity: 15177.1
[2024-03-12 14:13:00,555 INFO] Train accuracy: 9.23825
[2024-03-12 14:13:00,555 INFO] Sentences processed: 130828
[2024-03-12 14:13:00,555 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:13:00,555 INFO] Validation perplexity: 12767
[2024-03-12 14:13:00,555 INFO] Validation accuracy: 5.73606
[2024-03-12 14:13:00,556 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_12200.pt
[2024-03-12 14:13:04,163 INFO] Step 12250/14400; acc: 11.6; ppl: 3623.6; xent: 8.2; lr: 1.00000; sents:    2375; bsz:  566/ 491/48; 3928/3408 tok/s;    247 sec;
[2024-03-12 14:13:07,938 INFO] Step 12300/14400; acc: 12.2; ppl: 3602.7; xent: 8.2; lr: 1.00000; sents:    2273; bsz:  565/ 489/45; 7485/6477 tok/s;    250 sec;
[2024-03-12 14:13:11,527 INFO] Step 12350/14400; acc: 12.6; ppl: 2843.7; xent: 8.0; lr: 1.00000; sents:    2464; bsz:  584/ 508/49; 8143/7081 tok/s;    254 sec;
[2024-03-12 14:13:15,158 INFO] Step 12400/14400; acc: 9.4; ppl: 3427.3; xent: 8.1; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 7758/6725 tok/s;    258 sec;
[2024-03-12 14:13:18,740 INFO] valid stats calculation
                           took: 3.580904960632324 s.
[2024-03-12 14:13:18,740 INFO] Train perplexity: 13723
[2024-03-12 14:13:18,740 INFO] Train accuracy: 9.38534
[2024-03-12 14:13:18,740 INFO] Sentences processed: 140208
[2024-03-12 14:13:18,740 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:13:18,740 INFO] Validation perplexity: 1531.37
[2024-03-12 14:13:18,740 INFO] Validation accuracy: 13.0766
[2024-03-12 14:13:18,742 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_12400.pt
[2024-03-12 14:13:22,256 INFO] Step 12450/14400; acc: 10.1; ppl: 5977.1; xent: 8.7; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 3945/3401 tok/s;    265 sec;
[2024-03-12 14:13:25,701 INFO] Step 12500/14400; acc: 10.8; ppl: 5467.4; xent: 8.6; lr: 1.00000; sents:    2469; bsz:  583/ 505/49; 8455/7334 tok/s;    268 sec;
[2024-03-12 14:13:29,285 INFO] Step 12550/14400; acc: 9.6; ppl: 4181.0; xent: 8.3; lr: 1.00000; sents:    2267; bsz:  561/ 484/45; 7823/6751 tok/s;    272 sec;
[2024-03-12 14:13:32,966 INFO] Step 12600/14400; acc: 11.4; ppl: 1760.4; xent: 7.5; lr: 1.00000; sents:    2372; bsz:  583/ 504/47; 7918/6851 tok/s;    275 sec;
[2024-03-12 14:13:36,570 INFO] valid stats calculation
                           took: 3.603794574737549 s.
[2024-03-12 14:13:36,571 INFO] Train perplexity: 12688.6
[2024-03-12 14:13:36,571 INFO] Train accuracy: 9.45458
[2024-03-12 14:13:36,571 INFO] Sentences processed: 149578
[2024-03-12 14:13:36,571 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:13:36,571 INFO] Validation perplexity: 1745.34
[2024-03-12 14:13:36,571 INFO] Validation accuracy: 15.1625
[2024-03-12 14:13:36,572 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_12600.pt
[2024-03-12 14:13:39,931 INFO] Step 12650/14400; acc: 9.8; ppl: 8631.2; xent: 9.1; lr: 1.00000; sents:    2269; bsz:  542/ 474/45; 3892/3401 tok/s;    282 sec;
[2024-03-12 14:13:43,563 INFO] Step 12700/14400; acc: 9.8; ppl: 4158.0; xent: 8.3; lr: 1.00000; sents:    2375; bsz:  582/ 503/48; 8012/6931 tok/s;    286 sec;
[2024-03-12 14:13:47,100 INFO] Step 12750/14400; acc: 11.9; ppl: 1677.2; xent: 7.4; lr: 1.00000; sents:    2279; bsz:  561/ 487/46; 7936/6884 tok/s;    289 sec;
[2024-03-12 14:13:50,667 INFO] Step 12800/14400; acc: 11.3; ppl: 2477.8; xent: 7.8; lr: 1.00000; sents:    2378; bsz:  570/ 496/48; 7986/6955 tok/s;    293 sec;
[2024-03-12 14:13:54,185 INFO] valid stats calculation
                           took: 3.5171217918395996 s.
[2024-03-12 14:13:54,185 INFO] Train perplexity: 11763.9
[2024-03-12 14:13:54,185 INFO] Train accuracy: 9.52692
[2024-03-12 14:13:54,185 INFO] Sentences processed: 158879
[2024-03-12 14:13:54,185 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:13:54,185 INFO] Validation perplexity: 55491.7
[2024-03-12 14:13:54,185 INFO] Validation accuracy: 7.54112
[2024-03-12 14:13:54,187 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_12800.pt
[2024-03-12 14:13:57,417 INFO] Step 12850/14400; acc: 8.9; ppl: 5542.4; xent: 8.6; lr: 1.00000; sents:    2381; bsz:  592/ 515/48; 4388/3814 tok/s;    300 sec;
[2024-03-12 14:14:00,973 INFO] Step 12900/14400; acc: 11.5; ppl: 1981.9; xent: 7.6; lr: 1.00000; sents:    2368; bsz:  565/ 491/47; 7940/6902 tok/s;    303 sec;
[2024-03-12 14:14:04,566 INFO] Step 12950/14400; acc: 10.9; ppl: 3192.8; xent: 8.1; lr: 1.00000; sents:    2246; bsz:  570/ 491/45; 7937/6836 tok/s;    307 sec;
[2024-03-12 14:14:08,079 INFO] Step 13000/14400; acc: 11.2; ppl: 1782.8; xent: 7.5; lr: 1.00000; sents:    2368; bsz:  567/ 493/47; 8067/7020 tok/s;    310 sec;
[2024-03-12 14:14:11,623 INFO] valid stats calculation
                           took: 3.5429937839508057 s.
[2024-03-12 14:14:11,624 INFO] Train perplexity: 10862.9
[2024-03-12 14:14:11,624 INFO] Train accuracy: 9.58716
[2024-03-12 14:14:11,624 INFO] Sentences processed: 168242
[2024-03-12 14:14:11,625 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:14:11,625 INFO] Validation perplexity: 2126.57
[2024-03-12 14:14:11,625 INFO] Validation accuracy: 11.9535
[2024-03-12 14:14:11,627 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_13000.pt
[2024-03-12 14:14:14,636 INFO] Step 13050/14400; acc: 11.4; ppl: 1616.1; xent: 7.4; lr: 1.00000; sents:    2363; bsz:  576/ 498/47; 4397/3797 tok/s;    317 sec;
[2024-03-12 14:14:18,106 INFO] Step 13100/14400; acc: 11.8; ppl: 1187.2; xent: 7.1; lr: 1.00000; sents:    2251; bsz:  535/ 467/45; 7714/6723 tok/s;    320 sec;
[2024-03-12 14:14:21,705 INFO] Step 13150/14400; acc: 13.2; ppl: 1046.4; xent: 7.0; lr: 1.00000; sents:    2372; bsz:  582/ 505/47; 8093/7020 tok/s;    324 sec;
[2024-03-12 14:14:25,360 INFO] Step 13200/14400; acc: 9.9; ppl: 2103.1; xent: 7.7; lr: 1.00000; sents:    2377; bsz:  587/ 513/48; 8027/7020 tok/s;    328 sec;
[2024-03-12 14:14:28,845 INFO] valid stats calculation
                           took: 3.4839065074920654 s.
[2024-03-12 14:14:28,845 INFO] Train perplexity: 9763.38
[2024-03-12 14:14:28,845 INFO] Train accuracy: 9.69273
[2024-03-12 14:14:28,845 INFO] Sentences processed: 177605
[2024-03-12 14:14:28,845 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:14:28,845 INFO] Validation perplexity: 1384.37
[2024-03-12 14:14:28,845 INFO] Validation accuracy: 16.7669
[2024-03-12 14:14:28,847 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_13200.pt
[2024-03-12 14:14:31,620 INFO] Step 13250/14400; acc: 11.2; ppl: 1151.7; xent: 7.0; lr: 1.00000; sents:    2379; bsz:  565/ 493/48; 4514/3941 tok/s;    334 sec;
[2024-03-12 14:14:35,217 INFO] Step 13300/14400; acc: 10.6; ppl: 7102.5; xent: 8.9; lr: 1.00000; sents:    2274; bsz:  555/ 478/45; 7721/6651 tok/s;    338 sec;
[2024-03-12 14:14:38,836 INFO] Step 13350/14400; acc: 11.1; ppl: 4008.2; xent: 8.3; lr: 1.00000; sents:    2277; bsz:  566/ 489/46; 7815/6756 tok/s;    341 sec;
[2024-03-12 14:14:42,457 INFO] Step 13400/14400; acc: 10.5; ppl: 2207.9; xent: 7.7; lr: 1.00000; sents:    2377; bsz:  585/ 512/48; 8083/7067 tok/s;    345 sec;
[2024-03-12 14:14:46,283 INFO] valid stats calculation
                           took: 3.8257882595062256 s.
[2024-03-12 14:14:46,283 INFO] Train perplexity: 9187.36
[2024-03-12 14:14:46,283 INFO] Train accuracy: 9.75008
[2024-03-12 14:14:46,283 INFO] Sentences processed: 186912
[2024-03-12 14:14:46,283 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:14:46,283 INFO] Validation perplexity: 7578.88
[2024-03-12 14:14:46,283 INFO] Validation accuracy: 13.919
[2024-03-12 14:14:46,285 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_13400.pt
[2024-03-12 14:14:49,101 INFO] Step 13450/14400; acc: 11.6; ppl: 3003.9; xent: 8.0; lr: 1.00000; sents:    2372; bsz:  568/ 497/47; 4271/3738 tok/s;    351 sec;
[2024-03-12 14:14:52,769 INFO] Step 13500/14400; acc: 11.3; ppl: 1701.8; xent: 7.4; lr: 1.00000; sents:    2264; bsz:  559/ 483/45; 7621/6589 tok/s;    355 sec;
[2024-03-12 14:14:56,372 INFO] Step 13550/14400; acc: 11.2; ppl: 2758.1; xent: 7.9; lr: 1.00000; sents:    2366; bsz:  575/ 495/47; 7974/6874 tok/s;    359 sec;
[2024-03-12 14:14:59,920 INFO] Step 13600/14400; acc: 13.5; ppl: 1132.4; xent: 7.0; lr: 1.00000; sents:    2364; bsz:  558/ 487/47; 7867/6861 tok/s;    362 sec;
[2024-03-12 14:15:03,366 INFO] valid stats calculation
                           took: 3.4458608627319336 s.
[2024-03-12 14:15:03,366 INFO] Train perplexity: 8549.35
[2024-03-12 14:15:03,366 INFO] Train accuracy: 9.85078
[2024-03-12 14:15:03,366 INFO] Sentences processed: 196278
[2024-03-12 14:15:03,366 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:15:03,366 INFO] Validation perplexity: 3595.23
[2024-03-12 14:15:03,366 INFO] Validation accuracy: 10.8704
[2024-03-12 14:15:03,368 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_13600.pt
[2024-03-12 14:15:06,001 INFO] Step 13650/14400; acc: 12.5; ppl: 1557.8; xent: 7.4; lr: 1.00000; sents:    2367; bsz:  578/ 503/47; 4753/4137 tok/s;    368 sec;
[2024-03-12 14:15:09,580 INFO] Step 13700/14400; acc: 10.8; ppl: 4616.1; xent: 8.4; lr: 1.00000; sents:    2268; bsz:  546/ 473/45; 7630/6612 tok/s;    372 sec;
[2024-03-12 14:15:13,299 INFO] Step 13750/14400; acc: 12.7; ppl: 1200.8; xent: 7.1; lr: 1.00000; sents:    2373; bsz:  581/ 507/47; 7812/6811 tok/s;    376 sec;
[2024-03-12 14:15:16,991 INFO] Step 13800/14400; acc: 12.5; ppl: 1268.2; xent: 7.1; lr: 1.00000; sents:    2271; bsz:  564/ 489/45; 7643/6620 tok/s;    379 sec;
[2024-03-12 14:15:20,449 INFO] valid stats calculation
                           took: 3.457385778427124 s.
[2024-03-12 14:15:20,450 INFO] Train perplexity: 7965.07
[2024-03-12 14:15:20,450 INFO] Train accuracy: 9.95419
[2024-03-12 14:15:20,450 INFO] Sentences processed: 205557
[2024-03-12 14:15:20,450 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:15:20,450 INFO] Validation perplexity: 1336.56
[2024-03-12 14:15:20,450 INFO] Validation accuracy: 14.0794
[2024-03-12 14:15:20,451 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_13800.pt
[2024-03-12 14:15:23,031 INFO] Step 13850/14400; acc: 14.0; ppl: 1003.3; xent: 6.9; lr: 1.00000; sents:    2375; bsz:  579/ 498/48; 4794/4126 tok/s;    385 sec;
[2024-03-12 14:15:26,408 INFO] Step 13900/14400; acc: 11.0; ppl: 3176.4; xent: 8.1; lr: 1.00000; sents:    2382; bsz:  561/ 487/48; 8306/7218 tok/s;    389 sec;
[2024-03-12 14:15:30,002 INFO] Step 13950/14400; acc: 13.9; ppl: 1807.9; xent: 7.5; lr: 1.00000; sents:    2376; bsz:  567/ 491/48; 7890/6835 tok/s;    392 sec;
[2024-03-12 14:15:33,700 INFO] Step 14000/14400; acc: 11.5; ppl: 1467.4; xent: 7.3; lr: 1.00000; sents:    2375; bsz:  586/ 508/48; 7930/6872 tok/s;    396 sec;
[2024-03-12 14:15:37,480 INFO] valid stats calculation
                           took: 3.779599189758301 s.
[2024-03-12 14:15:37,481 INFO] Train perplexity: 7444.83
[2024-03-12 14:15:37,481 INFO] Train accuracy: 10.0697
[2024-03-12 14:15:37,481 INFO] Sentences processed: 215065
[2024-03-12 14:15:37,481 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:15:37,481 INFO] Validation perplexity: 1358.97
[2024-03-12 14:15:37,481 INFO] Validation accuracy: 14.9218
[2024-03-12 14:15:37,482 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_14000.pt
[2024-03-12 14:15:40,104 INFO] Step 14050/14400; acc: 13.7; ppl: 1082.2; xent: 7.0; lr: 1.00000; sents:    2273; bsz:  564/ 489/45; 4407/3817 tok/s;    402 sec;
[2024-03-12 14:15:43,433 INFO] Step 14100/14400; acc: 11.4; ppl: 3209.8; xent: 8.1; lr: 1.00000; sents:    2366; bsz:  579/ 500/47; 8699/7506 tok/s;    406 sec;
[2024-03-12 14:15:47,021 INFO] Step 14150/14400; acc: 11.7; ppl: 1962.6; xent: 7.6; lr: 1.00000; sents:    2366; bsz:  563/ 489/47; 7846/6815 tok/s;    409 sec;
[2024-03-12 14:15:50,602 INFO] Step 14200/14400; acc: 11.9; ppl: 1409.3; xent: 7.3; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 7820/6744 tok/s;    413 sec;
[2024-03-12 14:15:54,022 INFO] valid stats calculation
                           took: 3.419865131378174 s.
[2024-03-12 14:15:54,023 INFO] Train perplexity: 7014.9
[2024-03-12 14:15:54,023 INFO] Train accuracy: 10.1567
[2024-03-12 14:15:54,023 INFO] Sentences processed: 224332
[2024-03-12 14:15:54,023 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:15:54,023 INFO] Validation perplexity: 1326.93
[2024-03-12 14:15:54,023 INFO] Validation accuracy: 12.0337
[2024-03-12 14:15:54,024 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_14200.pt
[2024-03-12 14:15:56,551 INFO] Step 14250/14400; acc: 11.4; ppl: 1780.8; xent: 7.5; lr: 1.00000; sents:    2367; bsz:  586/ 507/47; 4922/4261 tok/s;    419 sec;
[2024-03-12 14:15:59,707 INFO] Step 14300/14400; acc: 13.5; ppl: 1091.0; xent: 7.0; lr: 1.00000; sents:    2369; bsz:  563/ 492/47; 8925/7793 tok/s;    422 sec;
[2024-03-12 14:16:03,312 INFO] Step 14350/14400; acc: 12.0; ppl: 1156.0; xent: 7.1; lr: 1.00000; sents:    2270; bsz:  557/ 483/45; 7728/6703 tok/s;    426 sec;
[2024-03-12 14:16:07,058 INFO] Step 14400/14400; acc: 13.0; ppl: 2039.7; xent: 7.6; lr: 1.00000; sents:    2371; bsz:  590/ 510/47; 7872/6812 tok/s;    429 sec;
[2024-03-12 14:16:10,482 INFO] valid stats calculation
                           took: 3.4233384132385254 s.
[2024-03-12 14:16:10,483 INFO] Train perplexity: 6586.48
[2024-03-12 14:16:10,483 INFO] Train accuracy: 10.2509
[2024-03-12 14:16:10,483 INFO] Sentences processed: 233709
[2024-03-12 14:16:10,483 INFO] Average bsz:  569/ 494/47
[2024-03-12 14:16:10,483 INFO] Validation perplexity: 3839.93
[2024-03-12 14:16:10,483 INFO] Validation accuracy: 7.78179
[2024-03-12 14:16:10,484 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_9400_02_step_14400.pt
