[2024-03-12 09:42:37,756 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-12 09:42:37,756 INFO] Parsed 2 corpora from -data.
[2024-03-12 09:42:37,756 INFO] Loading checkpoint from tg-pt-enc/models/tg-pt-enc_01_step_5200.pt
[2024-03-12 09:42:37,820 INFO] Building model...
[2024-03-12 09:42:37,875 INFO] Switching model to float32 for amp/apex_amp
[2024-03-12 09:42:37,875 INFO] Non quantized layer compute is fp32
[2024-03-12 09:42:40,225 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-12 09:42:40,225 INFO] encoder: 8952800
[2024-03-12 09:42:40,225 INFO] decoder: 16687344
[2024-03-12 09:42:40,225 INFO] * number of parameters: 25640144
[2024-03-12 09:42:40,225 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 09:42:40,225 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 09:42:40,225 INFO]  * src vocab size = 17816
[2024-03-12 09:42:40,225 INFO]  * tgt vocab size = 14144
[2024-03-12 09:42:40,227 INFO] Starting training on GPU: [0]
[2024-03-12 09:42:40,227 INFO] Start training loop and validate every 200 steps...
[2024-03-12 09:42:40,227 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-12 09:42:47,209 INFO] Step 5250/10200; acc: 9.7; ppl: 377305.9; xent: 12.8; lr: 1.00000; sents:    2366; bsz:  591/ 513/47; 4229/3673 tok/s;      7 sec;
[2024-03-12 09:42:50,187 INFO] Step 5300/10200; acc: 10.4; ppl: 18815.8; xent: 9.8; lr: 1.00000; sents:    2369; bsz:  568/ 496/47; 9543/8327 tok/s;     10 sec;
[2024-03-12 09:42:52,716 INFO] Step 5350/10200; acc: 10.8; ppl: 11871.8; xent: 9.4; lr: 1.00000; sents:    2267; bsz:  560/ 485/45; 11073/9586 tok/s;     12 sec;
[2024-03-12 09:42:56,242 INFO] Step 5400/10200; acc: 8.3; ppl: 45820.2; xent: 10.7; lr: 1.00000; sents:    2365; bsz:  585/ 507/47; 8298/7194 tok/s;     16 sec;
[2024-03-12 09:42:59,706 INFO] valid stats calculation
                           took: 3.4636406898498535 s.
[2024-03-12 09:42:59,706 INFO] Train perplexity: 45485.7
[2024-03-12 09:42:59,706 INFO] Train accuracy: 9.7561
[2024-03-12 09:42:59,706 INFO] Sentences processed: 9367
[2024-03-12 09:42:59,706 INFO] Average bsz:  576/ 500/47
[2024-03-12 09:42:59,706 INFO] Validation perplexity: 1820.8
[2024-03-12 09:42:59,706 INFO] Validation accuracy: 8.34336
[2024-03-12 09:42:59,708 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_5400.pt
[2024-03-12 09:43:03,348 INFO] Step 5450/10200; acc: 8.6; ppl: 9548.0; xent: 9.2; lr: 1.00000; sents:    2367; bsz:  564/ 491/47; 3971/3455 tok/s;     23 sec;
[2024-03-12 09:43:06,564 INFO] Step 5500/10200; acc: 9.3; ppl: 14991.8; xent: 9.6; lr: 1.00000; sents:    2251; bsz:  549/ 475/45; 8537/7383 tok/s;     26 sec;
[2024-03-12 09:43:09,126 INFO] Step 5550/10200; acc: 10.8; ppl: 4315.3; xent: 8.4; lr: 1.00000; sents:    2275; bsz:  561/ 487/46; 10956/9504 tok/s;     29 sec;
[2024-03-12 09:43:12,751 INFO] Step 5600/10200; acc: 11.3; ppl: 1958.1; xent: 7.6; lr: 1.00000; sents:    2383; bsz:  587/ 510/48; 8096/7033 tok/s;     33 sec;
[2024-03-12 09:43:16,171 INFO] valid stats calculation
                           took: 3.4200856685638428 s.
[2024-03-12 09:43:16,172 INFO] Train perplexity: 16397.4
[2024-03-12 09:43:16,172 INFO] Train accuracy: 9.87783
[2024-03-12 09:43:16,172 INFO] Sentences processed: 18643
[2024-03-12 09:43:16,172 INFO] Average bsz:  571/ 495/47
[2024-03-12 09:43:16,172 INFO] Validation perplexity: 1969.46
[2024-03-12 09:43:16,172 INFO] Validation accuracy: 9.86763
[2024-03-12 09:43:16,173 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_5600.pt
[2024-03-12 09:43:19,797 INFO] Step 5650/10200; acc: 12.2; ppl: 1017.3; xent: 6.9; lr: 1.00000; sents:    2381; bsz:  568/ 495/48; 4031/3510 tok/s;     40 sec;
[2024-03-12 09:43:23,036 INFO] Step 5700/10200; acc: 16.0; ppl: 394.2; xent: 6.0; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 8941/7721 tok/s;     43 sec;
[2024-03-12 09:43:25,387 INFO] Step 5750/10200; acc: 18.8; ppl: 259.5; xent: 5.6; lr: 1.00000; sents:    2258; bsz:  537/ 467/45; 11420/9941 tok/s;     45 sec;
[2024-03-12 09:43:28,798 INFO] Step 5800/10200; acc: 21.2; ppl: 155.6; xent: 5.0; lr: 1.00000; sents:    2366; bsz:  578/ 500/47; 8472/7337 tok/s;     49 sec;
[2024-03-12 09:43:32,232 INFO] valid stats calculation
                           took: 3.4331767559051514 s.
[2024-03-12 09:43:32,232 INFO] Train perplexity: 4618.44
[2024-03-12 09:43:32,232 INFO] Train accuracy: 12.2473
[2024-03-12 09:43:32,232 INFO] Sentences processed: 28023
[2024-03-12 09:43:32,232 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:43:32,232 INFO] Validation perplexity: 346.741
[2024-03-12 09:43:32,232 INFO] Validation accuracy: 17.2884
[2024-03-12 09:43:32,234 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_5800.pt
[2024-03-12 09:43:36,035 INFO] Step 5850/10200; acc: 24.1; ppl: 115.6; xent: 4.8; lr: 1.00000; sents:    2271; bsz:  567/ 491/45; 3917/3390 tok/s;     56 sec;
[2024-03-12 09:43:39,467 INFO] Step 5900/10200; acc: 27.0; ppl:  76.1; xent: 4.3; lr: 1.00000; sents:    2460; bsz:  588/ 522/49; 8565/7606 tok/s;     59 sec;
[2024-03-12 09:43:41,920 INFO] Step 5950/10200; acc: 29.2; ppl:  58.7; xent: 4.1; lr: 1.00000; sents:    2271; bsz:  567/ 490/45; 11551/9982 tok/s;     62 sec;
[2024-03-12 09:43:45,062 INFO] Step 6000/10200; acc: 33.3; ppl:  40.1; xent: 3.7; lr: 1.00000; sents:    2365; bsz:  561/ 487/47; 8924/7744 tok/s;     65 sec;
[2024-03-12 09:43:48,829 INFO] valid stats calculation
                           took: 3.7670443058013916 s.
[2024-03-12 09:43:48,830 INFO] Train perplexity: 1597.98
[2024-03-12 09:43:48,830 INFO] Train accuracy: 16.295
[2024-03-12 09:43:48,830 INFO] Sentences processed: 37390
[2024-03-12 09:43:48,830 INFO] Average bsz:  569/ 495/47
[2024-03-12 09:43:48,830 INFO] Validation perplexity: 223.539
[2024-03-12 09:43:48,830 INFO] Validation accuracy: 25.4713
[2024-03-12 09:43:48,831 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_6000.pt
[2024-03-12 09:43:52,606 INFO] Step 6050/10200; acc: 34.5; ppl:  35.1; xent: 3.6; lr: 1.00000; sents:    2269; bsz:  569/ 491/45; 3770/3257 tok/s;     72 sec;
[2024-03-12 09:43:56,229 INFO] Step 6100/10200; acc: 37.5; ppl:  26.0; xent: 3.3; lr: 1.00000; sents:    2371; bsz:  563/ 491/47; 7778/6774 tok/s;     76 sec;
[2024-03-12 09:43:58,743 INFO] Step 6150/10200; acc: 39.6; ppl:  21.0; xent: 3.0; lr: 1.00000; sents:    2376; bsz:  565/ 495/48; 11244/9845 tok/s;     79 sec;
[2024-03-12 09:44:01,912 INFO] Step 6200/10200; acc: 41.4; ppl:  18.4; xent: 2.9; lr: 1.00000; sents:    2381; bsz:  582/ 506/48; 9182/7978 tok/s;     82 sec;
[2024-03-12 09:44:05,342 INFO] valid stats calculation
                           took: 3.4289791584014893 s.
[2024-03-12 09:44:05,342 INFO] Train perplexity: 690.912
[2024-03-12 09:44:05,342 INFO] Train accuracy: 20.6994
[2024-03-12 09:44:05,342 INFO] Sentences processed: 46787
[2024-03-12 09:44:05,342 INFO] Average bsz:  569/ 495/47
[2024-03-12 09:44:05,342 INFO] Validation perplexity: 250.237
[2024-03-12 09:44:05,342 INFO] Validation accuracy: 25.4312
[2024-03-12 09:44:05,344 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_6200.pt
[2024-03-12 09:44:09,053 INFO] Step 6250/10200; acc: 43.0; ppl:  15.7; xent: 2.8; lr: 1.00000; sents:    2279; bsz:  562/ 485/46; 3935/3397 tok/s;     89 sec;
[2024-03-12 09:44:12,571 INFO] Step 6300/10200; acc: 45.9; ppl:  12.8; xent: 2.6; lr: 1.00000; sents:    2375; bsz:  565/ 490/48; 8034/6970 tok/s;     92 sec;
[2024-03-12 09:44:15,182 INFO] Step 6350/10200; acc: 47.3; ppl:  11.4; xent: 2.4; lr: 1.00000; sents:    2271; bsz:  574/ 492/45; 10992/9414 tok/s;     95 sec;
[2024-03-12 09:44:18,129 INFO] Step 6400/10200; acc: 49.8; ppl:   9.3; xent: 2.2; lr: 1.00000; sents:    2366; bsz:  563/ 491/47; 9559/8328 tok/s;     98 sec;
[2024-03-12 09:44:21,555 INFO] valid stats calculation
                           took: 3.4253125190734863 s.
[2024-03-12 09:44:21,556 INFO] Train perplexity: 354.141
[2024-03-12 09:44:21,556 INFO] Train accuracy: 24.9617
[2024-03-12 09:44:21,556 INFO] Sentences processed: 56078
[2024-03-12 09:44:21,556 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:44:21,556 INFO] Validation perplexity: 284.751
[2024-03-12 09:44:21,556 INFO] Validation accuracy: 28.9611
[2024-03-12 09:44:21,557 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_6400.pt
[2024-03-12 09:44:25,150 INFO] Step 6450/10200; acc: 51.2; ppl:   8.6; xent: 2.2; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 4018/3493 tok/s;    105 sec;
[2024-03-12 09:44:28,820 INFO] Step 6500/10200; acc: 52.2; ppl:   8.2; xent: 2.1; lr: 1.00000; sents:    2264; bsz:  582/ 502/45; 7933/6846 tok/s;    109 sec;
[2024-03-12 09:44:31,588 INFO] Step 6550/10200; acc: 55.1; ppl:   6.8; xent: 1.9; lr: 1.00000; sents:    2369; bsz:  566/ 491/47; 10219/8874 tok/s;    111 sec;
[2024-03-12 09:44:34,211 INFO] Step 6600/10200; acc: 55.7; ppl:   6.4; xent: 1.9; lr: 1.00000; sents:    2367; bsz:  579/ 500/47; 11047/9531 tok/s;    114 sec;
[2024-03-12 09:44:37,657 INFO] valid stats calculation
                           took: 3.4455947875976562 s.
[2024-03-12 09:44:37,658 INFO] Train perplexity: 203.572
[2024-03-12 09:44:37,658 INFO] Train accuracy: 29.059
[2024-03-12 09:44:37,658 INFO] Sentences processed: 65444
[2024-03-12 09:44:37,658 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:44:37,658 INFO] Validation perplexity: 332.904
[2024-03-12 09:44:37,658 INFO] Validation accuracy: 28.921
[2024-03-12 09:44:37,659 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_6600.pt
[2024-03-12 09:44:41,457 INFO] Step 6650/10200; acc: 58.1; ppl:   5.5; xent: 1.7; lr: 1.00000; sents:    2272; bsz:  562/ 485/45; 3879/3344 tok/s;    121 sec;
[2024-03-12 09:44:44,998 INFO] Step 6700/10200; acc: 59.7; ppl:   5.1; xent: 1.6; lr: 1.00000; sents:    2371; bsz:  564/ 490/47; 7965/6913 tok/s;    125 sec;
[2024-03-12 09:44:47,934 INFO] Step 6750/10200; acc: 61.4; ppl:   4.6; xent: 1.5; lr: 1.00000; sents:    2375; bsz:  566/ 493/48; 9646/8397 tok/s;    128 sec;
[2024-03-12 09:44:50,487 INFO] Step 6800/10200; acc: 62.1; ppl:   4.4; xent: 1.5; lr: 1.00000; sents:    2280; bsz:  576/ 497/46; 11277/9738 tok/s;    130 sec;
[2024-03-12 09:44:53,920 INFO] valid stats calculation
                           took: 3.4324448108673096 s.
[2024-03-12 09:44:53,920 INFO] Train perplexity: 128.043
[2024-03-12 09:44:53,920 INFO] Train accuracy: 32.9467
[2024-03-12 09:44:53,920 INFO] Sentences processed: 74742
[2024-03-12 09:44:53,920 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:44:53,920 INFO] Validation perplexity: 491.404
[2024-03-12 09:44:53,920 INFO] Validation accuracy: 29.0012
[2024-03-12 09:44:53,922 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_6800.pt
[2024-03-12 09:44:57,601 INFO] Step 6850/10200; acc: 64.0; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    2376; bsz:  564/ 490/48; 3962/3443 tok/s;    137 sec;
[2024-03-12 09:45:01,084 INFO] Step 6900/10200; acc: 65.6; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    2376; bsz:  568/ 496/48; 8160/7120 tok/s;    141 sec;
[2024-03-12 09:45:04,463 INFO] Step 6950/10200; acc: 66.5; ppl:   3.5; xent: 1.3; lr: 1.00000; sents:    2272; bsz:  563/ 488/45; 8333/7227 tok/s;    144 sec;
[2024-03-12 09:45:06,848 INFO] Step 7000/10200; acc: 67.4; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    2366; bsz:  589/ 511/47; 12347/10713 tok/s;    147 sec;
[2024-03-12 09:45:10,327 INFO] valid stats calculation
                           took: 3.477769613265991 s.
[2024-03-12 09:45:10,327 INFO] Train perplexity: 86.1042
[2024-03-12 09:45:10,327 INFO] Train accuracy: 36.6229
[2024-03-12 09:45:10,327 INFO] Sentences processed: 84132
[2024-03-12 09:45:10,327 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:45:10,328 INFO] Validation perplexity: 625.217
[2024-03-12 09:45:10,328 INFO] Validation accuracy: 28.4396
[2024-03-12 09:45:10,329 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_7000.pt
[2024-03-12 09:45:14,058 INFO] Step 7050/10200; acc: 68.9; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    2369; bsz:  587/ 508/47; 4071/3521 tok/s;    154 sec;
[2024-03-12 09:45:17,576 INFO] Step 7100/10200; acc: 70.2; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    2242; bsz:  548/ 475/45; 7789/6754 tok/s;    157 sec;
[2024-03-12 09:45:20,970 INFO] Step 7150/10200; acc: 71.6; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    2365; bsz:  564/ 490/47; 8310/7226 tok/s;    161 sec;
[2024-03-12 09:45:23,400 INFO] Step 7200/10200; acc: 72.4; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    2258; bsz:  553/ 479/45; 11380/9854 tok/s;    163 sec;
[2024-03-12 09:45:26,899 INFO] valid stats calculation
                           took: 3.4982845783233643 s.
[2024-03-12 09:45:26,899 INFO] Train perplexity: 61.6025
[2024-03-12 09:45:26,899 INFO] Train accuracy: 39.9985
[2024-03-12 09:45:26,899 INFO] Sentences processed: 93366
[2024-03-12 09:45:26,899 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:45:26,899 INFO] Validation perplexity: 885.346
[2024-03-12 09:45:26,899 INFO] Validation accuracy: 28.4797
[2024-03-12 09:45:26,901 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_7200.pt
[2024-03-12 09:45:30,604 INFO] Step 7250/10200; acc: 73.9; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2377; bsz:  566/ 491/48; 3925/3408 tok/s;    170 sec;
[2024-03-12 09:45:34,309 INFO] Step 7300/10200; acc: 74.4; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2379; bsz:  587/ 510/48; 7918/6886 tok/s;    174 sec;
[2024-03-12 09:45:37,867 INFO] Step 7350/10200; acc: 75.6; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2383; bsz:  567/ 495/48; 7972/6952 tok/s;    178 sec;
[2024-03-12 09:45:40,405 INFO] Step 7400/10200; acc: 76.4; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2267; bsz:  555/ 481/45; 10936/9472 tok/s;    180 sec;
[2024-03-12 09:45:43,907 INFO] valid stats calculation
                           took: 3.502476692199707 s.
[2024-03-12 09:45:43,908 INFO] Train perplexity: 45.89
[2024-03-12 09:45:43,908 INFO] Train accuracy: 43.1895
[2024-03-12 09:45:43,908 INFO] Sentences processed: 102772
[2024-03-12 09:45:43,908 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:45:43,908 INFO] Validation perplexity: 1200.9
[2024-03-12 09:45:43,908 INFO] Validation accuracy: 29.282
[2024-03-12 09:45:43,909 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_7400.pt
[2024-03-12 09:45:47,581 INFO] Step 7450/10200; acc: 77.4; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 4031/3483 tok/s;    187 sec;
[2024-03-12 09:45:51,181 INFO] Step 7500/10200; acc: 78.3; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    2372; bsz:  566/ 496/47; 7868/6894 tok/s;    191 sec;
[2024-03-12 09:45:54,935 INFO] Step 7550/10200; acc: 78.9; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2270; bsz:  587/ 508/45; 7820/6763 tok/s;    195 sec;
[2024-03-12 09:45:57,553 INFO] Step 7600/10200; acc: 80.1; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2367; bsz:  568/ 500/47; 10849/9544 tok/s;    197 sec;
[2024-03-12 09:46:01,055 INFO] valid stats calculation
                           took: 3.5017833709716797 s.
[2024-03-12 09:46:01,056 INFO] Train perplexity: 35.3602
[2024-03-12 09:46:01,056 INFO] Train accuracy: 46.1884
[2024-03-12 09:46:01,056 INFO] Sentences processed: 112156
[2024-03-12 09:46:01,056 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:46:01,056 INFO] Validation perplexity: 1644.35
[2024-03-12 09:46:01,056 INFO] Validation accuracy: 28.56
[2024-03-12 09:46:01,057 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_7600.pt
[2024-03-12 09:46:04,632 INFO] Step 7650/10200; acc: 80.7; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2364; bsz:  561/ 487/47; 3960/3441 tok/s;    204 sec;
[2024-03-12 09:46:08,339 INFO] Step 7700/10200; acc: 81.2; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2263; bsz:  566/ 485/45; 7631/6547 tok/s;    208 sec;
[2024-03-12 09:46:11,840 INFO] Step 7750/10200; acc: 82.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2365; bsz:  562/ 489/47; 8021/6984 tok/s;    212 sec;
[2024-03-12 09:46:14,766 INFO] Step 7800/10200; acc: 82.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2373; bsz:  582/ 507/47; 9939/8659 tok/s;    215 sec;
[2024-03-12 09:46:18,306 INFO] valid stats calculation
                           took: 3.5394604206085205 s.
[2024-03-12 09:46:18,307 INFO] Train perplexity: 28.2552
[2024-03-12 09:46:18,307 INFO] Train accuracy: 48.8969
[2024-03-12 09:46:18,307 INFO] Sentences processed: 121521
[2024-03-12 09:46:18,307 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:46:18,307 INFO] Validation perplexity: 2143.27
[2024-03-12 09:46:18,307 INFO] Validation accuracy: 29.2018
[2024-03-12 09:46:18,308 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_7800.pt
[2024-03-12 09:46:22,346 INFO] Step 7850/10200; acc: 83.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2275; bsz:  562/ 486/46; 3710/3203 tok/s;    222 sec;
[2024-03-12 09:46:26,119 INFO] Step 7900/10200; acc: 83.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2375; bsz:  565/ 494/48; 7487/6552 tok/s;    226 sec;
[2024-03-12 09:46:29,719 INFO] Step 7950/10200; acc: 84.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2281; bsz:  563/ 486/46; 7815/6752 tok/s;    229 sec;
[2024-03-12 09:46:32,525 INFO] Step 8000/10200; acc: 84.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2476; bsz:  582/ 503/50; 10366/8972 tok/s;    232 sec;
[2024-03-12 09:46:36,158 INFO] valid stats calculation
                           took: 3.6328325271606445 s.
[2024-03-12 09:46:36,159 INFO] Train perplexity: 23.1475
[2024-03-12 09:46:36,159 INFO] Train accuracy: 51.4084
[2024-03-12 09:46:36,159 INFO] Sentences processed: 130928
[2024-03-12 09:46:36,159 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:46:36,159 INFO] Validation perplexity: 2355.81
[2024-03-12 09:46:36,159 INFO] Validation accuracy: 30.2046
[2024-03-12 09:46:36,160 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_8000.pt
[2024-03-12 09:46:39,861 INFO] Step 8050/10200; acc: 85.1; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2275; bsz:  562/ 485/46; 3832/3308 tok/s;    240 sec;
[2024-03-12 09:46:43,464 INFO] Step 8100/10200; acc: 85.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2371; bsz:  566/ 491/47; 7850/6813 tok/s;    243 sec;
[2024-03-12 09:46:47,171 INFO] Step 8150/10200; acc: 85.4; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2268; bsz:  583/ 504/45; 7865/6805 tok/s;    247 sec;
[2024-03-12 09:46:50,247 INFO] Step 8200/10200; acc: 86.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 9176/7973 tok/s;    250 sec;
[2024-03-12 09:46:53,827 INFO] valid stats calculation
                           took: 3.579995632171631 s.
[2024-03-12 09:46:53,828 INFO] Train perplexity: 19.4035
[2024-03-12 09:46:53,828 INFO] Train accuracy: 53.678
[2024-03-12 09:46:53,828 INFO] Sentences processed: 140208
[2024-03-12 09:46:53,828 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:46:53,828 INFO] Validation perplexity: 2513.86
[2024-03-12 09:46:53,828 INFO] Validation accuracy: 29.2419
[2024-03-12 09:46:53,829 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_8200.pt
[2024-03-12 09:46:57,574 INFO] Step 8250/10200; acc: 87.1; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 3821/3294 tok/s;    257 sec;
[2024-03-12 09:47:01,034 INFO] Step 8300/10200; acc: 86.8; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2367; bsz:  563/ 488/47; 8134/7059 tok/s;    261 sec;
[2024-03-12 09:47:04,620 INFO] Step 8350/10200; acc: 87.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2369; bsz:  580/ 501/47; 8093/6983 tok/s;    264 sec;
[2024-03-12 09:47:08,003 INFO] Step 8400/10200; acc: 87.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2372; bsz:  583/ 504/47; 8614/7454 tok/s;    268 sec;
[2024-03-12 09:47:11,637 INFO] valid stats calculation
                           took: 3.632974624633789 s.
[2024-03-12 09:47:11,637 INFO] Train perplexity: 16.5623
[2024-03-12 09:47:11,637 INFO] Train accuracy: 55.7823
[2024-03-12 09:47:11,637 INFO] Sentences processed: 149578
[2024-03-12 09:47:11,637 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:47:11,637 INFO] Validation perplexity: 2642.01
[2024-03-12 09:47:11,637 INFO] Validation accuracy: 29.9639
[2024-03-12 09:47:11,638 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_8400.pt
[2024-03-12 09:47:15,322 INFO] Step 8450/10200; acc: 88.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2371; bsz:  566/ 492/47; 3865/3364 tok/s;    275 sec;
[2024-03-12 09:47:18,925 INFO] Step 8500/10200; acc: 88.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2273; bsz:  558/ 485/45; 7749/6728 tok/s;    279 sec;
[2024-03-12 09:47:22,515 INFO] Step 8550/10200; acc: 89.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2279; bsz:  561/ 487/46; 7820/6783 tok/s;    282 sec;
[2024-03-12 09:47:26,014 INFO] Step 8600/10200; acc: 88.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2378; bsz:  590/ 512/48; 8431/7312 tok/s;    286 sec;
[2024-03-12 09:47:29,559 INFO] valid stats calculation
                           took: 3.5443570613861084 s.
[2024-03-12 09:47:29,559 INFO] Train perplexity: 14.3619
[2024-03-12 09:47:29,559 INFO] Train accuracy: 57.7134
[2024-03-12 09:47:29,559 INFO] Sentences processed: 158879
[2024-03-12 09:47:29,559 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:47:29,559 INFO] Validation perplexity: 3270.02
[2024-03-12 09:47:29,559 INFO] Validation accuracy: 30.2046
[2024-03-12 09:47:29,561 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_8600.pt
[2024-03-12 09:47:33,275 INFO] Step 8650/10200; acc: 89.5; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2381; bsz:  572/ 499/48; 3939/3438 tok/s;    293 sec;
[2024-03-12 09:47:36,802 INFO] Step 8700/10200; acc: 89.4; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2247; bsz:  550/ 477/45; 7791/6756 tok/s;    297 sec;
[2024-03-12 09:47:40,419 INFO] Step 8750/10200; acc: 89.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2367; bsz:  586/ 506/47; 8094/6989 tok/s;    300 sec;
[2024-03-12 09:47:43,959 INFO] Step 8800/10200; acc: 90.5; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2368; bsz:  567/ 493/47; 8006/6968 tok/s;    304 sec;
[2024-03-12 09:47:47,526 INFO] valid stats calculation
                           took: 3.5663931369781494 s.
[2024-03-12 09:47:47,526 INFO] Train perplexity: 12.6274
[2024-03-12 09:47:47,526 INFO] Train accuracy: 59.4933
[2024-03-12 09:47:47,526 INFO] Sentences processed: 168242
[2024-03-12 09:47:47,526 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:47:47,526 INFO] Validation perplexity: 4365.86
[2024-03-12 09:47:47,526 INFO] Validation accuracy: 28.8408
[2024-03-12 09:47:47,528 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_8800.pt
[2024-03-12 09:47:51,196 INFO] Step 8850/10200; acc: 90.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2363; bsz:  576/ 498/47; 3983/3440 tok/s;    311 sec;
[2024-03-12 09:47:54,742 INFO] Step 8900/10200; acc: 90.5; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2251; bsz:  552/ 480/45; 7786/6769 tok/s;    315 sec;
[2024-03-12 09:47:58,196 INFO] Step 8950/10200; acc: 91.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  566/ 492/47; 8188/7117 tok/s;    318 sec;
[2024-03-12 09:48:01,883 INFO] Step 9000/10200; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  587/ 513/48; 7960/6961 tok/s;    322 sec;
[2024-03-12 09:48:05,498 INFO] valid stats calculation
                           took: 3.614386558532715 s.
[2024-03-12 09:48:05,498 INFO] Train perplexity: 11.234
[2024-03-12 09:48:05,498 INFO] Train accuracy: 61.1335
[2024-03-12 09:48:05,498 INFO] Sentences processed: 177605
[2024-03-12 09:48:05,499 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:48:05,499 INFO] Validation perplexity: 6126.49
[2024-03-12 09:48:05,499 INFO] Validation accuracy: 28.2792
[2024-03-12 09:48:05,500 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_9000.pt
[2024-03-12 09:48:09,016 INFO] Step 9050/10200; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2272; bsz:  539/ 467/45; 3778/3275 tok/s;    329 sec;
[2024-03-12 09:48:12,641 INFO] Step 9100/10200; acc: 91.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  582/ 505/48; 8024/6962 tok/s;    332 sec;
[2024-03-12 09:48:16,217 INFO] Step 9150/10200; acc: 91.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  564/ 492/48; 7885/6878 tok/s;    336 sec;
[2024-03-12 09:48:19,918 INFO] Step 9200/10200; acc: 91.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2278; bsz:  567/ 490/46; 7664/6625 tok/s;    340 sec;
[2024-03-12 09:48:23,478 INFO] valid stats calculation
                           took: 3.5598785877227783 s.
[2024-03-12 09:48:23,478 INFO] Train perplexity: 10.118
[2024-03-12 09:48:23,479 INFO] Train accuracy: 62.6184
[2024-03-12 09:48:23,479 INFO] Sentences processed: 186912
[2024-03-12 09:48:23,479 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:48:23,479 INFO] Validation perplexity: 5452.16
[2024-03-12 09:48:23,479 INFO] Validation accuracy: 27.9583
[2024-03-12 09:48:23,480 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_9200.pt
[2024-03-12 09:48:27,029 INFO] Step 9250/10200; acc: 91.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  587/ 515/47; 4130/3622 tok/s;    347 sec;
[2024-03-12 09:48:30,608 INFO] Step 9300/10200; acc: 91.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  563/ 489/47; 7859/6829 tok/s;    350 sec;
[2024-03-12 09:48:34,183 INFO] Step 9350/10200; acc: 91.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2263; bsz:  557/ 483/45; 7798/6754 tok/s;    354 sec;
[2024-03-12 09:48:37,618 INFO] Step 9400/10200; acc: 91.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2364; bsz:  572/ 494/47; 8321/7185 tok/s;    357 sec;
[2024-03-12 09:48:41,168 INFO] valid stats calculation
                           took: 3.5493123531341553 s.
[2024-03-12 09:48:41,168 INFO] Train perplexity: 9.18014
[2024-03-12 09:48:41,168 INFO] Train accuracy: 64.01
[2024-03-12 09:48:41,168 INFO] Sentences processed: 196278
[2024-03-12 09:48:41,169 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:48:41,169 INFO] Validation perplexity: 8703.94
[2024-03-12 09:48:41,169 INFO] Validation accuracy: 28.8809
[2024-03-12 09:48:41,170 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_9400.pt
[2024-03-12 09:48:44,303 INFO] Step 9450/10200; acc: 92.2; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2268; bsz:  558/ 481/45; 4171/3601 tok/s;    364 sec;
[2024-03-12 09:48:47,824 INFO] Step 9500/10200; acc: 92.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  566/ 495/47; 8045/7029 tok/s;    368 sec;
[2024-03-12 09:48:51,455 INFO] Step 9550/10200; acc: 92.0; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2373; bsz:  581/ 507/47; 8001/6977 tok/s;    371 sec;
[2024-03-12 09:48:55,082 INFO] Step 9600/10200; acc: 92.7; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2372; bsz:  585/ 503/47; 8060/6940 tok/s;    375 sec;
[2024-03-12 09:48:58,558 INFO] valid stats calculation
                           took: 3.4752554893493652 s.
[2024-03-12 09:48:58,558 INFO] Train perplexity: 8.39542
[2024-03-12 09:48:58,559 INFO] Train accuracy: 65.3041
[2024-03-12 09:48:58,559 INFO] Sentences processed: 205658
[2024-03-12 09:48:58,559 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:48:58,559 INFO] Validation perplexity: 7491.69
[2024-03-12 09:48:58,559 INFO] Validation accuracy: 29.5227
[2024-03-12 09:48:58,560 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_9600.pt
[2024-03-12 09:49:01,343 INFO] Step 9650/10200; acc: 92.8; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2375; bsz:  561/ 487/48; 4481/3891 tok/s;    381 sec;
[2024-03-12 09:49:04,940 INFO] Step 9700/10200; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2281; bsz:  559/ 484/46; 7766/6727 tok/s;    385 sec;
[2024-03-12 09:49:08,497 INFO] Step 9750/10200; acc: 93.0; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2376; bsz:  589/ 509/48; 8275/7157 tok/s;    388 sec;
[2024-03-12 09:49:12,004 INFO] Step 9800/10200; acc: 92.8; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2277; bsz:  544/ 471/46; 7754/6722 tok/s;    392 sec;
[2024-03-12 09:49:15,487 INFO] valid stats calculation
                           took: 3.4825167655944824 s.
[2024-03-12 09:49:15,487 INFO] Train perplexity: 7.74228
[2024-03-12 09:49:15,487 INFO] Train accuracy: 66.4893
[2024-03-12 09:49:15,487 INFO] Sentences processed: 214967
[2024-03-12 09:49:15,487 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:49:15,487 INFO] Validation perplexity: 6797.73
[2024-03-12 09:49:15,487 INFO] Validation accuracy: 29.8436
[2024-03-12 09:49:15,489 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_9800.pt
[2024-03-12 09:49:18,171 INFO] Step 9850/10200; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 4748/4118 tok/s;    398 sec;
[2024-03-12 09:49:21,707 INFO] Step 9900/10200; acc: 93.2; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2366; bsz:  563/ 489/47; 7959/6919 tok/s;    401 sec;
[2024-03-12 09:49:25,330 INFO] Step 9950/10200; acc: 93.3; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2263; bsz:  560/ 483/45; 7721/6663 tok/s;    405 sec;
[2024-03-12 09:49:28,747 INFO] Step 10000/10200; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2365; bsz:  580/ 500/47; 8486/7311 tok/s;    409 sec;
[2024-03-12 09:49:32,157 INFO] valid stats calculation
                           took: 3.409369945526123 s.
[2024-03-12 09:49:32,157 INFO] Train perplexity: 7.17833
[2024-03-12 09:49:32,157 INFO] Train accuracy: 67.6022
[2024-03-12 09:49:32,157 INFO] Sentences processed: 224332
[2024-03-12 09:49:32,157 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:49:32,157 INFO] Validation perplexity: 6924.93
[2024-03-12 09:49:32,157 INFO] Validation accuracy: 28.5199
[2024-03-12 09:49:32,158 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_10000.pt
[2024-03-12 09:49:34,626 INFO] Step 10050/10200; acc: 93.5; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  566/ 494/47; 4814/4204 tok/s;    414 sec;
[2024-03-12 09:49:38,029 INFO] Step 10100/10200; acc: 93.6; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2369; bsz:  583/ 504/47; 8565/7413 tok/s;    418 sec;
[2024-03-12 09:49:41,628 INFO] Step 10150/10200; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2270; bsz:  557/ 483/45; 7741/6713 tok/s;    421 sec;
[2024-03-12 09:49:45,207 INFO] Step 10200/10200; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2257; bsz:  556/ 481/45; 7773/6722 tok/s;    425 sec;
[2024-03-12 09:49:48,704 INFO] valid stats calculation
                           took: 3.496572256088257 s.
[2024-03-12 09:49:48,704 INFO] Train perplexity: 6.69656
[2024-03-12 09:49:48,704 INFO] Train accuracy: 68.6299
[2024-03-12 09:49:48,704 INFO] Sentences processed: 233595
[2024-03-12 09:49:48,705 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:49:48,705 INFO] Validation perplexity: 9455.73
[2024-03-12 09:49:48,705 INFO] Validation accuracy: 29.4424
[2024-03-12 09:49:48,706 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_03_step_10200.pt
