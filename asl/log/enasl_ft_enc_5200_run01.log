[2024-03-12 09:28:31,427 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-12 09:28:31,427 INFO] Parsed 2 corpora from -data.
[2024-03-12 09:28:31,427 INFO] Loading checkpoint from tg-pt-enc/models/tg-pt-enc_01_step_5200.pt
[2024-03-12 09:28:31,495 INFO] Building model...
[2024-03-12 09:28:31,550 INFO] Switching model to float32 for amp/apex_amp
[2024-03-12 09:28:31,550 INFO] Non quantized layer compute is fp32
[2024-03-12 09:28:33,859 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-12 09:28:33,859 INFO] encoder: 8952800
[2024-03-12 09:28:33,859 INFO] decoder: 16687344
[2024-03-12 09:28:33,859 INFO] * number of parameters: 25640144
[2024-03-12 09:28:33,859 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 09:28:33,859 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 09:28:33,859 INFO]  * src vocab size = 17816
[2024-03-12 09:28:33,859 INFO]  * tgt vocab size = 14144
[2024-03-12 09:28:33,861 INFO] Starting training on GPU: [0]
[2024-03-12 09:28:33,861 INFO] Start training loop and validate every 200 steps...
[2024-03-12 09:28:33,861 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-12 09:28:40,571 INFO] Step 5250/10200; acc: 8.5; ppl: 2288766.8; xent: 14.6; lr: 1.00000; sents:    2270; bsz:  565/ 490/45; 4212/3650 tok/s;      7 sec;
[2024-03-12 09:28:43,995 INFO] Step 5300/10200; acc: 6.1; ppl: 177326.0; xent: 12.1; lr: 1.00000; sents:    2369; bsz:  590/ 512/47; 8620/7485 tok/s;     10 sec;
[2024-03-12 09:28:47,392 INFO] Step 5350/10200; acc: 5.7; ppl: 41692.2; xent: 10.6; lr: 1.00000; sents:    2363; bsz:  564/ 491/47; 8296/7234 tok/s;     14 sec;
[2024-03-12 09:28:50,801 INFO] Step 5400/10200; acc: 8.3; ppl: 243916.0; xent: 12.4; lr: 1.00000; sents:    2365; bsz:  585/ 507/47; 8581/7440 tok/s;     17 sec;
[2024-03-12 09:28:54,337 INFO] valid stats calculation
                           took: 3.5360143184661865 s.
[2024-03-12 09:28:54,338 INFO] Train perplexity: 251976
[2024-03-12 09:28:54,338 INFO] Train accuracy: 7.17413
[2024-03-12 09:28:54,338 INFO] Sentences processed: 9367
[2024-03-12 09:28:54,338 INFO] Average bsz:  576/ 500/47
[2024-03-12 09:28:54,338 INFO] Validation perplexity: 406220
[2024-03-12 09:28:54,338 INFO] Validation accuracy: 2.96831
[2024-03-12 09:28:54,339 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_5400.pt
[2024-03-12 09:28:57,301 INFO] Step 5450/10200; acc: 8.4; ppl: 33221.5; xent: 10.4; lr: 1.00000; sents:    2246; bsz:  547/ 475/45; 4212/3653 tok/s;     23 sec;
[2024-03-12 09:29:00,782 INFO] Step 5500/10200; acc: 7.0; ppl: 12952.2; xent: 9.5; lr: 1.00000; sents:    2372; bsz:  566/ 491/47; 8129/7051 tok/s;     27 sec;
[2024-03-12 09:29:04,323 INFO] Step 5550/10200; acc: 8.8; ppl: 11812.4; xent: 9.4; lr: 1.00000; sents:    2275; bsz:  561/ 487/46; 7925/6875 tok/s;     30 sec;
[2024-03-12 09:29:07,859 INFO] Step 5600/10200; acc: 7.6; ppl: 12425.8; xent: 9.4; lr: 1.00000; sents:    2487; bsz:  594/ 518/50; 8393/7319 tok/s;     34 sec;
[2024-03-12 09:29:11,377 INFO] valid stats calculation
                           took: 3.516967296600342 s.
[2024-03-12 09:29:11,377 INFO] Train perplexity: 63603.2
[2024-03-12 09:29:11,377 INFO] Train accuracy: 7.54617
[2024-03-12 09:29:11,377 INFO] Sentences processed: 18747
[2024-03-12 09:29:11,377 INFO] Average bsz:  572/ 496/47
[2024-03-12 09:29:11,377 INFO] Validation perplexity: 9285.76
[2024-03-12 09:29:11,377 INFO] Validation accuracy: 2.04573
[2024-03-12 09:29:11,379 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_5600.pt
[2024-03-12 09:29:14,214 INFO] Step 5650/10200; acc: 9.0; ppl: 6914.8; xent: 8.8; lr: 1.00000; sents:    2277; bsz:  561/ 487/46; 4417/3831 tok/s;     40 sec;
[2024-03-12 09:29:17,685 INFO] Step 5700/10200; acc: 9.5; ppl: 9410.1; xent: 9.1; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 8113/7045 tok/s;     44 sec;
[2024-03-12 09:29:21,197 INFO] Step 5750/10200; acc: 8.2; ppl: 8932.5; xent: 9.1; lr: 1.00000; sents:    2258; bsz:  569/ 490/45; 8095/6973 tok/s;     47 sec;
[2024-03-12 09:29:24,749 INFO] Step 5800/10200; acc: 8.2; ppl: 12661.1; xent: 9.4; lr: 1.00000; sents:    2366; bsz:  562/ 489/47; 7915/6887 tok/s;     51 sec;
[2024-03-12 09:29:28,222 INFO] valid stats calculation
                           took: 3.472203493118286 s.
[2024-03-12 09:29:28,222 INFO] Train perplexity: 33689.2
[2024-03-12 09:29:28,222 INFO] Train accuracy: 7.93168
[2024-03-12 09:29:28,222 INFO] Sentences processed: 28023
[2024-03-12 09:29:28,222 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:29:28,222 INFO] Validation perplexity: 561830
[2024-03-12 09:29:28,222 INFO] Validation accuracy: 2.56719
[2024-03-12 09:29:28,223 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_5800.pt
[2024-03-12 09:29:30,876 INFO] Step 5850/10200; acc: 7.8; ppl: 14731.7; xent: 9.6; lr: 1.00000; sents:    2367; bsz:  587/ 513/47; 4791/4182 tok/s;     57 sec;
[2024-03-12 09:29:34,286 INFO] Step 5900/10200; acc: 11.8; ppl: 2166.4; xent: 7.7; lr: 1.00000; sents:    2364; bsz:  568/ 500/47; 8324/7333 tok/s;     60 sec;
[2024-03-12 09:29:37,779 INFO] Step 5950/10200; acc: 14.3; ppl: 544.2; xent: 6.3; lr: 1.00000; sents:    2271; bsz:  567/ 490/45; 8112/7010 tok/s;     64 sec;
[2024-03-12 09:29:41,205 INFO] Step 6000/10200; acc: 16.1; ppl: 316.2; xent: 5.8; lr: 1.00000; sents:    2261; bsz:  554/ 479/45; 8088/6986 tok/s;     67 sec;
[2024-03-12 09:29:44,696 INFO] valid stats calculation
                           took: 3.4905998706817627 s.
[2024-03-12 09:29:44,697 INFO] Train perplexity: 15672.3
[2024-03-12 09:29:44,697 INFO] Train accuracy: 9.05837
[2024-03-12 09:29:44,697 INFO] Sentences processed: 37286
[2024-03-12 09:29:44,697 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:29:44,697 INFO] Validation perplexity: 614.262
[2024-03-12 09:29:44,697 INFO] Validation accuracy: 14.3201
[2024-03-12 09:29:44,698 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_6000.pt
[2024-03-12 09:29:47,264 INFO] Step 6050/10200; acc: 19.1; ppl: 202.9; xent: 5.3; lr: 1.00000; sents:    2476; bsz:  582/ 508/50; 4801/4189 tok/s;     73 sec;
[2024-03-12 09:29:50,687 INFO] Step 6100/10200; acc: 21.1; ppl: 141.6; xent: 5.0; lr: 1.00000; sents:    2268; bsz:  557/ 483/45; 8138/7049 tok/s;     77 sec;
[2024-03-12 09:29:54,262 INFO] Step 6150/10200; acc: 23.2; ppl: 102.1; xent: 4.6; lr: 1.00000; sents:    2279; bsz:  563/ 487/46; 7871/6806 tok/s;     80 sec;
[2024-03-12 09:29:57,785 INFO] Step 6200/10200; acc: 26.2; ppl:  76.8; xent: 4.3; lr: 1.00000; sents:    2381; bsz:  582/ 506/48; 8258/7182 tok/s;     84 sec;
[2024-03-12 09:30:01,260 INFO] valid stats calculation
                           took: 3.474282741546631 s.
[2024-03-12 09:30:01,261 INFO] Train perplexity: 5926.04
[2024-03-12 09:30:01,261 INFO] Train accuracy: 11.7359
[2024-03-12 09:30:01,261 INFO] Sentences processed: 46690
[2024-03-12 09:30:01,261 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:30:01,261 INFO] Validation perplexity: 288.75
[2024-03-12 09:30:01,261 INFO] Validation accuracy: 16.5263
[2024-03-12 09:30:01,263 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_6200.pt
[2024-03-12 09:30:03,832 INFO] Step 6250/10200; acc: 29.4; ppl:  53.7; xent: 4.0; lr: 1.00000; sents:    2376; bsz:  564/ 493/48; 4668/4078 tok/s;     90 sec;
[2024-03-12 09:30:07,100 INFO] Step 6300/10200; acc: 30.9; ppl:  43.2; xent: 3.8; lr: 1.00000; sents:    2275; bsz:  561/ 484/46; 8587/7409 tok/s;     93 sec;
[2024-03-12 09:30:10,611 INFO] Step 6350/10200; acc: 34.3; ppl:  33.1; xent: 3.5; lr: 1.00000; sents:    2471; bsz:  582/ 504/49; 8297/7181 tok/s;     97 sec;
[2024-03-12 09:30:14,132 INFO] Step 6400/10200; acc: 35.4; ppl:  28.7; xent: 3.4; lr: 1.00000; sents:    2266; bsz:  559/ 484/45; 7938/6880 tok/s;    100 sec;
[2024-03-12 09:30:17,533 INFO] valid stats calculation
                           took: 3.4010579586029053 s.
[2024-03-12 09:30:17,534 INFO] Train perplexity: 2571.08
[2024-03-12 09:30:17,534 INFO] Train accuracy: 15.1826
[2024-03-12 09:30:17,534 INFO] Sentences processed: 56078
[2024-03-12 09:30:17,534 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:30:17,534 INFO] Validation perplexity: 220.905
[2024-03-12 09:30:17,534 INFO] Validation accuracy: 27.4368
[2024-03-12 09:30:17,535 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_6400.pt
[2024-03-12 09:30:20,089 INFO] Step 6450/10200; acc: 37.6; ppl:  23.7; xent: 3.2; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 4721/4094 tok/s;    106 sec;
[2024-03-12 09:30:23,044 INFO] Step 6500/10200; acc: 39.9; ppl:  19.5; xent: 3.0; lr: 1.00000; sents:    2462; bsz:  586/ 508/49; 9910/8601 tok/s;    109 sec;
[2024-03-12 09:30:26,564 INFO] Step 6550/10200; acc: 41.4; ppl:  16.5; xent: 2.8; lr: 1.00000; sents:    2269; bsz:  564/ 488/45; 8011/6932 tok/s;    113 sec;
[2024-03-12 09:30:30,047 INFO] Step 6600/10200; acc: 44.1; ppl:  14.0; xent: 2.6; lr: 1.00000; sents:    2367; bsz:  563/ 488/47; 8083/7005 tok/s;    116 sec;
[2024-03-12 09:30:33,484 INFO] valid stats calculation
                           took: 3.4363837242126465 s.
[2024-03-12 09:30:33,484 INFO] Train perplexity: 1267.99
[2024-03-12 09:30:33,484 INFO] Train accuracy: 18.8293
[2024-03-12 09:30:33,484 INFO] Sentences processed: 65444
[2024-03-12 09:30:33,485 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:30:33,485 INFO] Validation perplexity: 277.53
[2024-03-12 09:30:33,485 INFO] Validation accuracy: 27.9182
[2024-03-12 09:30:33,486 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_6600.pt
[2024-03-12 09:30:36,402 INFO] Step 6650/10200; acc: 44.2; ppl:  13.2; xent: 2.6; lr: 1.00000; sents:    2272; bsz:  578/ 497/45; 4551/3907 tok/s;    123 sec;
[2024-03-12 09:30:39,229 INFO] Step 6700/10200; acc: 47.1; ppl:  10.7; xent: 2.4; lr: 1.00000; sents:    2371; bsz:  564/ 490/47; 9979/8661 tok/s;    125 sec;
[2024-03-12 09:30:42,711 INFO] Step 6750/10200; acc: 48.4; ppl:   9.8; xent: 2.3; lr: 1.00000; sents:    2273; bsz:  560/ 486/45; 8038/6979 tok/s;    129 sec;
[2024-03-12 09:30:46,153 INFO] Step 6800/10200; acc: 51.0; ppl:   8.4; xent: 2.1; lr: 1.00000; sents:    2484; bsz:  588/ 510/50; 8548/7417 tok/s;    132 sec;
[2024-03-12 09:30:49,590 INFO] valid stats calculation
                           took: 3.4366917610168457 s.
[2024-03-12 09:30:49,591 INFO] Train perplexity: 693.996
[2024-03-12 09:30:49,591 INFO] Train accuracy: 22.4509
[2024-03-12 09:30:49,591 INFO] Sentences processed: 74844
[2024-03-12 09:30:49,591 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:30:49,591 INFO] Validation perplexity: 421.862
[2024-03-12 09:30:49,591 INFO] Validation accuracy: 28.8408
[2024-03-12 09:30:49,592 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_6800.pt
[2024-03-12 09:30:52,650 INFO] Step 6850/10200; acc: 51.8; ppl:   7.8; xent: 2.0; lr: 1.00000; sents:    2274; bsz:  557/ 483/45; 4291/3720 tok/s;    139 sec;
[2024-03-12 09:30:55,193 INFO] Step 6900/10200; acc: 53.4; ppl:   7.4; xent: 2.0; lr: 1.00000; sents:    2376; bsz:  589/ 510/48; 11573/10030 tok/s;    141 sec;
[2024-03-12 09:30:58,795 INFO] Step 6950/10200; acc: 56.5; ppl:   6.0; xent: 1.8; lr: 1.00000; sents:    2368; bsz:  569/ 498/47; 7898/6914 tok/s;    145 sec;
[2024-03-12 09:31:02,331 INFO] Step 7000/10200; acc: 57.8; ppl:   5.5; xent: 1.7; lr: 1.00000; sents:    2270; bsz:  563/ 487/45; 7961/6890 tok/s;    148 sec;
[2024-03-12 09:31:05,962 INFO] valid stats calculation
                           took: 3.6309311389923096 s.
[2024-03-12 09:31:05,963 INFO] Train perplexity: 413.428
[2024-03-12 09:31:05,963 INFO] Train accuracy: 26.0609
[2024-03-12 09:31:05,963 INFO] Sentences processed: 84132
[2024-03-12 09:31:05,963 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:31:05,963 INFO] Validation perplexity: 404.715
[2024-03-12 09:31:05,963 INFO] Validation accuracy: 29.1617
[2024-03-12 09:31:05,964 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_7000.pt
[2024-03-12 09:31:09,184 INFO] Step 7050/10200; acc: 59.1; ppl:   5.1; xent: 1.6; lr: 1.00000; sents:    2248; bsz:  550/ 476/45; 4012/3471 tok/s;    155 sec;
[2024-03-12 09:31:11,577 INFO] Step 7100/10200; acc: 61.5; ppl:   4.5; xent: 1.5; lr: 1.00000; sents:    2363; bsz:  564/ 490/47; 11781/10237 tok/s;    158 sec;
[2024-03-12 09:31:14,891 INFO] Step 7150/10200; acc: 61.4; ppl:   4.6; xent: 1.5; lr: 1.00000; sents:    2365; bsz:  585/ 508/47; 8832/7663 tok/s;    161 sec;
[2024-03-12 09:31:18,434 INFO] Step 7200/10200; acc: 62.8; ppl:   4.3; xent: 1.4; lr: 1.00000; sents:    2367; bsz:  579/ 502/47; 8173/7080 tok/s;    165 sec;
[2024-03-12 09:31:21,879 INFO] valid stats calculation
                           took: 3.444460868835449 s.
[2024-03-12 09:31:21,880 INFO] Train perplexity: 263.832
[2024-03-12 09:31:21,880 INFO] Train accuracy: 29.575
[2024-03-12 09:31:21,880 INFO] Sentences processed: 93475
[2024-03-12 09:31:21,880 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:31:21,880 INFO] Validation perplexity: 584.136
[2024-03-12 09:31:21,880 INFO] Validation accuracy: 29.0012
[2024-03-12 09:31:21,881 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_7200.pt
[2024-03-12 09:31:25,409 INFO] Step 7250/10200; acc: 65.8; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    2268; bsz:  539/ 468/45; 3866/3355 tok/s;    172 sec;
[2024-03-12 09:31:27,891 INFO] Step 7300/10200; acc: 65.6; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    2379; bsz:  587/ 510/48; 11821/10280 tok/s;    174 sec;
[2024-03-12 09:31:31,095 INFO] Step 7350/10200; acc: 66.7; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    2274; bsz:  558/ 483/45; 8705/7544 tok/s;    177 sec;
[2024-03-12 09:31:34,670 INFO] Step 7400/10200; acc: 68.2; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    2490; bsz:  591/ 515/50; 8272/7210 tok/s;    181 sec;
[2024-03-12 09:31:38,078 INFO] valid stats calculation
                           took: 3.407917022705078 s.
[2024-03-12 09:31:38,078 INFO] Train perplexity: 178.021
[2024-03-12 09:31:38,078 INFO] Train accuracy: 32.9421
[2024-03-12 09:31:38,078 INFO] Sentences processed: 102886
[2024-03-12 09:31:38,079 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:31:38,079 INFO] Validation perplexity: 761.645
[2024-03-12 09:31:38,079 INFO] Validation accuracy: 27.5973
[2024-03-12 09:31:38,080 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_7400.pt
[2024-03-12 09:31:41,688 INFO] Step 7450/10200; acc: 69.5; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    2261; bsz:  552/ 476/45; 3930/3395 tok/s;    188 sec;
[2024-03-12 09:31:44,192 INFO] Step 7500/10200; acc: 70.6; ppl:   2.9; xent: 1.1; lr: 1.00000; sents:    2372; bsz:  566/ 496/47; 11312/9911 tok/s;    190 sec;
[2024-03-12 09:31:47,214 INFO] Step 7550/10200; acc: 71.4; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    2270; bsz:  567/ 493/45; 9387/8152 tok/s;    193 sec;
[2024-03-12 09:31:50,812 INFO] Step 7600/10200; acc: 72.0; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    2367; bsz:  588/ 515/47; 8170/7154 tok/s;    197 sec;
[2024-03-12 09:31:54,256 INFO] valid stats calculation
                           took: 3.444336175918579 s.
[2024-03-12 09:31:54,257 INFO] Train perplexity: 126.136
[2024-03-12 09:31:54,257 INFO] Train accuracy: 36.1091
[2024-03-12 09:31:54,257 INFO] Sentences processed: 112156
[2024-03-12 09:31:54,257 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:31:54,257 INFO] Validation perplexity: 918.937
[2024-03-12 09:31:54,257 INFO] Validation accuracy: 28.8408
[2024-03-12 09:31:54,258 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_7600.pt
[2024-03-12 09:31:57,803 INFO] Step 7650/10200; acc: 74.2; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2364; bsz:  561/ 487/47; 4010/3485 tok/s;    204 sec;
[2024-03-12 09:32:00,641 INFO] Step 7700/10200; acc: 74.1; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2263; bsz:  566/ 485/45; 9966/8551 tok/s;    207 sec;
[2024-03-12 09:32:03,301 INFO] Step 7750/10200; acc: 75.9; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2365; bsz:  562/ 489/47; 10556/9192 tok/s;    209 sec;
[2024-03-12 09:32:07,034 INFO] Step 7800/10200; acc: 76.2; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2373; bsz:  582/ 507/47; 7794/6790 tok/s;    213 sec;
[2024-03-12 09:32:10,486 INFO] valid stats calculation
                           took: 3.4522109031677246 s.
[2024-03-12 09:32:10,487 INFO] Train perplexity: 93.1495
[2024-03-12 09:32:10,487 INFO] Train accuracy: 39.0981
[2024-03-12 09:32:10,487 INFO] Sentences processed: 121521
[2024-03-12 09:32:10,487 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:32:10,487 INFO] Validation perplexity: 1246.87
[2024-03-12 09:32:10,487 INFO] Validation accuracy: 27.8379
[2024-03-12 09:32:10,489 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_7800.pt
[2024-03-12 09:32:14,272 INFO] Step 7850/10200; acc: 77.7; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2371; bsz:  565/ 494/47; 3903/3414 tok/s;    220 sec;
[2024-03-12 09:32:17,187 INFO] Step 7900/10200; acc: 77.9; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2279; bsz:  562/ 486/46; 9648/8333 tok/s;    223 sec;
[2024-03-12 09:32:19,800 INFO] Step 7950/10200; acc: 78.6; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2381; bsz:  579/ 499/48; 11082/9553 tok/s;    226 sec;
[2024-03-12 09:32:23,299 INFO] Step 8000/10200; acc: 79.3; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2376; bsz:  565/ 490/48; 8077/7006 tok/s;    229 sec;
[2024-03-12 09:32:26,785 INFO] valid stats calculation
                           took: 3.4863498210906982 s.
[2024-03-12 09:32:26,786 INFO] Train perplexity: 71.1404
[2024-03-12 09:32:26,786 INFO] Train accuracy: 41.8951
[2024-03-12 09:32:26,786 INFO] Sentences processed: 130928
[2024-03-12 09:32:26,786 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:32:26,786 INFO] Validation perplexity: 1414.69
[2024-03-12 09:32:26,786 INFO] Validation accuracy: 28.0385
[2024-03-12 09:32:26,787 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_8000.pt
[2024-03-12 09:32:30,546 INFO] Step 8050/10200; acc: 80.0; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2275; bsz:  562/ 485/46; 3879/3348 tok/s;    237 sec;
[2024-03-12 09:32:33,645 INFO] Step 8100/10200; acc: 80.5; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2273; bsz:  565/ 489/45; 9121/7892 tok/s;    240 sec;
[2024-03-12 09:32:36,009 INFO] Step 8150/10200; acc: 81.5; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2464; bsz:  584/ 508/49; 12363/10752 tok/s;    242 sec;
[2024-03-12 09:32:39,609 INFO] Step 8200/10200; acc: 81.8; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 7825/6784 tok/s;    246 sec;
[2024-03-12 09:32:43,112 INFO] valid stats calculation
                           took: 3.502318859100342 s.
[2024-03-12 09:32:43,112 INFO] Train perplexity: 55.9325
[2024-03-12 09:32:43,112 INFO] Train accuracy: 44.4944
[2024-03-12 09:32:43,113 INFO] Sentences processed: 140208
[2024-03-12 09:32:43,113 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:32:43,113 INFO] Validation perplexity: 1917.96
[2024-03-12 09:32:43,113 INFO] Validation accuracy: 28.6001
[2024-03-12 09:32:43,114 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_8200.pt
[2024-03-12 09:32:46,702 INFO] Step 8250/10200; acc: 82.7; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2362; bsz:  579/ 499/47; 4079/3517 tok/s;    253 sec;
[2024-03-12 09:32:49,967 INFO] Step 8300/10200; acc: 83.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2267; bsz:  544/ 472/45; 8333/7232 tok/s;    256 sec;
[2024-03-12 09:32:52,351 INFO] Step 8350/10200; acc: 83.4; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2369; bsz:  580/ 501/47; 12176/10505 tok/s;    258 sec;
[2024-03-12 09:32:55,688 INFO] Step 8400/10200; acc: 83.8; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    2372; bsz:  566/ 494/47; 8480/7400 tok/s;    262 sec;
[2024-03-12 09:32:59,146 INFO] valid stats calculation
                           took: 3.45802903175354 s.
[2024-03-12 09:32:59,147 INFO] Train perplexity: 45.1154
[2024-03-12 09:32:59,147 INFO] Train accuracy: 46.9081
[2024-03-12 09:32:59,147 INFO] Sentences processed: 149578
[2024-03-12 09:32:59,147 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:32:59,147 INFO] Validation perplexity: 2240.16
[2024-03-12 09:32:59,147 INFO] Validation accuracy: 27.8781
[2024-03-12 09:32:59,148 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_8400.pt
[2024-03-12 09:33:02,936 INFO] Step 8450/10200; acc: 83.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2269; bsz:  576/ 495/45; 3971/3417 tok/s;    269 sec;
[2024-03-12 09:33:06,355 INFO] Step 8500/10200; acc: 84.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2375; bsz:  565/ 492/48; 8267/7200 tok/s;    272 sec;
[2024-03-12 09:33:08,829 INFO] Step 8550/10200; acc: 85.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2279; bsz:  561/ 487/46; 11350/9846 tok/s;    275 sec;
[2024-03-12 09:33:12,036 INFO] Step 8600/10200; acc: 85.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2479; bsz:  597/ 521/50; 9303/8116 tok/s;    278 sec;
[2024-03-12 09:33:15,468 INFO] valid stats calculation
                           took: 3.4310741424560547 s.
[2024-03-12 09:33:15,468 INFO] Train perplexity: 37.0943
[2024-03-12 09:33:15,468 INFO] Train accuracy: 49.1644
[2024-03-12 09:33:15,468 INFO] Sentences processed: 158980
[2024-03-12 09:33:15,468 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:33:15,468 INFO] Validation perplexity: 3322.34
[2024-03-12 09:33:15,468 INFO] Validation accuracy: 28.8408
[2024-03-12 09:33:15,470 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_8600.pt
[2024-03-12 09:33:19,124 INFO] Step 8650/10200; acc: 86.1; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2280; bsz:  565/ 490/46; 3987/3459 tok/s;    285 sec;
[2024-03-12 09:33:22,806 INFO] Step 8700/10200; acc: 86.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2368; bsz:  565/ 491/47; 7671/6668 tok/s;    289 sec;
[2024-03-12 09:33:25,298 INFO] Step 8750/10200; acc: 86.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2366; bsz:  586/ 506/47; 11752/10156 tok/s;    291 sec;
[2024-03-12 09:33:28,210 INFO] Step 8800/10200; acc: 86.8; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2248; bsz:  551/ 478/45; 9467/8213 tok/s;    294 sec;
[2024-03-12 09:33:31,652 INFO] valid stats calculation
                           took: 3.44128680229187 s.
[2024-03-12 09:33:31,653 INFO] Train perplexity: 31.1497
[2024-03-12 09:33:31,653 INFO] Train accuracy: 51.2344
[2024-03-12 09:33:31,653 INFO] Sentences processed: 168242
[2024-03-12 09:33:31,653 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:33:31,653 INFO] Validation perplexity: 3694.72
[2024-03-12 09:33:31,653 INFO] Validation accuracy: 28.199
[2024-03-12 09:33:31,654 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_8800.pt
[2024-03-12 09:33:35,323 INFO] Step 8850/10200; acc: 87.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2363; bsz:  576/ 498/47; 4053/3500 tok/s;    301 sec;
[2024-03-12 09:33:38,782 INFO] Step 8900/10200; acc: 87.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2251; bsz:  535/ 467/45; 7740/6745 tok/s;    305 sec;
[2024-03-12 09:33:41,485 INFO] Step 8950/10200; acc: 88.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2372; bsz:  582/ 505/47; 10777/9347 tok/s;    308 sec;
[2024-03-12 09:33:44,198 INFO] Step 9000/10200; acc: 88.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2377; bsz:  569/ 497/48; 10478/9164 tok/s;    310 sec;
[2024-03-12 09:33:47,614 INFO] valid stats calculation
                           took: 3.415239095687866 s.
[2024-03-12 09:33:47,614 INFO] Train perplexity: 26.5826
[2024-03-12 09:33:47,614 INFO] Train accuracy: 53.1504
[2024-03-12 09:33:47,614 INFO] Sentences processed: 177605
[2024-03-12 09:33:47,614 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:33:47,614 INFO] Validation perplexity: 4556.04
[2024-03-12 09:33:47,614 INFO] Validation accuracy: 28.8408
[2024-03-12 09:33:47,616 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_9000.pt
[2024-03-12 09:33:51,228 INFO] Step 9050/10200; acc: 88.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2272; bsz:  574/ 498/45; 4082/3542 tok/s;    317 sec;
[2024-03-12 09:33:54,751 INFO] Step 9100/10200; acc: 89.1; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2381; bsz:  565/ 490/48; 8017/6952 tok/s;    321 sec;
[2024-03-12 09:33:57,801 INFO] Step 9150/10200; acc: 89.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2376; bsz:  583/ 509/48; 9562/8338 tok/s;    324 sec;
[2024-03-12 09:34:00,245 INFO] Step 9200/10200; acc: 89.4; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  566/ 495/48; 11572/10123 tok/s;    326 sec;
[2024-03-12 09:34:03,672 INFO] valid stats calculation
                           took: 3.4259607791900635 s.
[2024-03-12 09:34:03,672 INFO] Train perplexity: 22.9606
[2024-03-12 09:34:03,672 INFO] Train accuracy: 54.9537
[2024-03-12 09:34:03,672 INFO] Sentences processed: 187009
[2024-03-12 09:34:03,672 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:34:03,672 INFO] Validation perplexity: 5728.61
[2024-03-12 09:34:03,672 INFO] Validation accuracy: 27.6775
[2024-03-12 09:34:03,674 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_9200.pt
[2024-03-12 09:34:07,387 INFO] Step 9250/10200; acc: 89.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2275; bsz:  569/ 494/46; 3987/3458 tok/s;    334 sec;
[2024-03-12 09:34:10,887 INFO] Step 9300/10200; acc: 89.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  563/ 489/47; 8037/6984 tok/s;    337 sec;
[2024-03-12 09:34:14,287 INFO] Step 9350/10200; acc: 89.5; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2263; bsz:  571/ 490/45; 8399/7204 tok/s;    340 sec;
[2024-03-12 09:34:16,730 INFO] Step 9400/10200; acc: 90.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2364; bsz:  558/ 487/47; 11423/9962 tok/s;    343 sec;
[2024-03-12 09:34:20,299 INFO] valid stats calculation
                           took: 3.568312883377075 s.
[2024-03-12 09:34:20,299 INFO] Train perplexity: 20.1268
[2024-03-12 09:34:20,299 INFO] Train accuracy: 56.6001
[2024-03-12 09:34:20,299 INFO] Sentences processed: 196278
[2024-03-12 09:34:20,299 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:34:20,299 INFO] Validation perplexity: 7232.32
[2024-03-12 09:34:20,299 INFO] Validation accuracy: 27.7176
[2024-03-12 09:34:20,301 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_9400.pt
[2024-03-12 09:34:24,011 INFO] Step 9450/10200; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  563/ 492/47; 3870/3379 tok/s;    350 sec;
[2024-03-12 09:34:27,572 INFO] Step 9500/10200; acc: 90.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2268; bsz:  561/ 484/45; 7873/6801 tok/s;    354 sec;
[2024-03-12 09:34:31,125 INFO] Step 9550/10200; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2373; bsz:  581/ 507/47; 8177/7130 tok/s;    357 sec;
[2024-03-12 09:34:33,630 INFO] Step 9600/10200; acc: 91.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  585/ 503/47; 11670/10048 tok/s;    360 sec;
[2024-03-12 09:34:37,198 INFO] valid stats calculation
                           took: 3.5667574405670166 s.
[2024-03-12 09:34:37,198 INFO] Train perplexity: 17.8067
[2024-03-12 09:34:37,198 INFO] Train accuracy: 58.1534
[2024-03-12 09:34:37,198 INFO] Sentences processed: 205658
[2024-03-12 09:34:37,198 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:34:37,198 INFO] Validation perplexity: 6286.23
[2024-03-12 09:34:37,198 INFO] Validation accuracy: 27.8781
[2024-03-12 09:34:37,200 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_9600.pt
[2024-03-12 09:34:40,871 INFO] Step 9650/10200; acc: 91.1; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2274; bsz:  543/ 474/45; 3751/3272 tok/s;    367 sec;
[2024-03-12 09:34:44,431 INFO] Step 9700/10200; acc: 91.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2382; bsz:  577/ 497/48; 8100/6987 tok/s;    371 sec;
[2024-03-12 09:34:48,055 INFO] Step 9750/10200; acc: 91.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  589/ 509/48; 8121/7024 tok/s;    374 sec;
[2024-03-12 09:34:50,549 INFO] Step 9800/10200; acc: 91.0; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2277; bsz:  564/ 488/46; 11311/9790 tok/s;    377 sec;
[2024-03-12 09:34:54,079 INFO] valid stats calculation
                           took: 3.528604030609131 s.
[2024-03-12 09:34:54,079 INFO] Train perplexity: 15.9233
[2024-03-12 09:34:54,079 INFO] Train accuracy: 59.5841
[2024-03-12 09:34:54,079 INFO] Sentences processed: 214967
[2024-03-12 09:34:54,079 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:34:54,079 INFO] Validation perplexity: 6015.44
[2024-03-12 09:34:54,079 INFO] Validation accuracy: 28.4396
[2024-03-12 09:34:54,081 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_9800.pt
[2024-03-12 09:34:57,737 INFO] Step 9850/10200; acc: 91.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2371; bsz:  565/ 491/47; 3932/3416 tok/s;    384 sec;
[2024-03-12 09:35:01,251 INFO] Step 9900/10200; acc: 91.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  563/ 489/47; 8008/6961 tok/s;    387 sec;
[2024-03-12 09:35:04,750 INFO] Step 9950/10200; acc: 91.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  579/ 499/47; 8278/7136 tok/s;    391 sec;
[2024-03-12 09:35:07,418 INFO] Step 10000/10200; acc: 92.2; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 10496/9051 tok/s;    394 sec;
[2024-03-12 09:35:10,989 INFO] valid stats calculation
                           took: 3.5699269771575928 s.
[2024-03-12 09:35:10,989 INFO] Train perplexity: 14.364
[2024-03-12 09:35:10,989 INFO] Train accuracy: 60.9194
[2024-03-12 09:35:10,989 INFO] Sentences processed: 224332
[2024-03-12 09:35:10,989 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:35:10,989 INFO] Validation perplexity: 8068.54
[2024-03-12 09:35:10,989 INFO] Validation accuracy: 29.5628
[2024-03-12 09:35:10,991 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_10000.pt
[2024-03-12 09:35:13,468 INFO] Step 10050/10200; acc: 92.0; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  586/ 507/47; 4840/4190 tok/s;    400 sec;
[2024-03-12 09:35:15,860 INFO] Step 10100/10200; acc: 92.2; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2369; bsz:  563/ 492/47; 11779/10285 tok/s;    402 sec;
[2024-03-12 09:35:18,631 INFO] Step 10150/10200; acc: 92.1; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2270; bsz:  557/ 483/45; 10055/8720 tok/s;    405 sec;
[2024-03-12 09:35:22,216 INFO] Step 10200/10200; acc: 92.2; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2257; bsz:  556/ 481/45; 7758/6709 tok/s;    408 sec;
[2024-03-12 09:35:25,802 INFO] valid stats calculation
                           took: 3.585515260696411 s.
[2024-03-12 09:35:25,803 INFO] Train perplexity: 13.0576
[2024-03-12 09:35:25,803 INFO] Train accuracy: 62.16
[2024-03-12 09:35:25,803 INFO] Sentences processed: 233595
[2024-03-12 09:35:25,803 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:35:25,803 INFO] Validation perplexity: 8882.63
[2024-03-12 09:35:25,803 INFO] Validation accuracy: 28.5199
[2024-03-12 09:35:25,804 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_5200_01_step_10200.pt
