[2024-03-12 15:31:35,354 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-12 15:31:35,354 INFO] Parsed 2 corpora from -data.
[2024-03-12 15:31:35,354 INFO] Loading checkpoint from tg-pt-dec/models/tg-pt-dec_03_step_6400.pt
[2024-03-12 15:31:35,420 INFO] Building model...
[2024-03-12 15:31:35,476 INFO] Switching model to float32 for amp/apex_amp
[2024-03-12 15:31:35,476 INFO] Non quantized layer compute is fp32
[2024-03-12 15:31:37,221 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-12 15:31:37,222 INFO] encoder: 8952800
[2024-03-12 15:31:37,222 INFO] decoder: 16687344
[2024-03-12 15:31:37,222 INFO] * number of parameters: 25640144
[2024-03-12 15:31:37,222 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 15:31:37,222 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 15:31:37,222 INFO]  * src vocab size = 17816
[2024-03-12 15:31:37,222 INFO]  * tgt vocab size = 14144
[2024-03-12 15:31:37,223 INFO] Starting training on GPU: [0]
[2024-03-12 15:31:37,224 INFO] Start training loop and validate every 200 steps...
[2024-03-12 15:31:37,224 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-12 15:31:42,942 INFO] Step 6450/11400; acc: 9.0; ppl: 7340822.7; xent: 15.8; lr: 1.00000; sents:    2366; bsz:  569/ 497/47; 4979/4348 tok/s;      6 sec;
[2024-03-12 15:31:45,243 INFO] Step 6500/11400; acc: 8.5; ppl: 220320.6; xent: 12.3; lr: 1.00000; sents:    2369; bsz:  590/ 512/47; 12812/11118 tok/s;      8 sec;
[2024-03-12 15:31:47,570 INFO] Step 6550/11400; acc: 9.1; ppl: 61852.1; xent: 11.0; lr: 1.00000; sents:    2267; bsz:  560/ 485/45; 12032/10416 tok/s;     10 sec;
[2024-03-12 15:31:49,806 INFO] Step 6600/11400; acc: 9.1; ppl: 31586.3; xent: 10.4; lr: 1.00000; sents:    2365; bsz:  563/ 489/47; 12583/10930 tok/s;     13 sec;
[2024-03-12 15:31:53,155 INFO] valid stats calculation
                           took: 3.3481807708740234 s.
[2024-03-12 15:31:53,155 INFO] Train perplexity: 241039
[2024-03-12 15:31:53,155 INFO] Train accuracy: 8.90765
[2024-03-12 15:31:53,155 INFO] Sentences processed: 9367
[2024-03-12 15:31:53,155 INFO] Average bsz:  570/ 496/47
[2024-03-12 15:31:53,155 INFO] Validation perplexity: 9339.65
[2024-03-12 15:31:53,155 INFO] Validation accuracy: 9.54673
[2024-03-12 15:31:53,157 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_6600.pt
[2024-03-12 15:31:55,654 INFO] Step 6650/11400; acc: 6.6; ppl: 38645.1; xent: 10.6; lr: 1.00000; sents:    2246; bsz:  570/ 493/45; 4872/4218 tok/s;     18 sec;
[2024-03-12 15:31:57,998 INFO] Step 6700/11400; acc: 8.5; ppl: 133235.7; xent: 11.8; lr: 1.00000; sents:    2372; bsz:  566/ 491/47; 12077/10476 tok/s;     21 sec;
[2024-03-12 15:32:00,374 INFO] Step 6750/11400; acc: 7.0; ppl: 58049.8; xent: 11.0; lr: 1.00000; sents:    2378; bsz:  568/ 494/48; 11943/10403 tok/s;     23 sec;
[2024-03-12 15:32:02,772 INFO] Step 6800/11400; acc: 8.2; ppl: 43822.2; xent: 10.7; lr: 1.00000; sents:    2280; bsz:  562/ 487/46; 11722/10166 tok/s;     26 sec;
[2024-03-12 15:32:06,073 INFO] valid stats calculation
                           took: 3.3001656532287598 s.
[2024-03-12 15:32:06,073 INFO] Train perplexity: 120762
[2024-03-12 15:32:06,073 INFO] Train accuracy: 8.24283
[2024-03-12 15:32:06,073 INFO] Sentences processed: 18643
[2024-03-12 15:32:06,073 INFO] Average bsz:  568/ 494/47
[2024-03-12 15:32:06,073 INFO] Validation perplexity: 51409.2
[2024-03-12 15:32:06,074 INFO] Validation accuracy: 2.56719
[2024-03-12 15:32:06,075 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_6800.pt
[2024-03-12 15:32:08,521 INFO] Step 6850/11400; acc: 6.9; ppl: 45156.5; xent: 10.7; lr: 1.00000; sents:    2381; bsz:  586/ 509/48; 5101/4431 tok/s;     31 sec;
[2024-03-12 15:32:10,833 INFO] Step 6900/11400; acc: 6.9; ppl: 62065.7; xent: 11.0; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 12182/10577 tok/s;     34 sec;
[2024-03-12 15:32:13,170 INFO] Step 6950/11400; acc: 7.1; ppl: 19477.5; xent: 9.9; lr: 1.00000; sents:    2258; bsz:  569/ 490/45; 12166/10480 tok/s;     36 sec;
[2024-03-12 15:32:15,488 INFO] Step 7000/11400; acc: 8.3; ppl: 9724.4; xent: 9.2; lr: 1.00000; sents:    2366; bsz:  562/ 489/47; 12129/10554 tok/s;     38 sec;
[2024-03-12 15:32:18,793 INFO] valid stats calculation
                           took: 3.3042328357696533 s.
[2024-03-12 15:32:18,793 INFO] Train perplexity: 73373.1
[2024-03-12 15:32:18,793 INFO] Train accuracy: 7.93134
[2024-03-12 15:32:18,793 INFO] Sentences processed: 28023
[2024-03-12 15:32:18,793 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:32:18,793 INFO] Validation perplexity: 11768.9
[2024-03-12 15:32:18,793 INFO] Validation accuracy: 2.48696
[2024-03-12 15:32:18,795 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_7000.pt
[2024-03-12 15:32:21,253 INFO] Step 7050/11400; acc: 5.8; ppl: 17762.2; xent: 9.8; lr: 1.00000; sents:    2271; bsz:  567/ 491/45; 4917/4255 tok/s;     44 sec;
[2024-03-12 15:32:23,489 INFO] Step 7100/11400; acc: 6.9; ppl: 32662.9; xent: 10.4; lr: 1.00000; sents:    2460; bsz:  588/ 522/49; 13147/11675 tok/s;     46 sec;
[2024-03-12 15:32:25,844 INFO] Step 7150/11400; acc: 5.7; ppl: 22597.9; xent: 10.0; lr: 1.00000; sents:    2271; bsz:  567/ 490/45; 12032/10398 tok/s;     49 sec;
[2024-03-12 15:32:28,099 INFO] Step 7200/11400; acc: 7.8; ppl: 11945.9; xent: 9.4; lr: 1.00000; sents:    2365; bsz:  561/ 487/47; 12431/10788 tok/s;     51 sec;
[2024-03-12 15:32:31,431 INFO] valid stats calculation
                           took: 3.3317346572875977 s.
[2024-03-12 15:32:31,432 INFO] Train perplexity: 52973.7
[2024-03-12 15:32:31,432 INFO] Train accuracy: 7.59624
[2024-03-12 15:32:31,432 INFO] Sentences processed: 37390
[2024-03-12 15:32:31,432 INFO] Average bsz:  569/ 495/47
[2024-03-12 15:32:31,432 INFO] Validation perplexity: 142020
[2024-03-12 15:32:31,432 INFO] Validation accuracy: 3.20899
[2024-03-12 15:32:31,433 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_7200.pt
[2024-03-12 15:32:33,928 INFO] Step 7250/11400; acc: 7.6; ppl: 12656.1; xent: 9.4; lr: 1.00000; sents:    2372; bsz:  575/ 500/47; 4933/4285 tok/s;     57 sec;
[2024-03-12 15:32:36,324 INFO] Step 7300/11400; acc: 5.7; ppl: 7768.8; xent: 9.0; lr: 1.00000; sents:    2268; bsz:  557/ 483/45; 11628/10072 tok/s;     59 sec;
[2024-03-12 15:32:38,736 INFO] Step 7350/11400; acc: 5.2; ppl: 16887.5; xent: 9.7; lr: 1.00000; sents:    2376; bsz:  581/ 506/48; 12049/10485 tok/s;     62 sec;
[2024-03-12 15:32:41,085 INFO] Step 7400/11400; acc: 5.6; ppl: 56854.7; xent: 10.9; lr: 1.00000; sents:    2381; bsz:  566/ 495/48; 12050/10537 tok/s;     64 sec;
[2024-03-12 15:32:44,372 INFO] valid stats calculation
                           took: 3.2867486476898193 s.
[2024-03-12 15:32:44,373 INFO] Train perplexity: 42481.1
[2024-03-12 15:32:44,373 INFO] Train accuracy: 7.28145
[2024-03-12 15:32:44,373 INFO] Sentences processed: 46787
[2024-03-12 15:32:44,373 INFO] Average bsz:  569/ 495/47
[2024-03-12 15:32:44,373 INFO] Validation perplexity: 13343.6
[2024-03-12 15:32:44,373 INFO] Validation accuracy: 1.80505
[2024-03-12 15:32:44,374 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_7400.pt
[2024-03-12 15:32:46,830 INFO] Step 7450/11400; acc: 8.5; ppl: 20117.2; xent: 9.9; lr: 1.00000; sents:    2279; bsz:  562/ 485/46; 4890/4222 tok/s;     70 sec;
[2024-03-12 15:32:49,113 INFO] Step 7500/11400; acc: 10.3; ppl: 3771.7; xent: 8.2; lr: 1.00000; sents:    2375; bsz:  565/ 490/48; 12381/10742 tok/s;     72 sec;
[2024-03-12 15:32:51,452 INFO] Step 7550/11400; acc: 11.5; ppl: 1755.9; xent: 7.5; lr: 1.00000; sents:    2371; bsz:  579/ 498/47; 12371/10650 tok/s;     74 sec;
[2024-03-12 15:32:53,805 INFO] Step 7600/11400; acc: 14.1; ppl: 599.3; xent: 6.4; lr: 1.00000; sents:    2266; bsz:  559/ 484/45; 11878/10296 tok/s;     77 sec;
[2024-03-12 15:32:57,108 INFO] valid stats calculation
                           took: 3.303191661834717 s.
[2024-03-12 15:32:57,109 INFO] Train perplexity: 27394.5
[2024-03-12 15:32:57,109 INFO] Train accuracy: 7.9108
[2024-03-12 15:32:57,109 INFO] Sentences processed: 56078
[2024-03-12 15:32:57,109 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:32:57,109 INFO] Validation perplexity: 809.128
[2024-03-12 15:32:57,109 INFO] Validation accuracy: 14.1596
[2024-03-12 15:32:57,110 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_7600.pt
[2024-03-12 15:32:59,566 INFO] Step 7650/11400; acc: 15.0; ppl: 382.1; xent: 5.9; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 4882/4234 tok/s;     82 sec;
[2024-03-12 15:33:01,802 INFO] Step 7700/11400; acc: 18.5; ppl: 220.7; xent: 5.4; lr: 1.00000; sents:    2362; bsz:  563/ 489/47; 12597/10943 tok/s;     85 sec;
[2024-03-12 15:33:04,123 INFO] Step 7750/11400; acc: 20.6; ppl: 164.4; xent: 5.1; lr: 1.00000; sents:    2369; bsz:  586/ 507/47; 12631/10922 tok/s;     87 sec;
[2024-03-12 15:33:06,395 INFO] Step 7800/11400; acc: 23.5; ppl: 112.3; xent: 4.7; lr: 1.00000; sents:    2367; bsz:  563/ 488/47; 12391/10739 tok/s;     89 sec;
[2024-03-12 15:33:09,696 INFO] valid stats calculation
                           took: 3.3012099266052246 s.
[2024-03-12 15:33:09,697 INFO] Train perplexity: 13564.3
[2024-03-12 15:33:09,697 INFO] Train accuracy: 9.55127
[2024-03-12 15:33:09,697 INFO] Sentences processed: 65444
[2024-03-12 15:33:09,697 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:33:09,697 INFO] Validation perplexity: 344.03
[2024-03-12 15:33:09,697 INFO] Validation accuracy: 20.5375
[2024-03-12 15:33:09,698 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_7800.pt
[2024-03-12 15:33:12,143 INFO] Step 7850/11400; acc: 25.4; ppl:  90.2; xent: 4.5; lr: 1.00000; sents:    2372; bsz:  581/ 501/47; 5050/4360 tok/s;     95 sec;
[2024-03-12 15:33:14,561 INFO] Step 7900/11400; acc: 27.4; ppl:  67.2; xent: 4.2; lr: 1.00000; sents:    2271; bsz:  562/ 485/45; 11622/10030 tok/s;     97 sec;
[2024-03-12 15:33:16,938 INFO] Step 7950/11400; acc: 29.6; ppl:  53.4; xent: 4.0; lr: 1.00000; sents:    2273; bsz:  560/ 486/45; 11776/10225 tok/s;    100 sec;
[2024-03-12 15:33:19,246 INFO] Step 8000/11400; acc: 32.1; ppl:  41.1; xent: 3.7; lr: 1.00000; sents:    2484; bsz:  588/ 510/50; 12753/11065 tok/s;    102 sec;
[2024-03-12 15:33:22,566 INFO] valid stats calculation
                           took: 3.319754123687744 s.
[2024-03-12 15:33:22,566 INFO] Train perplexity: 6876.83
[2024-03-12 15:33:22,566 INFO] Train accuracy: 11.9481
[2024-03-12 15:33:22,566 INFO] Sentences processed: 74844
[2024-03-12 15:33:22,566 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:33:22,566 INFO] Validation perplexity: 256.257
[2024-03-12 15:33:22,566 INFO] Validation accuracy: 23.8668
[2024-03-12 15:33:22,568 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_8000.pt
[2024-03-12 15:33:25,033 INFO] Step 8050/11400; acc: 33.7; ppl:  33.9; xent: 3.5; lr: 1.00000; sents:    2274; bsz:  557/ 483/45; 4817/4176 tok/s;    108 sec;
[2024-03-12 15:33:27,415 INFO] Step 8100/11400; acc: 35.6; ppl:  27.8; xent: 3.3; lr: 1.00000; sents:    2280; bsz:  563/ 487/46; 11822/10220 tok/s;    110 sec;
[2024-03-12 15:33:29,724 INFO] Step 8150/11400; acc: 37.1; ppl:  24.1; xent: 3.2; lr: 1.00000; sents:    2464; bsz:  595/ 521/49; 12876/11294 tok/s;    112 sec;
[2024-03-12 15:33:32,071 INFO] Step 8200/11400; acc: 40.1; ppl:  18.7; xent: 2.9; lr: 1.00000; sents:    2270; bsz:  563/ 487/45; 11991/10377 tok/s;    115 sec;
[2024-03-12 15:33:35,356 INFO] valid stats calculation
                           took: 3.2845101356506348 s.
[2024-03-12 15:33:35,357 INFO] Train perplexity: 3689.84
[2024-03-12 15:33:35,357 INFO] Train accuracy: 14.6929
[2024-03-12 15:33:35,357 INFO] Sentences processed: 84132
[2024-03-12 15:33:35,357 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:33:35,357 INFO] Validation perplexity: 249.565
[2024-03-12 15:33:35,357 INFO] Validation accuracy: 24.1075
[2024-03-12 15:33:35,358 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_8200.pt
[2024-03-12 15:33:37,743 INFO] Step 8250/11400; acc: 42.0; ppl:  16.1; xent: 2.8; lr: 1.00000; sents:    2369; bsz:  566/ 492/47; 4994/4337 tok/s;    121 sec;
[2024-03-12 15:33:40,063 INFO] Step 8300/11400; acc: 42.2; ppl:  15.5; xent: 2.7; lr: 1.00000; sents:    2363; bsz:  585/ 507/47; 12614/10937 tok/s;    123 sec;
[2024-03-12 15:33:42,333 INFO] Step 8350/11400; acc: 45.0; ppl:  12.5; xent: 2.5; lr: 1.00000; sents:    2244; bsz:  547/ 474/45; 12054/10440 tok/s;    125 sec;
[2024-03-12 15:33:44,664 INFO] Step 8400/11400; acc: 46.8; ppl:  11.2; xent: 2.4; lr: 1.00000; sents:    2258; bsz:  553/ 479/45; 11860/10270 tok/s;    127 sec;
[2024-03-12 15:33:47,958 INFO] valid stats calculation
                           took: 3.29274582862854 s.
[2024-03-12 15:33:47,958 INFO] Train perplexity: 2122.14
[2024-03-12 15:33:47,958 INFO] Train accuracy: 17.5881
[2024-03-12 15:33:47,958 INFO] Sentences processed: 93366
[2024-03-12 15:33:47,958 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:33:47,958 INFO] Validation perplexity: 307.61
[2024-03-12 15:33:47,958 INFO] Validation accuracy: 25.351
[2024-03-12 15:33:47,959 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_8400.pt
[2024-03-12 15:33:50,413 INFO] Step 8450/11400; acc: 49.5; ppl:   9.5; xent: 2.3; lr: 1.00000; sents:    2377; bsz:  566/ 491/48; 4919/4271 tok/s;    133 sec;
[2024-03-12 15:33:52,826 INFO] Step 8500/11400; acc: 49.4; ppl:   8.9; xent: 2.2; lr: 1.00000; sents:    2379; bsz:  587/ 510/48; 12157/10572 tok/s;    136 sec;
[2024-03-12 15:33:55,212 INFO] Step 8550/11400; acc: 52.0; ppl:   7.7; xent: 2.0; lr: 1.00000; sents:    2274; bsz:  558/ 483/45; 11687/10128 tok/s;    138 sec;
[2024-03-12 15:33:57,543 INFO] Step 8600/11400; acc: 54.3; ppl:   6.7; xent: 1.9; lr: 1.00000; sents:    2376; bsz:  564/ 492/48; 12110/10555 tok/s;    140 sec;
[2024-03-12 15:34:00,838 INFO] valid stats calculation
                           took: 3.2938783168792725 s.
[2024-03-12 15:34:00,838 INFO] Train perplexity: 1278.92
[2024-03-12 15:34:00,838 INFO] Train accuracy: 20.6547
[2024-03-12 15:34:00,838 INFO] Sentences processed: 102772
[2024-03-12 15:34:00,838 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:34:00,838 INFO] Validation perplexity: 406.127
[2024-03-12 15:34:00,838 INFO] Validation accuracy: 26.8753
[2024-03-12 15:34:00,840 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_8600.pt
[2024-03-12 15:34:03,284 INFO] Step 8650/11400; acc: 55.1; ppl:   6.2; xent: 1.8; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 5040/4354 tok/s;    146 sec;
[2024-03-12 15:34:05,622 INFO] Step 8700/11400; acc: 58.0; ppl:   5.5; xent: 1.7; lr: 1.00000; sents:    2372; bsz:  566/ 496/47; 12112/10612 tok/s;    148 sec;
[2024-03-12 15:34:08,004 INFO] Step 8750/11400; acc: 57.6; ppl:   5.5; xent: 1.7; lr: 1.00000; sents:    2366; bsz:  587/ 514/47; 12319/10791 tok/s;    151 sec;
[2024-03-12 15:34:10,379 INFO] Step 8800/11400; acc: 60.0; ppl:   4.9; xent: 1.6; lr: 1.00000; sents:    2271; bsz:  568/ 493/45; 11969/10390 tok/s;    153 sec;
[2024-03-12 15:34:13,681 INFO] valid stats calculation
                           took: 3.3017771244049072 s.
[2024-03-12 15:34:13,681 INFO] Train perplexity: 807.095
[2024-03-12 15:34:13,681 INFO] Train accuracy: 23.7798
[2024-03-12 15:34:13,681 INFO] Sentences processed: 112156
[2024-03-12 15:34:13,681 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:34:13,681 INFO] Validation perplexity: 525.234
[2024-03-12 15:34:13,681 INFO] Validation accuracy: 22.9442
[2024-03-12 15:34:13,683 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_8800.pt
[2024-03-12 15:34:16,087 INFO] Step 8850/11400; acc: 61.4; ppl:   4.5; xent: 1.5; lr: 1.00000; sents:    2260; bsz:  555/ 480/45; 4865/4209 tok/s;    159 sec;
[2024-03-12 15:34:18,413 INFO] Step 8900/11400; acc: 63.5; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    2471; bsz:  577/ 500/49; 12404/10747 tok/s;    161 sec;
[2024-03-12 15:34:20,754 INFO] Step 8950/11400; acc: 63.9; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    2261; bsz:  556/ 481/45; 11865/10278 tok/s;    164 sec;
[2024-03-12 15:34:23,157 INFO] Step 9000/11400; acc: 66.1; ppl:   3.5; xent: 1.3; lr: 1.00000; sents:    2373; bsz:  567/ 495/47; 11790/10310 tok/s;    166 sec;
[2024-03-12 15:34:26,462 INFO] valid stats calculation
                           took: 3.3044471740722656 s.
[2024-03-12 15:34:26,463 INFO] Train perplexity: 538.451
[2024-03-12 15:34:26,463 INFO] Train accuracy: 26.8265
[2024-03-12 15:34:26,463 INFO] Sentences processed: 121521
[2024-03-12 15:34:26,463 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:34:26,463 INFO] Validation perplexity: 658.739
[2024-03-12 15:34:26,463 INFO] Validation accuracy: 28.8006
[2024-03-12 15:34:26,464 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_9000.pt
[2024-03-12 15:34:29,010 INFO] Step 9050/11400; acc: 66.7; ppl:   3.5; xent: 1.2; lr: 1.00000; sents:    2371; bsz:  580/ 506/47; 4957/4320 tok/s;    172 sec;
[2024-03-12 15:34:31,424 INFO] Step 9100/11400; acc: 67.7; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    2279; bsz:  562/ 486/46; 11647/10060 tok/s;    174 sec;
[2024-03-12 15:34:33,714 INFO] Step 9150/11400; acc: 69.8; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    2381; bsz:  566/ 491/48; 12364/10727 tok/s;    176 sec;
[2024-03-12 15:34:36,111 INFO] Step 9200/11400; acc: 69.8; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    2276; bsz:  574/ 493/46; 11985/10281 tok/s;    179 sec;
[2024-03-12 15:34:39,402 INFO] valid stats calculation
                           took: 3.2912490367889404 s.
[2024-03-12 15:34:39,403 INFO] Train perplexity: 373.314
[2024-03-12 15:34:39,403 INFO] Train accuracy: 29.8031
[2024-03-12 15:34:39,403 INFO] Sentences processed: 130828
[2024-03-12 15:34:39,403 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:34:39,403 INFO] Validation perplexity: 802.699
[2024-03-12 15:34:39,403 INFO] Validation accuracy: 27.8781
[2024-03-12 15:34:39,404 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_9200.pt
[2024-03-12 15:34:41,803 INFO] Step 9250/11400; acc: 72.0; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    2375; bsz:  566/ 491/48; 4970/4312 tok/s;    185 sec;
[2024-03-12 15:34:44,192 INFO] Step 9300/11400; acc: 72.1; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    2273; bsz:  565/ 489/45; 11830/10237 tok/s;    187 sec;
[2024-03-12 15:34:46,445 INFO] Step 9350/11400; acc: 73.7; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2464; bsz:  584/ 508/49; 12971/11280 tok/s;    189 sec;
[2024-03-12 15:34:48,790 INFO] Step 9400/11400; acc: 73.9; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 12016/10416 tok/s;    192 sec;
[2024-03-12 15:34:52,077 INFO] valid stats calculation
                           took: 3.2871153354644775 s.
[2024-03-12 15:34:52,078 INFO] Train perplexity: 268.208
[2024-03-12 15:34:52,078 INFO] Train accuracy: 32.6808
[2024-03-12 15:34:52,078 INFO] Sentences processed: 140208
[2024-03-12 15:34:52,078 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:34:52,078 INFO] Validation perplexity: 1140.6
[2024-03-12 15:34:52,078 INFO] Validation accuracy: 29.2419
[2024-03-12 15:34:52,079 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_9400.pt
[2024-03-12 15:34:54,506 INFO] Step 9450/11400; acc: 75.5; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 4897/4222 tok/s;    197 sec;
[2024-03-12 15:34:56,712 INFO] Step 9500/11400; acc: 76.4; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2469; bsz:  583/ 505/49; 13208/11458 tok/s;    199 sec;
[2024-03-12 15:34:59,046 INFO] Step 9550/11400; acc: 76.7; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2267; bsz:  561/ 484/45; 12015/10368 tok/s;    202 sec;
[2024-03-12 15:35:01,392 INFO] Step 9600/11400; acc: 77.6; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2372; bsz:  583/ 504/47; 12422/10748 tok/s;    204 sec;
[2024-03-12 15:35:04,691 INFO] valid stats calculation
                           took: 3.298924446105957 s.
[2024-03-12 15:35:04,692 INFO] Train perplexity: 199.107
[2024-03-12 15:35:04,692 INFO] Train accuracy: 35.4239
[2024-03-12 15:35:04,692 INFO] Sentences processed: 149578
[2024-03-12 15:35:04,692 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:35:04,692 INFO] Validation perplexity: 1273.54
[2024-03-12 15:35:04,692 INFO] Validation accuracy: 28.921
[2024-03-12 15:35:04,693 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_9600.pt
[2024-03-12 15:35:07,163 INFO] Step 9650/11400; acc: 78.7; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2371; bsz:  566/ 492/47; 4902/4267 tok/s;    210 sec;
[2024-03-12 15:35:09,547 INFO] Step 9700/11400; acc: 79.2; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2273; bsz:  558/ 485/45; 11712/10169 tok/s;    212 sec;
[2024-03-12 15:35:11,893 INFO] Step 9750/11400; acc: 79.8; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2382; bsz:  568/ 496/48; 12113/10581 tok/s;    215 sec;
[2024-03-12 15:35:14,272 INFO] Step 9800/11400; acc: 79.8; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2376; bsz:  590/ 511/48; 12399/10746 tok/s;    217 sec;
[2024-03-12 15:35:17,569 INFO] valid stats calculation
                           took: 3.297154188156128 s.
[2024-03-12 15:35:17,570 INFO] Train perplexity: 151.923
[2024-03-12 15:35:17,570 INFO] Train accuracy: 38.0205
[2024-03-12 15:35:17,570 INFO] Sentences processed: 158980
[2024-03-12 15:35:17,570 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:35:17,570 INFO] Validation perplexity: 1664.44
[2024-03-12 15:35:17,570 INFO] Validation accuracy: 27.517
[2024-03-12 15:35:17,571 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_9800.pt
[2024-03-12 15:35:20,059 INFO] Step 9850/11400; acc: 81.0; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2280; bsz:  565/ 490/46; 4883/4236 tok/s;    223 sec;
[2024-03-12 15:35:22,456 INFO] Step 9900/11400; acc: 81.8; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2368; bsz:  585/ 506/47; 12212/10567 tok/s;    225 sec;
[2024-03-12 15:35:24,717 INFO] Step 9950/11400; acc: 83.3; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2246; bsz:  529/ 460/45; 11707/10182 tok/s;    227 sec;
[2024-03-12 15:35:27,079 INFO] Step 10000/11400; acc: 82.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2368; bsz:  587/ 509/47; 12429/10765 tok/s;    230 sec;
[2024-03-12 15:35:30,405 INFO] valid stats calculation
                           took: 3.325134754180908 s.
[2024-03-12 15:35:30,405 INFO] Train perplexity: 119.073
[2024-03-12 15:35:30,405 INFO] Train accuracy: 40.4548
[2024-03-12 15:35:30,405 INFO] Sentences processed: 168242
[2024-03-12 15:35:30,405 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:35:30,405 INFO] Validation perplexity: 2465.02
[2024-03-12 15:35:30,405 INFO] Validation accuracy: 26.6747
[2024-03-12 15:35:30,407 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_10000.pt
[2024-03-12 15:35:32,809 INFO] Step 10050/11400; acc: 83.2; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2363; bsz:  576/ 498/47; 5031/4344 tok/s;    236 sec;
[2024-03-12 15:35:35,131 INFO] Step 10100/11400; acc: 83.7; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2251; bsz:  552/ 480/45; 11894/10340 tok/s;    238 sec;
[2024-03-12 15:35:37,431 INFO] Step 10150/11400; acc: 84.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2372; bsz:  566/ 492/47; 12298/10691 tok/s;    240 sec;
[2024-03-12 15:35:39,834 INFO] Step 10200/11400; acc: 84.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2274; bsz:  563/ 490/45; 11711/10185 tok/s;    243 sec;
[2024-03-12 15:35:43,142 INFO] valid stats calculation
                           took: 3.3068201541900635 s.
[2024-03-12 15:35:43,142 INFO] Train perplexity: 95.457
[2024-03-12 15:35:43,142 INFO] Train accuracy: 42.7257
[2024-03-12 15:35:43,142 INFO] Sentences processed: 177502
[2024-03-12 15:35:43,142 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:35:43,142 INFO] Validation perplexity: 2625.95
[2024-03-12 15:35:43,142 INFO] Validation accuracy: 26.8753
[2024-03-12 15:35:43,144 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_10200.pt
[2024-03-12 15:35:45,593 INFO] Step 10250/11400; acc: 85.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2375; bsz:  563/ 491/48; 4888/4262 tok/s;    248 sec;
[2024-03-12 15:35:47,930 INFO] Step 10300/11400; acc: 85.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2381; bsz:  582/ 505/48; 12444/10798 tok/s;    251 sec;
[2024-03-12 15:35:50,309 INFO] Step 10350/11400; acc: 85.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2277; bsz:  566/ 489/46; 11889/10278 tok/s;    253 sec;
[2024-03-12 15:35:52,663 INFO] Step 10400/11400; acc: 86.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2377; bsz:  585/ 512/48; 12431/10868 tok/s;    255 sec;
[2024-03-12 15:35:55,950 INFO] valid stats calculation
                           took: 3.285980701446533 s.
[2024-03-12 15:35:55,950 INFO] Train perplexity: 77.6912
[2024-03-12 15:35:55,950 INFO] Train accuracy: 44.9015
[2024-03-12 15:35:55,950 INFO] Sentences processed: 186912
[2024-03-12 15:35:55,950 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:35:55,950 INFO] Validation perplexity: 3877.24
[2024-03-12 15:35:55,950 INFO] Validation accuracy: 25.8724
[2024-03-12 15:35:55,952 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_10400.pt
[2024-03-12 15:35:58,386 INFO] Step 10450/11400; acc: 86.5; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2372; bsz:  568/ 497/47; 4958/4340 tok/s;    261 sec;
[2024-03-12 15:36:00,743 INFO] Step 10500/11400; acc: 87.0; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2367; bsz:  563/ 489/47; 11938/10374 tok/s;    264 sec;
[2024-03-12 15:36:03,041 INFO] Step 10550/11400; acc: 87.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2367; bsz:  576/ 496/47; 12521/10788 tok/s;    266 sec;
[2024-03-12 15:36:05,326 INFO] Step 10600/11400; acc: 87.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2260; bsz:  554/ 481/45; 12116/10518 tok/s;    268 sec;
[2024-03-12 15:36:08,618 INFO] valid stats calculation
                           took: 3.2912044525146484 s.
[2024-03-12 15:36:08,618 INFO] Train perplexity: 64.5551
[2024-03-12 15:36:08,618 INFO] Train accuracy: 46.8963
[2024-03-12 15:36:08,618 INFO] Sentences processed: 196278
[2024-03-12 15:36:08,618 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:36:08,619 INFO] Validation perplexity: 3288.71
[2024-03-12 15:36:08,619 INFO] Validation accuracy: 28.3995
[2024-03-12 15:36:08,620 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_10600.pt
[2024-03-12 15:36:11,065 INFO] Step 10650/11400; acc: 88.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2367; bsz:  563/ 492/47; 4910/4287 tok/s;    274 sec;
[2024-03-12 15:36:13,385 INFO] Step 10700/11400; acc: 87.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2268; bsz:  576/ 496/45; 12407/10689 tok/s;    276 sec;
[2024-03-12 15:36:15,754 INFO] Step 10750/11400; acc: 88.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2373; bsz:  566/ 495/47; 11948/10450 tok/s;    279 sec;
[2024-03-12 15:36:18,149 INFO] Step 10800/11400; acc: 88.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2372; bsz:  585/ 503/47; 12205/10509 tok/s;    281 sec;
[2024-03-12 15:36:21,448 INFO] valid stats calculation
                           took: 3.2985169887542725 s.
[2024-03-12 15:36:21,449 INFO] Train perplexity: 54.3468
[2024-03-12 15:36:21,449 INFO] Train accuracy: 48.7867
[2024-03-12 15:36:21,449 INFO] Sentences processed: 205658
[2024-03-12 15:36:21,449 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:36:21,449 INFO] Validation perplexity: 4007.2
[2024-03-12 15:36:21,449 INFO] Validation accuracy: 27.6775
[2024-03-12 15:36:21,450 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_10800.pt
[2024-03-12 15:36:23,852 INFO] Step 10850/11400; acc: 89.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  561/ 487/48; 4920/4273 tok/s;    287 sec;
[2024-03-12 15:36:26,192 INFO] Step 10900/11400; acc: 89.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2281; bsz:  559/ 484/46; 11934/10337 tok/s;    289 sec;
[2024-03-12 15:36:28,548 INFO] Step 10950/11400; acc: 89.0; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2376; bsz:  589/ 509/48; 12495/10807 tok/s;    291 sec;
[2024-03-12 15:36:30,929 INFO] Step 11000/11400; acc: 89.5; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2277; bsz:  564/ 488/46; 11852/10257 tok/s;    294 sec;
[2024-03-12 15:36:34,213 INFO] valid stats calculation
                           took: 3.2835769653320312 s.
[2024-03-12 15:36:34,213 INFO] Train perplexity: 46.4463
[2024-03-12 15:36:34,213 INFO] Train accuracy: 50.533
[2024-03-12 15:36:34,213 INFO] Sentences processed: 214967
[2024-03-12 15:36:34,213 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:36:34,213 INFO] Validation perplexity: 3904.07
[2024-03-12 15:36:34,213 INFO] Validation accuracy: 27.9182
[2024-03-12 15:36:34,215 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_11000.pt
[2024-03-12 15:36:36,674 INFO] Step 11050/11400; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2371; bsz:  565/ 491/47; 4919/4274 tok/s;    299 sec;
[2024-03-12 15:36:39,001 INFO] Step 11100/11400; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  579/ 500/47; 12443/10736 tok/s;    302 sec;
[2024-03-12 15:36:41,327 INFO] Step 11150/11400; acc: 90.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2263; bsz:  559/ 483/45; 12022/10377 tok/s;    304 sec;
[2024-03-12 15:36:43,575 INFO] Step 11200/11400; acc: 90.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2365; bsz:  564/ 489/47; 12542/10884 tok/s;    306 sec;
[2024-03-12 15:36:46,875 INFO] valid stats calculation
                           took: 3.2992191314697266 s.
[2024-03-12 15:36:46,875 INFO] Train perplexity: 40.1658
[2024-03-12 15:36:46,875 INFO] Train accuracy: 52.1756
[2024-03-12 15:36:46,875 INFO] Sentences processed: 224332
[2024-03-12 15:36:46,875 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:36:46,875 INFO] Validation perplexity: 5666.62
[2024-03-12 15:36:46,875 INFO] Validation accuracy: 28.2792
[2024-03-12 15:36:46,877 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_11200.pt
[2024-03-12 15:36:49,281 INFO] Step 11250/11400; acc: 91.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  566/ 494/47; 4960/4332 tok/s;    312 sec;
[2024-03-12 15:36:51,608 INFO] Step 11300/11400; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2267; bsz:  558/ 484/45; 11996/10406 tok/s;    314 sec;
[2024-03-12 15:36:53,967 INFO] Step 11350/11400; acc: 90.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  582/ 503/47; 12334/10673 tok/s;    317 sec;
[2024-03-12 15:36:56,362 INFO] Step 11400/11400; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2257; bsz:  556/ 481/45; 11612/10042 tok/s;    319 sec;
[2024-03-12 15:36:59,669 INFO] valid stats calculation
                           took: 3.3055076599121094 s.
[2024-03-12 15:36:59,669 INFO] Train perplexity: 35.12
[2024-03-12 15:36:59,669 INFO] Train accuracy: 53.7084
[2024-03-12 15:36:59,669 INFO] Sentences processed: 233595
[2024-03-12 15:36:59,669 INFO] Average bsz:  569/ 494/47
[2024-03-12 15:36:59,669 INFO] Validation perplexity: 5870.89
[2024-03-12 15:36:59,669 INFO] Validation accuracy: 27.2363
[2024-03-12 15:36:59,671 INFO] Saving checkpoint tg-ft-dec/tg-ft-dec_6400_02_step_11400.pt
