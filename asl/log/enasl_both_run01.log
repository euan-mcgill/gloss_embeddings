[2024-03-08 17:06:52,751 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-08 17:06:52,751 INFO] Parsed 2 corpora from -data.
[2024-03-08 17:06:52,751 INFO] Get special vocabs from Transforms: {'src': [], 'tgt': []}.
[2024-03-08 17:06:52,756 INFO] Reading encoder embeddings from en_w2v.txt
[2024-03-08 17:07:27,914 INFO] 	Found 3000000 total vectors in file.
[2024-03-08 17:07:27,914 INFO] Reading decoder embeddings from asl_w2v.txt
[2024-03-08 17:08:03,233 INFO] 	Found 3002605 total vectors in file
[2024-03-08 17:08:03,234 INFO] After filtering to vectors in vocab:
[2024-03-08 17:08:03,234 INFO] 	* enc: 2268 match, 116 missing, (95.13%)
[2024-03-08 17:08:03,235 INFO] 	* dec: 1833 match, 583 missing, (75.87%)
[2024-03-08 17:08:03,235 INFO] 
Saving encoder embeddings as:
	* enc: tg-both.enc_embeddings.pt
[2024-03-08 17:08:03,701 INFO] 
Saving decoder embeddings as:
	* dec: tg-both.dec_embeddings.pt
[2024-03-08 17:08:04,113 INFO] The first 10 tokens of the vocabs are:['<unk>', '<blank>', '<s>', '</s>', '.', 'the', ',', 'i', 'to', 'it']
[2024-03-08 17:08:04,114 INFO] The decoder start token is: <s>
[2024-03-08 17:08:04,114 INFO] Building model...
[2024-03-08 17:08:04,226 INFO] Switching model to float32 for amp/apex_amp
[2024-03-08 17:08:04,226 INFO] Non quantized layer compute is fp32
[2024-03-08 17:08:06,251 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(2384, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(2416, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=2416, bias=True)
)
[2024-03-08 17:08:06,252 INFO] encoder: 4323200
[2024-03-08 17:08:06,252 INFO] decoder: 7293216
[2024-03-08 17:08:06,252 INFO] * number of parameters: 11616416
[2024-03-08 17:08:06,252 INFO] Trainable parameters = {'torch.float32': 11616416, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-08 17:08:06,252 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-08 17:08:06,252 INFO]  * src vocab size = 2384
[2024-03-08 17:08:06,252 INFO]  * tgt vocab size = 2416
[2024-03-08 17:08:06,253 INFO] Starting training on GPU: [0]
[2024-03-08 17:08:06,253 INFO] Start training loop and validate every 200 steps...
[2024-03-08 17:08:06,253 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-08 17:08:11,127 INFO] Step 50/10000; acc: 9.1; ppl: 22988.9; xent: 10.0; lr: 1.00000; sents:    2270; bsz:  565/ 490/45; 5799/5025 tok/s;      5 sec;
[2024-03-08 17:08:13,504 INFO] Step 100/10000; acc: 11.8; ppl: 2471.8; xent: 7.8; lr: 1.00000; sents:    2465; bsz:  594/ 519/49; 12489/10918 tok/s;      7 sec;
[2024-03-08 17:08:16,419 INFO] Step 150/10000; acc: 11.1; ppl: 722.3; xent: 6.6; lr: 1.00000; sents:    2267; bsz:  560/ 485/45; 9606/8316 tok/s;     10 sec;
[2024-03-08 17:08:19,270 INFO] Step 200/10000; acc: 12.1; ppl: 467.0; xent: 6.1; lr: 1.00000; sents:    2365; bsz:  563/ 489/47; 9872/8575 tok/s;     13 sec;
[2024-03-08 17:08:21,239 INFO] valid stats calculation
                           took: 1.9693717956542969 s.
[2024-03-08 17:08:21,240 INFO] Train perplexity: 2104.69
[2024-03-08 17:08:21,240 INFO] Train accuracy: 11.0354
[2024-03-08 17:08:21,240 INFO] Sentences processed: 9367
[2024-03-08 17:08:21,240 INFO] Average bsz:  570/ 496/47
[2024-03-08 17:08:21,240 INFO] Validation perplexity: 424.962
[2024-03-08 17:08:21,240 INFO] Validation accuracy: 10.9908
[2024-03-08 17:08:21,240 INFO] Saving checkpoint tg-both/tg_01_step_200.pt
[2024-03-08 17:08:24,193 INFO] Step 250/10000; acc: 12.4; ppl: 401.9; xent: 6.0; lr: 1.00000; sents:    2246; bsz:  547/ 473/45; 5551/4808 tok/s;     18 sec;
[2024-03-08 17:08:26,767 INFO] Step 300/10000; acc: 12.8; ppl: 383.9; xent: 6.0; lr: 1.00000; sents:    2372; bsz:  589/ 511/47; 11447/9925 tok/s;     21 sec;
[2024-03-08 17:08:29,837 INFO] Step 350/10000; acc: 13.2; ppl: 288.5; xent: 5.7; lr: 1.00000; sents:    2378; bsz:  586/ 509/48; 9538/8292 tok/s;     24 sec;
[2024-03-08 17:08:32,837 INFO] Step 400/10000; acc: 13.9; ppl: 251.3; xent: 5.5; lr: 1.00000; sents:    2280; bsz:  562/ 488/46; 9377/8128 tok/s;     27 sec;
[2024-03-08 17:08:34,874 INFO] valid stats calculation
                           took: 2.0373120307922363 s.
[2024-03-08 17:08:34,874 INFO] Train perplexity: 827.231
[2024-03-08 17:08:34,875 INFO] Train accuracy: 12.0584
[2024-03-08 17:08:34,875 INFO] Sentences processed: 18643
[2024-03-08 17:08:34,875 INFO] Average bsz:  571/ 495/47
[2024-03-08 17:08:34,875 INFO] Validation perplexity: 383.451
[2024-03-08 17:08:34,875 INFO] Validation accuracy: 13.9591
[2024-03-08 17:08:34,875 INFO] Saving checkpoint tg-both/tg_01_step_400.pt
[2024-03-08 17:08:37,808 INFO] Step 450/10000; acc: 15.3; ppl: 216.8; xent: 5.4; lr: 1.00000; sents:    2381; bsz:  568/ 495/48; 5713/4975 tok/s;     32 sec;
[2024-03-08 17:08:40,368 INFO] Step 500/10000; acc: 16.8; ppl: 188.6; xent: 5.2; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 11313/9769 tok/s;     34 sec;
[2024-03-08 17:08:43,214 INFO] Step 550/10000; acc: 18.7; ppl: 159.0; xent: 5.1; lr: 1.00000; sents:    2258; bsz:  553/ 479/45; 9711/8411 tok/s;     37 sec;
[2024-03-08 17:08:46,118 INFO] Step 600/10000; acc: 19.3; ppl: 145.7; xent: 5.0; lr: 1.00000; sents:    2366; bsz:  562/ 489/47; 9681/8423 tok/s;     40 sec;
[2024-03-08 17:08:48,119 INFO] valid stats calculation
                           took: 2.0004355907440186 s.
[2024-03-08 17:08:48,119 INFO] Train perplexity: 495.183
[2024-03-08 17:08:48,119 INFO] Train accuracy: 13.8606
[2024-03-08 17:08:48,119 INFO] Sentences processed: 28023
[2024-03-08 17:08:48,119 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:08:48,119 INFO] Validation perplexity: 381.126
[2024-03-08 17:08:48,120 INFO] Validation accuracy: 12.2343
[2024-03-08 17:08:48,120 INFO] Saving checkpoint tg-both/tg_01_step_600.pt
[2024-03-08 17:08:51,061 INFO] Step 650/10000; acc: 20.2; ppl: 128.5; xent: 4.9; lr: 1.00000; sents:    2367; bsz:  587/ 513/47; 5938/5184 tok/s;     45 sec;
[2024-03-08 17:08:53,703 INFO] Step 700/10000; acc: 21.1; ppl: 119.6; xent: 4.8; lr: 1.00000; sents:    2268; bsz:  567/ 491/45; 10735/9299 tok/s;     47 sec;
[2024-03-08 17:08:56,453 INFO] Step 750/10000; acc: 21.7; ppl: 106.5; xent: 4.7; lr: 1.00000; sents:    2367; bsz:  567/ 499/47; 10315/9066 tok/s;     50 sec;
[2024-03-08 17:08:59,275 INFO] Step 800/10000; acc: 22.4; ppl:  95.5; xent: 4.6; lr: 1.00000; sents:    2365; bsz:  561/ 487/47; 9935/8622 tok/s;     53 sec;
[2024-03-08 17:09:01,267 INFO] valid stats calculation
                           took: 1.99198579788208 s.
[2024-03-08 17:09:01,268 INFO] Train perplexity: 340.823
[2024-03-08 17:09:01,268 INFO] Train accuracy: 15.7439
[2024-03-08 17:09:01,268 INFO] Sentences processed: 37390
[2024-03-08 17:09:01,268 INFO] Average bsz:  569/ 495/47
[2024-03-08 17:09:01,268 INFO] Validation perplexity: 227.006
[2024-03-08 17:09:01,268 INFO] Validation accuracy: 20.016
[2024-03-08 17:09:01,269 INFO] Saving checkpoint tg-both/tg_01_step_800.pt
[2024-03-08 17:09:04,225 INFO] Step 850/10000; acc: 23.9; ppl:  86.3; xent: 4.5; lr: 1.00000; sents:    2269; bsz:  557/ 482/45; 5624/4867 tok/s;     58 sec;
[2024-03-08 17:09:06,813 INFO] Step 900/10000; acc: 25.5; ppl:  74.4; xent: 4.3; lr: 1.00000; sents:    2371; bsz:  576/ 500/47; 11118/9667 tok/s;     61 sec;
[2024-03-08 17:09:09,725 INFO] Step 950/10000; acc: 26.4; ppl:  66.2; xent: 4.2; lr: 1.00000; sents:    2376; bsz:  581/ 506/48; 9981/8685 tok/s;     63 sec;
[2024-03-08 17:09:12,620 INFO] Step 1000/10000; acc: 27.5; ppl:  56.0; xent: 4.0; lr: 1.00000; sents:    2381; bsz:  566/ 495/48; 9776/8548 tok/s;     66 sec;
[2024-03-08 17:09:14,608 INFO] valid stats calculation
                           took: 1.986833095550537 s.
[2024-03-08 17:09:14,608 INFO] Train perplexity: 248.036
[2024-03-08 17:09:14,608 INFO] Train accuracy: 17.7605
[2024-03-08 17:09:14,608 INFO] Sentences processed: 46787
[2024-03-08 17:09:14,608 INFO] Average bsz:  569/ 495/47
[2024-03-08 17:09:14,608 INFO] Validation perplexity: 250.191
[2024-03-08 17:09:14,608 INFO] Validation accuracy: 21.4601
[2024-03-08 17:09:14,609 INFO] Saving checkpoint tg-both/tg_01_step_1000.pt
[2024-03-08 17:09:17,611 INFO] Step 1050/10000; acc: 27.5; ppl:  54.8; xent: 4.0; lr: 1.00000; sents:    2279; bsz:  562/ 485/46; 5629/4860 tok/s;     71 sec;
[2024-03-08 17:09:20,138 INFO] Step 1100/10000; acc: 28.4; ppl:  49.0; xent: 3.9; lr: 1.00000; sents:    2375; bsz:  579/ 498/48; 11449/9851 tok/s;     74 sec;
[2024-03-08 17:09:22,960 INFO] Step 1150/10000; acc: 30.1; ppl:  41.6; xent: 3.7; lr: 1.00000; sents:    2271; bsz:  547/ 474/45; 9691/8399 tok/s;     77 sec;
[2024-03-08 17:09:25,917 INFO] Step 1200/10000; acc: 31.7; ppl:  37.2; xent: 3.6; lr: 1.00000; sents:    2366; bsz:  577/ 501/47; 9759/8472 tok/s;     80 sec;
[2024-03-08 17:09:27,907 INFO] valid stats calculation
                           took: 1.9890930652618408 s.
[2024-03-08 17:09:27,907 INFO] Train perplexity: 187.195
[2024-03-08 17:09:27,908 INFO] Train accuracy: 19.6885
[2024-03-08 17:09:27,908 INFO] Sentences processed: 56078
[2024-03-08 17:09:27,908 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:09:27,908 INFO] Validation perplexity: 235.53
[2024-03-08 17:09:27,908 INFO] Validation accuracy: 23.7866
[2024-03-08 17:09:27,908 INFO] Saving checkpoint tg-both/tg_01_step_1200.pt
[2024-03-08 17:09:30,797 INFO] Step 1250/10000; acc: 32.7; ppl:  34.4; xent: 3.5; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 5782/5026 tok/s;     85 sec;
[2024-03-08 17:09:33,542 INFO] Step 1300/10000; acc: 32.3; ppl:  33.0; xent: 3.5; lr: 1.00000; sents:    2264; bsz:  582/ 502/45; 10607/9154 tok/s;     87 sec;
[2024-03-08 17:09:36,215 INFO] Step 1350/10000; acc: 35.8; ppl:  25.8; xent: 3.2; lr: 1.00000; sents:    2369; bsz:  566/ 491/47; 10582/9189 tok/s;     90 sec;
[2024-03-08 17:09:39,069 INFO] Step 1400/10000; acc: 37.0; ppl:  22.6; xent: 3.1; lr: 1.00000; sents:    2367; bsz:  563/ 488/47; 9862/8547 tok/s;     93 sec;
[2024-03-08 17:09:41,033 INFO] valid stats calculation
                           took: 1.9627788066864014 s.
[2024-03-08 17:09:41,033 INFO] Train perplexity: 143.15
[2024-03-08 17:09:41,033 INFO] Train accuracy: 21.792
[2024-03-08 17:09:41,033 INFO] Sentences processed: 65444
[2024-03-08 17:09:41,033 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:09:41,033 INFO] Validation perplexity: 255.043
[2024-03-08 17:09:41,033 INFO] Validation accuracy: 23.9069
[2024-03-08 17:09:41,034 INFO] Saving checkpoint tg-both/tg_01_step_1400.pt
[2024-03-08 17:09:44,054 INFO] Step 1450/10000; acc: 38.1; ppl:  20.2; xent: 3.0; lr: 1.00000; sents:    2272; bsz:  561/ 484/45; 5632/4856 tok/s;     98 sec;
[2024-03-08 17:09:46,837 INFO] Step 1500/10000; acc: 40.2; ppl:  17.7; xent: 2.9; lr: 1.00000; sents:    2371; bsz:  581/ 502/47; 10439/9019 tok/s;    101 sec;
[2024-03-08 17:09:49,596 INFO] Step 1550/10000; acc: 42.6; ppl:  14.7; xent: 2.7; lr: 1.00000; sents:    2375; bsz:  583/ 505/48; 10566/9146 tok/s;    103 sec;
[2024-03-08 17:09:52,536 INFO] Step 1600/10000; acc: 44.3; ppl:  13.0; xent: 2.6; lr: 1.00000; sents:    2280; bsz:  559/ 486/46; 9509/8258 tok/s;    106 sec;
[2024-03-08 17:09:54,495 INFO] valid stats calculation
                           took: 1.9583520889282227 s.
[2024-03-08 17:09:54,495 INFO] Train perplexity: 108.978
[2024-03-08 17:09:54,495 INFO] Train accuracy: 24.2279
[2024-03-08 17:09:54,495 INFO] Sentences processed: 74742
[2024-03-08 17:09:54,495 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:09:54,495 INFO] Validation perplexity: 335.331
[2024-03-08 17:09:54,495 INFO] Validation accuracy: 25.3911
[2024-03-08 17:09:54,496 INFO] Saving checkpoint tg-both/tg_01_step_1600.pt
[2024-03-08 17:09:57,478 INFO] Step 1650/10000; acc: 47.4; ppl:  10.6; xent: 2.4; lr: 1.00000; sents:    2376; bsz:  564/ 490/48; 5703/4956 tok/s;    111 sec;
[2024-03-08 17:10:00,218 INFO] Step 1700/10000; acc: 49.2; ppl:   9.6; xent: 2.3; lr: 1.00000; sents:    2376; bsz:  568/ 496/48; 10375/9054 tok/s;    114 sec;
[2024-03-08 17:10:02,937 INFO] Step 1750/10000; acc: 51.7; ppl:   8.1; xent: 2.1; lr: 1.00000; sents:    2272; bsz:  563/ 488/45; 10355/8981 tok/s;    117 sec;
[2024-03-08 17:10:05,874 INFO] Step 1800/10000; acc: 52.1; ppl:   7.9; xent: 2.1; lr: 1.00000; sents:    2366; bsz:  589/ 511/47; 10028/8701 tok/s;    120 sec;
[2024-03-08 17:10:07,877 INFO] valid stats calculation
                           took: 2.002551794052124 s.
[2024-03-08 17:10:07,878 INFO] Train perplexity: 82.4983
[2024-03-08 17:10:07,878 INFO] Train accuracy: 27.1151
[2024-03-08 17:10:07,878 INFO] Sentences processed: 84132
[2024-03-08 17:10:07,878 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:10:07,878 INFO] Validation perplexity: 464.863
[2024-03-08 17:10:07,878 INFO] Validation accuracy: 27.2363
[2024-03-08 17:10:07,878 INFO] Saving checkpoint tg-both/tg_01_step_1800.pt
[2024-03-08 17:10:10,752 INFO] Step 1850/10000; acc: 56.1; ppl:   6.3; xent: 1.8; lr: 1.00000; sents:    2369; bsz:  566/ 492/47; 5807/5043 tok/s;    124 sec;
[2024-03-08 17:10:13,484 INFO] Step 1900/10000; acc: 56.2; ppl:   6.2; xent: 1.8; lr: 1.00000; sents:    2363; bsz:  585/ 507/47; 10713/9289 tok/s;    127 sec;
[2024-03-08 17:10:16,051 INFO] Step 1950/10000; acc: 60.2; ppl:   5.2; xent: 1.6; lr: 1.00000; sents:    2244; bsz:  547/ 474/45; 10660/9232 tok/s;    130 sec;
[2024-03-08 17:10:18,900 INFO] Step 2000/10000; acc: 61.7; ppl:   4.6; xent: 1.5; lr: 1.00000; sents:    2367; bsz:  561/ 488/47; 9843/8561 tok/s;    133 sec;
[2024-03-08 17:10:20,899 INFO] valid stats calculation
                           took: 1.998584270477295 s.
[2024-03-08 17:10:20,899 INFO] Train perplexity: 63.0679
[2024-03-08 17:10:20,899 INFO] Train accuracy: 30.2316
[2024-03-08 17:10:20,899 INFO] Sentences processed: 93475
[2024-03-08 17:10:20,899 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:10:20,899 INFO] Validation perplexity: 702.789
[2024-03-08 17:10:20,899 INFO] Validation accuracy: 26.5945
[2024-03-08 17:10:20,900 INFO] Saving checkpoint tg-both/tg_01_step_2000.pt
[2024-03-08 17:10:23,945 INFO] Step 2050/10000; acc: 64.4; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    2268; bsz:  558/ 482/45; 5527/4778 tok/s;    138 sec;
[2024-03-08 17:10:26,875 INFO] Step 2100/10000; acc: 65.6; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    2379; bsz:  587/ 510/48; 10010/8705 tok/s;    141 sec;
[2024-03-08 17:10:29,485 INFO] Step 2150/10000; acc: 67.8; ppl:   3.5; xent: 1.3; lr: 1.00000; sents:    2274; bsz:  558/ 483/45; 10687/9261 tok/s;    143 sec;
[2024-03-08 17:10:32,429 INFO] Step 2200/10000; acc: 70.0; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    2376; bsz:  580/ 503/48; 9852/8541 tok/s;    146 sec;
[2024-03-08 17:10:34,442 INFO] valid stats calculation
                           took: 2.012515068054199 s.
[2024-03-08 17:10:34,442 INFO] Train perplexity: 48.6361
[2024-03-08 17:10:34,442 INFO] Train accuracy: 33.5729
[2024-03-08 17:10:34,442 INFO] Sentences processed: 102772
[2024-03-08 17:10:34,442 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:10:34,442 INFO] Validation perplexity: 1279.01
[2024-03-08 17:10:34,442 INFO] Validation accuracy: 25.3109
[2024-03-08 17:10:34,443 INFO] Saving checkpoint tg-both/tg_01_step_2200.pt
[2024-03-08 17:10:37,376 INFO] Step 2250/10000; acc: 71.6; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 5692/4944 tok/s;    151 sec;
[2024-03-08 17:10:40,241 INFO] Step 2300/10000; acc: 72.5; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    2372; bsz:  566/ 496/47; 9883/8659 tok/s;    154 sec;
[2024-03-08 17:10:42,946 INFO] Step 2350/10000; acc: 74.2; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    2270; bsz:  567/ 493/45; 10490/9111 tok/s;    157 sec;
[2024-03-08 17:10:45,913 INFO] Step 2400/10000; acc: 75.2; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2367; bsz:  588/ 515/47; 9906/8673 tok/s;    160 sec;
[2024-03-08 17:10:47,875 INFO] valid stats calculation
                           took: 1.961317539215088 s.
[2024-03-08 17:10:47,875 INFO] Train perplexity: 38.1599
[2024-03-08 17:10:47,875 INFO] Train accuracy: 36.919
[2024-03-08 17:10:47,875 INFO] Sentences processed: 112156
[2024-03-08 17:10:47,875 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:10:47,875 INFO] Validation perplexity: 1515.24
[2024-03-08 17:10:47,875 INFO] Validation accuracy: 25.1103
[2024-03-08 17:10:47,876 INFO] Saving checkpoint tg-both/tg_01_step_2400.pt
[2024-03-08 17:10:50,836 INFO] Step 2450/10000; acc: 76.7; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2364; bsz:  573/ 494/47; 5820/5017 tok/s;    165 sec;
[2024-03-08 17:10:53,744 INFO] Step 2500/10000; acc: 77.4; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2263; bsz:  553/ 479/45; 9512/8229 tok/s;    167 sec;
[2024-03-08 17:10:56,316 INFO] Step 2550/10000; acc: 79.1; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2365; bsz:  562/ 489/47; 10921/9509 tok/s;    170 sec;
[2024-03-08 17:10:59,305 INFO] Step 2600/10000; acc: 80.0; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2373; bsz:  582/ 507/47; 9733/8479 tok/s;    173 sec;
[2024-03-08 17:11:01,275 INFO] valid stats calculation
                           took: 1.969984531402588 s.
[2024-03-08 17:11:01,276 INFO] Train perplexity: 30.6789
[2024-03-08 17:11:01,276 INFO] Train accuracy: 40.0917
[2024-03-08 17:11:01,276 INFO] Sentences processed: 121521
[2024-03-08 17:11:01,276 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:11:01,276 INFO] Validation perplexity: 1801.29
[2024-03-08 17:11:01,276 INFO] Validation accuracy: 25.9126
[2024-03-08 17:11:01,276 INFO] Saving checkpoint tg-both/tg_01_step_2600.pt
[2024-03-08 17:11:04,342 INFO] Step 2650/10000; acc: 81.4; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2371; bsz:  565/ 494/47; 5608/4906 tok/s;    178 sec;
[2024-03-08 17:11:07,216 INFO] Step 2700/10000; acc: 81.4; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2279; bsz:  562/ 486/46; 9785/8451 tok/s;    181 sec;
[2024-03-08 17:11:09,758 INFO] Step 2750/10000; acc: 82.1; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2381; bsz:  566/ 491/48; 11137/9662 tok/s;    184 sec;
[2024-03-08 17:11:12,725 INFO] Step 2800/10000; acc: 82.4; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2276; bsz:  561/ 485/46; 9461/8177 tok/s;    186 sec;
[2024-03-08 17:11:14,749 INFO] valid stats calculation
                           took: 2.0237162113189697 s.
[2024-03-08 17:11:14,749 INFO] Train perplexity: 25.2173
[2024-03-08 17:11:14,749 INFO] Train accuracy: 43.0425
[2024-03-08 17:11:14,749 INFO] Sentences processed: 130828
[2024-03-08 17:11:14,749 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:11:14,749 INFO] Validation perplexity: 2272.08
[2024-03-08 17:11:14,750 INFO] Validation accuracy: 26.073
[2024-03-08 17:11:14,750 INFO] Saving checkpoint tg-both/tg_01_step_2800.pt
[2024-03-08 17:11:17,711 INFO] Step 2850/10000; acc: 83.3; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2375; bsz:  579/ 499/48; 5806/5000 tok/s;    191 sec;
[2024-03-08 17:11:20,626 INFO] Step 2900/10000; acc: 83.1; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2273; bsz:  565/ 489/45; 9693/8387 tok/s;    194 sec;
[2024-03-08 17:11:22,989 INFO] Step 2950/10000; acc: 83.9; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2464; bsz:  584/ 508/49; 12370/10757 tok/s;    197 sec;
[2024-03-08 17:11:25,925 INFO] Step 3000/10000; acc: 84.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 9597/8320 tok/s;    200 sec;
[2024-03-08 17:11:27,928 INFO] valid stats calculation
                           took: 2.00309681892395 s.
[2024-03-08 17:11:27,929 INFO] Train perplexity: 21.1176
[2024-03-08 17:11:27,929 INFO] Train accuracy: 45.7668
[2024-03-08 17:11:27,929 INFO] Sentences processed: 140208
[2024-03-08 17:11:27,929 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:11:27,929 INFO] Validation perplexity: 2448.76
[2024-03-08 17:11:27,929 INFO] Validation accuracy: 26.8753
[2024-03-08 17:11:27,929 INFO] Saving checkpoint tg-both/tg_01_step_3000.pt
[2024-03-08 17:11:30,821 INFO] Step 3050/10000; acc: 85.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2362; bsz:  562/ 488/47; 5742/4985 tok/s;    205 sec;
[2024-03-08 17:11:33,772 INFO] Step 3100/10000; acc: 85.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2267; bsz:  577/ 495/45; 9785/8385 tok/s;    208 sec;
[2024-03-08 17:11:36,246 INFO] Step 3150/10000; acc: 86.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2369; bsz:  563/ 489/47; 11388/9883 tok/s;    210 sec;
[2024-03-08 17:11:39,284 INFO] Step 3200/10000; acc: 86.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2270; bsz:  559/ 485/45; 9206/7986 tok/s;    213 sec;
[2024-03-08 17:11:41,282 INFO] valid stats calculation
                           took: 1.9979121685028076 s.
[2024-03-08 17:11:41,282 INFO] Train perplexity: 18.0244
[2024-03-08 17:11:41,283 INFO] Train accuracy: 48.2596
[2024-03-08 17:11:41,283 INFO] Sentences processed: 149476
[2024-03-08 17:11:41,283 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:11:41,283 INFO] Validation perplexity: 3300.77
[2024-03-08 17:11:41,283 INFO] Validation accuracy: 25.712
[2024-03-08 17:11:41,283 INFO] Saving checkpoint tg-both/tg_01_step_3200.pt
[2024-03-08 17:11:44,239 INFO] Step 3250/10000; acc: 86.8; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2371; bsz:  566/ 493/47; 5709/4975 tok/s;    218 sec;
[2024-03-08 17:11:47,181 INFO] Step 3300/10000; acc: 87.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2375; bsz:  582/ 503/48; 9892/8557 tok/s;    221 sec;
[2024-03-08 17:11:49,790 INFO] Step 3350/10000; acc: 87.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2382; bsz:  589/ 510/48; 11283/9780 tok/s;    224 sec;
[2024-03-08 17:11:52,871 INFO] Step 3400/10000; acc: 88.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2275; bsz:  542/ 473/46; 8801/7673 tok/s;    227 sec;
[2024-03-08 17:11:55,121 INFO] valid stats calculation
                           took: 2.2500133514404297 s.
[2024-03-08 17:11:55,122 INFO] Train perplexity: 15.6041
[2024-03-08 17:11:55,122 INFO] Train accuracy: 50.5657
[2024-03-08 17:11:55,122 INFO] Sentences processed: 158879
[2024-03-08 17:11:55,122 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:11:55,122 INFO] Validation perplexity: 4290.2
[2024-03-08 17:11:55,122 INFO] Validation accuracy: 27.0758
[2024-03-08 17:11:55,122 INFO] Saving checkpoint tg-both/tg_01_step_3400.pt
[2024-03-08 17:11:58,150 INFO] Step 3450/10000; acc: 87.4; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2381; bsz:  592/ 515/48; 5610/4876 tok/s;    232 sec;
[2024-03-08 17:12:01,143 INFO] Step 3500/10000; acc: 88.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2368; bsz:  565/ 491/47; 9437/8203 tok/s;    235 sec;
[2024-03-08 17:12:03,624 INFO] Step 3550/10000; acc: 88.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2366; bsz:  586/ 506/47; 11802/10199 tok/s;    237 sec;
[2024-03-08 17:12:06,477 INFO] Step 3600/10000; acc: 89.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2248; bsz:  551/ 478/45; 9663/8383 tok/s;    240 sec;
[2024-03-08 17:12:08,515 INFO] valid stats calculation
                           took: 2.037449836730957 s.
[2024-03-08 17:12:08,516 INFO] Train perplexity: 13.6881
[2024-03-08 17:12:08,516 INFO] Train accuracy: 52.692
[2024-03-08 17:12:08,516 INFO] Sentences processed: 168242
[2024-03-08 17:12:08,516 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:12:08,516 INFO] Validation perplexity: 4703.65
[2024-03-08 17:12:08,516 INFO] Validation accuracy: 26.2736
[2024-03-08 17:12:08,516 INFO] Saving checkpoint tg-both/tg_01_step_3600.pt
[2024-03-08 17:12:11,479 INFO] Step 3650/10000; acc: 88.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2249; bsz:  551/ 478/45; 5509/4782 tok/s;    245 sec;
[2024-03-08 17:12:14,359 INFO] Step 3700/10000; acc: 88.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2479; bsz:  588/ 510/50; 10209/8847 tok/s;    248 sec;
[2024-03-08 17:12:17,010 INFO] Step 3750/10000; acc: 89.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2258; bsz:  555/ 482/45; 10478/9088 tok/s;    251 sec;
[2024-03-08 17:12:19,923 INFO] Step 3800/10000; acc: 89.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2377; bsz:  587/ 513/48; 10072/8808 tok/s;    254 sec;
[2024-03-08 17:12:21,874 INFO] valid stats calculation
                           took: 1.9504599571228027 s.
[2024-03-08 17:12:21,874 INFO] Train perplexity: 12.1646
[2024-03-08 17:12:21,874 INFO] Train accuracy: 54.6171
[2024-03-08 17:12:21,874 INFO] Sentences processed: 177605
[2024-03-08 17:12:21,874 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:12:21,874 INFO] Validation perplexity: 5326.23
[2024-03-08 17:12:21,874 INFO] Validation accuracy: 26.1532
[2024-03-08 17:12:21,875 INFO] Saving checkpoint tg-both/tg_01_step_3800.pt
[2024-03-08 17:12:24,808 INFO] Step 3850/10000; acc: 89.8; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2379; bsz:  565/ 493/48; 5785/5050 tok/s;    259 sec;
[2024-03-08 17:12:27,750 INFO] Step 3900/10000; acc: 89.7; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2274; bsz:  555/ 478/45; 9440/8132 tok/s;    261 sec;
[2024-03-08 17:12:30,364 INFO] Step 3950/10000; acc: 89.5; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2277; bsz:  566/ 489/46; 10821/9355 tok/s;    264 sec;
[2024-03-08 17:12:33,278 INFO] Step 4000/10000; acc: 90.1; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2377; bsz:  565/ 493/48; 9703/8463 tok/s;    267 sec;
[2024-03-08 17:12:35,290 INFO] valid stats calculation
                           took: 2.0117344856262207 s.
[2024-03-08 17:12:35,290 INFO] Train perplexity: 10.943
[2024-03-08 17:12:35,291 INFO] Train accuracy: 56.3572
[2024-03-08 17:12:35,291 INFO] Sentences processed: 186912
[2024-03-08 17:12:35,291 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:12:35,291 INFO] Validation perplexity: 5595.15
[2024-03-08 17:12:35,291 INFO] Validation accuracy: 26.4741
[2024-03-08 17:12:35,291 INFO] Saving checkpoint tg-both/tg_01_step_4000.pt
[2024-03-08 17:12:38,310 INFO] Step 4050/10000; acc: 89.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2372; bsz:  587/ 515/47; 5836/5119 tok/s;    272 sec;
[2024-03-08 17:12:41,227 INFO] Step 4100/10000; acc: 90.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  563/ 489/47; 9644/8380 tok/s;    275 sec;
[2024-03-08 17:12:44,040 INFO] Step 4150/10000; acc: 90.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  576/ 496/47; 10233/8816 tok/s;    278 sec;
[2024-03-08 17:12:46,782 INFO] Step 4200/10000; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2260; bsz:  554/ 481/45; 10095/8763 tok/s;    281 sec;
[2024-03-08 17:12:48,790 INFO] valid stats calculation
                           took: 2.00797438621521 s.
[2024-03-08 17:12:48,791 INFO] Train perplexity: 9.92409
[2024-03-08 17:12:48,791 INFO] Train accuracy: 57.9701
[2024-03-08 17:12:48,791 INFO] Sentences processed: 196278
[2024-03-08 17:12:48,791 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:12:48,791 INFO] Validation perplexity: 6919.37
[2024-03-08 17:12:48,791 INFO] Validation accuracy: 26.9555
[2024-03-08 17:12:48,791 INFO] Saving checkpoint tg-both/tg_01_step_4200.pt
[2024-03-08 17:12:51,734 INFO] Step 4250/10000; acc: 90.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  578/ 503/47; 5837/5080 tok/s;    285 sec;
[2024-03-08 17:12:54,687 INFO] Step 4300/10000; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2365; bsz:  565/ 494/47; 9573/8368 tok/s;    288 sec;
[2024-03-08 17:12:57,578 INFO] Step 4350/10000; acc: 90.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2276; bsz:  562/ 486/46; 9717/8401 tok/s;    291 sec;
[2024-03-08 17:13:00,388 INFO] Step 4400/10000; acc: 90.5; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  585/ 503/47; 10403/8958 tok/s;    294 sec;
[2024-03-08 17:13:02,417 INFO] valid stats calculation
                           took: 2.027660608291626 s.
[2024-03-08 17:13:02,417 INFO] Train perplexity: 9.07429
[2024-03-08 17:13:02,417 INFO] Train accuracy: 59.4482
[2024-03-08 17:13:02,417 INFO] Sentences processed: 205658
[2024-03-08 17:13:02,417 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:13:02,417 INFO] Validation perplexity: 6468.34
[2024-03-08 17:13:02,417 INFO] Validation accuracy: 27.6374
[2024-03-08 17:13:02,418 INFO] Saving checkpoint tg-both/tg_01_step_4400.pt
[2024-03-08 17:13:05,378 INFO] Step 4450/10000; acc: 90.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  561/ 487/48; 5623/4883 tok/s;    299 sec;
[2024-03-08 17:13:08,323 INFO] Step 4500/10000; acc: 90.5; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2281; bsz:  559/ 484/46; 9483/8214 tok/s;    302 sec;
[2024-03-08 17:13:11,143 INFO] Step 4550/10000; acc: 90.5; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  589/ 509/48; 10439/9029 tok/s;    305 sec;
[2024-03-08 17:13:13,789 INFO] Step 4600/10000; acc: 91.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2277; bsz:  544/ 471/46; 10280/8911 tok/s;    308 sec;
[2024-03-08 17:13:15,748 INFO] valid stats calculation
                           took: 1.9590682983398438 s.
[2024-03-08 17:13:15,748 INFO] Train perplexity: 8.37139
[2024-03-08 17:13:15,748 INFO] Train accuracy: 60.7907
[2024-03-08 17:13:15,749 INFO] Sentences processed: 214967
[2024-03-08 17:13:15,749 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:13:15,749 INFO] Validation perplexity: 6228.95
[2024-03-08 17:13:15,749 INFO] Validation accuracy: 26.9956
[2024-03-08 17:13:15,749 INFO] Saving checkpoint tg-both/tg_01_step_4600.pt
[2024-03-08 17:13:18,738 INFO] Step 4650/10000; acc: 90.5; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 5916/5131 tok/s;    312 sec;
[2024-03-08 17:13:21,647 INFO] Step 4700/10000; acc: 90.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2260; bsz:  558/ 482/45; 9587/8278 tok/s;    315 sec;
[2024-03-08 17:13:24,393 INFO] Step 4750/10000; acc: 91.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2369; bsz:  565/ 490/47; 10284/8933 tok/s;    318 sec;
[2024-03-08 17:13:27,012 INFO] Step 4800/10000; acc: 91.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2365; bsz:  580/ 500/47; 11070/9537 tok/s;    321 sec;
[2024-03-08 17:13:28,983 INFO] valid stats calculation
                           took: 1.9708137512207031 s.
[2024-03-08 17:13:28,983 INFO] Train perplexity: 7.76305
[2024-03-08 17:13:28,983 INFO] Train accuracy: 62.0484
[2024-03-08 17:13:28,983 INFO] Sentences processed: 224332
[2024-03-08 17:13:28,983 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:13:28,983 INFO] Validation perplexity: 7444.91
[2024-03-08 17:13:28,984 INFO] Validation accuracy: 26.0329
[2024-03-08 17:13:28,984 INFO] Saving checkpoint tg-both/tg_01_step_4800.pt
[2024-03-08 17:13:31,922 INFO] Step 4850/10000; acc: 91.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  586/ 507/47; 5964/5163 tok/s;    326 sec;
[2024-03-08 17:13:34,795 INFO] Step 4900/10000; acc: 91.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2267; bsz:  539/ 472/45; 9376/8208 tok/s;    329 sec;
[2024-03-08 17:13:37,765 INFO] Step 4950/10000; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  582/ 503/47; 9797/8478 tok/s;    332 sec;
[2024-03-08 17:13:40,353 INFO] Step 5000/10000; acc: 90.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2371; bsz:  590/ 510/47; 11392/9858 tok/s;    334 sec;
[2024-03-08 17:13:42,370 INFO] valid stats calculation
                           took: 2.0164265632629395 s.
[2024-03-08 17:13:42,371 INFO] Train perplexity: 7.23951
[2024-03-08 17:13:42,371 INFO] Train accuracy: 63.2095
[2024-03-08 17:13:42,371 INFO] Sentences processed: 233709
[2024-03-08 17:13:42,371 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:13:42,371 INFO] Validation perplexity: 7388.78
[2024-03-08 17:13:42,371 INFO] Validation accuracy: 26.6346
[2024-03-08 17:13:42,371 INFO] Saving checkpoint tg-both/tg_01_step_5000.pt
[2024-03-08 17:13:45,410 INFO] Step 5050/10000; acc: 91.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2270; bsz:  538/ 469/45; 5318/4641 tok/s;    339 sec;
[2024-03-08 17:13:48,415 INFO] Step 5100/10000; acc: 90.7; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2384; bsz:  591/ 513/48; 9835/8531 tok/s;    342 sec;
[2024-03-08 17:13:51,344 INFO] Step 5150/10000; acc: 91.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2378; bsz:  586/ 507/48; 9998/8664 tok/s;    345 sec;
[2024-03-08 17:13:53,896 INFO] Step 5200/10000; acc: 91.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  570/ 496/48; 11172/9720 tok/s;    348 sec;
[2024-03-08 17:13:55,871 INFO] valid stats calculation
                           took: 1.9744036197662354 s.
[2024-03-08 17:13:55,871 INFO] Train perplexity: 6.78671
[2024-03-08 17:13:55,871 INFO] Train accuracy: 64.2908
[2024-03-08 17:13:55,872 INFO] Sentences processed: 243122
[2024-03-08 17:13:55,872 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:13:55,872 INFO] Validation perplexity: 10128.4
[2024-03-08 17:13:55,872 INFO] Validation accuracy: 26.5544
[2024-03-08 17:13:55,872 INFO] Saving checkpoint tg-both/tg_01_step_5200.pt
[2024-03-08 17:13:58,859 INFO] Step 5250/10000; acc: 91.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2247; bsz:  551/ 476/45; 5552/4799 tok/s;    353 sec;
[2024-03-08 17:14:01,816 INFO] Step 5300/10000; acc: 91.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  578/ 500/47; 9776/8455 tok/s;    356 sec;
[2024-03-08 17:14:04,691 INFO] Step 5350/10000; acc: 91.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2250; bsz:  552/ 478/45; 9595/8317 tok/s;    358 sec;
[2024-03-08 17:14:07,072 INFO] Step 5400/10000; acc: 91.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  563/ 490/47; 11832/10282 tok/s;    361 sec;
[2024-03-08 17:14:09,064 INFO] valid stats calculation
                           took: 1.991269588470459 s.
[2024-03-08 17:14:09,064 INFO] Train perplexity: 6.39812
[2024-03-08 17:14:09,064 INFO] Train accuracy: 65.2785
[2024-03-08 17:14:09,064 INFO] Sentences processed: 252353
[2024-03-08 17:14:09,064 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:14:09,064 INFO] Validation perplexity: 9430.85
[2024-03-08 17:14:09,064 INFO] Validation accuracy: 26.2736
[2024-03-08 17:14:09,065 INFO] Saving checkpoint tg-both/tg_01_step_5400.pt
[2024-03-08 17:14:12,027 INFO] Step 5450/10000; acc: 91.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2365; bsz:  567/ 498/47; 5721/5029 tok/s;    366 sec;
[2024-03-08 17:14:15,035 INFO] Step 5500/10000; acc: 91.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  588/ 514/47; 9783/8538 tok/s;    369 sec;
[2024-03-08 17:14:18,098 INFO] Step 5550/10000; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2274; bsz:  560/ 485/45; 9139/7919 tok/s;    372 sec;
[2024-03-08 17:14:20,626 INFO] Step 5600/10000; acc: 91.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2274; bsz:  559/ 484/45; 11060/9575 tok/s;    374 sec;
[2024-03-08 17:14:22,650 INFO] valid stats calculation
                           took: 2.023715019226074 s.
[2024-03-08 17:14:22,650 INFO] Train perplexity: 6.05279
[2024-03-08 17:14:22,650 INFO] Train accuracy: 66.2015
[2024-03-08 17:14:22,650 INFO] Sentences processed: 261638
[2024-03-08 17:14:22,650 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:14:22,650 INFO] Validation perplexity: 7550.06
[2024-03-08 17:14:22,650 INFO] Validation accuracy: 26.8351
[2024-03-08 17:14:22,651 INFO] Saving checkpoint tg-both/tg_01_step_5600.pt
[2024-03-08 17:14:25,652 INFO] Step 5650/10000; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  582/ 506/48; 5792/5031 tok/s;    379 sec;
[2024-03-08 17:14:28,622 INFO] Step 5700/10000; acc: 91.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2378; bsz:  566/ 494/48; 9532/8318 tok/s;    382 sec;
[2024-03-08 17:14:31,499 INFO] Step 5750/10000; acc: 91.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  565/ 491/48; 9823/8543 tok/s;    385 sec;
[2024-03-08 17:14:34,023 INFO] Step 5800/10000; acc: 91.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2270; bsz:  560/ 484/45; 11095/9586 tok/s;    388 sec;
[2024-03-08 17:14:35,963 INFO] valid stats calculation
                           took: 1.9391891956329346 s.
[2024-03-08 17:14:35,963 INFO] Train perplexity: 5.749
[2024-03-08 17:14:35,963 INFO] Train accuracy: 67.0611
[2024-03-08 17:14:35,963 INFO] Sentences processed: 271044
[2024-03-08 17:14:35,963 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:14:35,963 INFO] Validation perplexity: 10299.1
[2024-03-08 17:14:35,963 INFO] Validation accuracy: 27.3967
[2024-03-08 17:14:35,964 INFO] Saving checkpoint tg-both/tg_01_step_5800.pt
[2024-03-08 17:14:38,949 INFO] Step 5850/10000; acc: 91.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  577/ 496/47; 5853/5040 tok/s;    393 sec;
[2024-03-08 17:14:41,867 INFO] Step 5900/10000; acc: 91.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  563/ 492/47; 9642/8437 tok/s;    396 sec;
[2024-03-08 17:14:44,797 INFO] Step 5950/10000; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2264; bsz:  558/ 482/45; 9518/8232 tok/s;    399 sec;
[2024-03-08 17:14:47,316 INFO] Step 6000/10000; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2368; bsz:  579/ 504/47; 11490/10010 tok/s;    401 sec;
[2024-03-08 17:14:49,349 INFO] valid stats calculation
                           took: 2.0328221321105957 s.
[2024-03-08 17:14:49,350 INFO] Train perplexity: 5.47952
[2024-03-08 17:14:49,350 INFO] Train accuracy: 67.8582
[2024-03-08 17:14:49,350 INFO] Sentences processed: 280408
[2024-03-08 17:14:49,350 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:14:49,350 INFO] Validation perplexity: 9286.07
[2024-03-08 17:14:49,350 INFO] Validation accuracy: 26.6346
[2024-03-08 17:14:49,350 INFO] Saving checkpoint tg-both/tg_01_step_6000.pt
[2024-03-08 17:14:52,269 INFO] Step 6050/10000; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  566/ 491/47; 5710/4959 tok/s;    406 sec;
[2024-03-08 17:14:55,285 INFO] Step 6100/10000; acc: 90.5; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2373; bsz:  586/ 505/47; 9707/8379 tok/s;    409 sec;
[2024-03-08 17:14:58,370 INFO] Step 6150/10000; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2271; bsz:  563/ 486/45; 9122/7882 tok/s;    412 sec;
[2024-03-08 17:15:00,949 INFO] Step 6200/10000; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2275; bsz:  559/ 483/46; 10827/9358 tok/s;    415 sec;
[2024-03-08 17:15:02,942 INFO] valid stats calculation
                           took: 1.9925575256347656 s.
[2024-03-08 17:15:02,942 INFO] Train perplexity: 5.24215
[2024-03-08 17:15:02,942 INFO] Train accuracy: 68.5893
[2024-03-08 17:15:02,942 INFO] Sentences processed: 289694
[2024-03-08 17:15:02,942 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:15:02,942 INFO] Validation perplexity: 10613.4
[2024-03-08 17:15:02,942 INFO] Validation accuracy: 27.3165
[2024-03-08 17:15:02,943 INFO] Saving checkpoint tg-both/tg_01_step_6200.pt
[2024-03-08 17:15:05,893 INFO] Step 6250/10000; acc: 90.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2382; bsz:  587/ 508/48; 5939/5134 tok/s;    420 sec;
[2024-03-08 17:15:08,770 INFO] Step 6300/10000; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  563/ 490/48; 9782/8511 tok/s;    423 sec;
[2024-03-08 17:15:11,700 INFO] Step 6350/10000; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  580/ 502/48; 9902/8563 tok/s;    425 sec;
[2024-03-08 17:15:14,333 INFO] Step 6400/10000; acc: 90.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2265; bsz:  558/ 482/45; 10591/9147 tok/s;    428 sec;
[2024-03-08 17:15:16,382 INFO] valid stats calculation
                           took: 2.0482563972473145 s.
[2024-03-08 17:15:16,382 INFO] Train perplexity: 5.02876
[2024-03-08 17:15:16,383 INFO] Train accuracy: 69.2744
[2024-03-08 17:15:16,383 INFO] Sentences processed: 299094
[2024-03-08 17:15:16,383 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:15:16,383 INFO] Validation perplexity: 12584.7
[2024-03-08 17:15:16,383 INFO] Validation accuracy: 27.9583
[2024-03-08 17:15:16,383 INFO] Saving checkpoint tg-both/tg_01_step_6400.pt
[2024-03-08 17:15:19,312 INFO] Step 6450/10000; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 5666/4920 tok/s;    433 sec;
[2024-03-08 17:15:22,302 INFO] Step 6500/10000; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2273; bsz:  565/ 490/45; 9451/8187 tok/s;    436 sec;
[2024-03-08 17:15:25,226 INFO] Step 6550/10000; acc: 90.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2363; bsz:  565/ 494/47; 9668/8448 tok/s;    439 sec;
[2024-03-08 17:15:27,802 INFO] Step 6600/10000; acc: 90.0; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2365; bsz:  583/ 504/47; 11311/9793 tok/s;    442 sec;
[2024-03-08 17:15:29,828 INFO] valid stats calculation
                           took: 2.025362253189087 s.
[2024-03-08 17:15:29,828 INFO] Train perplexity: 4.83729
[2024-03-08 17:15:29,828 INFO] Train accuracy: 69.9132
[2024-03-08 17:15:29,828 INFO] Sentences processed: 308461
[2024-03-08 17:15:29,828 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:15:29,828 INFO] Validation perplexity: 9878.16
[2024-03-08 17:15:29,828 INFO] Validation accuracy: 27.4769
[2024-03-08 17:15:29,829 INFO] Saving checkpoint tg-both/tg_01_step_6600.pt
[2024-03-08 17:15:32,802 INFO] Step 6650/10000; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  587/ 510/47; 5866/5096 tok/s;    447 sec;
[2024-03-08 17:15:35,790 INFO] Step 6700/10000; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2251; bsz:  526/ 456/45; 8795/7632 tok/s;    450 sec;
[2024-03-08 17:15:38,802 INFO] Step 6750/10000; acc: 89.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2378; bsz:  593/ 515/48; 9848/8546 tok/s;    453 sec;
[2024-03-08 17:15:41,757 INFO] Step 6800/10000; acc: 90.0; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2280; bsz:  562/ 487/46; 9516/8251 tok/s;    456 sec;
[2024-03-08 17:15:43,769 INFO] valid stats calculation
                           took: 2.0118520259857178 s.
[2024-03-08 17:15:43,769 INFO] Train perplexity: 4.66578
[2024-03-08 17:15:43,769 INFO] Train accuracy: 70.5042
[2024-03-08 17:15:43,769 INFO] Sentences processed: 317737
[2024-03-08 17:15:43,769 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:15:43,769 INFO] Validation perplexity: 10697.7
[2024-03-08 17:15:43,769 INFO] Validation accuracy: 26.795
[2024-03-08 17:15:43,770 INFO] Saving checkpoint tg-both/tg_01_step_6800.pt
[2024-03-08 17:15:46,795 INFO] Step 6850/10000; acc: 89.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2381; bsz:  587/ 509/48; 5822/5055 tok/s;    461 sec;
[2024-03-08 17:15:49,784 INFO] Step 6900/10000; acc: 90.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  565/ 490/48; 9452/8205 tok/s;    464 sec;
[2024-03-08 17:15:52,635 INFO] Step 6950/10000; acc: 89.9; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2258; bsz:  553/ 478/45; 9701/8393 tok/s;    466 sec;
[2024-03-08 17:15:55,558 INFO] Step 7000/10000; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  578/ 501/47; 9890/8569 tok/s;    469 sec;
[2024-03-08 17:15:57,578 INFO] valid stats calculation
                           took: 2.019615650177002 s.
[2024-03-08 17:15:57,578 INFO] Train perplexity: 4.51019
[2024-03-08 17:15:57,578 INFO] Train accuracy: 71.0603
[2024-03-08 17:15:57,578 INFO] Sentences processed: 327117
[2024-03-08 17:15:57,578 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:15:57,578 INFO] Validation perplexity: 14567.3
[2024-03-08 17:15:57,578 INFO] Validation accuracy: 27.9182
[2024-03-08 17:15:57,579 INFO] Saving checkpoint tg-both/tg_01_step_7000.pt
[2024-03-08 17:16:00,553 INFO] Step 7050/10000; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  563/ 489/47; 5631/4893 tok/s;    474 sec;
[2024-03-08 17:16:03,531 INFO] Step 7100/10000; acc: 89.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2268; bsz:  567/ 491/45; 9524/8242 tok/s;    477 sec;
[2024-03-08 17:16:06,527 INFO] Step 7150/10000; acc: 89.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2367; bsz:  587/ 514/47; 9805/8576 tok/s;    480 sec;
[2024-03-08 17:16:09,164 INFO] Step 7200/10000; acc: 89.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2365; bsz:  567/ 498/47; 10744/9438 tok/s;    483 sec;
[2024-03-08 17:16:11,197 INFO] valid stats calculation
                           took: 2.0322508811950684 s.
[2024-03-08 17:16:11,198 INFO] Train perplexity: 4.36902
[2024-03-08 17:16:11,198 INFO] Train accuracy: 71.5763
[2024-03-08 17:16:11,198 INFO] Sentences processed: 336484
[2024-03-08 17:16:11,198 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:16:11,198 INFO] Validation perplexity: 12734.8
[2024-03-08 17:16:11,198 INFO] Validation accuracy: 27.9984
[2024-03-08 17:16:11,198 INFO] Saving checkpoint tg-both/tg_01_step_7200.pt
[2024-03-08 17:16:14,226 INFO] Step 7250/10000; acc: 89.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2269; bsz:  557/ 481/45; 5499/4752 tok/s;    488 sec;
[2024-03-08 17:16:17,156 INFO] Step 7300/10000; acc: 89.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2473; bsz:  576/ 503/49; 9826/8578 tok/s;    491 sec;
[2024-03-08 17:16:20,208 INFO] Step 7350/10000; acc: 88.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2274; bsz:  564/ 489/45; 9231/8009 tok/s;    494 sec;
[2024-03-08 17:16:22,871 INFO] Step 7400/10000; acc: 88.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2284; bsz:  563/ 487/46; 10576/9142 tok/s;    497 sec;
[2024-03-08 17:16:24,905 INFO] valid stats calculation
                           took: 2.034261465072632 s.
[2024-03-08 17:16:24,906 INFO] Train perplexity: 4.24354
[2024-03-08 17:16:24,906 INFO] Train accuracy: 72.0415
[2024-03-08 17:16:24,906 INFO] Sentences processed: 345784
[2024-03-08 17:16:24,906 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:16:24,906 INFO] Validation perplexity: 15086.4
[2024-03-08 17:16:24,906 INFO] Validation accuracy: 27.5572
[2024-03-08 17:16:24,907 INFO] Saving checkpoint tg-both/tg_01_step_7400.pt
[2024-03-08 17:16:27,963 INFO] Step 7450/10000; acc: 88.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2376; bsz:  565/ 493/48; 5545/4842 tok/s;    502 sec;
[2024-03-08 17:16:30,901 INFO] Step 7500/10000; acc: 88.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  581/ 504/48; 9882/8580 tok/s;    505 sec;
[2024-03-08 17:16:33,793 INFO] Step 7550/10000; acc: 88.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2371; bsz:  564/ 487/47; 9752/8421 tok/s;    508 sec;
[2024-03-08 17:16:36,419 INFO] Step 7600/10000; acc: 88.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2266; bsz:  559/ 483/45; 10651/9195 tok/s;    510 sec;
[2024-03-08 17:16:38,433 INFO] valid stats calculation
                           took: 2.0133743286132812 s.
[2024-03-08 17:16:38,433 INFO] Train perplexity: 4.12867
[2024-03-08 17:16:38,433 INFO] Train accuracy: 72.478
[2024-03-08 17:16:38,433 INFO] Sentences processed: 355172
[2024-03-08 17:16:38,433 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:16:38,434 INFO] Validation perplexity: 13009.5
[2024-03-08 17:16:38,434 INFO] Validation accuracy: 26.795
[2024-03-08 17:16:38,434 INFO] Saving checkpoint tg-both/tg_01_step_7600.pt
[2024-03-08 17:16:41,424 INFO] Step 7650/10000; acc: 88.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2366; bsz:  577/ 503/47; 5766/5022 tok/s;    515 sec;
[2024-03-08 17:16:44,304 INFO] Step 7700/10000; acc: 88.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2364; bsz:  563/ 489/47; 9778/8500 tok/s;    518 sec;
[2024-03-08 17:16:47,218 INFO] Step 7750/10000; acc: 87.8; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2368; bsz:  585/ 506/47; 10042/8687 tok/s;    521 sec;
[2024-03-08 17:16:50,012 INFO] Step 7800/10000; acc: 87.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2268; bsz:  565/ 488/45; 10101/8728 tok/s;    524 sec;
[2024-03-08 17:16:52,079 INFO] valid stats calculation
                           took: 2.066944122314453 s.
[2024-03-08 17:16:52,080 INFO] Train perplexity: 4.02475
[2024-03-08 17:16:52,080 INFO] Train accuracy: 72.8807
[2024-03-08 17:16:52,080 INFO] Sentences processed: 364538
[2024-03-08 17:16:52,080 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:16:52,080 INFO] Validation perplexity: 11977.7
[2024-03-08 17:16:52,080 INFO] Validation accuracy: 26.8753
[2024-03-08 17:16:52,080 INFO] Saving checkpoint tg-both/tg_01_step_7800.pt
[2024-03-08 17:16:54,471 INFO] Step 7850/10000; acc: 87.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2272; bsz:  561/ 484/45; 6293/5428 tok/s;    528 sec;
[2024-03-08 17:16:56,683 INFO] Step 7900/10000; acc: 88.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2471; bsz:  583/ 506/49; 13176/11432 tok/s;    530 sec;
[2024-03-08 17:16:58,966 INFO] Step 7950/10000; acc: 86.5; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2275; bsz:  564/ 487/46; 12344/10665 tok/s;    533 sec;
[2024-03-08 17:17:01,174 INFO] Step 8000/10000; acc: 87.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2382; bsz:  566/ 493/48; 12831/11170 tok/s;    535 sec;
[2024-03-08 17:17:03,112 INFO] valid stats calculation
                           took: 1.9379289150238037 s.
[2024-03-08 17:17:03,112 INFO] Train perplexity: 3.93179
[2024-03-08 17:17:03,113 INFO] Train accuracy: 73.2426
[2024-03-08 17:17:03,113 INFO] Sentences processed: 373938
[2024-03-08 17:17:03,113 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:17:03,113 INFO] Validation perplexity: 14228.8
[2024-03-08 17:17:03,113 INFO] Validation accuracy: 27.0357
[2024-03-08 17:17:03,113 INFO] Saving checkpoint tg-both/tg_01_step_8000.pt
[2024-03-08 17:17:05,442 INFO] Step 8050/10000; acc: 86.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2274; bsz:  557/ 483/45; 6520/5659 tok/s;    539 sec;
[2024-03-08 17:17:07,690 INFO] Step 8100/10000; acc: 86.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2376; bsz:  579/ 499/48; 12892/11112 tok/s;    541 sec;
[2024-03-08 17:17:09,964 INFO] Step 8150/10000; acc: 86.0; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2368; bsz:  589/ 512/47; 12948/11258 tok/s;    544 sec;
[2024-03-08 17:17:12,233 INFO] Step 8200/10000; acc: 86.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2270; bsz:  564/ 489/45; 12437/10777 tok/s;    546 sec;
[2024-03-08 17:17:14,203 INFO] valid stats calculation
                           took: 1.969473123550415 s.
[2024-03-08 17:17:14,204 INFO] Train perplexity: 3.84841
[2024-03-08 17:17:14,204 INFO] Train accuracy: 73.5676
[2024-03-08 17:17:14,204 INFO] Sentences processed: 383226
[2024-03-08 17:17:14,204 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:17:14,204 INFO] Validation perplexity: 15092.8
[2024-03-08 17:17:14,204 INFO] Validation accuracy: 26.9555
[2024-03-08 17:17:14,205 INFO] Saving checkpoint tg-both/tg_01_step_8200.pt
[2024-03-08 17:17:16,460 INFO] Step 8250/10000; acc: 86.0; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2369; bsz:  568/ 496/47; 6723/5864 tok/s;    550 sec;
[2024-03-08 17:17:18,693 INFO] Step 8300/10000; acc: 85.6; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2363; bsz:  584/ 507/47; 13089/11349 tok/s;    552 sec;
[2024-03-08 17:17:20,885 INFO] Step 8350/10000; acc: 85.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2244; bsz:  547/ 474/45; 12485/10809 tok/s;    555 sec;
[2024-03-08 17:17:23,081 INFO] Step 8400/10000; acc: 85.4; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2367; bsz:  564/ 491/47; 12850/11182 tok/s;    557 sec;
[2024-03-08 17:17:25,021 INFO] valid stats calculation
                           took: 1.9392304420471191 s.
[2024-03-08 17:17:25,021 INFO] Train perplexity: 3.77407
[2024-03-08 17:17:25,021 INFO] Train accuracy: 73.8546
[2024-03-08 17:17:25,021 INFO] Sentences processed: 392569
[2024-03-08 17:17:25,021 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:17:25,021 INFO] Validation perplexity: 14013.5
[2024-03-08 17:17:25,021 INFO] Validation accuracy: 26.7148
[2024-03-08 17:17:25,022 INFO] Saving checkpoint tg-both/tg_01_step_8400.pt
[2024-03-08 17:17:27,366 INFO] Step 8450/10000; acc: 85.0; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    2268; bsz:  557/ 481/45; 6499/5616 tok/s;    561 sec;
[2024-03-08 17:17:29,617 INFO] Step 8500/10000; acc: 85.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2482; bsz:  592/ 517/50; 13158/11486 tok/s;    563 sec;
[2024-03-08 17:17:32,043 INFO] Step 8550/10000; acc: 85.2; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2280; bsz:  562/ 488/46; 11593/10050 tok/s;    566 sec;
[2024-03-08 17:17:34,637 INFO] Step 8600/10000; acc: 84.5; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2381; bsz:  582/ 505/48; 11218/9725 tok/s;    568 sec;
[2024-03-08 17:17:36,633 INFO] valid stats calculation
                           took: 1.995168924331665 s.
[2024-03-08 17:17:36,633 INFO] Train perplexity: 3.70629
[2024-03-08 17:17:36,633 INFO] Train accuracy: 74.116
[2024-03-08 17:17:36,633 INFO] Sentences processed: 401980
[2024-03-08 17:17:36,633 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:17:36,633 INFO] Validation perplexity: 12594.5
[2024-03-08 17:17:36,633 INFO] Validation accuracy: 27.0357
[2024-03-08 17:17:36,634 INFO] Saving checkpoint tg-both/tg_01_step_8600.pt
[2024-03-08 17:17:39,608 INFO] Step 8650/10000; acc: 85.8; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 5667/4919 tok/s;    573 sec;
[2024-03-08 17:17:42,545 INFO] Step 8700/10000; acc: 85.2; ppl:   1.7; xent: 0.6; lr: 1.00000; sents:    2258; bsz:  552/ 479/45; 9407/8150 tok/s;    576 sec;
[2024-03-08 17:17:45,431 INFO] Step 8750/10000; acc: 84.3; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2270; bsz:  566/ 491/45; 9811/8498 tok/s;    579 sec;
[2024-03-08 17:17:47,945 INFO] Step 8800/10000; acc: 86.0; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2463; bsz:  587/ 521/49; 11686/10363 tok/s;    582 sec;
[2024-03-08 17:17:49,918 INFO] valid stats calculation
                           took: 1.9724044799804688 s.
[2024-03-08 17:17:49,918 INFO] Train perplexity: 3.64309
[2024-03-08 17:17:49,918 INFO] Train accuracy: 74.3713
[2024-03-08 17:17:49,918 INFO] Sentences processed: 411346
[2024-03-08 17:17:49,918 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:17:49,918 INFO] Validation perplexity: 13981.7
[2024-03-08 17:17:49,918 INFO] Validation accuracy: 26.8753
[2024-03-08 17:17:49,919 INFO] Saving checkpoint tg-both/tg_01_step_8800.pt
[2024-03-08 17:17:52,945 INFO] Step 8850/10000; acc: 82.8; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2268; bsz:  567/ 492/45; 5672/4917 tok/s;    587 sec;
[2024-03-08 17:17:55,808 INFO] Step 8900/10000; acc: 83.6; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2263; bsz:  554/ 478/45; 9678/8346 tok/s;    590 sec;
[2024-03-08 17:17:58,582 INFO] Step 8950/10000; acc: 83.0; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 10322/8943 tok/s;    592 sec;
[2024-03-08 17:18:01,074 INFO] Step 9000/10000; acc: 82.8; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2373; bsz:  564/ 490/47; 11310/9841 tok/s;    595 sec;
[2024-03-08 17:18:03,074 INFO] valid stats calculation
                           took: 1.9990136623382568 s.
[2024-03-08 17:18:03,074 INFO] Train perplexity: 3.59252
[2024-03-08 17:18:03,074 INFO] Train accuracy: 74.5626
[2024-03-08 17:18:03,074 INFO] Sentences processed: 420615
[2024-03-08 17:18:03,074 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:18:03,074 INFO] Validation perplexity: 13219.7
[2024-03-08 17:18:03,074 INFO] Validation accuracy: 25.9928
[2024-03-08 17:18:03,075 INFO] Saving checkpoint tg-both/tg_01_step_9000.pt
[2024-03-08 17:18:06,121 INFO] Step 9050/10000; acc: 82.8; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2371; bsz:  581/ 506/47; 5756/5010 tok/s;    600 sec;
[2024-03-08 17:18:09,173 INFO] Step 9100/10000; acc: 82.3; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2279; bsz:  563/ 486/46; 9219/7963 tok/s;    603 sec;
[2024-03-08 17:18:12,109 INFO] Step 9150/10000; acc: 83.0; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2381; bsz:  566/ 495/48; 9642/8431 tok/s;    606 sec;
[2024-03-08 17:18:14,690 INFO] Step 9200/10000; acc: 82.0; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2276; bsz:  561/ 485/46; 10872/9391 tok/s;    608 sec;
[2024-03-08 17:18:16,648 INFO] valid stats calculation
                           took: 1.9573848247528076 s.
[2024-03-08 17:18:16,648 INFO] Train perplexity: 3.54616
[2024-03-08 17:18:16,648 INFO] Train accuracy: 74.7354
[2024-03-08 17:18:16,648 INFO] Sentences processed: 429922
[2024-03-08 17:18:16,648 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:18:16,648 INFO] Validation perplexity: 15942.3
[2024-03-08 17:18:16,648 INFO] Validation accuracy: 25.7922
[2024-03-08 17:18:16,649 INFO] Saving checkpoint tg-both/tg_01_step_9200.pt
[2024-03-08 17:18:19,572 INFO] Step 9250/10000; acc: 81.9; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2375; bsz:  565/ 490/48; 5789/5023 tok/s;    613 sec;
[2024-03-08 17:18:22,529 INFO] Step 9300/10000; acc: 81.3; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2371; bsz:  579/ 499/47; 9787/8431 tok/s;    616 sec;
[2024-03-08 17:18:25,392 INFO] Step 9350/10000; acc: 82.0; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2366; bsz:  563/ 490/47; 9840/8560 tok/s;    619 sec;
[2024-03-08 17:18:27,966 INFO] Step 9400/10000; acc: 79.3; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2268; bsz:  583/ 504/45; 11329/9794 tok/s;    622 sec;
[2024-03-08 17:18:29,945 INFO] valid stats calculation
                           took: 1.978600025177002 s.
[2024-03-08 17:18:29,945 INFO] Train perplexity: 3.50707
[2024-03-08 17:18:29,945 INFO] Train accuracy: 74.8713
[2024-03-08 17:18:29,945 INFO] Sentences processed: 439302
[2024-03-08 17:18:29,945 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:18:29,945 INFO] Validation perplexity: 9912.53
[2024-03-08 17:18:29,945 INFO] Validation accuracy: 26.9154
[2024-03-08 17:18:29,946 INFO] Saving checkpoint tg-both/tg_01_step_9400.pt
[2024-03-08 17:18:32,901 INFO] Step 9450/10000; acc: 81.4; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    2362; bsz:  564/ 490/47; 5716/4961 tok/s;    627 sec;
[2024-03-08 17:18:35,740 INFO] Step 9500/10000; acc: 81.0; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2369; bsz:  563/ 489/47; 9921/8606 tok/s;    629 sec;
[2024-03-08 17:18:38,694 INFO] Step 9550/10000; acc: 80.0; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2267; bsz:  561/ 483/45; 9500/8184 tok/s;    632 sec;
[2024-03-08 17:18:41,181 INFO] Step 9600/10000; acc: 79.9; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2372; bsz:  581/ 501/47; 11678/10083 tok/s;    635 sec;
[2024-03-08 17:18:43,179 INFO] valid stats calculation
                           took: 1.9976661205291748 s.
[2024-03-08 17:18:43,180 INFO] Train perplexity: 3.47295
[2024-03-08 17:18:43,180 INFO] Train accuracy: 74.9895
[2024-03-08 17:18:43,180 INFO] Sentences processed: 448672
[2024-03-08 17:18:43,180 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:18:43,180 INFO] Validation perplexity: 12938.5
[2024-03-08 17:18:43,180 INFO] Validation accuracy: 27.2363
[2024-03-08 17:18:43,180 INFO] Saving checkpoint tg-both/tg_01_step_9600.pt
[2024-03-08 17:18:46,227 INFO] Step 9650/10000; acc: 80.0; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2371; bsz:  582/ 504/47; 5772/4995 tok/s;    640 sec;
[2024-03-08 17:18:49,174 INFO] Step 9700/10000; acc: 80.2; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2375; bsz:  566/ 493/48; 9595/8357 tok/s;    643 sec;
[2024-03-08 17:18:52,062 INFO] Step 9750/10000; acc: 79.2; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2280; bsz:  558/ 485/46; 9668/8396 tok/s;    646 sec;
[2024-03-08 17:18:54,692 INFO] Step 9800/10000; acc: 79.6; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2376; bsz:  569/ 495/48; 10813/9419 tok/s;    648 sec;
[2024-03-08 17:18:56,692 INFO] valid stats calculation
                           took: 2.0003859996795654 s.
[2024-03-08 17:18:56,693 INFO] Train perplexity: 3.44276
[2024-03-08 17:18:56,693 INFO] Train accuracy: 75.0873
[2024-03-08 17:18:56,693 INFO] Sentences processed: 458074
[2024-03-08 17:18:56,693 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:18:56,693 INFO] Validation perplexity: 12667
[2024-03-08 17:18:56,693 INFO] Validation accuracy: 26.2335
[2024-03-08 17:18:56,693 INFO] Saving checkpoint tg-both/tg_01_step_9800.pt
[2024-03-08 17:18:59,758 INFO] Step 9850/10000; acc: 77.4; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2280; bsz:  584/ 503/46; 5768/4969 tok/s;    654 sec;
[2024-03-08 17:19:02,701 INFO] Step 9900/10000; acc: 79.7; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2368; bsz:  569/ 498/47; 9667/8465 tok/s;    656 sec;
[2024-03-08 17:19:05,603 INFO] Step 9950/10000; acc: 78.6; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2246; bsz:  549/ 475/45; 9466/8186 tok/s;    659 sec;
[2024-03-08 17:19:08,096 INFO] Step 10000/10000; acc: 79.5; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2368; bsz:  566/ 492/47; 11350/9859 tok/s;    662 sec;
[2024-03-08 17:19:10,128 INFO] valid stats calculation
                           took: 2.03092885017395 s.
[2024-03-08 17:19:10,128 INFO] Train perplexity: 3.4177
[2024-03-08 17:19:10,128 INFO] Train accuracy: 75.1611
[2024-03-08 17:19:10,128 INFO] Sentences processed: 467336
[2024-03-08 17:19:10,128 INFO] Average bsz:  569/ 494/47
[2024-03-08 17:19:10,128 INFO] Validation perplexity: 14350
[2024-03-08 17:19:10,128 INFO] Validation accuracy: 27.4368
[2024-03-08 17:19:10,129 INFO] Saving checkpoint tg-both/tg_01_step_10000.pt
