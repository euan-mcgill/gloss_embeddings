[2024-03-12 09:58:46,957 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-12 09:58:46,958 INFO] Parsed 2 corpora from -data.
[2024-03-12 09:58:46,958 INFO] Loading checkpoint from tg-pt-enc/models/tg-pt-enc_02_step_6200.pt
[2024-03-12 09:58:47,027 INFO] Building model...
[2024-03-12 09:58:47,082 INFO] Switching model to float32 for amp/apex_amp
[2024-03-12 09:58:47,082 INFO] Non quantized layer compute is fp32
[2024-03-12 09:58:49,463 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-12 09:58:49,464 INFO] encoder: 8952800
[2024-03-12 09:58:49,465 INFO] decoder: 16687344
[2024-03-12 09:58:49,465 INFO] * number of parameters: 25640144
[2024-03-12 09:58:49,465 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 09:58:49,465 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 09:58:49,465 INFO]  * src vocab size = 17816
[2024-03-12 09:58:49,465 INFO]  * tgt vocab size = 14144
[2024-03-12 09:58:49,466 INFO] Starting training on GPU: [0]
[2024-03-12 09:58:49,466 INFO] Start training loop and validate every 200 steps...
[2024-03-12 09:58:49,467 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-12 09:58:55,442 INFO] Step 6250/11200; acc: 10.1; ppl: 180403.3; xent: 12.1; lr: 1.00000; sents:    2270; bsz:  565/ 490/45; 4729/4098 tok/s;      6 sec;
[2024-03-12 09:58:58,782 INFO] Step 6300/11200; acc: 10.5; ppl: 8923.0; xent: 9.1; lr: 1.00000; sents:    2369; bsz:  569/ 496/47; 8512/7425 tok/s;      9 sec;
[2024-03-12 09:59:02,359 INFO] Step 6350/11200; acc: 10.3; ppl: 5710.3; xent: 8.7; lr: 1.00000; sents:    2363; bsz:  585/ 508/47; 8180/7101 tok/s;     13 sec;
[2024-03-12 09:59:05,883 INFO] Step 6400/11200; acc: 12.2; ppl: 4184.7; xent: 8.3; lr: 1.00000; sents:    2365; bsz:  585/ 507/47; 8301/7197 tok/s;     16 sec;
[2024-03-12 09:59:09,294 INFO] valid stats calculation
                           took: 3.4101953506469727 s.
[2024-03-12 09:59:09,294 INFO] Train perplexity: 13726.1
[2024-03-12 09:59:09,294 INFO] Train accuracy: 10.7937
[2024-03-12 09:59:09,294 INFO] Sentences processed: 9367
[2024-03-12 09:59:09,294 INFO] Average bsz:  576/ 500/47
[2024-03-12 09:59:09,294 INFO] Validation perplexity: 52455.5
[2024-03-12 09:59:09,294 INFO] Validation accuracy: 12.1139
[2024-03-12 09:59:09,296 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_6400.pt
[2024-03-12 09:59:11,816 INFO] Step 6450/11200; acc: 10.2; ppl: 4027.9; xent: 8.3; lr: 1.00000; sents:    2246; bsz:  547/ 475/45; 4614/4002 tok/s;     22 sec;
[2024-03-12 09:59:14,926 INFO] Step 6500/11200; acc: 11.3; ppl: 3016.1; xent: 8.0; lr: 1.00000; sents:    2372; bsz:  566/ 491/47; 9100/7893 tok/s;     25 sec;
[2024-03-12 09:59:18,490 INFO] Step 6550/11200; acc: 12.0; ppl: 2058.9; xent: 7.6; lr: 1.00000; sents:    2378; bsz:  586/ 509/48; 8216/7143 tok/s;     29 sec;
[2024-03-12 09:59:21,990 INFO] Step 6600/11200; acc: 11.5; ppl: 1825.9; xent: 7.5; lr: 1.00000; sents:    2384; bsz:  569/ 495/48; 8132/7077 tok/s;     33 sec;
[2024-03-12 09:59:25,377 INFO] valid stats calculation
                           took: 3.386613130569458 s.
[2024-03-12 09:59:25,378 INFO] Train perplexity: 5992.47
[2024-03-12 09:59:25,378 INFO] Train accuracy: 11.0113
[2024-03-12 09:59:25,378 INFO] Sentences processed: 18747
[2024-03-12 09:59:25,378 INFO] Average bsz:  572/ 496/47
[2024-03-12 09:59:25,378 INFO] Validation perplexity: 2822.68
[2024-03-12 09:59:25,378 INFO] Validation accuracy: 11.6326
[2024-03-12 09:59:25,379 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_6600.pt
[2024-03-12 09:59:28,130 INFO] Step 6650/11200; acc: 10.7; ppl: 1683.6; xent: 7.4; lr: 1.00000; sents:    2277; bsz:  561/ 487/46; 4572/3965 tok/s;     39 sec;
[2024-03-12 09:59:30,864 INFO] Step 6700/11200; acc: 10.2; ppl: 2737.8; xent: 7.9; lr: 1.00000; sents:    2261; bsz:  552/ 477/45; 10095/8723 tok/s;     41 sec;
[2024-03-12 09:59:34,408 INFO] Step 6750/11200; acc: 11.0; ppl: 1207.0; xent: 7.1; lr: 1.00000; sents:    2486; bsz:  591/ 514/50; 8335/7257 tok/s;     45 sec;
[2024-03-12 09:59:37,928 INFO] Step 6800/11200; acc: 12.4; ppl: 1216.9; xent: 7.1; lr: 1.00000; sents:    2252; bsz:  551/ 477/45; 7832/6773 tok/s;     48 sec;
[2024-03-12 09:59:41,325 INFO] valid stats calculation
                           took: 3.3973031044006348 s.
[2024-03-12 09:59:41,326 INFO] Train perplexity: 3879.96
[2024-03-12 09:59:41,326 INFO] Train accuracy: 11.0387
[2024-03-12 09:59:41,326 INFO] Sentences processed: 28023
[2024-03-12 09:59:41,326 INFO] Average bsz:  569/ 494/47
[2024-03-12 09:59:41,326 INFO] Validation perplexity: 748.319
[2024-03-12 09:59:41,326 INFO] Validation accuracy: 11.5122
[2024-03-12 09:59:41,327 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_6800.pt
[2024-03-12 09:59:44,303 INFO] Step 6850/11200; acc: 15.3; ppl: 483.6; xent: 6.2; lr: 1.00000; sents:    2367; bsz:  587/ 513/47; 4604/4020 tok/s;     55 sec;
[2024-03-12 09:59:46,824 INFO] Step 6900/11200; acc: 17.8; ppl: 287.9; xent: 5.7; lr: 1.00000; sents:    2268; bsz:  547/ 478/45; 10860/9476 tok/s;     57 sec;
[2024-03-12 09:59:50,373 INFO] Step 6950/11200; acc: 20.4; ppl: 184.2; xent: 5.2; lr: 1.00000; sents:    2367; bsz:  587/ 512/47; 8268/7215 tok/s;     61 sec;
[2024-03-12 09:59:53,834 INFO] Step 7000/11200; acc: 24.3; ppl: 104.8; xent: 4.7; lr: 1.00000; sents:    2365; bsz:  561/ 487/47; 8102/7031 tok/s;     64 sec;
[2024-03-12 09:59:57,237 INFO] valid stats calculation
                           took: 3.403316020965576 s.
[2024-03-12 09:59:57,238 INFO] Train perplexity: 1905.62
[2024-03-12 09:59:57,238 INFO] Train accuracy: 13.1383
[2024-03-12 09:59:57,238 INFO] Sentences processed: 37390
[2024-03-12 09:59:57,238 INFO] Average bsz:  569/ 495/47
[2024-03-12 09:59:57,238 INFO] Validation perplexity: 313.041
[2024-03-12 09:59:57,238 INFO] Validation accuracy: 21.6606
[2024-03-12 09:59:57,239 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_7000.pt
[2024-03-12 10:00:00,528 INFO] Step 7050/11200; acc: 25.6; ppl:  85.7; xent: 4.5; lr: 1.00000; sents:    2269; bsz:  557/ 482/45; 4158/3598 tok/s;     71 sec;
[2024-03-12 10:00:03,037 INFO] Step 7100/11200; acc: 27.6; ppl:  66.3; xent: 4.2; lr: 1.00000; sents:    2371; bsz:  576/ 500/47; 11473/9975 tok/s;     74 sec;
[2024-03-12 10:00:06,704 INFO] Step 7150/11200; acc: 29.9; ppl:  48.8; xent: 3.9; lr: 1.00000; sents:    2279; bsz:  563/ 487/46; 7673/6634 tok/s;     77 sec;
[2024-03-12 10:00:10,353 INFO] Step 7200/11200; acc: 32.5; ppl:  36.9; xent: 3.6; lr: 1.00000; sents:    2381; bsz:  566/ 495/48; 7750/6778 tok/s;     81 sec;
[2024-03-12 10:00:13,797 INFO] valid stats calculation
                           took: 3.443809986114502 s.
[2024-03-12 10:00:13,798 INFO] Train perplexity: 946.9
[2024-03-12 10:00:13,798 INFO] Train accuracy: 16.2715
[2024-03-12 10:00:13,798 INFO] Sentences processed: 46690
[2024-03-12 10:00:13,798 INFO] Average bsz:  568/ 494/47
[2024-03-12 10:00:13,798 INFO] Validation perplexity: 315.72
[2024-03-12 10:00:13,798 INFO] Validation accuracy: 21.3799
[2024-03-12 10:00:13,799 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_7200.pt
[2024-03-12 10:00:17,085 INFO] Step 7250/11200; acc: 34.6; ppl:  30.8; xent: 3.4; lr: 1.00000; sents:    2376; bsz:  581/ 505/48; 4314/3747 tok/s;     88 sec;
[2024-03-12 10:00:19,476 INFO] Step 7300/11200; acc: 36.7; ppl:  25.0; xent: 3.2; lr: 1.00000; sents:    2375; bsz:  565/ 490/48; 11825/10260 tok/s;     90 sec;
[2024-03-12 10:00:22,905 INFO] Step 7350/11200; acc: 39.0; ppl:  20.4; xent: 3.0; lr: 1.00000; sents:    2371; bsz:  579/ 498/47; 8436/7262 tok/s;     93 sec;
[2024-03-12 10:00:26,546 INFO] Step 7400/11200; acc: 40.5; ppl:  17.6; xent: 2.9; lr: 1.00000; sents:    2266; bsz:  559/ 484/45; 7676/6653 tok/s;     97 sec;
[2024-03-12 10:00:29,991 INFO] valid stats calculation
                           took: 3.4448628425598145 s.
[2024-03-12 10:00:29,992 INFO] Train perplexity: 509.283
[2024-03-12 10:00:29,992 INFO] Train accuracy: 19.8398
[2024-03-12 10:00:29,992 INFO] Sentences processed: 56078
[2024-03-12 10:00:29,992 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:00:29,992 INFO] Validation perplexity: 270.332
[2024-03-12 10:00:29,992 INFO] Validation accuracy: 26.1131
[2024-03-12 10:00:29,993 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_7400.pt
[2024-03-12 10:00:33,451 INFO] Step 7450/11200; acc: 41.8; ppl:  15.1; xent: 2.7; lr: 1.00000; sents:    2366; bsz:  584/ 506/47; 4230/3666 tok/s;    104 sec;
[2024-03-12 10:00:35,777 INFO] Step 7500/11200; acc: 44.8; ppl:  12.8; xent: 2.6; lr: 1.00000; sents:    2364; bsz:  564/ 490/47; 12127/10533 tok/s;    106 sec;
[2024-03-12 10:00:39,230 INFO] Step 7550/11200; acc: 46.4; ppl:  11.2; xent: 2.4; lr: 1.00000; sents:    2269; bsz:  564/ 488/45; 8165/7066 tok/s;    110 sec;
[2024-03-12 10:00:42,763 INFO] Step 7600/11200; acc: 49.1; ppl:   9.5; xent: 2.2; lr: 1.00000; sents:    2367; bsz:  563/ 488/47; 7970/6907 tok/s;    113 sec;
[2024-03-12 10:00:46,240 INFO] valid stats calculation
                           took: 3.4769210815429688 s.
[2024-03-12 10:00:46,240 INFO] Train perplexity: 298.404
[2024-03-12 10:00:46,240 INFO] Train accuracy: 23.4991
[2024-03-12 10:00:46,240 INFO] Sentences processed: 65444
[2024-03-12 10:00:46,240 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:00:46,241 INFO] Validation perplexity: 316.299
[2024-03-12 10:00:46,241 INFO] Validation accuracy: 27.6775
[2024-03-12 10:00:46,242 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_7600.pt
[2024-03-12 10:00:49,763 INFO] Step 7650/11200; acc: 50.1; ppl:   8.8; xent: 2.2; lr: 1.00000; sents:    2372; bsz:  581/ 501/47; 4147/3580 tok/s;    120 sec;
[2024-03-12 10:00:52,245 INFO] Step 7700/11200; acc: 51.0; ppl:   8.2; xent: 2.1; lr: 1.00000; sents:    2271; bsz:  562/ 485/45; 11319/9769 tok/s;    123 sec;
[2024-03-12 10:00:55,553 INFO] Step 7750/11200; acc: 54.3; ppl:   6.8; xent: 1.9; lr: 1.00000; sents:    2273; bsz:  560/ 486/45; 8463/7348 tok/s;    126 sec;
[2024-03-12 10:00:59,020 INFO] Step 7800/11200; acc: 56.0; ppl:   6.1; xent: 1.8; lr: 1.00000; sents:    2484; bsz:  588/ 510/50; 8486/7362 tok/s;    130 sec;
[2024-03-12 10:01:02,444 INFO] valid stats calculation
                           took: 3.4229683876037598 s.
[2024-03-12 10:01:02,444 INFO] Train perplexity: 187.674
[2024-03-12 10:01:02,444 INFO] Train accuracy: 27.1818
[2024-03-12 10:01:02,444 INFO] Sentences processed: 74844
[2024-03-12 10:01:02,444 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:01:02,444 INFO] Validation perplexity: 371.937
[2024-03-12 10:01:02,444 INFO] Validation accuracy: 27.9583
[2024-03-12 10:01:02,446 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_7800.pt
[2024-03-12 10:01:06,157 INFO] Step 7850/11200; acc: 57.5; ppl:   5.5; xent: 1.7; lr: 1.00000; sents:    2274; bsz:  557/ 483/45; 3906/3386 tok/s;    137 sec;
[2024-03-12 10:01:08,752 INFO] Step 7900/11200; acc: 59.7; ppl:   5.0; xent: 1.6; lr: 1.00000; sents:    2280; bsz:  563/ 487/46; 10850/9381 tok/s;    139 sec;
[2024-03-12 10:01:11,801 INFO] Step 7950/11200; acc: 59.3; ppl:   5.1; xent: 1.6; lr: 1.00000; sents:    2368; bsz:  589/ 512/47; 9659/8399 tok/s;    142 sec;
[2024-03-12 10:01:15,352 INFO] Step 8000/11200; acc: 62.1; ppl:   4.3; xent: 1.5; lr: 1.00000; sents:    2366; bsz:  569/ 497/47; 8006/6992 tok/s;    146 sec;
[2024-03-12 10:01:18,806 INFO] valid stats calculation
                           took: 3.4531824588775635 s.
[2024-03-12 10:01:18,807 INFO] Train perplexity: 125.285
[2024-03-12 10:01:18,807 INFO] Train accuracy: 30.7965
[2024-03-12 10:01:18,807 INFO] Sentences processed: 84132
[2024-03-12 10:01:18,807 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:01:18,807 INFO] Validation perplexity: 575.189
[2024-03-12 10:01:18,807 INFO] Validation accuracy: 26.9956
[2024-03-12 10:01:18,808 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_8000.pt
[2024-03-12 10:01:22,477 INFO] Step 8050/11200; acc: 62.7; ppl:   4.2; xent: 1.4; lr: 1.00000; sents:    2369; bsz:  587/ 508/47; 4120/3564 tok/s;    153 sec;
[2024-03-12 10:01:25,051 INFO] Step 8100/11200; acc: 66.4; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    2242; bsz:  527/ 458/45; 10232/8893 tok/s;    156 sec;
[2024-03-12 10:01:27,871 INFO] Step 8150/11200; acc: 65.0; ppl:   3.8; xent: 1.3; lr: 1.00000; sents:    2365; bsz:  585/ 508/47; 10377/9003 tok/s;    158 sec;
[2024-03-12 10:01:31,339 INFO] Step 8200/11200; acc: 68.0; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    2367; bsz:  561/ 488/47; 8087/7033 tok/s;    162 sec;
[2024-03-12 10:01:34,770 INFO] valid stats calculation
                           took: 3.4304773807525635 s.
[2024-03-12 10:01:34,770 INFO] Train perplexity: 88.3793
[2024-03-12 10:01:34,770 INFO] Train accuracy: 34.2405
[2024-03-12 10:01:34,770 INFO] Sentences processed: 93475
[2024-03-12 10:01:34,770 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:01:34,770 INFO] Validation perplexity: 706.249
[2024-03-12 10:01:34,770 INFO] Validation accuracy: 28.0786
[2024-03-12 10:01:34,772 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_8200.pt
[2024-03-12 10:01:38,530 INFO] Step 8250/11200; acc: 68.3; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    2372; bsz:  583/ 505/47; 4050/3512 tok/s;    169 sec;
[2024-03-12 10:01:41,501 INFO] Step 8300/11200; acc: 70.2; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    2275; bsz:  562/ 487/46; 9455/8199 tok/s;    172 sec;
[2024-03-12 10:01:44,139 INFO] Step 8350/11200; acc: 71.1; ppl:   2.9; xent: 1.0; lr: 1.00000; sents:    2383; bsz:  583/ 507/48; 11054/9607 tok/s;    175 sec;
[2024-03-12 10:01:47,825 INFO] Step 8400/11200; acc: 72.4; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    2381; bsz:  566/ 492/48; 7679/6674 tok/s;    178 sec;
[2024-03-12 10:01:51,254 INFO] valid stats calculation
                           took: 3.4284462928771973 s.
[2024-03-12 10:01:51,254 INFO] Train perplexity: 64.7289
[2024-03-12 10:01:51,254 INFO] Train accuracy: 37.5622
[2024-03-12 10:01:51,254 INFO] Sentences processed: 102886
[2024-03-12 10:01:51,254 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:01:51,254 INFO] Validation perplexity: 1390.92
[2024-03-12 10:01:51,254 INFO] Validation accuracy: 27.2764
[2024-03-12 10:01:51,255 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_8400.pt
[2024-03-12 10:01:54,949 INFO] Step 8450/11200; acc: 73.6; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    2261; bsz:  552/ 476/45; 3872/3344 tok/s;    185 sec;
[2024-03-12 10:01:58,058 INFO] Step 8500/11200; acc: 73.9; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    2372; bsz:  586/ 513/47; 9427/8253 tok/s;    189 sec;
[2024-03-12 10:02:00,567 INFO] Step 8550/11200; acc: 74.7; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2270; bsz:  567/ 491/45; 11308/9782 tok/s;    191 sec;
[2024-03-12 10:02:04,077 INFO] Step 8600/11200; acc: 76.4; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2367; bsz:  568/ 500/47; 8093/7120 tok/s;    195 sec;
[2024-03-12 10:02:07,744 INFO] valid stats calculation
                           took: 3.667086362838745 s.
[2024-03-12 10:02:07,745 INFO] Train perplexity: 49.2675
[2024-03-12 10:02:07,745 INFO] Train accuracy: 40.6577
[2024-03-12 10:02:07,745 INFO] Sentences processed: 112156
[2024-03-12 10:02:07,745 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:02:07,745 INFO] Validation perplexity: 1526.14
[2024-03-12 10:02:07,745 INFO] Validation accuracy: 25.712
[2024-03-12 10:02:07,746 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_8600.pt
[2024-03-12 10:02:11,367 INFO] Step 8650/11200; acc: 76.9; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2364; bsz:  561/ 487/47; 3845/3342 tok/s;    202 sec;
[2024-03-12 10:02:14,668 INFO] Step 8700/11200; acc: 78.7; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    2367; bsz:  572/ 493/47; 8660/7470 tok/s;    205 sec;
[2024-03-12 10:02:17,094 INFO] Step 8750/11200; acc: 78.0; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    2261; bsz:  556/ 481/45; 11451/9920 tok/s;    208 sec;
[2024-03-12 10:02:20,399 INFO] Step 8800/11200; acc: 79.6; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2373; bsz:  582/ 507/47; 8801/7668 tok/s;    211 sec;
[2024-03-12 10:02:23,866 INFO] valid stats calculation
                           took: 3.4667656421661377 s.
[2024-03-12 10:02:23,867 INFO] Train perplexity: 38.7391
[2024-03-12 10:02:23,867 INFO] Train accuracy: 43.544
[2024-03-12 10:02:23,867 INFO] Sentences processed: 121521
[2024-03-12 10:02:23,867 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:02:23,867 INFO] Validation perplexity: 1893.73
[2024-03-12 10:02:23,867 INFO] Validation accuracy: 27.3967
[2024-03-12 10:02:23,868 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_8800.pt
[2024-03-12 10:02:27,545 INFO] Step 8850/11200; acc: 79.9; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2275; bsz:  562/ 486/46; 3935/3398 tok/s;    218 sec;
[2024-03-12 10:02:31,186 INFO] Step 8900/11200; acc: 81.3; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2375; bsz:  565/ 494/48; 7758/6789 tok/s;    222 sec;
[2024-03-12 10:02:33,655 INFO] Step 8950/11200; acc: 81.5; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2281; bsz:  563/ 486/46; 11393/9843 tok/s;    224 sec;
[2024-03-12 10:02:36,640 INFO] Step 9000/11200; acc: 82.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2376; bsz:  565/ 490/48; 9465/8215 tok/s;    227 sec;
[2024-03-12 10:02:40,042 INFO] valid stats calculation
                           took: 3.4015328884124756 s.
[2024-03-12 10:02:40,042 INFO] Train perplexity: 31.3017
[2024-03-12 10:02:40,042 INFO] Train accuracy: 46.2174
[2024-03-12 10:02:40,042 INFO] Sentences processed: 130828
[2024-03-12 10:02:40,042 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:02:40,042 INFO] Validation perplexity: 2829.74
[2024-03-12 10:02:40,042 INFO] Validation accuracy: 26.7549
[2024-03-12 10:02:40,043 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_9000.pt
[2024-03-12 10:02:43,763 INFO] Step 9050/11200; acc: 82.9; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2375; bsz:  579/ 499/48; 4064/3499 tok/s;    234 sec;
[2024-03-12 10:02:47,357 INFO] Step 9100/11200; acc: 83.6; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2371; bsz:  566/ 491/47; 7868/6827 tok/s;    238 sec;
[2024-03-12 10:02:50,054 INFO] Step 9150/11200; acc: 83.7; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2366; bsz:  584/ 506/47; 10832/9394 tok/s;    241 sec;
[2024-03-12 10:02:52,823 INFO] Step 9200/11200; acc: 84.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 10173/8819 tok/s;    243 sec;
[2024-03-12 10:02:56,260 INFO] valid stats calculation
                           took: 3.4364466667175293 s.
[2024-03-12 10:02:56,260 INFO] Train perplexity: 25.8104
[2024-03-12 10:02:56,261 INFO] Train accuracy: 48.7222
[2024-03-12 10:02:56,261 INFO] Sentences processed: 140208
[2024-03-12 10:02:56,261 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:02:56,261 INFO] Validation perplexity: 3931.26
[2024-03-12 10:02:56,261 INFO] Validation accuracy: 26.9555
[2024-03-12 10:02:56,262 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_9200.pt
[2024-03-12 10:02:59,940 INFO] Step 9250/11200; acc: 84.7; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 3934/3392 tok/s;    250 sec;
[2024-03-12 10:03:03,460 INFO] Step 9300/11200; acc: 85.1; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2367; bsz:  580/ 500/47; 8238/7107 tok/s;    254 sec;
[2024-03-12 10:03:06,332 INFO] Step 9350/11200; acc: 86.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2369; bsz:  563/ 489/47; 9810/8514 tok/s;    257 sec;
[2024-03-12 10:03:08,778 INFO] Step 9400/11200; acc: 85.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2270; bsz:  559/ 485/45; 11429/9914 tok/s;    259 sec;
[2024-03-12 10:03:12,422 INFO] valid stats calculation
                           took: 3.643197536468506 s.
[2024-03-12 10:03:12,422 INFO] Train perplexity: 21.7592
[2024-03-12 10:03:12,422 INFO] Train accuracy: 51.001
[2024-03-12 10:03:12,422 INFO] Sentences processed: 149476
[2024-03-12 10:03:12,423 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:03:12,423 INFO] Validation perplexity: 3279.81
[2024-03-12 10:03:12,423 INFO] Validation accuracy: 26.9555
[2024-03-12 10:03:12,424 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_9400.pt
[2024-03-12 10:03:14,924 INFO] Step 9450/11200; acc: 85.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2473; bsz:  589/ 512/49; 4795/4163 tok/s;    265 sec;
[2024-03-12 10:03:17,697 INFO] Step 9500/11200; acc: 87.1; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2273; bsz:  558/ 485/45; 10070/8743 tok/s;    268 sec;
[2024-03-12 10:03:21,315 INFO] Step 9550/11200; acc: 86.9; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2382; bsz:  589/ 510/48; 8136/7053 tok/s;    272 sec;
[2024-03-12 10:03:24,857 INFO] Step 9600/11200; acc: 88.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2376; bsz:  569/ 497/48; 8038/7020 tok/s;    275 sec;
[2024-03-12 10:03:28,264 INFO] valid stats calculation
                           took: 3.406827449798584 s.
[2024-03-12 10:03:28,265 INFO] Train perplexity: 18.594
[2024-03-12 10:03:28,265 INFO] Train accuracy: 53.1473
[2024-03-12 10:03:28,265 INFO] Sentences processed: 158980
[2024-03-12 10:03:28,265 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:03:28,265 INFO] Validation perplexity: 5382.5
[2024-03-12 10:03:28,265 INFO] Validation accuracy: 27.4769
[2024-03-12 10:03:28,266 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_9600.pt
[2024-03-12 10:03:31,278 INFO] Step 9650/11200; acc: 88.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2280; bsz:  565/ 490/46; 4400/3818 tok/s;    282 sec;
[2024-03-12 10:03:33,812 INFO] Step 9700/11200; acc: 88.5; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2368; bsz:  565/ 491/47; 11151/9693 tok/s;    284 sec;
[2024-03-12 10:03:37,233 INFO] Step 9750/11200; acc: 88.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2246; bsz:  550/ 476/45; 8035/6954 tok/s;    288 sec;
[2024-03-12 10:03:40,888 INFO] Step 9800/11200; acc: 89.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2368; bsz:  587/ 509/47; 8033/6957 tok/s;    291 sec;
[2024-03-12 10:03:44,301 INFO] valid stats calculation
                           took: 3.4122817516326904 s.
[2024-03-12 10:03:44,301 INFO] Train perplexity: 16.1599
[2024-03-12 10:03:44,301 INFO] Train accuracy: 55.1136
[2024-03-12 10:03:44,302 INFO] Sentences processed: 168242
[2024-03-12 10:03:44,302 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:03:44,302 INFO] Validation perplexity: 7553.58
[2024-03-12 10:03:44,302 INFO] Validation accuracy: 27.1961
[2024-03-12 10:03:44,303 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_9800.pt
[2024-03-12 10:03:47,609 INFO] Step 9850/11200; acc: 89.4; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2363; bsz:  562/ 488/47; 4178/3632 tok/s;    298 sec;
[2024-03-12 10:03:49,960 INFO] Step 9900/11200; acc: 88.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2251; bsz:  550/ 476/45; 11705/10130 tok/s;    300 sec;
[2024-03-12 10:03:53,327 INFO] Step 9950/11200; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  582/ 505/47; 8651/7503 tok/s;    304 sec;
[2024-03-12 10:03:56,972 INFO] Step 10000/11200; acc: 89.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  587/ 513/48; 8051/7040 tok/s;    308 sec;
[2024-03-12 10:04:00,522 INFO] valid stats calculation
                           took: 3.5499541759490967 s.
[2024-03-12 10:04:00,523 INFO] Train perplexity: 14.2173
[2024-03-12 10:04:00,523 INFO] Train accuracy: 56.9295
[2024-03-12 10:04:00,523 INFO] Sentences processed: 177605
[2024-03-12 10:04:00,523 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:04:00,523 INFO] Validation perplexity: 7938.8
[2024-03-12 10:04:00,523 INFO] Validation accuracy: 26.1532
[2024-03-12 10:04:00,524 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_10000.pt
[2024-03-12 10:04:04,189 INFO] Step 10050/11200; acc: 90.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2272; bsz:  539/ 467/45; 3734/3236 tok/s;    315 sec;
[2024-03-12 10:04:06,696 INFO] Step 10100/11200; acc: 90.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  582/ 505/48; 11604/10069 tok/s;    317 sec;
[2024-03-12 10:04:09,849 INFO] Step 10150/11200; acc: 90.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  583/ 509/48; 9250/8066 tok/s;    320 sec;
[2024-03-12 10:04:13,387 INFO] Step 10200/11200; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2278; bsz:  548/ 473/46; 7742/6692 tok/s;    324 sec;
[2024-03-12 10:04:16,791 INFO] valid stats calculation
                           took: 3.40348219871521 s.
[2024-03-12 10:04:16,792 INFO] Train perplexity: 12.6714
[2024-03-12 10:04:16,792 INFO] Train accuracy: 58.5845
[2024-03-12 10:04:16,792 INFO] Sentences processed: 186912
[2024-03-12 10:04:16,792 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:04:16,792 INFO] Validation perplexity: 9383.95
[2024-03-12 10:04:16,792 INFO] Validation accuracy: 27.4368
[2024-03-12 10:04:16,793 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_10200.pt
[2024-03-12 10:04:20,521 INFO] Step 10250/11200; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  587/ 515/47; 4117/3611 tok/s;    331 sec;
[2024-03-12 10:04:23,292 INFO] Step 10300/11200; acc: 91.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2264; bsz:  559/ 483/45; 10089/8721 tok/s;    334 sec;
[2024-03-12 10:04:26,058 INFO] Step 10350/11200; acc: 91.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2470; bsz:  579/ 501/49; 10467/9064 tok/s;    337 sec;
[2024-03-12 10:04:29,565 INFO] Step 10400/11200; acc: 91.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2260; bsz:  554/ 481/45; 7895/6854 tok/s;    340 sec;
[2024-03-12 10:04:33,001 INFO] valid stats calculation
                           took: 3.436098337173462 s.
[2024-03-12 10:04:33,001 INFO] Train perplexity: 11.3884
[2024-03-12 10:04:33,002 INFO] Train accuracy: 60.141
[2024-03-12 10:04:33,002 INFO] Sentences processed: 196278
[2024-03-12 10:04:33,002 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:04:33,002 INFO] Validation perplexity: 9858.47
[2024-03-12 10:04:33,002 INFO] Validation accuracy: 26.8753
[2024-03-12 10:04:33,003 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_10400.pt
[2024-03-12 10:04:36,714 INFO] Step 10450/11200; acc: 91.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  563/ 492/47; 3941/3441 tok/s;    347 sec;
[2024-03-12 10:04:39,579 INFO] Step 10500/11200; acc: 91.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2268; bsz:  561/ 484/45; 9785/8454 tok/s;    350 sec;
[2024-03-12 10:04:42,210 INFO] Step 10550/11200; acc: 91.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2373; bsz:  581/ 507/47; 11043/9630 tok/s;    353 sec;
[2024-03-12 10:04:45,876 INFO] Step 10600/11200; acc: 92.1; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  585/ 503/47; 7975/6867 tok/s;    356 sec;
[2024-03-12 10:04:49,310 INFO] valid stats calculation
                           took: 3.4332942962646484 s.
[2024-03-12 10:04:49,310 INFO] Train perplexity: 10.3206
[2024-03-12 10:04:49,310 INFO] Train accuracy: 61.5883
[2024-03-12 10:04:49,310 INFO] Sentences processed: 205658
[2024-03-12 10:04:49,310 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:04:49,310 INFO] Validation perplexity: 9654.48
[2024-03-12 10:04:49,310 INFO] Validation accuracy: 27.156
[2024-03-12 10:04:49,312 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_10600.pt
[2024-03-12 10:04:52,992 INFO] Step 10650/11200; acc: 91.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2274; bsz:  559/ 484/45; 3927/3399 tok/s;    364 sec;
[2024-03-12 10:04:56,010 INFO] Step 10700/11200; acc: 92.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2382; bsz:  561/ 487/48; 9294/8076 tok/s;    367 sec;
[2024-03-12 10:04:58,540 INFO] Step 10750/11200; acc: 92.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  589/ 509/48; 11635/10063 tok/s;    369 sec;
[2024-03-12 10:05:02,075 INFO] Step 10800/11200; acc: 92.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2277; bsz:  544/ 471/46; 7692/6668 tok/s;    373 sec;
[2024-03-12 10:05:05,517 INFO] valid stats calculation
                           took: 3.4412832260131836 s.
[2024-03-12 10:05:05,517 INFO] Train perplexity: 9.44245
[2024-03-12 10:05:05,517 INFO] Train accuracy: 62.9078
[2024-03-12 10:05:05,517 INFO] Sentences processed: 214967
[2024-03-12 10:05:05,517 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:05:05,517 INFO] Validation perplexity: 10052.2
[2024-03-12 10:05:05,517 INFO] Validation accuracy: 26.8753
[2024-03-12 10:05:05,518 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_10800.pt
[2024-03-12 10:05:09,254 INFO] Step 10850/11200; acc: 92.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 4078/3537 tok/s;    380 sec;
[2024-03-12 10:05:12,575 INFO] Step 10900/11200; acc: 93.0; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2366; bsz:  579/ 500/47; 8721/7525 tok/s;    383 sec;
[2024-03-12 10:05:14,927 INFO] Step 10950/11200; acc: 92.8; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2263; bsz:  543/ 472/45; 11547/10041 tok/s;    385 sec;
[2024-03-12 10:05:18,108 INFO] Step 11000/11200; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2365; bsz:  580/ 500/47; 9115/7853 tok/s;    389 sec;
[2024-03-12 10:05:21,535 INFO] valid stats calculation
                           took: 3.4270198345184326 s.
[2024-03-12 10:05:21,536 INFO] Train perplexity: 8.68665
[2024-03-12 10:05:21,536 INFO] Train accuracy: 64.1573
[2024-03-12 10:05:21,536 INFO] Sentences processed: 224332
[2024-03-12 10:05:21,536 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:05:21,536 INFO] Validation perplexity: 13804.9
[2024-03-12 10:05:21,536 INFO] Validation accuracy: 26.5945
[2024-03-12 10:05:21,537 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_11000.pt
[2024-03-12 10:05:25,208 INFO] Step 11050/11200; acc: 92.7; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2267; bsz:  560/ 486/45; 3946/3423 tok/s;    396 sec;
[2024-03-12 10:05:28,804 INFO] Step 11100/11200; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  582/ 504/47; 8092/7003 tok/s;    399 sec;
[2024-03-12 10:05:31,291 INFO] Step 11150/11200; acc: 92.8; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2372; bsz:  564/ 492/47; 11339/9903 tok/s;    402 sec;
[2024-03-12 10:05:34,299 INFO] Step 11200/11200; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2371; bsz:  567/ 494/47; 9428/8205 tok/s;    405 sec;
[2024-03-12 10:05:37,726 INFO] valid stats calculation
                           took: 3.4261772632598877 s.
[2024-03-12 10:05:37,726 INFO] Train perplexity: 8.04417
[2024-03-12 10:05:37,726 INFO] Train accuracy: 65.3072
[2024-03-12 10:05:37,726 INFO] Sentences processed: 233709
[2024-03-12 10:05:37,727 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:05:37,727 INFO] Validation perplexity: 14441.1
[2024-03-12 10:05:37,727 INFO] Validation accuracy: 27.1961
[2024-03-12 10:05:37,728 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_01_step_11200.pt
