[2024-03-12 10:27:56,844 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-12 10:27:56,844 INFO] Parsed 2 corpora from -data.
[2024-03-12 10:27:56,844 INFO] Loading checkpoint from tg-pt-enc/models/tg-pt-enc_03_step_2800.pt
[2024-03-12 10:27:56,913 INFO] Building model...
[2024-03-12 10:27:56,968 INFO] Switching model to float32 for amp/apex_amp
[2024-03-12 10:27:56,968 INFO] Non quantized layer compute is fp32
[2024-03-12 10:27:59,171 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-12 10:27:59,171 INFO] encoder: 8952800
[2024-03-12 10:27:59,171 INFO] decoder: 16687344
[2024-03-12 10:27:59,171 INFO] * number of parameters: 25640144
[2024-03-12 10:27:59,171 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 10:27:59,171 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 10:27:59,171 INFO]  * src vocab size = 17816
[2024-03-12 10:27:59,172 INFO]  * tgt vocab size = 14144
[2024-03-12 10:27:59,173 INFO] Starting training on GPU: [0]
[2024-03-12 10:27:59,173 INFO] Start training loop and validate every 200 steps...
[2024-03-12 10:27:59,173 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-12 10:28:05,733 INFO] Step 2850/ 7800; acc: 9.8; ppl: 57278.0; xent: 11.0; lr: 1.00000; sents:    2366; bsz:  591/ 513/47; 4502/3910 tok/s;      7 sec;
[2024-03-12 10:28:09,195 INFO] Step 2900/ 7800; acc: 13.2; ppl: 1598.4; xent: 7.4; lr: 1.00000; sents:    2369; bsz:  568/ 496/47; 8208/7162 tok/s;     10 sec;
[2024-03-12 10:28:12,754 INFO] Step 2950/ 7800; acc: 16.7; ppl: 433.4; xent: 6.1; lr: 1.00000; sents:    2267; bsz:  560/ 485/45; 7868/6812 tok/s;     14 sec;
[2024-03-12 10:28:16,201 INFO] Step 3000/ 7800; acc: 20.1; ppl: 240.0; xent: 5.5; lr: 1.00000; sents:    2244; bsz:  546/ 472/45; 7920/6853 tok/s;     17 sec;
[2024-03-12 10:28:19,656 INFO] valid stats calculation
                           took: 3.454709053039551 s.
[2024-03-12 10:28:19,657 INFO] Train perplexity: 1868.93
[2024-03-12 10:28:19,657 INFO] Train accuracy: 14.8332
[2024-03-12 10:28:19,657 INFO] Sentences processed: 9246
[2024-03-12 10:28:19,657 INFO] Average bsz:  566/ 492/46
[2024-03-12 10:28:19,657 INFO] Validation perplexity: 706.113
[2024-03-12 10:28:19,657 INFO] Validation accuracy: 12.3546
[2024-03-12 10:28:19,658 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_3000.pt
[2024-03-12 10:28:22,425 INFO] Step 3050/ 7800; acc: 22.7; ppl: 150.7; xent: 5.0; lr: 1.00000; sents:    2367; bsz:  587/ 510/47; 4712/4094 tok/s;     23 sec;
[2024-03-12 10:28:25,943 INFO] Step 3100/ 7800; acc: 26.8; ppl:  93.7; xent: 4.5; lr: 1.00000; sents:    2372; bsz:  566/ 491/47; 8046/6979 tok/s;     27 sec;
[2024-03-12 10:28:29,473 INFO] Step 3150/ 7800; acc: 29.6; ppl:  64.6; xent: 4.2; lr: 1.00000; sents:    2275; bsz:  561/ 487/46; 7950/6896 tok/s;     30 sec;
[2024-03-12 10:28:32,963 INFO] Step 3200/ 7800; acc: 33.1; ppl:  45.2; xent: 3.8; lr: 1.00000; sents:    2487; bsz:  594/ 518/50; 8505/7417 tok/s;     34 sec;
[2024-03-12 10:28:36,413 INFO] valid stats calculation
                           took: 3.4496517181396484 s.
[2024-03-12 10:28:36,413 INFO] Train perplexity: 380.815
[2024-03-12 10:28:36,413 INFO] Train accuracy: 21.5108
[2024-03-12 10:28:36,413 INFO] Sentences processed: 18747
[2024-03-12 10:28:36,413 INFO] Average bsz:  572/ 496/47
[2024-03-12 10:28:36,413 INFO] Validation perplexity: 215.743
[2024-03-12 10:28:36,413 INFO] Validation accuracy: 24.8696
[2024-03-12 10:28:36,415 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_3200.pt
[2024-03-12 10:28:39,021 INFO] Step 3250/ 7800; acc: 35.1; ppl:  35.4; xent: 3.6; lr: 1.00000; sents:    2277; bsz:  561/ 487/46; 4633/4018 tok/s;     40 sec;
[2024-03-12 10:28:42,542 INFO] Step 3300/ 7800; acc: 38.3; ppl:  27.2; xent: 3.3; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 7998/6945 tok/s;     43 sec;
[2024-03-12 10:28:46,166 INFO] Step 3350/ 7800; acc: 39.0; ppl:  23.6; xent: 3.2; lr: 1.00000; sents:    2258; bsz:  569/ 490/45; 7846/6759 tok/s;     47 sec;
[2024-03-12 10:28:49,709 INFO] Step 3400/ 7800; acc: 43.0; ppl:  17.3; xent: 2.9; lr: 1.00000; sents:    2366; bsz:  562/ 489/47; 7934/6904 tok/s;     51 sec;
[2024-03-12 10:28:53,277 INFO] valid stats calculation
                           took: 3.567505359649658 s.
[2024-03-12 10:28:53,277 INFO] Train perplexity: 155.167
[2024-03-12 10:28:53,277 INFO] Train accuracy: 27.2264
[2024-03-12 10:28:53,278 INFO] Sentences processed: 28023
[2024-03-12 10:28:53,278 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:28:53,278 INFO] Validation perplexity: 292.864
[2024-03-12 10:28:53,278 INFO] Validation accuracy: 26.9956
[2024-03-12 10:28:53,279 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_3400.pt
[2024-03-12 10:28:55,830 INFO] Step 3450/ 7800; acc: 43.7; ppl:  16.2; xent: 2.8; lr: 1.00000; sents:    2271; bsz:  567/ 491/45; 4631/4008 tok/s;     57 sec;
[2024-03-12 10:28:59,087 INFO] Step 3500/ 7800; acc: 46.4; ppl:  13.0; xent: 2.6; lr: 1.00000; sents:    2460; bsz:  588/ 522/49; 9023/8013 tok/s;     60 sec;
[2024-03-12 10:29:02,641 INFO] Step 3550/ 7800; acc: 48.5; ppl:  11.3; xent: 2.4; lr: 1.00000; sents:    2271; bsz:  567/ 490/45; 7974/6891 tok/s;     63 sec;
[2024-03-12 10:29:06,207 INFO] Step 3600/ 7800; acc: 50.9; ppl:   9.5; xent: 2.3; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 8027/6957 tok/s;     67 sec;
[2024-03-12 10:29:09,596 INFO] valid stats calculation
                           took: 3.3884944915771484 s.
[2024-03-12 10:29:09,597 INFO] Train perplexity: 81.814
[2024-03-12 10:29:09,597 INFO] Train accuracy: 32.3079
[2024-03-12 10:29:09,597 INFO] Sentences processed: 37390
[2024-03-12 10:29:09,597 INFO] Average bsz:  570/ 495/47
[2024-03-12 10:29:09,597 INFO] Validation perplexity: 312.459
[2024-03-12 10:29:09,597 INFO] Validation accuracy: 24.7894
[2024-03-12 10:29:09,598 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_3600.pt
[2024-03-12 10:29:12,184 INFO] Step 3650/ 7800; acc: 52.5; ppl:   8.5; xent: 2.1; lr: 1.00000; sents:    2269; bsz:  557/ 482/45; 4660/4031 tok/s;     73 sec;
[2024-03-12 10:29:15,421 INFO] Step 3700/ 7800; acc: 54.9; ppl:   7.2; xent: 2.0; lr: 1.00000; sents:    2371; bsz:  563/ 491/47; 8703/7580 tok/s;     76 sec;
[2024-03-12 10:29:19,110 INFO] Step 3750/ 7800; acc: 57.1; ppl:   6.2; xent: 1.8; lr: 1.00000; sents:    2376; bsz:  565/ 495/48; 7665/6711 tok/s;     80 sec;
[2024-03-12 10:29:22,821 INFO] Step 3800/ 7800; acc: 56.4; ppl:   6.2; xent: 1.8; lr: 1.00000; sents:    2284; bsz:  579/ 498/46; 7804/6704 tok/s;     84 sec;
[2024-03-12 10:29:26,244 INFO] valid stats calculation
                           took: 3.421910047531128 s.
[2024-03-12 10:29:26,244 INFO] Train perplexity: 50.0898
[2024-03-12 10:29:26,244 INFO] Train accuracy: 36.867
[2024-03-12 10:29:26,244 INFO] Sentences processed: 46690
[2024-03-12 10:29:26,244 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:29:26,244 INFO] Validation perplexity: 391.151
[2024-03-12 10:29:26,244 INFO] Validation accuracy: 28.1187
[2024-03-12 10:29:26,246 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_3800.pt
[2024-03-12 10:29:28,798 INFO] Step 3850/ 7800; acc: 60.3; ppl:   5.2; xent: 1.6; lr: 1.00000; sents:    2376; bsz:  564/ 493/48; 4722/4125 tok/s;     90 sec;
[2024-03-12 10:29:31,787 INFO] Step 3900/ 7800; acc: 62.0; ppl:   4.7; xent: 1.6; lr: 1.00000; sents:    2375; bsz:  579/ 498/48; 9683/8332 tok/s;     93 sec;
[2024-03-12 10:29:35,392 INFO] Step 3950/ 7800; acc: 63.0; ppl:   4.3; xent: 1.5; lr: 1.00000; sents:    2371; bsz:  565/ 491/47; 7837/6803 tok/s;     96 sec;
[2024-03-12 10:29:38,981 INFO] Step 4000/ 7800; acc: 64.4; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    2266; bsz:  559/ 484/45; 7786/6749 tok/s;    100 sec;
[2024-03-12 10:29:42,407 INFO] valid stats calculation
                           took: 3.4246716499328613 s.
[2024-03-12 10:29:42,407 INFO] Train perplexity: 33.6615
[2024-03-12 10:29:42,407 INFO] Train accuracy: 41.0974
[2024-03-12 10:29:42,407 INFO] Sentences processed: 56078
[2024-03-12 10:29:42,407 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:29:42,407 INFO] Validation perplexity: 490.554
[2024-03-12 10:29:42,407 INFO] Validation accuracy: 29.9639
[2024-03-12 10:29:42,408 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_4000.pt
[2024-03-12 10:29:45,120 INFO] Step 4050/ 7800; acc: 66.0; ppl:   3.7; xent: 1.3; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 4595/3995 tok/s;    106 sec;
[2024-03-12 10:29:47,959 INFO] Step 4100/ 7800; acc: 67.1; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    2364; bsz:  584/ 506/47; 10286/8907 tok/s;    109 sec;
[2024-03-12 10:29:51,603 INFO] Step 4150/ 7800; acc: 68.6; ppl:   3.3; xent: 1.2; lr: 1.00000; sents:    2269; bsz:  564/ 488/45; 7738/6696 tok/s;    112 sec;
[2024-03-12 10:29:55,138 INFO] Step 4200/ 7800; acc: 70.4; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    2367; bsz:  579/ 500/47; 8198/7073 tok/s;    116 sec;
[2024-03-12 10:29:58,571 INFO] valid stats calculation
                           took: 3.432565689086914 s.
[2024-03-12 10:29:58,571 INFO] Train perplexity: 24.2352
[2024-03-12 10:29:58,571 INFO] Train accuracy: 44.9591
[2024-03-12 10:29:58,571 INFO] Sentences processed: 65444
[2024-03-12 10:29:58,571 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:29:58,571 INFO] Validation perplexity: 769.706
[2024-03-12 10:29:58,571 INFO] Validation accuracy: 28.0786
[2024-03-12 10:29:58,573 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_4200.pt
[2024-03-12 10:30:01,493 INFO] Step 4250/ 7800; acc: 72.0; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    2272; bsz:  545/ 472/45; 4288/3714 tok/s;    122 sec;
[2024-03-12 10:30:04,231 INFO] Step 4300/ 7800; acc: 72.5; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    2371; bsz:  581/ 502/47; 10613/9170 tok/s;    125 sec;
[2024-03-12 10:30:07,789 INFO] Step 4350/ 7800; acc: 73.5; ppl:   2.6; xent: 1.0; lr: 1.00000; sents:    2273; bsz:  560/ 486/45; 7868/6831 tok/s;    129 sec;
[2024-03-12 10:30:11,398 INFO] Step 4400/ 7800; acc: 74.8; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2382; bsz:  582/ 504/48; 8067/6984 tok/s;    132 sec;
[2024-03-12 10:30:14,830 INFO] valid stats calculation
                           took: 3.4316885471343994 s.
[2024-03-12 10:30:14,830 INFO] Train perplexity: 18.4442
[2024-03-12 10:30:14,830 INFO] Train accuracy: 48.47
[2024-03-12 10:30:14,830 INFO] Sentences processed: 74742
[2024-03-12 10:30:14,830 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:30:14,830 INFO] Validation perplexity: 1042.37
[2024-03-12 10:30:14,830 INFO] Validation accuracy: 26.434
[2024-03-12 10:30:14,832 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_4400.pt
[2024-03-12 10:30:17,905 INFO] Step 4450/ 7800; acc: 75.7; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2376; bsz:  564/ 490/48; 4331/3764 tok/s;    139 sec;
[2024-03-12 10:30:20,369 INFO] Step 4500/ 7800; acc: 76.0; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2376; bsz:  589/ 510/48; 11945/10352 tok/s;    141 sec;
[2024-03-12 10:30:22,790 INFO] Step 4550/ 7800; acc: 78.1; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2368; bsz:  569/ 498/47; 11754/10290 tok/s;    144 sec;
[2024-03-12 10:30:25,223 INFO] Step 4600/ 7800; acc: 79.1; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2270; bsz:  563/ 487/45; 11566/10010 tok/s;    146 sec;
[2024-03-12 10:30:28,872 INFO] valid stats calculation
                           took: 3.647620677947998 s.
[2024-03-12 10:30:28,872 INFO] Train perplexity: 14.5879
[2024-03-12 10:30:28,872 INFO] Train accuracy: 51.6777
[2024-03-12 10:30:28,872 INFO] Sentences processed: 84132
[2024-03-12 10:30:28,872 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:30:28,872 INFO] Validation perplexity: 1651.15
[2024-03-12 10:30:28,872 INFO] Validation accuracy: 28.2792
[2024-03-12 10:30:28,874 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_4600.pt
[2024-03-12 10:30:32,500 INFO] Step 4650/ 7800; acc: 78.9; ppl:   2.1; xent: 0.8; lr: 1.00000; sents:    2369; bsz:  587/ 508/47; 4033/3489 tok/s;    153 sec;
[2024-03-12 10:30:35,985 INFO] Step 4700/ 7800; acc: 81.0; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2363; bsz:  565/ 492/47; 8105/7056 tok/s;    157 sec;
[2024-03-12 10:30:39,506 INFO] Step 4750/ 7800; acc: 81.2; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2244; bsz:  547/ 474/45; 7769/6729 tok/s;    160 sec;
[2024-03-12 10:30:43,119 INFO] Step 4800/ 7800; acc: 82.2; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2367; bsz:  579/ 502/47; 8015/6944 tok/s;    164 sec;
[2024-03-12 10:30:46,741 INFO] valid stats calculation
                           took: 3.6210196018218994 s.
[2024-03-12 10:30:46,741 INFO] Train perplexity: 11.9402
[2024-03-12 10:30:46,741 INFO] Train accuracy: 54.5867
[2024-03-12 10:30:46,741 INFO] Sentences processed: 93475
[2024-03-12 10:30:46,741 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:30:46,741 INFO] Validation perplexity: 2093.55
[2024-03-12 10:30:46,741 INFO] Validation accuracy: 28.3995
[2024-03-12 10:30:46,743 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_4800.pt
[2024-03-12 10:30:50,376 INFO] Step 4850/ 7800; acc: 82.3; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2268; bsz:  558/ 484/45; 3845/3333 tok/s;    171 sec;
[2024-03-12 10:30:53,956 INFO] Step 4900/ 7800; acc: 83.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2379; bsz:  568/ 494/48; 7933/6907 tok/s;    175 sec;
[2024-03-12 10:30:57,534 INFO] Step 4950/ 7800; acc: 83.5; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2383; bsz:  583/ 507/48; 8149/7083 tok/s;    178 sec;
[2024-03-12 10:31:01,104 INFO] Step 5000/ 7800; acc: 84.4; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2267; bsz:  555/ 479/45; 7769/6715 tok/s;    182 sec;
[2024-03-12 10:31:04,655 INFO] valid stats calculation
                           took: 3.55131459236145 s.
[2024-03-12 10:31:04,656 INFO] Train perplexity: 10.058
[2024-03-12 10:31:04,656 INFO] Train accuracy: 57.1843
[2024-03-12 10:31:04,656 INFO] Sentences processed: 102772
[2024-03-12 10:31:04,656 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:31:04,656 INFO] Validation perplexity: 2223.58
[2024-03-12 10:31:04,656 INFO] Validation accuracy: 27.0758
[2024-03-12 10:31:04,657 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_5000.pt
[2024-03-12 10:31:08,006 INFO] Step 5050/ 7800; acc: 85.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 4079/3544 tok/s;    189 sec;
[2024-03-12 10:31:11,688 INFO] Step 5100/ 7800; acc: 85.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2372; bsz:  586/ 513/47; 7960/6969 tok/s;    193 sec;
[2024-03-12 10:31:15,269 INFO] Step 5150/ 7800; acc: 85.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2366; bsz:  567/ 497/47; 7917/6941 tok/s;    196 sec;
[2024-03-12 10:31:18,906 INFO] Step 5200/ 7800; acc: 86.2; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2271; bsz:  568/ 493/45; 7815/6784 tok/s;    200 sec;
[2024-03-12 10:31:22,502 INFO] valid stats calculation
                           took: 3.5953030586242676 s.
[2024-03-12 10:31:22,502 INFO] Train perplexity: 8.63845
[2024-03-12 10:31:22,502 INFO] Train accuracy: 59.5716
[2024-03-12 10:31:22,502 INFO] Sentences processed: 112156
[2024-03-12 10:31:22,502 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:31:22,502 INFO] Validation perplexity: 3646.89
[2024-03-12 10:31:22,502 INFO] Validation accuracy: 26.7549
[2024-03-12 10:31:22,503 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_5200.pt
[2024-03-12 10:31:25,720 INFO] Step 5250/ 7800; acc: 86.3; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2260; bsz:  555/ 480/45; 4076/3526 tok/s;    207 sec;
[2024-03-12 10:31:29,251 INFO] Step 5300/ 7800; acc: 87.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2367; bsz:  571/ 492/47; 8085/6969 tok/s;    210 sec;
[2024-03-12 10:31:32,743 INFO] Step 5350/ 7800; acc: 87.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2365; bsz:  562/ 489/47; 8040/7001 tok/s;    214 sec;
[2024-03-12 10:31:36,307 INFO] Step 5400/ 7800; acc: 87.7; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2276; bsz:  563/ 487/46; 7897/6826 tok/s;    217 sec;
[2024-03-12 10:31:39,707 INFO] valid stats calculation
                           took: 3.399595022201538 s.
[2024-03-12 10:31:39,707 INFO] Train perplexity: 7.58475
[2024-03-12 10:31:39,708 INFO] Train accuracy: 61.6588
[2024-03-12 10:31:39,708 INFO] Sentences processed: 121424
[2024-03-12 10:31:39,708 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:31:39,708 INFO] Validation perplexity: 3703.05
[2024-03-12 10:31:39,708 INFO] Validation accuracy: 28.2391
[2024-03-12 10:31:39,709 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_5400.pt
[2024-03-12 10:31:42,744 INFO] Step 5450/ 7800; acc: 87.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2372; bsz:  581/ 506/47; 4515/3929 tok/s;    224 sec;
[2024-03-12 10:31:46,408 INFO] Step 5500/ 7800; acc: 88.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  565/ 494/48; 7711/6748 tok/s;    227 sec;
[2024-03-12 10:31:49,852 INFO] Step 5550/ 7800; acc: 88.9; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2381; bsz:  566/ 491/48; 8219/7130 tok/s;    231 sec;
[2024-03-12 10:31:53,444 INFO] Step 5600/ 7800; acc: 88.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2276; bsz:  561/ 485/46; 7814/6753 tok/s;    234 sec;
[2024-03-12 10:31:56,866 INFO] valid stats calculation
                           took: 3.421806573867798 s.
[2024-03-12 10:31:56,866 INFO] Train perplexity: 6.75174
[2024-03-12 10:31:56,867 INFO] Train accuracy: 63.5814
[2024-03-12 10:31:56,867 INFO] Sentences processed: 130828
[2024-03-12 10:31:56,867 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:31:56,867 INFO] Validation perplexity: 4481.3
[2024-03-12 10:31:56,867 INFO] Validation accuracy: 28.199
[2024-03-12 10:31:56,868 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_5600.pt
[2024-03-12 10:31:59,544 INFO] Step 5650/ 7800; acc: 89.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  579/ 499/48; 4746/4087 tok/s;    240 sec;
[2024-03-12 10:32:03,202 INFO] Step 5700/ 7800; acc: 89.3; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2273; bsz:  565/ 489/45; 7724/6684 tok/s;    244 sec;
[2024-03-12 10:32:06,879 INFO] Step 5750/ 7800; acc: 89.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2366; bsz:  583/ 506/47; 7934/6884 tok/s;    248 sec;
[2024-03-12 10:32:10,397 INFO] Step 5800/ 7800; acc: 90.4; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 8023/6971 tok/s;    251 sec;
[2024-03-12 10:32:13,836 INFO] valid stats calculation
                           took: 3.4382503032684326 s.
[2024-03-12 10:32:13,836 INFO] Train perplexity: 6.08731
[2024-03-12 10:32:13,836 INFO] Train accuracy: 65.3208
[2024-03-12 10:32:13,836 INFO] Sentences processed: 140208
[2024-03-12 10:32:13,836 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:32:13,836 INFO] Validation perplexity: 5319.04
[2024-03-12 10:32:13,836 INFO] Validation accuracy: 28.1187
[2024-03-12 10:32:13,838 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_5800.pt
[2024-03-12 10:32:16,433 INFO] Step 5850/ 7800; acc: 90.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2362; bsz:  579/ 499/47; 4794/4133 tok/s;    257 sec;
[2024-03-12 10:32:19,917 INFO] Step 5900/ 7800; acc: 90.5; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2267; bsz:  544/ 472/45; 7809/6778 tok/s;    261 sec;
[2024-03-12 10:32:23,430 INFO] Step 5950/ 7800; acc: 90.5; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2369; bsz:  580/ 501/47; 8263/7129 tok/s;    264 sec;
[2024-03-12 10:32:27,003 INFO] Step 6000/ 7800; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  566/ 494/47; 7919/6910 tok/s;    268 sec;
[2024-03-12 10:32:30,459 INFO] valid stats calculation
                           took: 3.455472469329834 s.
[2024-03-12 10:32:30,459 INFO] Train perplexity: 5.55214
[2024-03-12 10:32:30,460 INFO] Train accuracy: 66.8894
[2024-03-12 10:32:30,460 INFO] Sentences processed: 149578
[2024-03-12 10:32:30,460 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:32:30,460 INFO] Validation perplexity: 5030.21
[2024-03-12 10:32:30,460 INFO] Validation accuracy: 29.282
[2024-03-12 10:32:30,461 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_6000.pt
[2024-03-12 10:32:33,057 INFO] Step 6050/ 7800; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2269; bsz:  576/ 495/45; 4755/4092 tok/s;    274 sec;
[2024-03-12 10:32:36,444 INFO] Step 6100/ 7800; acc: 91.3; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  565/ 492/48; 8345/7268 tok/s;    277 sec;
[2024-03-12 10:32:40,096 INFO] Step 6150/ 7800; acc: 91.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2279; bsz:  561/ 487/46; 7686/6667 tok/s;    281 sec;
[2024-03-12 10:32:43,650 INFO] Step 6200/ 7800; acc: 91.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2378; bsz:  570/ 496/48; 8014/6979 tok/s;    284 sec;
[2024-03-12 10:32:47,086 INFO] valid stats calculation
                           took: 3.435107946395874 s.
[2024-03-12 10:32:47,087 INFO] Train perplexity: 5.11104
[2024-03-12 10:32:47,087 INFO] Train accuracy: 68.326
[2024-03-12 10:32:47,087 INFO] Sentences processed: 158879
[2024-03-12 10:32:47,087 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:32:47,087 INFO] Validation perplexity: 5845.08
[2024-03-12 10:32:47,087 INFO] Validation accuracy: 30.0842
[2024-03-12 10:32:47,088 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_6200.pt
[2024-03-12 10:32:49,659 INFO] Step 6250/ 7800; acc: 91.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  592/ 515/48; 4928/4284 tok/s;    290 sec;
[2024-03-12 10:32:52,950 INFO] Step 6300/ 7800; acc: 91.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2368; bsz:  585/ 506/47; 8894/7696 tok/s;    294 sec;
[2024-03-12 10:32:56,424 INFO] Step 6350/ 7800; acc: 91.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2246; bsz:  529/ 460/45; 7619/6626 tok/s;    297 sec;
[2024-03-12 10:33:00,013 INFO] Step 6400/ 7800; acc: 91.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2368; bsz:  587/ 509/47; 8181/7086 tok/s;    301 sec;
[2024-03-12 10:33:03,663 INFO] valid stats calculation
                           took: 3.6487953662872314 s.
[2024-03-12 10:33:03,663 INFO] Train perplexity: 4.74102
[2024-03-12 10:33:03,663 INFO] Train accuracy: 69.629
[2024-03-12 10:33:03,663 INFO] Sentences processed: 168242
[2024-03-12 10:33:03,663 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:33:03,663 INFO] Validation perplexity: 7100.13
[2024-03-12 10:33:03,663 INFO] Validation accuracy: 29.8436
[2024-03-12 10:33:03,664 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_6400.pt
[2024-03-12 10:33:06,201 INFO] Step 6450/ 7800; acc: 91.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2249; bsz:  551/ 478/45; 4453/3866 tok/s;    307 sec;
[2024-03-12 10:33:09,117 INFO] Step 6500/ 7800; acc: 92.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2479; bsz:  588/ 510/50; 10082/8737 tok/s;    310 sec;
[2024-03-12 10:33:12,754 INFO] Step 6550/ 7800; acc: 92.0; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2258; bsz:  555/ 482/45; 7635/6622 tok/s;    314 sec;
[2024-03-12 10:33:16,313 INFO] Step 6600/ 7800; acc: 92.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  569/ 497/48; 7987/6986 tok/s;    317 sec;
[2024-03-12 10:33:19,772 INFO] valid stats calculation
                           took: 3.4579155445098877 s.
[2024-03-12 10:33:19,772 INFO] Train perplexity: 4.43219
[2024-03-12 10:33:19,772 INFO] Train accuracy: 70.8132
[2024-03-12 10:33:19,772 INFO] Sentences processed: 177605
[2024-03-12 10:33:19,772 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:33:19,772 INFO] Validation perplexity: 7667.84
[2024-03-12 10:33:19,772 INFO] Validation accuracy: 28.9611
[2024-03-12 10:33:19,774 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_6600.pt
[2024-03-12 10:33:22,576 INFO] Step 6650/ 7800; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2379; bsz:  583/ 509/48; 4657/4066 tok/s;    323 sec;
[2024-03-12 10:33:25,396 INFO] Step 6700/ 7800; acc: 92.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2274; bsz:  555/ 478/45; 9849/8484 tok/s;    326 sec;
[2024-03-12 10:33:29,025 INFO] Step 6750/ 7800; acc: 92.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  583/ 509/48; 8038/7009 tok/s;    330 sec;
[2024-03-12 10:33:32,586 INFO] Step 6800/ 7800; acc: 92.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  566/ 495/48; 7942/6947 tok/s;    333 sec;
[2024-03-12 10:33:35,983 INFO] valid stats calculation
                           took: 3.396007776260376 s.
[2024-03-12 10:33:35,983 INFO] Train perplexity: 4.16484
[2024-03-12 10:33:35,983 INFO] Train accuracy: 71.9145
[2024-03-12 10:33:35,983 INFO] Sentences processed: 187009
[2024-03-12 10:33:35,983 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:33:35,983 INFO] Validation perplexity: 9244.47
[2024-03-12 10:33:35,983 INFO] Validation accuracy: 28.6001
[2024-03-12 10:33:35,985 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_6800.pt
[2024-03-12 10:33:39,072 INFO] Step 6850/ 7800; acc: 92.8; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2275; bsz:  569/ 494/46; 4391/3808 tok/s;    340 sec;
[2024-03-12 10:33:41,772 INFO] Step 6900/ 7800; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  578/ 498/47; 10697/9221 tok/s;    343 sec;
[2024-03-12 10:33:45,224 INFO] Step 6950/ 7800; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2263; bsz:  542/ 474/45; 7860/6865 tok/s;    346 sec;
[2024-03-12 10:33:48,723 INFO] Step 7000/ 7800; acc: 93.6; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2364; bsz:  572/ 494/47; 8170/7055 tok/s;    350 sec;
[2024-03-12 10:33:52,125 INFO] valid stats calculation
                           took: 3.4019079208374023 s.
[2024-03-12 10:33:52,125 INFO] Train perplexity: 3.93674
[2024-03-12 10:33:52,125 INFO] Train accuracy: 72.9235
[2024-03-12 10:33:52,125 INFO] Sentences processed: 196278
[2024-03-12 10:33:52,125 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:33:52,125 INFO] Validation perplexity: 8977.5
[2024-03-12 10:33:52,126 INFO] Validation accuracy: 28.56
[2024-03-12 10:33:52,127 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_7000.pt
[2024-03-12 10:33:55,456 INFO] Step 7050/ 7800; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  578/ 503/47; 4293/3737 tok/s;    356 sec;
[2024-03-12 10:33:57,871 INFO] Step 7100/ 7800; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2268; bsz:  546/ 473/45; 11304/9796 tok/s;    359 sec;
[2024-03-12 10:34:01,448 INFO] Step 7150/ 7800; acc: 93.2; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2373; bsz:  581/ 507/47; 8122/7082 tok/s;    362 sec;
[2024-03-12 10:34:05,024 INFO] Step 7200/ 7800; acc: 93.7; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2372; bsz:  565/ 491/47; 7907/6866 tok/s;    366 sec;
[2024-03-12 10:34:08,506 INFO] valid stats calculation
                           took: 3.4816555976867676 s.
[2024-03-12 10:34:08,506 INFO] Train perplexity: 3.73834
[2024-03-12 10:34:08,506 INFO] Train accuracy: 73.8508
[2024-03-12 10:34:08,506 INFO] Sentences processed: 205658
[2024-03-12 10:34:08,506 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:34:08,506 INFO] Validation perplexity: 11413.8
[2024-03-12 10:34:08,506 INFO] Validation accuracy: 28.1588
[2024-03-12 10:34:08,508 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_7200.pt
[2024-03-12 10:34:11,992 INFO] Step 7250/ 7800; acc: 93.2; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2375; bsz:  580/ 500/48; 4165/3586 tok/s;    373 sec;
[2024-03-12 10:34:14,521 INFO] Step 7300/ 7800; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2281; bsz:  559/ 484/46; 11042/9564 tok/s;    375 sec;
[2024-03-12 10:34:17,976 INFO] Step 7350/ 7800; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2376; bsz:  567/ 491/48; 8210/7112 tok/s;    379 sec;
[2024-03-12 10:34:21,604 INFO] Step 7400/ 7800; acc: 93.5; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2277; bsz:  565/ 489/46; 7790/6742 tok/s;    382 sec;
[2024-03-12 10:34:25,020 INFO] valid stats calculation
                           took: 3.415508270263672 s.
[2024-03-12 10:34:25,020 INFO] Train perplexity: 3.56629
[2024-03-12 10:34:25,021 INFO] Train accuracy: 74.6951
[2024-03-12 10:34:25,021 INFO] Sentences processed: 214967
[2024-03-12 10:34:25,021 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:34:25,021 INFO] Validation perplexity: 11694.5
[2024-03-12 10:34:25,021 INFO] Validation accuracy: 28.199
[2024-03-12 10:34:25,022 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_7400.pt
[2024-03-12 10:34:28,604 INFO] Step 7450/ 7800; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 4183/3628 tok/s;    389 sec;
[2024-03-12 10:34:31,091 INFO] Step 7500/ 7800; acc: 94.1; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2260; bsz:  558/ 482/45; 11217/9686 tok/s;    392 sec;
[2024-03-12 10:34:34,282 INFO] Step 7550/ 7800; acc: 93.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2369; bsz:  581/ 501/47; 9099/7848 tok/s;    395 sec;
[2024-03-12 10:34:37,784 INFO] Step 7600/ 7800; acc: 93.9; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2365; bsz:  564/ 489/47; 8051/6987 tok/s;    399 sec;
[2024-03-12 10:34:41,212 INFO] valid stats calculation
                           took: 3.4276046752929688 s.
[2024-03-12 10:34:41,212 INFO] Train perplexity: 3.41222
[2024-03-12 10:34:41,212 INFO] Train accuracy: 75.493
[2024-03-12 10:34:41,212 INFO] Sentences processed: 224332
[2024-03-12 10:34:41,212 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:34:41,212 INFO] Validation perplexity: 9798.37
[2024-03-12 10:34:41,212 INFO] Validation accuracy: 29.0012
[2024-03-12 10:34:41,214 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_7600.pt
[2024-03-12 10:34:44,837 INFO] Step 7650/ 7800; acc: 93.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2267; bsz:  560/ 486/45; 3972/3445 tok/s;    406 sec;
[2024-03-12 10:34:47,289 INFO] Step 7700/ 7800; acc: 93.9; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2469; bsz:  589/ 513/49; 12002/10457 tok/s;    408 sec;
[2024-03-12 10:34:50,323 INFO] Step 7750/ 7800; acc: 93.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2270; bsz:  557/ 483/45; 9184/7965 tok/s;    411 sec;
[2024-03-12 10:34:54,079 INFO] Step 7800/ 7800; acc: 93.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2371; bsz:  590/ 510/47; 7853/6795 tok/s;    415 sec;
[2024-03-12 10:34:57,512 INFO] valid stats calculation
                           took: 3.4325101375579834 s.
[2024-03-12 10:34:57,512 INFO] Train perplexity: 3.2753
[2024-03-12 10:34:57,512 INFO] Train accuracy: 76.2336
[2024-03-12 10:34:57,512 INFO] Sentences processed: 233709
[2024-03-12 10:34:57,512 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:34:57,512 INFO] Validation perplexity: 12226.6
[2024-03-12 10:34:57,512 INFO] Validation accuracy: 29.2419
[2024-03-12 10:34:57,514 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_01_step_7800.pt
