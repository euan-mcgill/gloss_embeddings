[2024-03-13 10:09:14,502 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-13 10:09:14,502 INFO] Parsed 2 corpora from -data.
[2024-03-13 10:09:14,502 INFO] Loading checkpoint from tg-pt-both/models/tg-pt-both_03_step_8600.pt
[2024-03-13 10:09:14,570 INFO] Building model...
[2024-03-13 10:09:14,625 INFO] Switching model to float32 for amp/apex_amp
[2024-03-13 10:09:14,625 INFO] Non quantized layer compute is fp32
[2024-03-13 10:09:16,964 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-13 10:09:16,965 INFO] encoder: 8952800
[2024-03-13 10:09:16,965 INFO] decoder: 16687344
[2024-03-13 10:09:16,965 INFO] * number of parameters: 25640144
[2024-03-13 10:09:16,965 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 10:09:16,965 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 10:09:16,965 INFO]  * src vocab size = 17816
[2024-03-13 10:09:16,965 INFO]  * tgt vocab size = 14144
[2024-03-13 10:09:16,967 INFO] Starting training on GPU: [0]
[2024-03-13 10:09:16,967 INFO] Start training loop and validate every 200 steps...
[2024-03-13 10:09:16,967 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-13 10:09:20,727 INFO] Saving checkpoint tg-ft-both/tg-ft-both_13600_01_step_8601.pt
[2024-03-13 10:18:06,611 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-13 10:18:06,611 INFO] Parsed 2 corpora from -data.
[2024-03-13 10:18:06,611 INFO] Loading checkpoint from tg-pt-both/models/tg-pt-both_03_step_8600.pt
[2024-03-13 10:18:06,678 INFO] Building model...
[2024-03-13 10:18:06,734 INFO] Switching model to float32 for amp/apex_amp
[2024-03-13 10:18:06,734 INFO] Non quantized layer compute is fp32
[2024-03-13 10:18:09,150 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-13 10:18:09,150 INFO] encoder: 8952800
[2024-03-13 10:18:09,150 INFO] decoder: 16687344
[2024-03-13 10:18:09,150 INFO] * number of parameters: 25640144
[2024-03-13 10:18:09,150 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 10:18:09,150 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 10:18:09,150 INFO]  * src vocab size = 17816
[2024-03-13 10:18:09,151 INFO]  * tgt vocab size = 14144
[2024-03-13 10:18:09,152 INFO] Starting training on GPU: [0]
[2024-03-13 10:18:09,152 INFO] Start training loop and validate every 200 steps...
[2024-03-13 10:18:09,152 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-13 10:18:16,147 INFO] Step 8650/13600; acc: 9.4; ppl: 1940828.4; xent: 14.5; lr: 1.00000; sents:    2270; bsz:  565/ 490/45; 4040/3501 tok/s;      7 sec;
[2024-03-13 10:18:18,979 INFO] Step 8700/13600; acc: 9.5; ppl: 36917.3; xent: 10.5; lr: 1.00000; sents:    2369; bsz:  590/ 512/47; 10422/9049 tok/s;     10 sec;
[2024-03-13 10:18:21,522 INFO] Step 8750/13600; acc: 9.3; ppl: 46569.1; xent: 10.7; lr: 1.00000; sents:    2363; bsz:  564/ 491/47; 11079/9661 tok/s;     12 sec;
[2024-03-13 10:18:24,951 INFO] Step 8800/13600; acc: 10.8; ppl: 11518.1; xent: 9.4; lr: 1.00000; sents:    2365; bsz:  563/ 489/47; 8205/7128 tok/s;     16 sec;
[2024-03-13 10:18:28,384 INFO] valid stats calculation
                           took: 3.432157039642334 s.
[2024-03-13 10:18:28,384 INFO] Train perplexity: 78097.9
[2024-03-13 10:18:28,384 INFO] Train accuracy: 9.74
[2024-03-13 10:18:28,384 INFO] Sentences processed: 9367
[2024-03-13 10:18:28,384 INFO] Average bsz:  570/ 496/47
[2024-03-13 10:18:28,384 INFO] Validation perplexity: 688656
[2024-03-13 10:18:28,385 INFO] Validation accuracy: 12.154
[2024-03-13 10:18:28,386 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_8800.pt
[2024-03-13 10:18:32,002 INFO] Step 8850/13600; acc: 9.4; ppl: 18548.2; xent: 9.8; lr: 1.00000; sents:    2246; bsz:  547/ 473/45; 3877/3357 tok/s;     23 sec;
[2024-03-13 10:18:35,030 INFO] Step 8900/13600; acc: 7.5; ppl: 31044.3; xent: 10.3; lr: 1.00000; sents:    2372; bsz:  589/ 511/47; 9731/8437 tok/s;     26 sec;
[2024-03-13 10:18:37,511 INFO] Step 8950/13600; acc: 7.5; ppl: 38666.9; xent: 10.6; lr: 1.00000; sents:    2378; bsz:  586/ 509/48; 11800/10258 tok/s;     28 sec;
[2024-03-13 10:18:41,108 INFO] Step 9000/13600; acc: 8.5; ppl: 11683.0; xent: 9.4; lr: 1.00000; sents:    2280; bsz:  562/ 488/46; 7821/6779 tok/s;     32 sec;
[2024-03-13 10:18:44,610 INFO] valid stats calculation
                           took: 3.5012753009796143 s.
[2024-03-13 10:18:44,610 INFO] Train perplexity: 42237.9
[2024-03-13 10:18:44,610 INFO] Train accuracy: 8.96796
[2024-03-13 10:18:44,610 INFO] Sentences processed: 18643
[2024-03-13 10:18:44,610 INFO] Average bsz:  571/ 495/47
[2024-03-13 10:18:44,610 INFO] Validation perplexity: 5553.33
[2024-03-13 10:18:44,610 INFO] Validation accuracy: 7.30044
[2024-03-13 10:18:44,611 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_9000.pt
[2024-03-13 10:18:48,217 INFO] Step 9050/13600; acc: 8.7; ppl: 15222.8; xent: 9.6; lr: 1.00000; sents:    2381; bsz:  568/ 495/48; 3995/3479 tok/s;     39 sec;
[2024-03-13 10:18:51,333 INFO] Step 9100/13600; acc: 8.1; ppl: 22137.0; xent: 10.0; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 9294/8026 tok/s;     42 sec;
[2024-03-13 10:18:53,762 INFO] Step 9150/13600; acc: 7.2; ppl: 224615.4; xent: 12.3; lr: 1.00000; sents:    2258; bsz:  553/ 479/45; 11381/9857 tok/s;     45 sec;
[2024-03-13 10:18:57,125 INFO] Step 9200/13600; acc: 8.9; ppl: 9188.4; xent: 9.1; lr: 1.00000; sents:    2366; bsz:  562/ 489/47; 8360/7274 tok/s;     48 sec;
[2024-03-13 10:19:00,559 INFO] valid stats calculation
                           took: 3.433509349822998 s.
[2024-03-13 10:19:00,559 INFO] Train perplexity: 37064.9
[2024-03-13 10:19:00,559 INFO] Train accuracy: 8.72008
[2024-03-13 10:19:00,559 INFO] Sentences processed: 28023
[2024-03-13 10:19:00,559 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:19:00,559 INFO] Validation perplexity: 25315.3
[2024-03-13 10:19:00,559 INFO] Validation accuracy: 10.9105
[2024-03-13 10:19:00,560 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_9200.pt
[2024-03-13 10:19:04,178 INFO] Step 9250/13600; acc: 8.1; ppl: 56812.2; xent: 10.9; lr: 1.00000; sents:    2367; bsz:  567/ 499/47; 4021/3537 tok/s;     55 sec;
[2024-03-13 10:19:07,639 INFO] Step 9300/13600; acc: 6.9; ppl: 24680.8; xent: 10.1; lr: 1.00000; sents:    2268; bsz:  587/ 505/45; 8478/7292 tok/s;     58 sec;
[2024-03-13 10:19:10,003 INFO] Step 9350/13600; acc: 8.7; ppl: 13924.8; xent: 9.5; lr: 1.00000; sents:    2367; bsz:  567/ 499/47; 12000/10547 tok/s;     61 sec;
[2024-03-13 10:19:12,517 INFO] Step 9400/13600; acc: 9.5; ppl: 7210.5; xent: 8.9; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 11387/9869 tok/s;     63 sec;
[2024-03-13 10:19:16,127 INFO] valid stats calculation
                           took: 3.609079360961914 s.
[2024-03-13 10:19:16,127 INFO] Train perplexity: 31486.1
[2024-03-13 10:19:16,127 INFO] Train accuracy: 8.60913
[2024-03-13 10:19:16,127 INFO] Sentences processed: 37390
[2024-03-13 10:19:16,127 INFO] Average bsz:  570/ 495/47
[2024-03-13 10:19:16,127 INFO] Validation perplexity: 6020.48
[2024-03-13 10:19:16,128 INFO] Validation accuracy: 11.1111
[2024-03-13 10:19:16,129 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_9400.pt
[2024-03-13 10:19:18,596 INFO] Step 9450/13600; acc: 10.1; ppl: 93805.4; xent: 11.4; lr: 1.00000; sents:    2269; bsz:  545/ 472/45; 4482/3883 tok/s;     69 sec;
[2024-03-13 10:19:22,026 INFO] Step 9500/13600; acc: 9.0; ppl: 6721.5; xent: 8.8; lr: 1.00000; sents:    2371; bsz:  576/ 500/47; 8389/7294 tok/s;     73 sec;
[2024-03-13 10:19:25,629 INFO] Step 9550/13600; acc: 9.6; ppl: 12285.2; xent: 9.4; lr: 1.00000; sents:    2279; bsz:  563/ 487/46; 7811/6753 tok/s;     76 sec;
[2024-03-13 10:19:29,269 INFO] Step 9600/13600; acc: 9.5; ppl: 8524.3; xent: 9.1; lr: 1.00000; sents:    2381; bsz:  582/ 506/48; 7994/6953 tok/s;     80 sec;
[2024-03-13 10:19:32,893 INFO] valid stats calculation
                           took: 3.623710870742798 s.
[2024-03-13 10:19:32,893 INFO] Train perplexity: 27394.8
[2024-03-13 10:19:32,894 INFO] Train accuracy: 8.79155
[2024-03-13 10:19:32,894 INFO] Sentences processed: 46690
[2024-03-13 10:19:32,894 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:19:32,894 INFO] Validation perplexity: 66099.1
[2024-03-13 10:19:32,894 INFO] Validation accuracy: 10.9908
[2024-03-13 10:19:32,895 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_9600.pt
[2024-03-13 10:19:35,389 INFO] Step 9650/13600; acc: 10.4; ppl: 7202.0; xent: 8.9; lr: 1.00000; sents:    2376; bsz:  564/ 493/48; 4611/4028 tok/s;     86 sec;
[2024-03-13 10:19:38,653 INFO] Step 9700/13600; acc: 8.3; ppl: 6773.9; xent: 8.8; lr: 1.00000; sents:    2375; bsz:  565/ 490/48; 8661/7514 tok/s;     90 sec;
[2024-03-13 10:19:42,171 INFO] Step 9750/13600; acc: 9.1; ppl: 7020.8; xent: 8.9; lr: 1.00000; sents:    2271; bsz:  560/ 481/45; 7964/6844 tok/s;     93 sec;
[2024-03-13 10:19:45,835 INFO] Step 9800/13600; acc: 9.2; ppl: 5248.7; xent: 8.6; lr: 1.00000; sents:    2366; bsz:  577/ 501/47; 7878/6838 tok/s;     97 sec;
[2024-03-13 10:19:49,270 INFO] valid stats calculation
                           took: 3.4344093799591064 s.
[2024-03-13 10:19:49,270 INFO] Train perplexity: 21582.2
[2024-03-13 10:19:49,270 INFO] Train accuracy: 8.8653
[2024-03-13 10:19:49,270 INFO] Sentences processed: 56078
[2024-03-13 10:19:49,270 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:19:49,270 INFO] Validation perplexity: 18906.7
[2024-03-13 10:19:49,270 INFO] Validation accuracy: 11.9936
[2024-03-13 10:19:49,272 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_9800.pt
[2024-03-13 10:19:51,689 INFO] Step 9850/13600; acc: 9.6; ppl: 4401.3; xent: 8.4; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 4819/4190 tok/s;    103 sec;
[2024-03-13 10:19:54,660 INFO] Step 9900/13600; acc: 10.3; ppl: 3628.3; xent: 8.2; lr: 1.00000; sents:    2364; bsz:  584/ 506/47; 9828/8510 tok/s;    106 sec;
[2024-03-13 10:19:58,226 INFO] Step 9950/13600; acc: 9.4; ppl: 8354.1; xent: 9.0; lr: 1.00000; sents:    2269; bsz:  564/ 488/45; 7907/6842 tok/s;    109 sec;
[2024-03-13 10:20:01,704 INFO] Step 10000/13600; acc: 9.2; ppl: 12865.9; xent: 9.5; lr: 1.00000; sents:    2367; bsz:  579/ 500/47; 8333/7189 tok/s;    113 sec;
[2024-03-13 10:20:05,160 INFO] valid stats calculation
                           took: 3.4555234909057617 s.
[2024-03-13 10:20:05,160 INFO] Train perplexity: 18141.9
[2024-03-13 10:20:05,160 INFO] Train accuracy: 8.9749
[2024-03-13 10:20:05,160 INFO] Sentences processed: 65444
[2024-03-13 10:20:05,160 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:20:05,160 INFO] Validation perplexity: 1.90645e+06
[2024-03-13 10:20:05,160 INFO] Validation accuracy: 11.5523
[2024-03-13 10:20:05,161 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_10000.pt
[2024-03-13 10:20:07,875 INFO] Step 10050/13600; acc: 10.2; ppl: 9266.1; xent: 9.1; lr: 1.00000; sents:    2372; bsz:  564/ 489/47; 4571/3964 tok/s;    119 sec;
[2024-03-13 10:20:10,798 INFO] Step 10100/13600; acc: 10.0; ppl: 8328.6; xent: 9.0; lr: 1.00000; sents:    2271; bsz:  562/ 485/45; 9613/8296 tok/s;    122 sec;
[2024-03-13 10:20:14,555 INFO] Step 10150/13600; acc: 11.9; ppl: 1833.7; xent: 7.5; lr: 1.00000; sents:    2273; bsz:  560/ 486/45; 7451/6470 tok/s;    125 sec;
[2024-03-13 10:20:18,222 INFO] Step 10200/13600; acc: 10.8; ppl: 5592.9; xent: 8.6; lr: 1.00000; sents:    2484; bsz:  588/ 510/50; 8023/6961 tok/s;    129 sec;
[2024-03-13 10:20:21,672 INFO] valid stats calculation
                           took: 3.4499149322509766 s.
[2024-03-13 10:20:21,673 INFO] Train perplexity: 15566.1
[2024-03-13 10:20:21,673 INFO] Train accuracy: 9.19609
[2024-03-13 10:20:21,673 INFO] Sentences processed: 74844
[2024-03-13 10:20:21,673 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:20:21,673 INFO] Validation perplexity: 1420.84
[2024-03-13 10:20:21,673 INFO] Validation accuracy: 14.7212
[2024-03-13 10:20:21,674 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_10200.pt
[2024-03-13 10:20:24,575 INFO] Step 10250/13600; acc: 11.9; ppl: 1837.6; xent: 7.5; lr: 1.00000; sents:    2274; bsz:  557/ 483/45; 4387/3804 tok/s;    135 sec;
[2024-03-13 10:20:27,169 INFO] Step 10300/13600; acc: 9.0; ppl: 4877.2; xent: 8.5; lr: 1.00000; sents:    2376; bsz:  568/ 496/48; 10958/9562 tok/s;    138 sec;
[2024-03-13 10:20:30,863 INFO] Step 10350/13600; acc: 8.0; ppl: 17908.2; xent: 9.8; lr: 1.00000; sents:    2368; bsz:  589/ 512/47; 7976/6935 tok/s;    142 sec;
[2024-03-13 10:20:34,453 INFO] Step 10400/13600; acc: 10.5; ppl: 38110.0; xent: 10.5; lr: 1.00000; sents:    2270; bsz:  563/ 487/45; 7840/6785 tok/s;    145 sec;
[2024-03-13 10:20:37,878 INFO] valid stats calculation
                           took: 3.4249155521392822 s.
[2024-03-13 10:20:37,879 INFO] Train perplexity: 14632.5
[2024-03-13 10:20:37,879 INFO] Train accuracy: 9.26664
[2024-03-13 10:20:37,879 INFO] Sentences processed: 84132
[2024-03-13 10:20:37,879 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:20:37,879 INFO] Validation perplexity: 6000.97
[2024-03-13 10:20:37,879 INFO] Validation accuracy: 10.1083
[2024-03-13 10:20:37,880 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_10400.pt
[2024-03-13 10:20:40,905 INFO] Step 10450/13600; acc: 8.0; ppl: 9125.6; xent: 9.1; lr: 1.00000; sents:    2248; bsz:  550/ 476/45; 4262/3687 tok/s;    152 sec;
[2024-03-13 10:20:43,272 INFO] Step 10500/13600; acc: 6.5; ppl: 36616.6; xent: 10.5; lr: 1.00000; sents:    2484; bsz:  602/ 524/50; 12715/11066 tok/s;    154 sec;
[2024-03-13 10:20:46,677 INFO] Step 10550/13600; acc: 9.0; ppl: 22776.7; xent: 10.0; lr: 1.00000; sents:    2244; bsz:  547/ 474/45; 8035/6959 tok/s;    158 sec;
[2024-03-13 10:20:50,270 INFO] Step 10600/13600; acc: 10.4; ppl: 4679.8; xent: 8.5; lr: 1.00000; sents:    2367; bsz:  579/ 502/47; 8060/6982 tok/s;    161 sec;
[2024-03-13 10:20:53,722 INFO] valid stats calculation
                           took: 3.4514124393463135 s.
[2024-03-13 10:20:53,722 INFO] Train perplexity: 14553.8
[2024-03-13 10:20:53,723 INFO] Train accuracy: 9.1864
[2024-03-13 10:20:53,723 INFO] Sentences processed: 93475
[2024-03-13 10:20:53,723 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:20:53,723 INFO] Validation perplexity: 2451.18
[2024-03-13 10:20:53,723 INFO] Validation accuracy: 12.3947
[2024-03-13 10:20:53,724 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_10600.pt
[2024-03-13 10:20:57,174 INFO] Step 10650/13600; acc: 8.0; ppl: 9207.7; xent: 9.1; lr: 1.00000; sents:    2268; bsz:  558/ 484/45; 4041/3503 tok/s;    168 sec;
[2024-03-13 10:20:59,599 INFO] Step 10700/13600; acc: 7.8; ppl: 4622.2; xent: 8.4; lr: 1.00000; sents:    2379; bsz:  568/ 494/48; 11712/10198 tok/s;    170 sec;
[2024-03-13 10:21:02,937 INFO] Step 10750/13600; acc: 7.8; ppl: 14735.6; xent: 9.6; lr: 1.00000; sents:    2383; bsz:  583/ 507/48; 8734/7591 tok/s;    174 sec;
[2024-03-13 10:21:06,394 INFO] Step 10800/13600; acc: 7.2; ppl: 9202.5; xent: 9.1; lr: 1.00000; sents:    2267; bsz:  539/ 469/45; 7798/6778 tok/s;    177 sec;
[2024-03-13 10:21:09,820 INFO] valid stats calculation
                           took: 3.4252071380615234 s.
[2024-03-13 10:21:09,820 INFO] Train perplexity: 13900.7
[2024-03-13 10:21:09,820 INFO] Train accuracy: 9.05138
[2024-03-13 10:21:09,820 INFO] Sentences processed: 102772
[2024-03-13 10:21:09,820 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:21:09,820 INFO] Validation perplexity: 3206.37
[2024-03-13 10:21:09,820 INFO] Validation accuracy: 6.05696
[2024-03-13 10:21:09,821 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_10800.pt
[2024-03-13 10:21:13,473 INFO] Step 10850/13600; acc: 8.6; ppl: 4547.9; xent: 8.4; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 4086/3530 tok/s;    184 sec;
[2024-03-13 10:21:15,923 INFO] Step 10900/13600; acc: 7.4; ppl: 34954.3; xent: 10.5; lr: 1.00000; sents:    2372; bsz:  566/ 496/47; 11563/10131 tok/s;    187 sec;
[2024-03-13 10:21:19,081 INFO] Step 10950/13600; acc: 8.4; ppl: 59733.6; xent: 11.0; lr: 1.00000; sents:    2270; bsz:  567/ 493/45; 8984/7802 tok/s;    190 sec;
[2024-03-13 10:21:22,686 INFO] Step 11000/13600; acc: 7.3; ppl: 16244.0; xent: 9.7; lr: 1.00000; sents:    2367; bsz:  588/ 515/47; 8151/7137 tok/s;    194 sec;
[2024-03-13 10:21:26,135 INFO] valid stats calculation
                           took: 3.4478657245635986 s.
[2024-03-13 10:21:26,135 INFO] Train perplexity: 14315.7
[2024-03-13 10:21:26,135 INFO] Train accuracy: 8.95458
[2024-03-13 10:21:26,135 INFO] Sentences processed: 112156
[2024-03-13 10:21:26,135 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:21:26,135 INFO] Validation perplexity: 5146.11
[2024-03-13 10:21:26,135 INFO] Validation accuracy: 9.22583
[2024-03-13 10:21:26,137 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_11000.pt
[2024-03-13 10:21:29,997 INFO] Step 11050/13600; acc: 9.3; ppl: 14966.8; xent: 9.6; lr: 1.00000; sents:    2364; bsz:  573/ 494/47; 3919/3378 tok/s;    201 sec;
[2024-03-13 10:21:32,559 INFO] Step 11100/13600; acc: 10.8; ppl: 1601.6; xent: 7.4; lr: 1.00000; sents:    2263; bsz:  542/ 471/45; 10574/9203 tok/s;    203 sec;
[2024-03-13 10:21:35,281 INFO] Step 11150/13600; acc: 11.7; ppl: 4421.1; xent: 8.4; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 10527/9113 tok/s;    206 sec;
[2024-03-13 10:21:38,973 INFO] Step 11200/13600; acc: 11.0; ppl: 2019.6; xent: 7.6; lr: 1.00000; sents:    2373; bsz:  582/ 507/47; 7880/6866 tok/s;    210 sec;
[2024-03-13 10:21:42,428 INFO] valid stats calculation
                           took: 3.4547572135925293 s.
[2024-03-13 10:21:42,428 INFO] Train perplexity: 12944.6
[2024-03-13 10:21:42,428 INFO] Train accuracy: 9.08701
[2024-03-13 10:21:42,428 INFO] Sentences processed: 121521
[2024-03-13 10:21:42,428 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:21:42,428 INFO] Validation perplexity: 1637.45
[2024-03-13 10:21:42,428 INFO] Validation accuracy: 15.2828
[2024-03-13 10:21:42,430 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_11200.pt
[2024-03-13 10:21:46,157 INFO] Step 11250/13600; acc: 12.0; ppl: 4664.8; xent: 8.4; lr: 1.00000; sents:    2275; bsz:  562/ 486/46; 3914/3379 tok/s;    217 sec;
[2024-03-13 10:21:48,992 INFO] Step 11300/13600; acc: 10.7; ppl: 3334.6; xent: 8.1; lr: 1.00000; sents:    2375; bsz:  565/ 494/48; 9968/8723 tok/s;    220 sec;
[2024-03-13 10:21:51,564 INFO] Step 11350/13600; acc: 9.5; ppl: 3661.9; xent: 8.2; lr: 1.00000; sents:    2381; bsz:  566/ 491/48; 11006/9548 tok/s;    222 sec;
[2024-03-13 10:21:55,102 INFO] Step 11400/13600; acc: 10.6; ppl: 4007.2; xent: 8.3; lr: 1.00000; sents:    2376; bsz:  578/ 498/48; 8170/7042 tok/s;    226 sec;
[2024-03-13 10:21:58,550 INFO] valid stats calculation
                           took: 3.4477741718292236 s.
[2024-03-13 10:21:58,550 INFO] Train perplexity: 11881.4
[2024-03-13 10:21:58,551 INFO] Train accuracy: 9.2012
[2024-03-13 10:21:58,551 INFO] Sentences processed: 130928
[2024-03-13 10:21:58,551 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:21:58,551 INFO] Validation perplexity: 112266
[2024-03-13 10:21:58,551 INFO] Validation accuracy: 8.7846
[2024-03-13 10:21:58,552 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_11400.pt
[2024-03-13 10:22:02,277 INFO] Step 11450/13600; acc: 9.5; ppl: 4416.6; xent: 8.4; lr: 1.00000; sents:    2275; bsz:  562/ 485/46; 3918/3382 tok/s;    233 sec;
[2024-03-13 10:22:05,270 INFO] Step 11500/13600; acc: 10.2; ppl: 2423.5; xent: 7.8; lr: 1.00000; sents:    2273; bsz:  565/ 489/45; 9442/8170 tok/s;    236 sec;
[2024-03-13 10:22:07,759 INFO] Step 11550/13600; acc: 9.7; ppl: 3030.2; xent: 8.0; lr: 1.00000; sents:    2366; bsz:  583/ 506/47; 11726/10174 tok/s;    239 sec;
[2024-03-13 10:22:11,202 INFO] Step 11600/13600; acc: 11.4; ppl: 5280.8; xent: 8.6; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 8197/7123 tok/s;    242 sec;
[2024-03-13 10:22:14,621 INFO] valid stats calculation
                           took: 3.418632745742798 s.
[2024-03-13 10:22:14,621 INFO] Train perplexity: 10976.5
[2024-03-13 10:22:14,621 INFO] Train accuracy: 9.26964
[2024-03-13 10:22:14,621 INFO] Sentences processed: 140208
[2024-03-13 10:22:14,621 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:22:14,621 INFO] Validation perplexity: 14778.1
[2024-03-13 10:22:14,621 INFO] Validation accuracy: 5.5355
[2024-03-13 10:22:14,622 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_11600.pt
[2024-03-13 10:22:18,267 INFO] Step 11650/13600; acc: 10.0; ppl: 4214.2; xent: 8.3; lr: 1.00000; sents:    2362; bsz:  579/ 499/47; 4095/3531 tok/s;    249 sec;
[2024-03-13 10:22:21,437 INFO] Step 11700/13600; acc: 11.0; ppl: 21612.6; xent: 10.0; lr: 1.00000; sents:    2267; bsz:  544/ 472/45; 8582/7449 tok/s;    252 sec;
[2024-03-13 10:22:23,791 INFO] Step 11750/13600; acc: 10.2; ppl: 3698.5; xent: 8.2; lr: 1.00000; sents:    2369; bsz:  580/ 501/47; 12330/10638 tok/s;    255 sec;
[2024-03-13 10:22:27,151 INFO] Step 11800/13600; acc: 9.5; ppl: 3416.6; xent: 8.1; lr: 1.00000; sents:    2372; bsz:  583/ 504/47; 8675/7506 tok/s;    258 sec;
[2024-03-13 10:22:30,601 INFO] valid stats calculation
                           took: 3.4497201442718506 s.
[2024-03-13 10:22:30,601 INFO] Train perplexity: 10537.2
[2024-03-13 10:22:30,601 INFO] Train accuracy: 9.32524
[2024-03-13 10:22:30,601 INFO] Sentences processed: 149578
[2024-03-13 10:22:30,601 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:22:30,601 INFO] Validation perplexity: 58952.9
[2024-03-13 10:22:30,601 INFO] Validation accuracy: 12.9964
[2024-03-13 10:22:30,602 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_11800.pt
[2024-03-13 10:22:34,268 INFO] Step 11850/13600; acc: 10.5; ppl: 2889.5; xent: 8.0; lr: 1.00000; sents:    2269; bsz:  542/ 474/45; 3808/3328 tok/s;    265 sec;
[2024-03-13 10:22:37,732 INFO] Step 11900/13600; acc: 11.4; ppl: 2445.5; xent: 7.8; lr: 1.00000; sents:    2375; bsz:  582/ 503/48; 8401/7268 tok/s;    269 sec;
[2024-03-13 10:22:40,117 INFO] Step 11950/13600; acc: 12.3; ppl: 1252.6; xent: 7.1; lr: 1.00000; sents:    2382; bsz:  568/ 496/48; 11915/10408 tok/s;    271 sec;
[2024-03-13 10:22:43,400 INFO] Step 12000/13600; acc: 12.9; ppl: 1425.0; xent: 7.3; lr: 1.00000; sents:    2376; bsz:  590/ 511/48; 8985/7786 tok/s;    274 sec;
[2024-03-13 10:22:46,813 INFO] valid stats calculation
                           took: 3.412180185317993 s.
[2024-03-13 10:22:46,813 INFO] Train perplexity: 9514.81
[2024-03-13 10:22:46,813 INFO] Train accuracy: 9.47198
[2024-03-13 10:22:46,813 INFO] Sentences processed: 158980
[2024-03-13 10:22:46,813 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:22:46,813 INFO] Validation perplexity: 1293.24
[2024-03-13 10:22:46,813 INFO] Validation accuracy: 10.1083
[2024-03-13 10:22:46,814 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_12000.pt
[2024-03-13 10:22:50,531 INFO] Step 12050/13600; acc: 9.7; ppl: 2652.8; xent: 7.9; lr: 1.00000; sents:    2280; bsz:  565/ 490/46; 3962/3438 tok/s;    281 sec;
[2024-03-13 10:22:54,138 INFO] Step 12100/13600; acc: 13.1; ppl: 3041.4; xent: 8.0; lr: 1.00000; sents:    2368; bsz:  565/ 491/47; 7831/6807 tok/s;    285 sec;
[2024-03-13 10:22:56,568 INFO] Step 12150/13600; acc: 10.8; ppl: 6240.6; xent: 8.7; lr: 1.00000; sents:    2246; bsz:  570/ 491/45; 11734/10107 tok/s;    287 sec;
[2024-03-13 10:22:59,497 INFO] Step 12200/13600; acc: 8.0; ppl: 8786.9; xent: 9.1; lr: 1.00000; sents:    2368; bsz:  567/ 493/47; 9675/8419 tok/s;    290 sec;
[2024-03-13 10:23:02,938 INFO] valid stats calculation
                           took: 3.440427780151367 s.
[2024-03-13 10:23:02,939 INFO] Train perplexity: 9139.07
[2024-03-13 10:23:02,939 INFO] Train accuracy: 9.5222
[2024-03-13 10:23:02,939 INFO] Sentences processed: 168242
[2024-03-13 10:23:02,939 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:23:02,939 INFO] Validation perplexity: 2403.23
[2024-03-13 10:23:02,939 INFO] Validation accuracy: 12.515
[2024-03-13 10:23:02,940 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_12200.pt
[2024-03-13 10:23:06,554 INFO] Step 12250/13600; acc: 9.6; ppl: 6705.4; xent: 8.8; lr: 1.00000; sents:    2363; bsz:  576/ 498/47; 4085/3528 tok/s;    297 sec;
[2024-03-13 10:23:10,091 INFO] Step 12300/13600; acc: 10.2; ppl: 4217.7; xent: 8.3; lr: 1.00000; sents:    2365; bsz:  562/ 490/47; 7951/6927 tok/s;    301 sec;
[2024-03-13 10:23:12,735 INFO] Step 12350/13600; acc: 8.3; ppl: 4983.7; xent: 8.5; lr: 1.00000; sents:    2258; bsz:  555/ 482/45; 10504/9110 tok/s;    304 sec;
[2024-03-13 10:23:15,621 INFO] Step 12400/13600; acc: 10.3; ppl: 2733.1; xent: 7.9; lr: 1.00000; sents:    2377; bsz:  587/ 513/48; 10171/8894 tok/s;    306 sec;
[2024-03-13 10:23:19,084 INFO] valid stats calculation
                           took: 3.463013172149658 s.
[2024-03-13 10:23:19,085 INFO] Train perplexity: 8794.04
[2024-03-13 10:23:19,085 INFO] Train accuracy: 9.52805
[2024-03-13 10:23:19,085 INFO] Sentences processed: 177605
[2024-03-13 10:23:19,085 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:23:19,085 INFO] Validation perplexity: 2371.48
[2024-03-13 10:23:19,085 INFO] Validation accuracy: 13.5178
[2024-03-13 10:23:19,086 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_12400.pt
[2024-03-13 10:23:22,776 INFO] Step 12450/13600; acc: 9.6; ppl: 3082.4; xent: 8.0; lr: 1.00000; sents:    2379; bsz:  565/ 493/48; 3949/3448 tok/s;    314 sec;
[2024-03-13 10:23:26,382 INFO] Step 12500/13600; acc: 10.5; ppl: 13533.0; xent: 9.5; lr: 1.00000; sents:    2274; bsz:  555/ 478/45; 7702/6635 tok/s;    317 sec;
[2024-03-13 10:23:29,291 INFO] Step 12550/13600; acc: 10.8; ppl: 1814.8; xent: 7.5; lr: 1.00000; sents:    2277; bsz:  566/ 489/46; 9725/8407 tok/s;    320 sec;
[2024-03-13 10:23:31,793 INFO] Step 12600/13600; acc: 10.8; ppl: 2436.3; xent: 7.8; lr: 1.00000; sents:    2377; bsz:  565/ 493/48; 11301/9857 tok/s;    323 sec;
[2024-03-13 10:23:35,224 INFO] valid stats calculation
                           took: 3.430837631225586 s.
[2024-03-13 10:23:35,225 INFO] Train perplexity: 8420.17
[2024-03-13 10:23:35,225 INFO] Train accuracy: 9.57258
[2024-03-13 10:23:35,225 INFO] Sentences processed: 186912
[2024-03-13 10:23:35,225 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:23:35,225 INFO] Validation perplexity: 13297.3
[2024-03-13 10:23:35,225 INFO] Validation accuracy: 11.8331
[2024-03-13 10:23:35,226 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_12600.pt
[2024-03-13 10:23:39,012 INFO] Step 12650/13600; acc: 10.1; ppl: 1677.0; xent: 7.4; lr: 1.00000; sents:    2372; bsz:  587/ 515/47; 4068/3568 tok/s;    330 sec;
[2024-03-13 10:23:42,606 INFO] Step 12700/13600; acc: 10.7; ppl: 9269.6; xent: 9.1; lr: 1.00000; sents:    2367; bsz:  578/ 498/47; 8036/6927 tok/s;    333 sec;
[2024-03-13 10:23:45,690 INFO] Step 12750/13600; acc: 10.8; ppl: 4842.1; xent: 8.5; lr: 1.00000; sents:    2263; bsz:  556/ 481/45; 9017/7796 tok/s;    337 sec;
[2024-03-13 10:23:47,981 INFO] Step 12800/13600; acc: 11.4; ppl: 1710.1; xent: 7.4; lr: 1.00000; sents:    2364; bsz:  558/ 487/47; 12181/10622 tok/s;    339 sec;
[2024-03-13 10:23:51,453 INFO] valid stats calculation
                           took: 3.471820116043091 s.
[2024-03-13 10:23:51,454 INFO] Train perplexity: 8057.64
[2024-03-13 10:23:51,454 INFO] Train accuracy: 9.62755
[2024-03-13 10:23:51,454 INFO] Sentences processed: 196278
[2024-03-13 10:23:51,454 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:23:51,454 INFO] Validation perplexity: 8925.14
[2024-03-13 10:23:51,454 INFO] Validation accuracy: 11.6727
[2024-03-13 10:23:51,455 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_12800.pt
[2024-03-13 10:23:55,190 INFO] Step 12850/13600; acc: 9.4; ppl: 2835.0; xent: 7.9; lr: 1.00000; sents:    2367; bsz:  578/ 503/47; 4010/3490 tok/s;    346 sec;
[2024-03-13 10:23:58,744 INFO] Step 12900/13600; acc: 8.0; ppl: 4498.9; xent: 8.4; lr: 1.00000; sents:    2268; bsz:  561/ 485/45; 7893/6820 tok/s;    350 sec;
[2024-03-13 10:24:02,155 INFO] Step 12950/13600; acc: 10.0; ppl: 3172.4; xent: 8.1; lr: 1.00000; sents:    2373; bsz:  566/ 495/47; 8298/7258 tok/s;    353 sec;
[2024-03-13 10:24:04,514 INFO] Step 13000/13600; acc: 7.4; ppl: 11402.3; xent: 9.3; lr: 1.00000; sents:    2372; bsz:  565/ 491/47; 11985/10408 tok/s;    355 sec;
[2024-03-13 10:24:08,038 INFO] valid stats calculation
                           took: 3.523620367050171 s.
[2024-03-13 10:24:08,038 INFO] Train perplexity: 7856.37
[2024-03-13 10:24:08,038 INFO] Train accuracy: 9.5864
[2024-03-13 10:24:08,038 INFO] Sentences processed: 205658
[2024-03-13 10:24:08,038 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:24:08,039 INFO] Validation perplexity: 13520.7
[2024-03-13 10:24:08,039 INFO] Validation accuracy: 9.14561
[2024-03-13 10:24:08,040 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_13000.pt
[2024-03-13 10:24:11,829 INFO] Step 13050/13600; acc: 9.6; ppl: 3918.2; xent: 8.3; lr: 1.00000; sents:    2274; bsz:  578/ 496/45; 3951/3391 tok/s;    363 sec;
[2024-03-13 10:24:15,279 INFO] Step 13100/13600; acc: 11.0; ppl: 3496.9; xent: 8.2; lr: 1.00000; sents:    2382; bsz:  561/ 487/48; 8131/7065 tok/s;    366 sec;
[2024-03-13 10:24:18,782 INFO] Step 13150/13600; acc: 9.4; ppl: 4180.0; xent: 8.3; lr: 1.00000; sents:    2376; bsz:  589/ 509/48; 8402/7267 tok/s;    370 sec;
[2024-03-13 10:24:21,273 INFO] Step 13200/13600; acc: 10.9; ppl: 1657.4; xent: 7.4; lr: 1.00000; sents:    2277; bsz:  564/ 488/46; 11327/9803 tok/s;    372 sec;
[2024-03-13 10:24:24,803 INFO] valid stats calculation
                           took: 3.530198574066162 s.
[2024-03-13 10:24:24,804 INFO] Train perplexity: 7547.72
[2024-03-13 10:24:24,804 INFO] Train accuracy: 9.61321
[2024-03-13 10:24:24,804 INFO] Sentences processed: 214967
[2024-03-13 10:24:24,804 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:24:24,804 INFO] Validation perplexity: 1264.29
[2024-03-13 10:24:24,804 INFO] Validation accuracy: 14.9619
[2024-03-13 10:24:24,805 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_13200.pt
[2024-03-13 10:24:28,432 INFO] Step 13250/13600; acc: 11.0; ppl: 2449.1; xent: 7.8; lr: 1.00000; sents:    2371; bsz:  565/ 491/47; 3948/3429 tok/s;    379 sec;
[2024-03-13 10:24:32,012 INFO] Step 13300/13600; acc: 9.1; ppl: 7644.3; xent: 8.9; lr: 1.00000; sents:    2260; bsz:  558/ 482/45; 7790/6727 tok/s;    383 sec;
[2024-03-13 10:24:35,451 INFO] Step 13350/13600; acc: 8.3; ppl: 4950.8; xent: 8.5; lr: 1.00000; sents:    2472; bsz:  584/ 507/49; 8497/7373 tok/s;    386 sec;
[2024-03-13 10:24:37,951 INFO] Step 13400/13600; acc: 6.7; ppl: 12080.3; xent: 9.4; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 11200/9658 tok/s;    389 sec;
[2024-03-13 10:24:41,452 INFO] valid stats calculation
                           took: 3.5002341270446777 s.
[2024-03-13 10:24:41,452 INFO] Train perplexity: 7463.27
[2024-03-13 10:24:41,452 INFO] Train accuracy: 9.57774
[2024-03-13 10:24:41,452 INFO] Sentences processed: 224332
[2024-03-13 10:24:41,452 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:24:41,452 INFO] Validation perplexity: 4099.87
[2024-03-13 10:24:41,452 INFO] Validation accuracy: 9.38628
[2024-03-13 10:24:41,454 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_13400.pt
[2024-03-13 10:24:45,079 INFO] Step 13450/13600; acc: 7.5; ppl: 25901.3; xent: 10.2; lr: 1.00000; sents:    2367; bsz:  566/ 494/47; 3970/3468 tok/s;    396 sec;
[2024-03-13 10:24:48,647 INFO] Step 13500/13600; acc: 7.0; ppl: 19318.5; xent: 9.9; lr: 1.00000; sents:    2267; bsz:  576/ 495/45; 8076/6942 tok/s;    399 sec;
[2024-03-13 10:24:52,238 INFO] Step 13550/13600; acc: 7.2; ppl: 17600.2; xent: 9.8; lr: 1.00000; sents:    2372; bsz:  564/ 492/47; 7851/6857 tok/s;    403 sec;
[2024-03-13 10:24:54,951 INFO] Step 13600/13600; acc: 8.6; ppl: 2809.7; xent: 7.9; lr: 1.00000; sents:    2257; bsz:  556/ 481/45; 10254/8867 tok/s;    406 sec;
[2024-03-13 10:24:58,455 INFO] valid stats calculation
                           took: 3.5028555393218994 s.
[2024-03-13 10:24:58,455 INFO] Train perplexity: 7622
[2024-03-13 10:24:58,455 INFO] Train accuracy: 9.49873
[2024-03-13 10:24:58,455 INFO] Sentences processed: 233595
[2024-03-13 10:24:58,455 INFO] Average bsz:  569/ 494/47
[2024-03-13 10:24:58,455 INFO] Validation perplexity: 2519.32
[2024-03-13 10:24:58,455 INFO] Validation accuracy: 13.3173
[2024-03-13 10:24:58,456 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_13600.pt
[2024-03-13 11:21:04,122 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-13 11:21:04,122 INFO] Parsed 2 corpora from -data.
[2024-03-13 11:21:04,122 INFO] Loading checkpoint from tg-pt-both/models/tg-pt-both_03_step_8600.pt
[2024-03-13 11:21:04,194 INFO] Building model...
[2024-03-13 11:21:04,250 INFO] Switching model to float32 for amp/apex_amp
[2024-03-13 11:21:04,250 INFO] Non quantized layer compute is fp32
[2024-03-13 11:21:06,059 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-13 11:21:06,060 INFO] encoder: 8952800
[2024-03-13 11:21:06,060 INFO] decoder: 16687344
[2024-03-13 11:21:06,060 INFO] * number of parameters: 25640144
[2024-03-13 11:21:06,060 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 11:21:06,060 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-13 11:21:06,060 INFO]  * src vocab size = 17816
[2024-03-13 11:21:06,060 INFO]  * tgt vocab size = 14144
[2024-03-13 11:21:06,061 INFO] Starting training on GPU: [0]
[2024-03-13 11:21:06,062 INFO] Start training loop and validate every 200 steps...
[2024-03-13 11:21:06,062 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-13 11:21:11,899 INFO] Step 8650/13600; acc: 10.2; ppl: 2081354.2; xent: 14.5; lr: 1.00000; sents:    2366; bsz:  591/ 513/47; 5059/4394 tok/s;      6 sec;
[2024-03-13 11:21:14,202 INFO] Step 8700/13600; acc: 8.8; ppl: 43403.6; xent: 10.7; lr: 1.00000; sents:    2273; bsz:  543/ 473/45; 11793/10264 tok/s;      8 sec;
[2024-03-13 11:21:16,492 INFO] Step 8750/13600; acc: 9.5; ppl: 62691.1; xent: 11.0; lr: 1.00000; sents:    2363; bsz:  585/ 508/47; 12777/11090 tok/s;     10 sec;
[2024-03-13 11:21:18,723 INFO] Step 8800/13600; acc: 10.7; ppl: 18013.3; xent: 9.8; lr: 1.00000; sents:    2365; bsz:  563/ 489/47; 12615/10958 tok/s;     13 sec;
[2024-03-13 11:21:22,059 INFO] valid stats calculation
                           took: 3.335684061050415 s.
[2024-03-13 11:21:22,059 INFO] Train perplexity: 104520
[2024-03-13 11:21:22,059 INFO] Train accuracy: 9.79751
[2024-03-13 11:21:22,059 INFO] Sentences processed: 9367
[2024-03-13 11:21:22,059 INFO] Average bsz:  570/ 496/47
[2024-03-13 11:21:22,059 INFO] Validation perplexity: 29526.8
[2024-03-13 11:21:22,060 INFO] Validation accuracy: 10.8303
[2024-03-13 11:21:22,061 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_8800.pt
[2024-03-13 11:21:24,502 INFO] Step 8850/13600; acc: 8.6; ppl: 21361.1; xent: 10.0; lr: 1.00000; sents:    2367; bsz:  587/ 509/47; 5077/4408 tok/s;     18 sec;
[2024-03-13 11:21:26,860 INFO] Step 8900/13600; acc: 11.1; ppl: 5539.7; xent: 8.6; lr: 1.00000; sents:    2251; bsz:  549/ 475/45; 11647/10072 tok/s;     21 sec;
[2024-03-13 11:21:29,255 INFO] Step 8950/13600; acc: 9.5; ppl: 6895.1; xent: 8.8; lr: 1.00000; sents:    2275; bsz:  561/ 487/46; 11715/10163 tok/s;     23 sec;
[2024-03-13 11:21:31,563 INFO] Step 9000/13600; acc: 9.2; ppl: 25386.2; xent: 10.1; lr: 1.00000; sents:    2487; bsz:  594/ 518/50; 12860/11214 tok/s;     26 sec;
[2024-03-13 11:21:34,936 INFO] valid stats calculation
                           took: 3.3725805282592773 s.
[2024-03-13 11:21:34,937 INFO] Train perplexity: 35756.4
[2024-03-13 11:21:34,937 INFO] Train accuracy: 9.68819
[2024-03-13 11:21:34,937 INFO] Sentences processed: 18747
[2024-03-13 11:21:34,937 INFO] Average bsz:  572/ 496/47
[2024-03-13 11:21:34,937 INFO] Validation perplexity: 2459.45
[2024-03-13 11:21:34,937 INFO] Validation accuracy: 12.2744
[2024-03-13 11:21:34,938 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_9000.pt
[2024-03-13 11:21:37,404 INFO] Step 9050/13600; acc: 12.0; ppl: 4311.6; xent: 8.4; lr: 1.00000; sents:    2277; bsz:  561/ 487/46; 4806/4168 tok/s;     31 sec;
[2024-03-13 11:21:39,748 INFO] Step 9100/13600; acc: 10.1; ppl: 10780.6; xent: 9.3; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 12355/10670 tok/s;     34 sec;
[2024-03-13 11:21:42,053 INFO] Step 9150/13600; acc: 10.9; ppl: 5258.5; xent: 8.6; lr: 1.00000; sents:    2258; bsz:  537/ 467/45; 11648/10139 tok/s;     36 sec;
[2024-03-13 11:21:44,402 INFO] Step 9200/13600; acc: 9.9; ppl: 13081.3; xent: 9.5; lr: 1.00000; sents:    2366; bsz:  578/ 500/47; 12305/10656 tok/s;     38 sec;
[2024-03-13 11:21:47,761 INFO] valid stats calculation
                           took: 3.3593711853027344 s.
[2024-03-13 11:21:47,762 INFO] Train perplexity: 21447.9
[2024-03-13 11:21:47,762 INFO] Train accuracy: 10.0266
[2024-03-13 11:21:47,762 INFO] Sentences processed: 28023
[2024-03-13 11:21:47,762 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:21:47,762 INFO] Validation perplexity: 12082.2
[2024-03-13 11:21:47,762 INFO] Validation accuracy: 10.1083
[2024-03-13 11:21:47,763 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_9200.pt
[2024-03-13 11:21:50,214 INFO] Step 9250/13600; acc: 10.0; ppl: 4619.3; xent: 8.4; lr: 1.00000; sents:    2367; bsz:  587/ 513/47; 5050/4409 tok/s;     44 sec;
[2024-03-13 11:21:52,506 INFO] Step 9300/13600; acc: 10.2; ppl: 5964.1; xent: 8.7; lr: 1.00000; sents:    2268; bsz:  547/ 478/45; 11944/10422 tok/s;     46 sec;
[2024-03-13 11:21:54,840 INFO] Step 9350/13600; acc: 9.2; ppl: 15481.8; xent: 9.6; lr: 1.00000; sents:    2367; bsz:  587/ 512/47; 12571/10971 tok/s;     49 sec;
[2024-03-13 11:21:57,189 INFO] Step 9400/13600; acc: 9.9; ppl: 7475.0; xent: 8.9; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 12192/10567 tok/s;     51 sec;
[2024-03-13 11:22:00,571 INFO] valid stats calculation
                           took: 3.381986379623413 s.
[2024-03-13 11:22:00,572 INFO] Train perplexity: 16479.5
[2024-03-13 11:22:00,572 INFO] Train accuracy: 9.97554
[2024-03-13 11:22:00,572 INFO] Sentences processed: 37390
[2024-03-13 11:22:00,572 INFO] Average bsz:  570/ 495/47
[2024-03-13 11:22:00,572 INFO] Validation perplexity: 3458.48
[2024-03-13 11:22:00,572 INFO] Validation accuracy: 9.54673
[2024-03-13 11:22:00,573 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_9400.pt
[2024-03-13 11:22:03,012 INFO] Step 9450/13600; acc: 9.8; ppl: 11519.1; xent: 9.4; lr: 1.00000; sents:    2269; bsz:  557/ 482/45; 4782/4137 tok/s;     57 sec;
[2024-03-13 11:22:05,355 INFO] Step 9500/13600; acc: 9.9; ppl: 8100.9; xent: 9.0; lr: 1.00000; sents:    2371; bsz:  563/ 491/47; 12022/10470 tok/s;     59 sec;
[2024-03-13 11:22:07,756 INFO] Step 9550/13600; acc: 9.8; ppl: 15739.1; xent: 9.7; lr: 1.00000; sents:    2279; bsz:  563/ 487/46; 11720/10133 tok/s;     62 sec;
[2024-03-13 11:22:10,118 INFO] Step 9600/13600; acc: 11.1; ppl: 2940.9; xent: 8.0; lr: 1.00000; sents:    2381; bsz:  566/ 495/48; 11975/10473 tok/s;     64 sec;
[2024-03-13 11:22:13,506 INFO] valid stats calculation
                           took: 3.3874683380126953 s.
[2024-03-13 11:22:13,507 INFO] Train perplexity: 14307.9
[2024-03-13 11:22:13,507 INFO] Train accuracy: 10.0115
[2024-03-13 11:22:13,507 INFO] Sentences processed: 46690
[2024-03-13 11:22:13,507 INFO] Average bsz:  568/ 494/47
[2024-03-13 11:22:13,507 INFO] Validation perplexity: 1635.95
[2024-03-13 11:22:13,507 INFO] Validation accuracy: 14.0393
[2024-03-13 11:22:13,508 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_9600.pt
[2024-03-13 11:22:16,013 INFO] Step 9650/13600; acc: 10.6; ppl: 2360.8; xent: 7.8; lr: 1.00000; sents:    2376; bsz:  581/ 505/48; 4926/4280 tok/s;     70 sec;
[2024-03-13 11:22:18,347 INFO] Step 9700/13600; acc: 9.2; ppl: 7206.1; xent: 8.9; lr: 1.00000; sents:    2275; bsz:  561/ 484/46; 12028/10378 tok/s;     72 sec;
[2024-03-13 11:22:20,693 INFO] Step 9750/13600; acc: 9.2; ppl: 6532.1; xent: 8.8; lr: 1.00000; sents:    2371; bsz:  578/ 498/47; 12317/10608 tok/s;     75 sec;
[2024-03-13 11:22:23,017 INFO] Step 9800/13600; acc: 10.8; ppl: 4839.3; xent: 8.5; lr: 1.00000; sents:    2366; bsz:  563/ 491/47; 12123/10561 tok/s;     77 sec;
[2024-03-13 11:22:26,380 INFO] valid stats calculation
                           took: 3.3617818355560303 s.
[2024-03-13 11:22:26,380 INFO] Train perplexity: 11921.1
[2024-03-13 11:22:26,380 INFO] Train accuracy: 10.0032
[2024-03-13 11:22:26,380 INFO] Sentences processed: 56078
[2024-03-13 11:22:26,380 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:22:26,380 INFO] Validation perplexity: 6974.9
[2024-03-13 11:22:26,380 INFO] Validation accuracy: 12.1139
[2024-03-13 11:22:26,382 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_9800.pt
[2024-03-13 11:22:28,787 INFO] Step 9850/13600; acc: 9.2; ppl: 4489.3; xent: 8.4; lr: 1.00000; sents:    2366; bsz:  584/ 506/47; 5062/4387 tok/s;     83 sec;
[2024-03-13 11:22:31,117 INFO] Step 9900/13600; acc: 9.7; ppl: 7071.8; xent: 8.9; lr: 1.00000; sents:    2264; bsz:  562/ 487/45; 12072/10448 tok/s;     85 sec;
[2024-03-13 11:22:33,367 INFO] Step 9950/13600; acc: 11.5; ppl: 2646.1; xent: 7.9; lr: 1.00000; sents:    2369; bsz:  566/ 491/47; 12570/10915 tok/s;     87 sec;
[2024-03-13 11:22:35,634 INFO] Step 10000/13600; acc: 10.7; ppl: 7821.1; xent: 9.0; lr: 1.00000; sents:    2367; bsz:  579/ 500/47; 12783/11028 tok/s;     90 sec;
[2024-03-13 11:22:38,986 INFO] valid stats calculation
                           took: 3.3515098094940186 s.
[2024-03-13 11:22:38,986 INFO] Train perplexity: 10544.2
[2024-03-13 11:22:38,986 INFO] Train accuracy: 10.0442
[2024-03-13 11:22:38,986 INFO] Sentences processed: 65444
[2024-03-13 11:22:38,986 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:22:38,986 INFO] Validation perplexity: 7617.03
[2024-03-13 11:22:38,987 INFO] Validation accuracy: 11.3518
[2024-03-13 11:22:38,988 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_10000.pt
[2024-03-13 11:22:41,419 INFO] Step 10050/13600; acc: 10.6; ppl: 2531.9; xent: 7.8; lr: 1.00000; sents:    2372; bsz:  564/ 489/47; 4877/4229 tok/s;     95 sec;
[2024-03-13 11:22:43,831 INFO] Step 10100/13600; acc: 9.6; ppl: 6212.8; xent: 8.7; lr: 1.00000; sents:    2271; bsz:  562/ 485/45; 11647/10052 tok/s;     98 sec;
[2024-03-13 11:22:46,141 INFO] Step 10150/13600; acc: 11.0; ppl: 1517.9; xent: 7.3; lr: 1.00000; sents:    2375; bsz:  566/ 493/48; 12262/10674 tok/s;    100 sec;
[2024-03-13 11:22:48,477 INFO] Step 10200/13600; acc: 11.0; ppl: 1674.8; xent: 7.4; lr: 1.00000; sents:    2280; bsz:  560/ 486/46; 11980/10406 tok/s;    102 sec;
[2024-03-13 11:22:51,811 INFO] valid stats calculation
                           took: 3.33393931388855 s.
[2024-03-13 11:22:51,812 INFO] Train perplexity: 8828.7
[2024-03-13 11:22:51,812 INFO] Train accuracy: 10.1044
[2024-03-13 11:22:51,812 INFO] Sentences processed: 74742
[2024-03-13 11:22:51,812 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:22:51,812 INFO] Validation perplexity: 1522.51
[2024-03-13 11:22:51,812 INFO] Validation accuracy: 15.0421
[2024-03-13 11:22:51,813 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_10200.pt
[2024-03-13 11:22:54,285 INFO] Step 10250/13600; acc: 10.7; ppl: 6645.5; xent: 8.8; lr: 1.00000; sents:    2376; bsz:  580/ 501/48; 4991/4312 tok/s;    108 sec;
[2024-03-13 11:22:56,693 INFO] Step 10300/13600; acc: 10.1; ppl: 8058.8; xent: 9.0; lr: 1.00000; sents:    2280; bsz:  563/ 487/46; 11693/10109 tok/s;    111 sec;
[2024-03-13 11:22:59,044 INFO] Step 10350/13600; acc: 11.5; ppl: 15437.6; xent: 9.6; lr: 1.00000; sents:    2464; bsz:  595/ 521/49; 12646/11092 tok/s;    113 sec;
[2024-03-13 11:23:01,443 INFO] Step 10400/13600; acc: 9.8; ppl: 4191.1; xent: 8.3; lr: 1.00000; sents:    2270; bsz:  563/ 487/45; 11734/10155 tok/s;    115 sec;
[2024-03-13 11:23:04,776 INFO] valid stats calculation
                           took: 3.332674026489258 s.
[2024-03-13 11:23:04,777 INFO] Train perplexity: 8701.45
[2024-03-13 11:23:04,777 INFO] Train accuracy: 10.1544
[2024-03-13 11:23:04,777 INFO] Sentences processed: 84132
[2024-03-13 11:23:04,777 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:23:04,777 INFO] Validation perplexity: 1907.81
[2024-03-13 11:23:04,777 INFO] Validation accuracy: 13.0766
[2024-03-13 11:23:04,778 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_10400.pt
[2024-03-13 11:23:07,150 INFO] Step 10450/13600; acc: 10.5; ppl: 3914.0; xent: 8.3; lr: 1.00000; sents:    2369; bsz:  566/ 492/47; 4964/4311 tok/s;    121 sec;
[2024-03-13 11:23:09,456 INFO] Step 10500/13600; acc: 10.9; ppl: 2859.4; xent: 8.0; lr: 1.00000; sents:    2242; bsz:  568/ 491/45; 12324/10644 tok/s;    123 sec;
[2024-03-13 11:23:11,699 INFO] Step 10550/13600; acc: 10.6; ppl: 1910.0; xent: 7.6; lr: 1.00000; sents:    2365; bsz:  564/ 490/47; 12576/10936 tok/s;    126 sec;
[2024-03-13 11:23:13,996 INFO] Step 10600/13600; acc: 10.6; ppl: 2751.7; xent: 7.9; lr: 1.00000; sents:    2367; bsz:  579/ 502/47; 12610/10924 tok/s;    128 sec;
[2024-03-13 11:23:17,334 INFO] valid stats calculation
                           took: 3.3372864723205566 s.
[2024-03-13 11:23:17,334 INFO] Train perplexity: 7760.96
[2024-03-13 11:23:17,334 INFO] Train accuracy: 10.2033
[2024-03-13 11:23:17,334 INFO] Sentences processed: 93475
[2024-03-13 11:23:17,334 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:23:17,334 INFO] Validation perplexity: 2496.36
[2024-03-13 11:23:17,334 INFO] Validation accuracy: 11.5523
[2024-03-13 11:23:17,335 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_10600.pt
[2024-03-13 11:23:19,767 INFO] Step 10650/13600; acc: 11.0; ppl: 11190.0; xent: 9.3; lr: 1.00000; sents:    2372; bsz:  564/ 491/47; 4888/4255 tok/s;    134 sec;
[2024-03-13 11:23:22,173 INFO] Step 10700/13600; acc: 11.4; ppl: 6848.9; xent: 8.8; lr: 1.00000; sents:    2275; bsz:  562/ 487/46; 11678/10127 tok/s;    136 sec;
[2024-03-13 11:23:24,521 INFO] Step 10750/13600; acc: 10.5; ppl: 4028.7; xent: 8.3; lr: 1.00000; sents:    2383; bsz:  583/ 507/48; 12420/10794 tok/s;    138 sec;
[2024-03-13 11:23:26,829 INFO] Step 10800/13600; acc: 10.5; ppl: 2315.3; xent: 7.7; lr: 1.00000; sents:    2381; bsz:  566/ 492/48; 12259/10655 tok/s;    141 sec;
[2024-03-13 11:23:30,173 INFO] valid stats calculation
                           took: 3.3432068824768066 s.
[2024-03-13 11:23:30,173 INFO] Train perplexity: 7477.64
[2024-03-13 11:23:30,173 INFO] Train accuracy: 10.2614
[2024-03-13 11:23:30,173 INFO] Sentences processed: 102886
[2024-03-13 11:23:30,173 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:23:30,173 INFO] Validation perplexity: 2224.28
[2024-03-13 11:23:30,173 INFO] Validation accuracy: 5.29483
[2024-03-13 11:23:30,175 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_10800.pt
[2024-03-13 11:23:32,610 INFO] Step 10850/13600; acc: 11.7; ppl: 2409.9; xent: 7.8; lr: 1.00000; sents:    2261; bsz:  552/ 476/45; 4772/4121 tok/s;    147 sec;
[2024-03-13 11:23:34,976 INFO] Step 10900/13600; acc: 10.6; ppl: 2551.2; xent: 7.8; lr: 1.00000; sents:    2372; bsz:  586/ 513/47; 12391/10848 tok/s;    149 sec;
[2024-03-13 11:23:37,288 INFO] Step 10950/13600; acc: 10.4; ppl: 2512.7; xent: 7.8; lr: 1.00000; sents:    2366; bsz:  567/ 497/47; 12263/10751 tok/s;    151 sec;
[2024-03-13 11:23:39,637 INFO] Step 11000/13600; acc: 10.6; ppl: 2617.9; xent: 7.9; lr: 1.00000; sents:    2271; bsz:  568/ 493/45; 12100/10504 tok/s;    154 sec;
[2024-03-13 11:23:42,974 INFO] valid stats calculation
                           took: 3.3366801738739014 s.
[2024-03-13 11:23:42,974 INFO] Train perplexity: 6829.33
[2024-03-13 11:23:42,974 INFO] Train accuracy: 10.3098
[2024-03-13 11:23:42,974 INFO] Sentences processed: 112156
[2024-03-13 11:23:42,974 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:23:42,975 INFO] Validation perplexity: 11174.7
[2024-03-13 11:23:42,975 INFO] Validation accuracy: 13.4376
[2024-03-13 11:23:42,976 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_11000.pt
[2024-03-13 11:23:45,409 INFO] Step 11050/13600; acc: 10.8; ppl: 1626.4; xent: 7.4; lr: 1.00000; sents:    2260; bsz:  555/ 480/45; 4812/4163 tok/s;    159 sec;
[2024-03-13 11:23:47,657 INFO] Step 11100/13600; acc: 9.8; ppl: 4082.8; xent: 8.3; lr: 1.00000; sents:    2471; bsz:  577/ 500/49; 12829/11116 tok/s;    162 sec;
[2024-03-13 11:23:49,974 INFO] Step 11150/13600; acc: 10.1; ppl: 2127.9; xent: 7.7; lr: 1.00000; sents:    2261; bsz:  556/ 481/45; 11992/10388 tok/s;    164 sec;
[2024-03-13 11:23:52,359 INFO] Step 11200/13600; acc: 10.3; ppl: 1578.7; xent: 7.4; lr: 1.00000; sents:    2373; bsz:  582/ 507/47; 12198/10627 tok/s;    166 sec;
[2024-03-13 11:23:55,707 INFO] valid stats calculation
                           took: 3.3478026390075684 s.
[2024-03-13 11:23:55,707 INFO] Train perplexity: 6256.62
[2024-03-13 11:23:55,708 INFO] Train accuracy: 10.3045
[2024-03-13 11:23:55,708 INFO] Sentences processed: 121521
[2024-03-13 11:23:55,708 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:23:55,708 INFO] Validation perplexity: 1690.75
[2024-03-13 11:23:55,708 INFO] Validation accuracy: 12.515
[2024-03-13 11:23:55,709 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_11200.pt
[2024-03-13 11:23:58,215 INFO] Step 11250/13600; acc: 11.7; ppl: 1404.4; xent: 7.2; lr: 1.00000; sents:    2371; bsz:  565/ 494/47; 4824/4220 tok/s;    172 sec;
[2024-03-13 11:24:00,595 INFO] Step 11300/13600; acc: 11.1; ppl: 3187.3; xent: 8.1; lr: 1.00000; sents:    2279; bsz:  562/ 486/46; 11815/10205 tok/s;    175 sec;
[2024-03-13 11:24:02,929 INFO] Step 11350/13600; acc: 9.7; ppl: 3740.7; xent: 8.2; lr: 1.00000; sents:    2281; bsz:  563/ 486/46; 12055/10415 tok/s;    177 sec;
[2024-03-13 11:24:05,235 INFO] Step 11400/13600; acc: 11.2; ppl: 2771.0; xent: 7.9; lr: 1.00000; sents:    2376; bsz:  578/ 498/48; 12530/10794 tok/s;    179 sec;
[2024-03-13 11:24:08,581 INFO] valid stats calculation
                           took: 3.345222234725952 s.
[2024-03-13 11:24:08,582 INFO] Train perplexity: 5879
[2024-03-13 11:24:08,582 INFO] Train accuracy: 10.3474
[2024-03-13 11:24:08,582 INFO] Sentences processed: 130828
[2024-03-13 11:24:08,582 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:24:08,582 INFO] Validation perplexity: 19609.1
[2024-03-13 11:24:08,582 INFO] Validation accuracy: 10.3891
[2024-03-13 11:24:08,583 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_11400.pt
[2024-03-13 11:24:10,995 INFO] Step 11450/13600; acc: 12.3; ppl: 2809.7; xent: 7.9; lr: 1.00000; sents:    2375; bsz:  566/ 491/48; 4912/4261 tok/s;    185 sec;
[2024-03-13 11:24:13,374 INFO] Step 11500/13600; acc: 9.4; ppl: 3160.3; xent: 8.1; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 12320/10678 tok/s;    187 sec;
[2024-03-13 11:24:15,745 INFO] Step 11550/13600; acc: 10.7; ppl: 2339.2; xent: 7.8; lr: 1.00000; sents:    2268; bsz:  563/ 487/45; 11868/10281 tok/s;    190 sec;
[2024-03-13 11:24:18,009 INFO] Step 11600/13600; acc: 11.8; ppl: 1324.8; xent: 7.2; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 12466/10833 tok/s;    192 sec;
[2024-03-13 11:24:21,360 INFO] valid stats calculation
                           took: 3.3510379791259766 s.
[2024-03-13 11:24:21,360 INFO] Train perplexity: 5521.74
[2024-03-13 11:24:21,360 INFO] Train accuracy: 10.3928
[2024-03-13 11:24:21,361 INFO] Sentences processed: 140208
[2024-03-13 11:24:21,361 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:24:21,361 INFO] Validation perplexity: 4632.91
[2024-03-13 11:24:21,361 INFO] Validation accuracy: 12.5552
[2024-03-13 11:24:21,362 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_11600.pt
[2024-03-13 11:24:23,796 INFO] Step 11650/13600; acc: 10.1; ppl: 2446.7; xent: 7.8; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 4838/4171 tok/s;    198 sec;
[2024-03-13 11:24:26,047 INFO] Step 11700/13600; acc: 12.0; ppl: 1315.2; xent: 7.2; lr: 1.00000; sents:    2367; bsz:  563/ 488/47; 12502/10849 tok/s;    200 sec;
[2024-03-13 11:24:28,335 INFO] Step 11750/13600; acc: 12.8; ppl: 1452.1; xent: 7.3; lr: 1.00000; sents:    2369; bsz:  580/ 501/47; 12685/10944 tok/s;    202 sec;
[2024-03-13 11:24:30,687 INFO] Step 11800/13600; acc: 13.1; ppl: 845.3; xent: 6.7; lr: 1.00000; sents:    2270; bsz:  559/ 485/45; 11887/10311 tok/s;    205 sec;
[2024-03-13 11:24:34,045 INFO] valid stats calculation
                           took: 3.3571619987487793 s.
[2024-03-13 11:24:34,045 INFO] Train perplexity: 5073.72
[2024-03-13 11:24:34,045 INFO] Train accuracy: 10.4928
[2024-03-13 11:24:34,045 INFO] Sentences processed: 149476
[2024-03-13 11:24:34,045 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:24:34,045 INFO] Validation perplexity: 3362.85
[2024-03-13 11:24:34,045 INFO] Validation accuracy: 10.71
[2024-03-13 11:24:34,047 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_11800.pt
[2024-03-13 11:24:36,468 INFO] Step 11850/13600; acc: 12.0; ppl: 1027.1; xent: 6.9; lr: 1.00000; sents:    2473; bsz:  589/ 512/49; 5098/4426 tok/s;    210 sec;
[2024-03-13 11:24:38,811 INFO] Step 11900/13600; acc: 11.6; ppl: 1422.0; xent: 7.3; lr: 1.00000; sents:    2273; bsz:  558/ 485/45; 11917/10347 tok/s;    213 sec;
[2024-03-13 11:24:41,145 INFO] Step 11950/13600; acc: 12.7; ppl: 2230.1; xent: 7.7; lr: 1.00000; sents:    2382; bsz:  589/ 510/48; 12615/10934 tok/s;    215 sec;
[2024-03-13 11:24:43,514 INFO] Step 12000/13600; acc: 11.6; ppl: 1305.7; xent: 7.2; lr: 1.00000; sents:    2275; bsz:  563/ 488/46; 11878/10311 tok/s;    217 sec;
[2024-03-13 11:24:46,861 INFO] valid stats calculation
                           took: 3.3476226329803467 s.
[2024-03-13 11:24:46,862 INFO] Train perplexity: 4707.44
[2024-03-13 11:24:46,862 INFO] Train accuracy: 10.5812
[2024-03-13 11:24:46,862 INFO] Sentences processed: 158879
[2024-03-13 11:24:46,862 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:24:46,862 INFO] Validation perplexity: 1413.3
[2024-03-13 11:24:46,862 INFO] Validation accuracy: 14.7613
[2024-03-13 11:24:46,863 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_12000.pt
[2024-03-13 11:24:49,301 INFO] Step 12050/13600; acc: 12.9; ppl: 1078.2; xent: 7.0; lr: 1.00000; sents:    2381; bsz:  572/ 499/48; 4941/4312 tok/s;    223 sec;
[2024-03-13 11:24:51,627 INFO] Step 12100/13600; acc: 12.7; ppl: 1135.5; xent: 7.0; lr: 1.00000; sents:    2368; bsz:  565/ 491/47; 12147/10559 tok/s;    226 sec;
[2024-03-13 11:24:53,971 INFO] Step 12150/13600; acc: 12.1; ppl: 1755.0; xent: 7.5; lr: 1.00000; sents:    2366; bsz:  586/ 506/47; 12489/10793 tok/s;    228 sec;
[2024-03-13 11:24:56,245 INFO] Step 12200/13600; acc: 12.2; ppl: 1327.5; xent: 7.2; lr: 1.00000; sents:    2248; bsz:  551/ 478/45; 12128/10521 tok/s;    230 sec;
[2024-03-13 11:24:59,585 INFO] valid stats calculation
                           took: 3.3389413356781006 s.
[2024-03-13 11:24:59,585 INFO] Train perplexity: 4383.05
[2024-03-13 11:24:59,585 INFO] Train accuracy: 10.6864
[2024-03-13 11:24:59,585 INFO] Sentences processed: 168242
[2024-03-13 11:24:59,585 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:24:59,585 INFO] Validation perplexity: 1028.42
[2024-03-13 11:24:59,585 INFO] Validation accuracy: 13.9992
[2024-03-13 11:24:59,587 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_12200.pt
[2024-03-13 11:25:01,957 INFO] Step 12250/13600; acc: 13.4; ppl: 1142.1; xent: 7.0; lr: 1.00000; sents:    2363; bsz:  562/ 488/47; 4916/4274 tok/s;    236 sec;
[2024-03-13 11:25:04,262 INFO] Step 12300/13600; acc: 10.5; ppl: 2679.8; xent: 7.9; lr: 1.00000; sents:    2365; bsz:  577/ 500/47; 12522/10838 tok/s;    238 sec;
[2024-03-13 11:25:06,611 INFO] Step 12350/13600; acc: 13.0; ppl: 1183.9; xent: 7.1; lr: 1.00000; sents:    2258; bsz:  555/ 482/45; 11824/10255 tok/s;    241 sec;
[2024-03-13 11:25:09,015 INFO] Step 12400/13600; acc: 13.1; ppl: 746.6; xent: 6.6; lr: 1.00000; sents:    2274; bsz:  563/ 490/45; 11712/10185 tok/s;    243 sec;
[2024-03-13 11:25:12,338 INFO] valid stats calculation
                           took: 3.322267770767212 s.
[2024-03-13 11:25:12,338 INFO] Train perplexity: 4111.5
[2024-03-13 11:25:12,338 INFO] Train accuracy: 10.7806
[2024-03-13 11:25:12,338 INFO] Sentences processed: 177502
[2024-03-13 11:25:12,338 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:25:12,338 INFO] Validation perplexity: 1182.48
[2024-03-13 11:25:12,338 INFO] Validation accuracy: 10.8303
[2024-03-13 11:25:12,340 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_12400.pt
[2024-03-13 11:25:14,793 INFO] Step 12450/13600; acc: 12.0; ppl: 2540.0; xent: 7.8; lr: 1.00000; sents:    2375; bsz:  563/ 491/48; 4871/4247 tok/s;    249 sec;
[2024-03-13 11:25:17,127 INFO] Step 12500/13600; acc: 11.8; ppl: 1773.4; xent: 7.5; lr: 1.00000; sents:    2381; bsz:  582/ 505/48; 12461/10813 tok/s;    251 sec;
[2024-03-13 11:25:19,458 INFO] Step 12550/13600; acc: 13.0; ppl: 1314.0; xent: 7.2; lr: 1.00000; sents:    2376; bsz:  564/ 492/48; 12096/10550 tok/s;    253 sec;
[2024-03-13 11:25:21,842 INFO] Step 12600/13600; acc: 13.4; ppl: 833.0; xent: 6.7; lr: 1.00000; sents:    2278; bsz:  567/ 490/46; 11898/10285 tok/s;    256 sec;
[2024-03-13 11:25:25,181 INFO] valid stats calculation
                           took: 3.338355541229248 s.
[2024-03-13 11:25:25,181 INFO] Train perplexity: 3908.01
[2024-03-13 11:25:25,181 INFO] Train accuracy: 10.8689
[2024-03-13 11:25:25,181 INFO] Sentences processed: 186912
[2024-03-13 11:25:25,181 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:25:25,182 INFO] Validation perplexity: 2307.87
[2024-03-13 11:25:25,182 INFO] Validation accuracy: 15.7641
[2024-03-13 11:25:25,183 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_12600.pt
[2024-03-13 11:25:27,635 INFO] Step 12650/13600; acc: 11.3; ppl: 3480.1; xent: 8.2; lr: 1.00000; sents:    2372; bsz:  587/ 515/47; 5069/4447 tok/s;    262 sec;
[2024-03-13 11:25:30,022 INFO] Step 12700/13600; acc: 11.9; ppl: 1625.9; xent: 7.4; lr: 1.00000; sents:    2264; bsz:  559/ 483/45; 11712/10124 tok/s;    264 sec;
[2024-03-13 11:25:32,308 INFO] Step 12750/13600; acc: 11.4; ppl: 3338.8; xent: 8.1; lr: 1.00000; sents:    2366; bsz:  575/ 495/47; 12570/10837 tok/s;    266 sec;
[2024-03-13 11:25:34,536 INFO] Step 12800/13600; acc: 12.6; ppl: 1499.9; xent: 7.3; lr: 1.00000; sents:    2364; bsz:  558/ 487/47; 12525/10922 tok/s;    268 sec;
[2024-03-13 11:25:37,904 INFO] valid stats calculation
                           took: 3.3670620918273926 s.
[2024-03-13 11:25:37,904 INFO] Train perplexity: 3812.38
[2024-03-13 11:25:37,904 INFO] Train accuracy: 10.9118
[2024-03-13 11:25:37,904 INFO] Sentences processed: 196278
[2024-03-13 11:25:37,904 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:25:37,904 INFO] Validation perplexity: 279225
[2024-03-13 11:25:37,904 INFO] Validation accuracy: 11.793
[2024-03-13 11:25:37,905 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_12800.pt
[2024-03-13 11:25:40,319 INFO] Step 12850/13600; acc: 11.8; ppl: 1663.2; xent: 7.4; lr: 1.00000; sents:    2268; bsz:  558/ 481/45; 4822/4163 tok/s;    274 sec;
[2024-03-13 11:25:42,686 INFO] Step 12900/13600; acc: 11.0; ppl: 1523.4; xent: 7.3; lr: 1.00000; sents:    2464; bsz:  586/ 516/49; 12373/10899 tok/s;    277 sec;
[2024-03-13 11:25:45,022 INFO] Step 12950/13600; acc: 10.6; ppl: 2111.3; xent: 7.7; lr: 1.00000; sents:    2276; bsz:  562/ 486/46; 12026/10397 tok/s;    279 sec;
[2024-03-13 11:25:47,422 INFO] Step 13000/13600; acc: 8.4; ppl: 9746.2; xent: 9.2; lr: 1.00000; sents:    2271; bsz:  564/ 489/45; 11758/10184 tok/s;    281 sec;
[2024-03-13 11:25:50,759 INFO] valid stats calculation
                           took: 3.335972785949707 s.
[2024-03-13 11:25:50,759 INFO] Train perplexity: 3751.38
[2024-03-13 11:25:50,759 INFO] Train accuracy: 10.8908
[2024-03-13 11:25:50,759 INFO] Sentences processed: 205557
[2024-03-13 11:25:50,759 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:25:50,759 INFO] Validation perplexity: 2005.26
[2024-03-13 11:25:50,759 INFO] Validation accuracy: 14.6811
[2024-03-13 11:25:50,761 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_13000.pt
[2024-03-13 11:25:53,253 INFO] Step 13050/13600; acc: 13.3; ppl: 1485.6; xent: 7.3; lr: 1.00000; sents:    2375; bsz:  579/ 498/48; 4965/4273 tok/s;    287 sec;
[2024-03-13 11:25:55,575 INFO] Step 13100/13600; acc: 13.2; ppl: 1386.5; xent: 7.2; lr: 1.00000; sents:    2382; bsz:  561/ 487/48; 12084/10500 tok/s;    290 sec;
[2024-03-13 11:25:57,993 INFO] Step 13150/13600; acc: 11.2; ppl: 2665.4; xent: 7.9; lr: 1.00000; sents:    2276; bsz:  565/ 488/46; 11684/10102 tok/s;    292 sec;
[2024-03-13 11:26:00,365 INFO] Step 13200/13600; acc: 10.0; ppl: 2088.3; xent: 7.6; lr: 1.00000; sents:    2377; bsz:  588/ 509/48; 12389/10726 tok/s;    294 sec;
[2024-03-13 11:26:03,707 INFO] valid stats calculation
                           took: 3.3418407440185547 s.
[2024-03-13 11:26:03,708 INFO] Train perplexity: 3636.59
[2024-03-13 11:26:03,708 INFO] Train accuracy: 10.936
[2024-03-13 11:26:03,708 INFO] Sentences processed: 214967
[2024-03-13 11:26:03,708 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:26:03,708 INFO] Validation perplexity: 5770.05
[2024-03-13 11:26:03,708 INFO] Validation accuracy: 11.3919
[2024-03-13 11:26:03,709 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_13200.pt
[2024-03-13 11:26:06,144 INFO] Step 13250/13600; acc: 12.0; ppl: 1886.0; xent: 7.5; lr: 1.00000; sents:    2371; bsz:  565/ 491/47; 4891/4249 tok/s;    300 sec;
[2024-03-13 11:26:08,436 INFO] Step 13300/13600; acc: 12.8; ppl: 1352.2; xent: 7.2; lr: 1.00000; sents:    2366; bsz:  563/ 489/47; 12279/10675 tok/s;    302 sec;
[2024-03-13 11:26:10,723 INFO] Step 13350/13600; acc: 11.5; ppl: 1375.4; xent: 7.2; lr: 1.00000; sents:    2366; bsz:  579/ 499/47; 12663/10916 tok/s;    305 sec;
[2024-03-13 11:26:13,056 INFO] Step 13400/13600; acc: 11.2; ppl: 1607.9; xent: 7.4; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 12003/10351 tok/s;    307 sec;
[2024-03-13 11:26:16,386 INFO] valid stats calculation
                           took: 3.329045295715332 s.
[2024-03-13 11:26:16,386 INFO] Train perplexity: 3509.48
[2024-03-13 11:26:16,386 INFO] Train accuracy: 10.9755
[2024-03-13 11:26:16,386 INFO] Sentences processed: 224332
[2024-03-13 11:26:16,386 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:26:16,386 INFO] Validation perplexity: 2.10407e+06
[2024-03-13 11:26:16,386 INFO] Validation accuracy: 12.3947
[2024-03-13 11:26:16,388 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_13400.pt
[2024-03-13 11:26:18,816 INFO] Step 13450/13600; acc: 11.6; ppl: 2885.7; xent: 8.0; lr: 1.00000; sents:    2367; bsz:  586/ 507/47; 5084/4402 tok/s;    313 sec;
[2024-03-13 11:26:21,129 INFO] Step 13500/13600; acc: 11.8; ppl: 1048.7; xent: 7.0; lr: 1.00000; sents:    2267; bsz:  557/ 483/45; 12030/10431 tok/s;    315 sec;
[2024-03-13 11:26:23,457 INFO] Step 13550/13600; acc: 14.3; ppl: 609.2; xent: 6.4; lr: 1.00000; sents:    2372; bsz:  564/ 492/47; 12111/10577 tok/s;    317 sec;
[2024-03-13 11:26:25,844 INFO] Step 13600/13600; acc: 13.3; ppl: 730.5; xent: 6.6; lr: 1.00000; sents:    2257; bsz:  556/ 481/45; 11654/10078 tok/s;    320 sec;
[2024-03-13 11:26:29,174 INFO] valid stats calculation
                           took: 3.3295748233795166 s.
[2024-03-13 11:26:29,175 INFO] Train perplexity: 3349.72
[2024-03-13 11:26:29,175 INFO] Train accuracy: 11.0462
[2024-03-13 11:26:29,175 INFO] Sentences processed: 233595
[2024-03-13 11:26:29,175 INFO] Average bsz:  569/ 494/47
[2024-03-13 11:26:29,175 INFO] Validation perplexity: 1553.56
[2024-03-13 11:26:29,175 INFO] Validation accuracy: 13.3574
[2024-03-13 11:26:29,176 INFO] Saving checkpoint tg-ft-both/tg-ft-both_8600_01_step_13600.pt
