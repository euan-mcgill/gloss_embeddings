[2024-03-12 10:34:59,831 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-12 10:34:59,831 INFO] Parsed 2 corpora from -data.
[2024-03-12 10:34:59,831 INFO] Loading checkpoint from tg-pt-enc/models/tg-pt-enc_03_step_2800.pt
[2024-03-12 10:34:59,896 INFO] Building model...
[2024-03-12 10:34:59,951 INFO] Switching model to float32 for amp/apex_amp
[2024-03-12 10:34:59,952 INFO] Non quantized layer compute is fp32
[2024-03-12 10:35:01,871 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-12 10:35:01,871 INFO] encoder: 8952800
[2024-03-12 10:35:01,871 INFO] decoder: 16687344
[2024-03-12 10:35:01,871 INFO] * number of parameters: 25640144
[2024-03-12 10:35:01,871 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 10:35:01,871 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 10:35:01,872 INFO]  * src vocab size = 17816
[2024-03-12 10:35:01,872 INFO]  * tgt vocab size = 14144
[2024-03-12 10:35:01,873 INFO] Starting training on GPU: [0]
[2024-03-12 10:35:01,873 INFO] Start training loop and validate every 200 steps...
[2024-03-12 10:35:01,873 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-12 10:35:09,084 INFO] Step 2850/ 7800; acc: 8.4; ppl: 115812.8; xent: 11.7; lr: 1.00000; sents:    2270; bsz:  565/ 490/45; 3919/3396 tok/s;      7 sec;
[2024-03-12 10:35:12,678 INFO] Step 2900/ 7800; acc: 10.9; ppl: 3126.3; xent: 8.0; lr: 1.00000; sents:    2369; bsz:  590/ 512/47; 8212/7130 tok/s;     11 sec;
[2024-03-12 10:35:16,185 INFO] Step 2950/ 7800; acc: 15.1; ppl: 613.8; xent: 6.4; lr: 1.00000; sents:    2363; bsz:  564/ 491/47; 8035/7007 tok/s;     14 sec;
[2024-03-12 10:35:19,385 INFO] Step 3000/ 7800; acc: 17.7; ppl: 329.5; xent: 5.8; lr: 1.00000; sents:    2365; bsz:  585/ 507/47; 9142/7926 tok/s;     18 sec;
[2024-03-12 10:35:22,998 INFO] valid stats calculation
                           took: 3.612222909927368 s.
[2024-03-12 10:35:22,998 INFO] Train perplexity: 2868.56
[2024-03-12 10:35:22,998 INFO] Train accuracy: 13.0268
[2024-03-12 10:35:22,998 INFO] Sentences processed: 9367
[2024-03-12 10:35:22,998 INFO] Average bsz:  576/ 500/47
[2024-03-12 10:35:22,998 INFO] Validation perplexity: 568.072
[2024-03-12 10:35:22,998 INFO] Validation accuracy: 11.8331
[2024-03-12 10:35:23,000 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_3000.pt
[2024-03-12 10:35:26,689 INFO] Step 3050/ 7800; acc: 20.6; ppl: 199.6; xent: 5.3; lr: 1.00000; sents:    2246; bsz:  547/ 475/45; 3748/3251 tok/s;     25 sec;
[2024-03-12 10:35:30,275 INFO] Step 3100/ 7800; acc: 24.3; ppl: 118.8; xent: 4.8; lr: 1.00000; sents:    2372; bsz:  566/ 491/47; 7892/6846 tok/s;     28 sec;
[2024-03-12 10:35:33,910 INFO] Step 3150/ 7800; acc: 28.1; ppl:  78.8; xent: 4.4; lr: 1.00000; sents:    2378; bsz:  568/ 494/48; 7806/6799 tok/s;     32 sec;
[2024-03-12 10:35:37,248 INFO] Step 3200/ 7800; acc: 30.1; ppl:  58.3; xent: 4.1; lr: 1.00000; sents:    2384; bsz:  587/ 510/48; 8799/7643 tok/s;     35 sec;
[2024-03-12 10:35:40,826 INFO] valid stats calculation
                           took: 3.578148126602173 s.
[2024-03-12 10:35:40,827 INFO] Train perplexity: 545.208
[2024-03-12 10:35:40,827 INFO] Train accuracy: 19.3915
[2024-03-12 10:35:40,827 INFO] Sentences processed: 18747
[2024-03-12 10:35:40,827 INFO] Average bsz:  572/ 496/47
[2024-03-12 10:35:40,827 INFO] Validation perplexity: 210.023
[2024-03-12 10:35:40,827 INFO] Validation accuracy: 24.99
[2024-03-12 10:35:40,828 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_3200.pt
[2024-03-12 10:35:44,565 INFO] Step 3250/ 7800; acc: 33.1; ppl:  43.8; xent: 3.8; lr: 1.00000; sents:    2277; bsz:  561/ 487/46; 3836/3327 tok/s;     43 sec;
[2024-03-12 10:35:48,122 INFO] Step 3300/ 7800; acc: 35.8; ppl:  32.8; xent: 3.5; lr: 1.00000; sents:    2375; bsz:  579/ 500/48; 8140/7030 tok/s;     46 sec;
[2024-03-12 10:35:51,659 INFO] Step 3350/ 7800; acc: 38.1; ppl:  26.3; xent: 3.3; lr: 1.00000; sents:    2258; bsz:  553/ 479/45; 7813/6767 tok/s;     50 sec;
[2024-03-12 10:35:55,093 INFO] Step 3400/ 7800; acc: 40.9; ppl:  20.9; xent: 3.0; lr: 1.00000; sents:    2366; bsz:  562/ 489/47; 8187/7124 tok/s;     53 sec;
[2024-03-12 10:35:58,715 INFO] valid stats calculation
                           took: 3.621346950531006 s.
[2024-03-12 10:35:58,715 INFO] Train perplexity: 209.066
[2024-03-12 10:35:58,715 INFO] Train accuracy: 25.1889
[2024-03-12 10:35:58,715 INFO] Sentences processed: 28023
[2024-03-12 10:35:58,715 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:35:58,715 INFO] Validation perplexity: 249.393
[2024-03-12 10:35:58,715 INFO] Validation accuracy: 26.3939
[2024-03-12 10:35:58,717 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_3400.pt
[2024-03-12 10:36:02,342 INFO] Step 3450/ 7800; acc: 42.6; ppl:  18.3; xent: 2.9; lr: 1.00000; sents:    2271; bsz:  567/ 491/45; 3910/3384 tok/s;     60 sec;
[2024-03-12 10:36:05,816 INFO] Step 3500/ 7800; acc: 44.4; ppl:  15.4; xent: 2.7; lr: 1.00000; sents:    2460; bsz:  588/ 522/49; 8460/7513 tok/s;     64 sec;
[2024-03-12 10:36:09,376 INFO] Step 3550/ 7800; acc: 46.4; ppl:  12.8; xent: 2.5; lr: 1.00000; sents:    2271; bsz:  567/ 490/45; 7959/6878 tok/s;     68 sec;
[2024-03-12 10:36:12,927 INFO] Step 3600/ 7800; acc: 49.1; ppl:  10.4; xent: 2.3; lr: 1.00000; sents:    2261; bsz:  554/ 479/45; 7803/6740 tok/s;     71 sec;
[2024-03-12 10:36:16,568 INFO] valid stats calculation
                           took: 3.6403932571411133 s.
[2024-03-12 10:36:16,569 INFO] Train perplexity: 106.137
[2024-03-12 10:36:16,569 INFO] Train accuracy: 30.296
[2024-03-12 10:36:16,569 INFO] Sentences processed: 37286
[2024-03-12 10:36:16,569 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:36:16,569 INFO] Validation perplexity: 288.311
[2024-03-12 10:36:16,569 INFO] Validation accuracy: 28.2391
[2024-03-12 10:36:16,570 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_3600.pt
[2024-03-12 10:36:20,172 INFO] Step 3650/ 7800; acc: 51.5; ppl:   9.0; xent: 2.2; lr: 1.00000; sents:    2373; bsz:  575/ 499/47; 3971/3447 tok/s;     78 sec;
[2024-03-12 10:36:23,777 INFO] Step 3700/ 7800; acc: 53.2; ppl:   8.0; xent: 2.1; lr: 1.00000; sents:    2371; bsz:  563/ 491/47; 7816/6807 tok/s;     82 sec;
[2024-03-12 10:36:27,408 INFO] Step 3750/ 7800; acc: 54.3; ppl:   7.2; xent: 2.0; lr: 1.00000; sents:    2279; bsz:  563/ 487/46; 7750/6700 tok/s;     86 sec;
[2024-03-12 10:36:31,093 INFO] Step 3800/ 7800; acc: 57.0; ppl:   6.3; xent: 1.8; lr: 1.00000; sents:    2478; bsz:  584/ 514/50; 7931/6976 tok/s;     89 sec;
[2024-03-12 10:36:34,670 INFO] valid stats calculation
                           took: 3.5764389038085938 s.
[2024-03-12 10:36:34,670 INFO] Train perplexity: 62.4093
[2024-03-12 10:36:34,670 INFO] Train accuracy: 35.0687
[2024-03-12 10:36:34,670 INFO] Sentences processed: 46787
[2024-03-12 10:36:34,670 INFO] Average bsz:  569/ 495/47
[2024-03-12 10:36:34,670 INFO] Validation perplexity: 355.246
[2024-03-12 10:36:34,670 INFO] Validation accuracy: 27.5973
[2024-03-12 10:36:34,672 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_3800.pt
[2024-03-12 10:36:38,280 INFO] Step 3850/ 7800; acc: 58.0; ppl:   5.8; xent: 1.8; lr: 1.00000; sents:    2279; bsz:  562/ 485/46; 3909/3375 tok/s;     96 sec;
[2024-03-12 10:36:41,818 INFO] Step 3900/ 7800; acc: 60.6; ppl:   5.1; xent: 1.6; lr: 1.00000; sents:    2375; bsz:  565/ 490/48; 7989/6932 tok/s;    100 sec;
[2024-03-12 10:36:45,392 INFO] Step 3950/ 7800; acc: 62.2; ppl:   4.6; xent: 1.5; lr: 1.00000; sents:    2271; bsz:  560/ 481/45; 7839/6736 tok/s;    104 sec;
[2024-03-12 10:36:49,044 INFO] Step 4000/ 7800; acc: 63.6; ppl:   4.3; xent: 1.5; lr: 1.00000; sents:    2366; bsz:  577/ 501/47; 7903/6860 tok/s;    107 sec;
[2024-03-12 10:36:52,606 INFO] valid stats calculation
                           took: 3.561382293701172 s.
[2024-03-12 10:36:52,606 INFO] Train perplexity: 41.0065
[2024-03-12 10:36:52,606 INFO] Train accuracy: 39.3698
[2024-03-12 10:36:52,606 INFO] Sentences processed: 56078
[2024-03-12 10:36:52,606 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:36:52,606 INFO] Validation perplexity: 493.507
[2024-03-12 10:36:52,606 INFO] Validation accuracy: 27.9583
[2024-03-12 10:36:52,607 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_4000.pt
[2024-03-12 10:36:55,981 INFO] Step 4050/ 7800; acc: 64.3; ppl:   4.1; xent: 1.4; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 4055/3516 tok/s;    114 sec;
[2024-03-12 10:36:59,394 INFO] Step 4100/ 7800; acc: 67.1; ppl:   3.6; xent: 1.3; lr: 1.00000; sents:    2462; bsz:  586/ 508/49; 8579/7446 tok/s;    118 sec;
[2024-03-12 10:37:02,956 INFO] Step 4150/ 7800; acc: 67.5; ppl:   3.5; xent: 1.2; lr: 1.00000; sents:    2269; bsz:  564/ 488/45; 7917/6851 tok/s;    121 sec;
[2024-03-12 10:37:06,419 INFO] Step 4200/ 7800; acc: 69.5; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    2367; bsz:  563/ 488/47; 8130/7046 tok/s;    125 sec;
[2024-03-12 10:37:09,921 INFO] valid stats calculation
                           took: 3.5015151500701904 s.
[2024-03-12 10:37:09,921 INFO] Train perplexity: 28.9803
[2024-03-12 10:37:09,921 INFO] Train accuracy: 43.3221
[2024-03-12 10:37:09,921 INFO] Sentences processed: 65444
[2024-03-12 10:37:09,921 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:37:09,921 INFO] Validation perplexity: 695.284
[2024-03-12 10:37:09,921 INFO] Validation accuracy: 28.1588
[2024-03-12 10:37:09,923 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_4200.pt
[2024-03-12 10:37:13,120 INFO] Step 4250/ 7800; acc: 70.0; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    2272; bsz:  578/ 497/45; 4316/3706 tok/s;    131 sec;
[2024-03-12 10:37:16,658 INFO] Step 4300/ 7800; acc: 71.9; ppl:   2.8; xent: 1.0; lr: 1.00000; sents:    2371; bsz:  564/ 490/47; 7972/6919 tok/s;    135 sec;
[2024-03-12 10:37:20,215 INFO] Step 4350/ 7800; acc: 72.7; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    2273; bsz:  560/ 486/45; 7869/6833 tok/s;    138 sec;
[2024-03-12 10:37:23,816 INFO] Step 4400/ 7800; acc: 74.3; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2382; bsz:  566/ 493/48; 7863/6847 tok/s;    142 sec;
[2024-03-12 10:37:27,322 INFO] valid stats calculation
                           took: 3.5054867267608643 s.
[2024-03-12 10:37:27,322 INFO] Train perplexity: 21.6353
[2024-03-12 10:37:27,322 INFO] Train accuracy: 46.9185
[2024-03-12 10:37:27,322 INFO] Sentences processed: 74742
[2024-03-12 10:37:27,322 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:37:27,322 INFO] Validation perplexity: 911.103
[2024-03-12 10:37:27,322 INFO] Validation accuracy: 28.6803
[2024-03-12 10:37:27,324 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_4400.pt
[2024-03-12 10:37:30,161 INFO] Step 4450/ 7800; acc: 75.3; ppl:   2.4; xent: 0.9; lr: 1.00000; sents:    2376; bsz:  580/ 501/48; 4568/3947 tok/s;    148 sec;
[2024-03-12 10:37:33,766 INFO] Step 4500/ 7800; acc: 76.8; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2280; bsz:  563/ 487/46; 7810/6752 tok/s;    152 sec;
[2024-03-12 10:37:37,422 INFO] Step 4550/ 7800; acc: 77.0; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2368; bsz:  589/ 512/47; 8055/7004 tok/s;    156 sec;
[2024-03-12 10:37:40,991 INFO] Step 4600/ 7800; acc: 78.5; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2366; bsz:  569/ 497/47; 7968/6959 tok/s;    159 sec;
[2024-03-12 10:37:44,429 INFO] valid stats calculation
                           took: 3.437835693359375 s.
[2024-03-12 10:37:44,429 INFO] Train perplexity: 16.8318
[2024-03-12 10:37:44,429 INFO] Train accuracy: 50.2854
[2024-03-12 10:37:44,429 INFO] Sentences processed: 84132
[2024-03-12 10:37:44,430 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:37:44,430 INFO] Validation perplexity: 1258.03
[2024-03-12 10:37:44,430 INFO] Validation accuracy: 27.5572
[2024-03-12 10:37:44,431 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_4600.pt
[2024-03-12 10:37:46,990 INFO] Step 4650/ 7800; acc: 79.7; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2369; bsz:  587/ 508/47; 4892/4232 tok/s;    165 sec;
[2024-03-12 10:37:49,340 INFO] Step 4700/ 7800; acc: 81.4; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2242; bsz:  527/ 458/45; 11206/9740 tok/s;    167 sec;
[2024-03-12 10:37:51,743 INFO] Step 4750/ 7800; acc: 80.3; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2365; bsz:  585/ 508/47; 12180/10567 tok/s;    170 sec;
[2024-03-12 10:37:54,109 INFO] Step 4800/ 7800; acc: 82.0; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2367; bsz:  561/ 488/47; 11853/10309 tok/s;    172 sec;
[2024-03-12 10:37:57,584 INFO] valid stats calculation
                           took: 3.4745194911956787 s.
[2024-03-12 10:37:57,584 INFO] Train perplexity: 13.6036
[2024-03-12 10:37:57,584 INFO] Train accuracy: 53.3169
[2024-03-12 10:37:57,585 INFO] Sentences processed: 93475
[2024-03-12 10:37:57,585 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:37:57,585 INFO] Validation perplexity: 1359.28
[2024-03-12 10:37:57,585 INFO] Validation accuracy: 28.8408
[2024-03-12 10:37:57,586 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_4800.pt
[2024-03-12 10:38:01,348 INFO] Step 4850/ 7800; acc: 82.3; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2268; bsz:  576/ 498/45; 3981/3438 tok/s;    179 sec;
[2024-03-12 10:38:04,982 INFO] Step 4900/ 7800; acc: 83.4; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2379; bsz:  568/ 494/48; 7814/6803 tok/s;    183 sec;
[2024-03-12 10:38:08,603 INFO] Step 4950/ 7800; acc: 83.9; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2274; bsz:  558/ 483/45; 7704/6676 tok/s;    187 sec;
[2024-03-12 10:38:11,205 INFO] Step 5000/ 7800; acc: 84.4; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2490; bsz:  591/ 515/50; 11366/9906 tok/s;    189 sec;
[2024-03-12 10:38:14,673 INFO] valid stats calculation
                           took: 3.4679367542266846 s.
[2024-03-12 10:38:14,673 INFO] Train perplexity: 11.2935
[2024-03-12 10:38:14,673 INFO] Train accuracy: 56.0797
[2024-03-12 10:38:14,673 INFO] Sentences processed: 102886
[2024-03-12 10:38:14,673 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:38:14,673 INFO] Validation perplexity: 2188.43
[2024-03-12 10:38:14,673 INFO] Validation accuracy: 28.0786
[2024-03-12 10:38:14,675 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_5000.pt
[2024-03-12 10:38:18,381 INFO] Step 5050/ 7800; acc: 84.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2261; bsz:  552/ 476/45; 3844/3320 tok/s;    197 sec;
[2024-03-12 10:38:21,963 INFO] Step 5100/ 7800; acc: 85.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2275; bsz:  567/ 492/46; 7920/6862 tok/s;    200 sec;
[2024-03-12 10:38:25,545 INFO] Step 5150/ 7800; acc: 85.7; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2367; bsz:  566/ 498/47; 7907/6944 tok/s;    204 sec;
[2024-03-12 10:38:28,408 INFO] Step 5200/ 7800; acc: 86.0; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2367; bsz:  588/ 515/47; 10267/8990 tok/s;    207 sec;
[2024-03-12 10:38:31,913 INFO] valid stats calculation
                           took: 3.5044562816619873 s.
[2024-03-12 10:38:31,913 INFO] Train perplexity: 9.61677
[2024-03-12 10:38:31,913 INFO] Train accuracy: 58.541
[2024-03-12 10:38:31,913 INFO] Sentences processed: 112156
[2024-03-12 10:38:31,913 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:38:31,913 INFO] Validation perplexity: 3329.38
[2024-03-12 10:38:31,913 INFO] Validation accuracy: 27.9182
[2024-03-12 10:38:31,915 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_5200.pt
[2024-03-12 10:38:35,448 INFO] Step 5250/ 7800; acc: 87.1; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2364; bsz:  561/ 487/47; 3981/3460 tok/s;    214 sec;
[2024-03-12 10:38:39,019 INFO] Step 5300/ 7800; acc: 87.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2263; bsz:  554/ 478/45; 7759/6695 tok/s;    217 sec;
[2024-03-12 10:38:42,609 INFO] Step 5350/ 7800; acc: 87.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2365; bsz:  573/ 496/47; 7984/6911 tok/s;    221 sec;
[2024-03-12 10:38:45,569 INFO] Step 5400/ 7800; acc: 87.4; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2276; bsz:  563/ 487/46; 9509/8220 tok/s;    224 sec;
[2024-03-12 10:38:49,117 INFO] valid stats calculation
                           took: 3.547156572341919 s.
[2024-03-12 10:38:49,117 INFO] Train perplexity: 8.37058
[2024-03-12 10:38:49,117 INFO] Train accuracy: 60.7257
[2024-03-12 10:38:49,117 INFO] Sentences processed: 121424
[2024-03-12 10:38:49,117 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:38:49,117 INFO] Validation perplexity: 3061.55
[2024-03-12 10:38:49,117 INFO] Validation accuracy: 28.0385
[2024-03-12 10:38:49,119 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_5400.pt
[2024-03-12 10:38:52,911 INFO] Step 5450/ 7800; acc: 88.2; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2372; bsz:  566/ 495/47; 3853/3372 tok/s;    231 sec;
[2024-03-12 10:38:56,637 INFO] Step 5500/ 7800; acc: 88.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  580/ 505/48; 7789/6780 tok/s;    235 sec;
[2024-03-12 10:39:00,235 INFO] Step 5550/ 7800; acc: 88.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2381; bsz:  579/ 499/48; 8048/6938 tok/s;    238 sec;
[2024-03-12 10:39:03,297 INFO] Step 5600/ 7800; acc: 89.0; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2276; bsz:  562/ 485/46; 9169/7916 tok/s;    241 sec;
[2024-03-12 10:39:06,886 INFO] valid stats calculation
                           took: 3.5881471633911133 s.
[2024-03-12 10:39:06,886 INFO] Train perplexity: 7.3942
[2024-03-12 10:39:06,886 INFO] Train accuracy: 62.7179
[2024-03-12 10:39:06,886 INFO] Sentences processed: 130828
[2024-03-12 10:39:06,886 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:39:06,886 INFO] Validation perplexity: 3154.9
[2024-03-12 10:39:06,886 INFO] Validation accuracy: 28.3594
[2024-03-12 10:39:06,888 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_5600.pt
[2024-03-12 10:39:10,481 INFO] Step 5650/ 7800; acc: 89.8; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  566/ 491/48; 3939/3417 tok/s;    249 sec;
[2024-03-12 10:39:14,200 INFO] Step 5700/ 7800; acc: 89.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 7880/6829 tok/s;    252 sec;
[2024-03-12 10:39:17,739 INFO] Step 5750/ 7800; acc: 90.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  564/ 489/47; 7962/6914 tok/s;    256 sec;
[2024-03-12 10:39:20,925 INFO] Step 5800/ 7800; acc: 90.1; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2268; bsz:  563/ 488/45; 8843/7666 tok/s;    259 sec;
[2024-03-12 10:39:24,555 INFO] valid stats calculation
                           took: 3.629650592803955 s.
[2024-03-12 10:39:24,555 INFO] Train perplexity: 6.62579
[2024-03-12 10:39:24,555 INFO] Train accuracy: 64.5238
[2024-03-12 10:39:24,556 INFO] Sentences processed: 140208
[2024-03-12 10:39:24,556 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:39:24,556 INFO] Validation perplexity: 3711.26
[2024-03-12 10:39:24,556 INFO] Validation accuracy: 27.5973
[2024-03-12 10:39:24,557 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_5800.pt
[2024-03-12 10:39:28,168 INFO] Step 5850/ 7800; acc: 90.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2362; bsz:  579/ 499/47; 3995/3444 tok/s;    266 sec;
[2024-03-12 10:39:31,659 INFO] Step 5900/ 7800; acc: 90.6; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2267; bsz:  544/ 472/45; 7793/6764 tok/s;    270 sec;
[2024-03-12 10:39:35,240 INFO] Step 5950/ 7800; acc: 91.1; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2369; bsz:  580/ 501/47; 8104/6992 tok/s;    273 sec;
[2024-03-12 10:39:38,553 INFO] Step 6000/ 7800; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  583/ 504/47; 8797/7612 tok/s;    277 sec;
[2024-03-12 10:39:42,185 INFO] valid stats calculation
                           took: 3.6317217350006104 s.
[2024-03-12 10:39:42,185 INFO] Train perplexity: 6.00718
[2024-03-12 10:39:42,186 INFO] Train accuracy: 66.161
[2024-03-12 10:39:42,186 INFO] Sentences processed: 149578
[2024-03-12 10:39:42,186 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:39:42,186 INFO] Validation perplexity: 3891.07
[2024-03-12 10:39:42,186 INFO] Validation accuracy: 27.9182
[2024-03-12 10:39:42,187 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_6000.pt
[2024-03-12 10:39:45,895 INFO] Step 6050/ 7800; acc: 91.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2269; bsz:  542/ 474/45; 3692/3226 tok/s;    284 sec;
[2024-03-12 10:39:49,581 INFO] Step 6100/ 7800; acc: 91.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  582/ 503/48; 7896/6831 tok/s;    288 sec;
[2024-03-12 10:39:53,199 INFO] Step 6150/ 7800; acc: 91.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2382; bsz:  568/ 496/48; 7854/6860 tok/s;    291 sec;
[2024-03-12 10:39:56,615 INFO] Step 6200/ 7800; acc: 92.2; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2275; bsz:  563/ 487/46; 8237/7124 tok/s;    295 sec;
[2024-03-12 10:40:00,182 INFO] valid stats calculation
                           took: 3.566960573196411 s.
[2024-03-12 10:40:00,183 INFO] Train perplexity: 5.50121
[2024-03-12 10:40:00,183 INFO] Train accuracy: 67.6557
[2024-03-12 10:40:00,183 INFO] Sentences processed: 158879
[2024-03-12 10:40:00,183 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:40:00,183 INFO] Validation perplexity: 4639.19
[2024-03-12 10:40:00,183 INFO] Validation accuracy: 28.3594
[2024-03-12 10:40:00,184 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_6200.pt
[2024-03-12 10:40:04,013 INFO] Step 6250/ 7800; acc: 91.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  592/ 515/48; 4003/3479 tok/s;    302 sec;
[2024-03-12 10:40:07,704 INFO] Step 6300/ 7800; acc: 91.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2368; bsz:  585/ 506/47; 7931/6862 tok/s;    306 sec;
[2024-03-12 10:40:11,203 INFO] Step 6350/ 7800; acc: 92.2; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2366; bsz:  565/ 490/47; 8074/7010 tok/s;    309 sec;
[2024-03-12 10:40:14,547 INFO] Step 6400/ 7800; acc: 92.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2248; bsz:  551/ 478/45; 8246/7154 tok/s;    313 sec;
[2024-03-12 10:40:18,140 INFO] valid stats calculation
                           took: 3.592414379119873 s.
[2024-03-12 10:40:18,140 INFO] Train perplexity: 5.07837
[2024-03-12 10:40:18,141 INFO] Train accuracy: 69.0178
[2024-03-12 10:40:18,141 INFO] Sentences processed: 168242
[2024-03-12 10:40:18,141 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:40:18,141 INFO] Validation perplexity: 5621.25
[2024-03-12 10:40:18,141 INFO] Validation accuracy: 28.3193
[2024-03-12 10:40:18,142 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_6400.pt
[2024-03-12 10:40:21,833 INFO] Step 6450/ 7800; acc: 92.2; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2363; bsz:  576/ 498/47; 3956/3417 tok/s;    320 sec;
[2024-03-12 10:40:25,409 INFO] Step 6500/ 7800; acc: 92.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2365; bsz:  562/ 490/47; 7866/6853 tok/s;    324 sec;
[2024-03-12 10:40:29,041 INFO] Step 6550/ 7800; acc: 92.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2258; bsz:  555/ 482/45; 7645/6631 tok/s;    327 sec;
[2024-03-12 10:40:32,664 INFO] Step 6600/ 7800; acc: 92.9; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2377; bsz:  587/ 513/48; 8100/7084 tok/s;    331 sec;
[2024-03-12 10:40:36,218 INFO] valid stats calculation
                           took: 3.5543153285980225 s.
[2024-03-12 10:40:36,219 INFO] Train perplexity: 4.72516
[2024-03-12 10:40:36,219 INFO] Train accuracy: 70.2583
[2024-03-12 10:40:36,219 INFO] Sentences processed: 177605
[2024-03-12 10:40:36,219 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:40:36,219 INFO] Validation perplexity: 6321.01
[2024-03-12 10:40:36,219 INFO] Validation accuracy: 26.8351
[2024-03-12 10:40:36,220 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_6600.pt
[2024-03-12 10:40:39,852 INFO] Step 6650/ 7800; acc: 92.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2379; bsz:  565/ 493/48; 3931/3432 tok/s;    338 sec;
[2024-03-12 10:40:43,404 INFO] Step 6700/ 7800; acc: 92.7; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2274; bsz:  555/ 478/45; 7818/6735 tok/s;    342 sec;
[2024-03-12 10:40:47,064 INFO] Step 6750/ 7800; acc: 93.0; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2277; bsz:  566/ 489/46; 7730/6682 tok/s;    345 sec;
[2024-03-12 10:40:50,658 INFO] Step 6800/ 7800; acc: 93.6; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2377; bsz:  565/ 493/48; 7866/6860 tok/s;    349 sec;
[2024-03-12 10:40:54,235 INFO] valid stats calculation
                           took: 3.5763838291168213 s.
[2024-03-12 10:40:54,236 INFO] Train perplexity: 4.42916
[2024-03-12 10:40:54,236 INFO] Train accuracy: 71.3852
[2024-03-12 10:40:54,236 INFO] Sentences processed: 186912
[2024-03-12 10:40:54,236 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:40:54,236 INFO] Validation perplexity: 7154.25
[2024-03-12 10:40:54,236 INFO] Validation accuracy: 28.7204
[2024-03-12 10:40:54,237 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_6800.pt
[2024-03-12 10:40:57,751 INFO] Step 6850/ 7800; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2372; bsz:  587/ 515/47; 4140/3632 tok/s;    356 sec;
[2024-03-12 10:41:01,436 INFO] Step 6900/ 7800; acc: 93.3; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2264; bsz:  559/ 483/45; 7586/6558 tok/s;    360 sec;
[2024-03-12 10:41:04,878 INFO] Step 6950/ 7800; acc: 93.4; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2470; bsz:  579/ 501/49; 8412/7285 tok/s;    363 sec;
[2024-03-12 10:41:08,367 INFO] Step 7000/ 7800; acc: 93.9; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2260; bsz:  554/ 481/45; 7936/6889 tok/s;    366 sec;
[2024-03-12 10:41:11,975 INFO] valid stats calculation
                           took: 3.607600212097168 s.
[2024-03-12 10:41:11,975 INFO] Train perplexity: 4.17155
[2024-03-12 10:41:11,975 INFO] Train accuracy: 72.4369
[2024-03-12 10:41:11,975 INFO] Sentences processed: 196278
[2024-03-12 10:41:11,975 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:41:11,975 INFO] Validation perplexity: 7472.99
[2024-03-12 10:41:11,975 INFO] Validation accuracy: 29.2419
[2024-03-12 10:41:11,977 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_7000.pt
[2024-03-12 10:41:15,391 INFO] Step 7050/ 7800; acc: 93.9; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  563/ 492/47; 4011/3502 tok/s;    374 sec;
[2024-03-12 10:41:18,925 INFO] Step 7100/ 7800; acc: 93.5; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2268; bsz:  561/ 484/45; 7935/6855 tok/s;    377 sec;
[2024-03-12 10:41:22,642 INFO] Step 7150/ 7800; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2373; bsz:  581/ 507/47; 7814/6814 tok/s;    381 sec;
[2024-03-12 10:41:26,229 INFO] Step 7200/ 7800; acc: 93.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2372; bsz:  565/ 491/47; 7883/6846 tok/s;    384 sec;
[2024-03-12 10:41:29,755 INFO] valid stats calculation
                           took: 3.5259969234466553 s.
[2024-03-12 10:41:29,755 INFO] Train perplexity: 3.94944
[2024-03-12 10:41:29,755 INFO] Train accuracy: 73.398
[2024-03-12 10:41:29,755 INFO] Sentences processed: 205658
[2024-03-12 10:41:29,755 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:41:29,756 INFO] Validation perplexity: 8627.23
[2024-03-12 10:41:29,756 INFO] Validation accuracy: 29.4023
[2024-03-12 10:41:29,757 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_7200.pt
[2024-03-12 10:41:33,122 INFO] Step 7250/ 7800; acc: 93.7; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2274; bsz:  578/ 496/45; 4193/3599 tok/s;    391 sec;
[2024-03-12 10:41:36,613 INFO] Step 7300/ 7800; acc: 93.9; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2382; bsz:  561/ 487/48; 8033/6980 tok/s;    395 sec;
[2024-03-12 10:41:40,203 INFO] Step 7350/ 7800; acc: 93.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2276; bsz:  565/ 488/46; 7870/6804 tok/s;    398 sec;
[2024-03-12 10:41:43,760 INFO] Step 7400/ 7800; acc: 93.9; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2377; bsz:  567/ 492/48; 7977/6918 tok/s;    402 sec;
[2024-03-12 10:41:47,239 INFO] valid stats calculation
                           took: 3.4785921573638916 s.
[2024-03-12 10:41:47,239 INFO] Train perplexity: 3.75718
[2024-03-12 10:41:47,239 INFO] Train accuracy: 74.2805
[2024-03-12 10:41:47,239 INFO] Sentences processed: 214967
[2024-03-12 10:41:47,239 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:41:47,239 INFO] Validation perplexity: 7617.14
[2024-03-12 10:41:47,239 INFO] Validation accuracy: 28.8408
[2024-03-12 10:41:47,241 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_7400.pt
[2024-03-12 10:41:50,268 INFO] Step 7450/ 7800; acc: 93.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 4499/3901 tok/s;    408 sec;
[2024-03-12 10:41:53,823 INFO] Step 7500/ 7800; acc: 94.0; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2260; bsz:  558/ 482/45; 7846/6776 tok/s;    412 sec;
[2024-03-12 10:41:57,323 INFO] Step 7550/ 7800; acc: 94.1; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2369; bsz:  581/ 501/47; 8295/7154 tok/s;    415 sec;
[2024-03-12 10:42:00,830 INFO] Step 7600/ 7800; acc: 94.4; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2365; bsz:  564/ 489/47; 8040/6977 tok/s;    419 sec;
[2024-03-12 10:42:04,437 INFO] valid stats calculation
                           took: 3.6071436405181885 s.
[2024-03-12 10:42:04,437 INFO] Train perplexity: 3.586
[2024-03-12 10:42:04,437 INFO] Train accuracy: 75.1072
[2024-03-12 10:42:04,437 INFO] Sentences processed: 224332
[2024-03-12 10:42:04,438 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:42:04,438 INFO] Validation perplexity: 9192.02
[2024-03-12 10:42:04,438 INFO] Validation accuracy: 28.7605
[2024-03-12 10:42:04,439 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_7600.pt
[2024-03-12 10:42:07,073 INFO] Step 7650/ 7800; acc: 94.2; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  566/ 494/47; 4533/3959 tok/s;    425 sec;
[2024-03-12 10:42:10,634 INFO] Step 7700/ 7800; acc: 94.2; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2369; bsz:  583/ 504/47; 8185/7084 tok/s;    429 sec;
[2024-03-12 10:42:14,218 INFO] Step 7750/ 7800; acc: 93.8; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2270; bsz:  557/ 483/45; 7774/6742 tok/s;    432 sec;
[2024-03-12 10:42:17,760 INFO] Step 7800/ 7800; acc: 94.5; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2371; bsz:  567/ 494/47; 8009/6970 tok/s;    436 sec;
[2024-03-12 10:42:21,190 INFO] valid stats calculation
                           took: 3.428809404373169 s.
[2024-03-12 10:42:21,190 INFO] Train perplexity: 3.43526
[2024-03-12 10:42:21,190 INFO] Train accuracy: 75.8705
[2024-03-12 10:42:21,190 INFO] Sentences processed: 233709
[2024-03-12 10:42:21,190 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:42:21,190 INFO] Validation perplexity: 9393.57
[2024-03-12 10:42:21,190 INFO] Validation accuracy: 29.0012
[2024-03-12 10:42:21,191 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_2800_02_step_7800.pt
