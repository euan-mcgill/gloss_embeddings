[2024-03-12 10:05:40,116 WARNING] Corpus corpus_1's weight should be given. We default it to 1 for you.
[2024-03-12 10:05:40,116 INFO] Parsed 2 corpora from -data.
[2024-03-12 10:05:40,116 INFO] Loading checkpoint from tg-pt-enc/models/tg-pt-enc_02_step_6200.pt
[2024-03-12 10:05:40,182 INFO] Building model...
[2024-03-12 10:05:40,239 INFO] Switching model to float32 for amp/apex_amp
[2024-03-12 10:05:40,239 INFO] Non quantized layer compute is fp32
[2024-03-12 10:05:42,528 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(17816, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (rnn): LSTM(300, 500, num_layers=2, batch_first=True, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(14144, 300, padding_idx=1)
        )
      )
      (dropout): Dropout(p=0.3, inplace=False)
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(800, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Linear(in_features=500, out_features=14144, bias=True)
)
[2024-03-12 10:05:42,529 INFO] encoder: 8952800
[2024-03-12 10:05:42,529 INFO] decoder: 16687344
[2024-03-12 10:05:42,529 INFO] * number of parameters: 25640144
[2024-03-12 10:05:42,529 INFO] Trainable parameters = {'torch.float32': 25640144, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 10:05:42,529 INFO] Non trainable parameters = {'torch.float32': 0, 'torch.float16': 0, 'torch.uint8': 0, 'torch.int8': 0}
[2024-03-12 10:05:42,529 INFO]  * src vocab size = 17816
[2024-03-12 10:05:42,529 INFO]  * tgt vocab size = 14144
[2024-03-12 10:05:42,530 INFO] Starting training on GPU: [0]
[2024-03-12 10:05:42,530 INFO] Start training loop and validate every 200 steps...
[2024-03-12 10:05:42,531 INFO] Scoring with: TransformPipe(InferFeatsTransform())
[2024-03-12 10:05:49,436 INFO] Step 6250/11200; acc: 10.1; ppl: 391153.8; xent: 12.9; lr: 1.00000; sents:    2270; bsz:  565/ 490/45; 4092/3546 tok/s;      7 sec;
[2024-03-12 10:05:52,940 INFO] Step 6300/11200; acc: 10.0; ppl: 19943.1; xent: 9.9; lr: 1.00000; sents:    2369; bsz:  569/ 496/47; 8114/7077 tok/s;     10 sec;
[2024-03-12 10:05:56,552 INFO] Step 6350/11200; acc: 11.3; ppl: 9473.0; xent: 9.2; lr: 1.00000; sents:    2363; bsz:  585/ 508/47; 8101/7032 tok/s;     14 sec;
[2024-03-12 10:06:00,141 INFO] Step 6400/11200; acc: 9.8; ppl: 5033.8; xent: 8.5; lr: 1.00000; sents:    2365; bsz:  585/ 507/47; 8151/7067 tok/s;     18 sec;
[2024-03-12 10:06:03,675 INFO] valid stats calculation
                           took: 3.533891201019287 s.
[2024-03-12 10:06:03,676 INFO] Train perplexity: 24128.8
[2024-03-12 10:06:03,676 INFO] Train accuracy: 10.2989
[2024-03-12 10:06:03,676 INFO] Sentences processed: 9367
[2024-03-12 10:06:03,676 INFO] Average bsz:  576/ 500/47
[2024-03-12 10:06:03,676 INFO] Validation perplexity: 2441.64
[2024-03-12 10:06:03,676 INFO] Validation accuracy: 7.74168
[2024-03-12 10:06:03,677 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_6400.pt
[2024-03-12 10:06:06,676 INFO] Step 6450/11200; acc: 10.9; ppl: 3012.4; xent: 8.0; lr: 1.00000; sents:    2367; bsz:  564/ 491/47; 4318/3757 tok/s;     24 sec;
[2024-03-12 10:06:10,280 INFO] Step 6500/11200; acc: 10.6; ppl: 3368.2; xent: 8.1; lr: 1.00000; sents:    2251; bsz:  549/ 475/45; 7618/6588 tok/s;     28 sec;
[2024-03-12 10:06:13,899 INFO] Step 6550/11200; acc: 12.6; ppl: 1378.3; xent: 7.2; lr: 1.00000; sents:    2275; bsz:  561/ 487/46; 7753/6726 tok/s;     31 sec;
[2024-03-12 10:06:17,436 INFO] Step 6600/11200; acc: 13.1; ppl: 1144.1; xent: 7.0; lr: 1.00000; sents:    2487; bsz:  594/ 518/50; 8393/7319 tok/s;     35 sec;
[2024-03-12 10:06:20,923 INFO] valid stats calculation
                           took: 3.4868969917297363 s.
[2024-03-12 10:06:20,924 INFO] Train perplexity: 6975.33
[2024-03-12 10:06:20,924 INFO] Train accuracy: 11.0531
[2024-03-12 10:06:20,924 INFO] Sentences processed: 18747
[2024-03-12 10:06:20,924 INFO] Average bsz:  572/ 496/47
[2024-03-12 10:06:20,924 INFO] Validation perplexity: 868.11
[2024-03-12 10:06:20,924 INFO] Validation accuracy: 10.5897
[2024-03-12 10:06:20,925 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_6600.pt
[2024-03-12 10:06:23,770 INFO] Step 6650/11200; acc: 15.0; ppl: 573.5; xent: 6.4; lr: 1.00000; sents:    2277; bsz:  561/ 487/46; 4432/3843 tok/s;     41 sec;
[2024-03-12 10:06:27,310 INFO] Step 6700/11200; acc: 17.0; ppl: 333.7; xent: 5.8; lr: 1.00000; sents:    2261; bsz:  552/ 477/45; 7795/6735 tok/s;     45 sec;
[2024-03-12 10:06:30,908 INFO] Step 6750/11200; acc: 21.5; ppl: 161.3; xent: 5.1; lr: 1.00000; sents:    2372; bsz:  564/ 491/47; 7842/6820 tok/s;     48 sec;
[2024-03-12 10:06:34,547 INFO] Step 6800/11200; acc: 23.4; ppl: 117.4; xent: 4.8; lr: 1.00000; sents:    2366; bsz:  578/ 500/47; 7940/6876 tok/s;     52 sec;
[2024-03-12 10:06:38,045 INFO] valid stats calculation
                           took: 3.4974589347839355 s.
[2024-03-12 10:06:38,045 INFO] Train perplexity: 2306.3
[2024-03-12 10:06:38,045 INFO] Train accuracy: 13.7621
[2024-03-12 10:06:38,045 INFO] Sentences processed: 28023
[2024-03-12 10:06:38,045 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:06:38,045 INFO] Validation perplexity: 350.401
[2024-03-12 10:06:38,045 INFO] Validation accuracy: 21.0991
[2024-03-12 10:06:38,047 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_6800.pt
[2024-03-12 10:06:40,619 INFO] Step 6850/11200; acc: 25.4; ppl:  87.0; xent: 4.5; lr: 1.00000; sents:    2367; bsz:  567/ 499/47; 4671/4109 tok/s;     58 sec;
[2024-03-12 10:06:44,184 INFO] Step 6900/11200; acc: 28.6; ppl:  65.9; xent: 4.2; lr: 1.00000; sents:    2268; bsz:  587/ 505/45; 8231/7080 tok/s;     62 sec;
[2024-03-12 10:06:47,717 INFO] Step 6950/11200; acc: 31.1; ppl:  46.8; xent: 3.8; lr: 1.00000; sents:    2367; bsz:  567/ 499/47; 8028/7056 tok/s;     65 sec;
[2024-03-12 10:06:51,282 INFO] Step 7000/11200; acc: 33.2; ppl:  36.6; xent: 3.6; lr: 1.00000; sents:    2261; bsz:  554/ 479/45; 7772/6713 tok/s;     69 sec;
[2024-03-12 10:06:54,665 INFO] valid stats calculation
                           took: 3.3829314708709717 s.
[2024-03-12 10:06:54,666 INFO] Train perplexity: 909.651
[2024-03-12 10:06:54,666 INFO] Train accuracy: 17.714
[2024-03-12 10:06:54,666 INFO] Sentences processed: 37286
[2024-03-12 10:06:54,666 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:06:54,666 INFO] Validation perplexity: 255.657
[2024-03-12 10:06:54,666 INFO] Validation accuracy: 22.503
[2024-03-12 10:06:54,667 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_7000.pt
[2024-03-12 10:06:57,203 INFO] Step 7050/11200; acc: 36.1; ppl:  31.0; xent: 3.4; lr: 1.00000; sents:    2373; bsz:  575/ 499/47; 4859/4217 tok/s;     75 sec;
[2024-03-12 10:07:00,587 INFO] Step 7100/11200; acc: 38.7; ppl:  22.8; xent: 3.1; lr: 1.00000; sents:    2371; bsz:  563/ 491/47; 8325/7250 tok/s;     78 sec;
[2024-03-12 10:07:04,228 INFO] Step 7150/11200; acc: 39.6; ppl:  20.9; xent: 3.0; lr: 1.00000; sents:    2376; bsz:  581/ 506/48; 7983/6946 tok/s;     82 sec;
[2024-03-12 10:07:07,748 INFO] Step 7200/11200; acc: 42.3; ppl:  16.4; xent: 2.8; lr: 1.00000; sents:    2284; bsz:  547/ 475/46; 7773/6755 tok/s;     85 sec;
[2024-03-12 10:07:11,158 INFO] valid stats calculation
                           took: 3.4096519947052 s.
[2024-03-12 10:07:11,158 INFO] Train perplexity: 433.764
[2024-03-12 10:07:11,158 INFO] Train accuracy: 21.987
[2024-03-12 10:07:11,158 INFO] Sentences processed: 46690
[2024-03-12 10:07:11,158 INFO] Average bsz:  568/ 494/47
[2024-03-12 10:07:11,158 INFO] Validation perplexity: 370.574
[2024-03-12 10:07:11,158 INFO] Validation accuracy: 24.2278
[2024-03-12 10:07:11,160 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_7200.pt
[2024-03-12 10:07:13,749 INFO] Step 7250/11200; acc: 43.9; ppl:  14.5; xent: 2.7; lr: 1.00000; sents:    2376; bsz:  581/ 505/48; 4839/4204 tok/s;     91 sec;
[2024-03-12 10:07:16,834 INFO] Step 7300/11200; acc: 45.5; ppl:  12.3; xent: 2.5; lr: 1.00000; sents:    2275; bsz:  561/ 484/46; 9099/7851 tok/s;     94 sec;
[2024-03-12 10:07:20,347 INFO] Step 7350/11200; acc: 47.9; ppl:  10.6; xent: 2.4; lr: 1.00000; sents:    2371; bsz:  564/ 488/47; 8031/6940 tok/s;     98 sec;
[2024-03-12 10:07:23,986 INFO] Step 7400/11200; acc: 49.4; ppl:   9.3; xent: 2.2; lr: 1.00000; sents:    2366; bsz:  577/ 501/47; 7931/6885 tok/s;    101 sec;
[2024-03-12 10:07:27,439 INFO] valid stats calculation
                           took: 3.4524240493774414 s.
[2024-03-12 10:07:27,439 INFO] Train perplexity: 236.852
[2024-03-12 10:07:27,439 INFO] Train accuracy: 26.1036
[2024-03-12 10:07:27,439 INFO] Sentences processed: 56078
[2024-03-12 10:07:27,439 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:07:27,439 INFO] Validation perplexity: 346.743
[2024-03-12 10:07:27,439 INFO] Validation accuracy: 26.1131
[2024-03-12 10:07:27,441 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_7400.pt
[2024-03-12 10:07:30,106 INFO] Step 7450/11200; acc: 51.4; ppl:   8.2; xent: 2.1; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 4610/4007 tok/s;    108 sec;
[2024-03-12 10:07:32,862 INFO] Step 7500/11200; acc: 52.9; ppl:   7.6; xent: 2.0; lr: 1.00000; sents:    2364; bsz:  584/ 506/47; 10594/9173 tok/s;    110 sec;
[2024-03-12 10:07:36,422 INFO] Step 7550/11200; acc: 54.6; ppl:   6.7; xent: 1.9; lr: 1.00000; sents:    2269; bsz:  564/ 488/45; 7922/6855 tok/s;    114 sec;
[2024-03-12 10:07:39,965 INFO] Step 7600/11200; acc: 56.0; ppl:   6.2; xent: 1.8; lr: 1.00000; sents:    2367; bsz:  579/ 500/47; 8177/7055 tok/s;    117 sec;
[2024-03-12 10:07:43,441 INFO] valid stats calculation
                           took: 3.474876642227173 s.
[2024-03-12 10:07:43,441 INFO] Train perplexity: 143.378
[2024-03-12 10:07:43,441 INFO] Train accuracy: 30.0614
[2024-03-12 10:07:43,441 INFO] Sentences processed: 65444
[2024-03-12 10:07:43,441 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:07:43,441 INFO] Validation perplexity: 442.664
[2024-03-12 10:07:43,441 INFO] Validation accuracy: 27.3566
[2024-03-12 10:07:43,442 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_7600.pt
[2024-03-12 10:07:46,591 INFO] Step 7650/11200; acc: 58.1; ppl:   5.6; xent: 1.7; lr: 1.00000; sents:    2272; bsz:  562/ 485/45; 4241/3657 tok/s;    124 sec;
[2024-03-12 10:07:49,303 INFO] Step 7700/11200; acc: 59.7; ppl:   5.0; xent: 1.6; lr: 1.00000; sents:    2371; bsz:  564/ 490/47; 10404/9030 tok/s;    127 sec;
[2024-03-12 10:07:52,812 INFO] Step 7750/11200; acc: 61.4; ppl:   4.5; xent: 1.5; lr: 1.00000; sents:    2375; bsz:  566/ 493/48; 8068/7024 tok/s;    130 sec;
[2024-03-12 10:07:56,415 INFO] Step 7800/11200; acc: 62.1; ppl:   4.4; xent: 1.5; lr: 1.00000; sents:    2382; bsz:  582/ 504/48; 8076/6989 tok/s;    134 sec;
[2024-03-12 10:07:59,900 INFO] valid stats calculation
                           took: 3.4842112064361572 s.
[2024-03-12 10:07:59,900 INFO] Train perplexity: 94.0027
[2024-03-12 10:07:59,900 INFO] Train accuracy: 33.836
[2024-03-12 10:07:59,900 INFO] Sentences processed: 74844
[2024-03-12 10:07:59,900 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:07:59,900 INFO] Validation perplexity: 576.073
[2024-03-12 10:07:59,900 INFO] Validation accuracy: 28.6803
[2024-03-12 10:07:59,901 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_7800.pt
[2024-03-12 10:08:03,093 INFO] Step 7850/11200; acc: 64.1; ppl:   3.9; xent: 1.4; lr: 1.00000; sents:    2274; bsz:  557/ 483/45; 4174/3619 tok/s;    141 sec;
[2024-03-12 10:08:05,627 INFO] Step 7900/11200; acc: 64.2; ppl:   4.0; xent: 1.4; lr: 1.00000; sents:    2376; bsz:  589/ 510/48; 11617/10069 tok/s;    143 sec;
[2024-03-12 10:08:09,269 INFO] Step 7950/11200; acc: 66.8; ppl:   3.4; xent: 1.2; lr: 1.00000; sents:    2368; bsz:  569/ 498/47; 7812/6839 tok/s;    147 sec;
[2024-03-12 10:08:12,874 INFO] Step 8000/11200; acc: 68.7; ppl:   3.2; xent: 1.2; lr: 1.00000; sents:    2270; bsz:  563/ 487/45; 7807/6757 tok/s;    150 sec;
[2024-03-12 10:08:16,381 INFO] valid stats calculation
                           took: 3.506547451019287 s.
[2024-03-12 10:08:16,382 INFO] Train perplexity: 65.4438
[2024-03-12 10:08:16,382 INFO] Train accuracy: 37.406
[2024-03-12 10:08:16,382 INFO] Sentences processed: 84132
[2024-03-12 10:08:16,382 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:08:16,382 INFO] Validation perplexity: 941.198
[2024-03-12 10:08:16,382 INFO] Validation accuracy: 27.6775
[2024-03-12 10:08:16,383 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_8000.pt
[2024-03-12 10:08:19,803 INFO] Step 8050/11200; acc: 68.9; ppl:   3.1; xent: 1.1; lr: 1.00000; sents:    2369; bsz:  587/ 508/47; 4236/3664 tok/s;    157 sec;
[2024-03-12 10:08:22,147 INFO] Step 8100/11200; acc: 70.2; ppl:   3.0; xent: 1.1; lr: 1.00000; sents:    2242; bsz:  548/ 475/45; 11688/10135 tok/s;    160 sec;
[2024-03-12 10:08:25,511 INFO] Step 8150/11200; acc: 72.3; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    2365; bsz:  564/ 490/47; 8386/7292 tok/s;    163 sec;
[2024-03-12 10:08:29,103 INFO] Step 8200/11200; acc: 72.2; ppl:   2.7; xent: 1.0; lr: 1.00000; sents:    2367; bsz:  579/ 502/47; 8062/6984 tok/s;    167 sec;
[2024-03-12 10:08:32,608 INFO] valid stats calculation
                           took: 3.504711866378784 s.
[2024-03-12 10:08:32,609 INFO] Train perplexity: 47.9167
[2024-03-12 10:08:32,609 INFO] Train accuracy: 40.7516
[2024-03-12 10:08:32,609 INFO] Sentences processed: 93475
[2024-03-12 10:08:32,609 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:08:32,609 INFO] Validation perplexity: 1197.3
[2024-03-12 10:08:32,609 INFO] Validation accuracy: 27.0357
[2024-03-12 10:08:32,611 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_8200.pt
[2024-03-12 10:08:36,415 INFO] Step 8250/11200; acc: 73.8; ppl:   2.6; xent: 0.9; lr: 1.00000; sents:    2372; bsz:  564/ 491/47; 3858/3358 tok/s;    174 sec;
[2024-03-12 10:08:38,944 INFO] Step 8300/11200; acc: 74.1; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2275; bsz:  562/ 487/46; 11108/9633 tok/s;    176 sec;
[2024-03-12 10:08:42,076 INFO] Step 8350/11200; acc: 74.3; ppl:   2.5; xent: 0.9; lr: 1.00000; sents:    2383; bsz:  583/ 507/48; 9311/8092 tok/s;    180 sec;
[2024-03-12 10:08:45,680 INFO] Step 8400/11200; acc: 76.4; ppl:   2.3; xent: 0.8; lr: 1.00000; sents:    2267; bsz:  555/ 479/45; 7693/6650 tok/s;    183 sec;
[2024-03-12 10:08:49,116 INFO] valid stats calculation
                           took: 3.435926914215088 s.
[2024-03-12 10:08:49,117 INFO] Train perplexity: 36.6642
[2024-03-12 10:08:49,117 INFO] Train accuracy: 43.8136
[2024-03-12 10:08:49,117 INFO] Sentences processed: 102772
[2024-03-12 10:08:49,117 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:08:49,117 INFO] Validation perplexity: 1697.51
[2024-03-12 10:08:49,117 INFO] Validation accuracy: 27.7978
[2024-03-12 10:08:49,119 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_8400.pt
[2024-03-12 10:08:52,770 INFO] Step 8450/11200; acc: 77.4; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2375; bsz:  563/ 489/48; 3971/3450 tok/s;    190 sec;
[2024-03-12 10:08:55,395 INFO] Step 8500/11200; acc: 77.7; ppl:   2.2; xent: 0.8; lr: 1.00000; sents:    2372; bsz:  586/ 513/47; 11165/9775 tok/s;    193 sec;
[2024-03-12 10:08:58,494 INFO] Step 8550/11200; acc: 78.2; ppl:   2.1; xent: 0.7; lr: 1.00000; sents:    2270; bsz:  567/ 491/45; 9154/7919 tok/s;    196 sec;
[2024-03-12 10:09:02,047 INFO] Step 8600/11200; acc: 79.5; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2367; bsz:  568/ 500/47; 7993/7032 tok/s;    200 sec;
[2024-03-12 10:09:05,536 INFO] valid stats calculation
                           took: 3.488236904144287 s.
[2024-03-12 10:09:05,536 INFO] Train perplexity: 28.8624
[2024-03-12 10:09:05,537 INFO] Train accuracy: 46.7017
[2024-03-12 10:09:05,537 INFO] Sentences processed: 112156
[2024-03-12 10:09:05,537 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:09:05,537 INFO] Validation perplexity: 2369.68
[2024-03-12 10:09:05,537 INFO] Validation accuracy: 26.073
[2024-03-12 10:09:05,538 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_8600.pt
[2024-03-12 10:09:09,158 INFO] Step 8650/11200; acc: 79.6; ppl:   2.0; xent: 0.7; lr: 1.00000; sents:    2260; bsz:  555/ 480/45; 3906/3379 tok/s;    207 sec;
[2024-03-12 10:09:11,967 INFO] Step 8700/11200; acc: 80.9; ppl:   1.9; xent: 0.7; lr: 1.00000; sents:    2367; bsz:  571/ 492/47; 10164/8762 tok/s;    209 sec;
[2024-03-12 10:09:14,630 INFO] Step 8750/11200; acc: 81.6; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2365; bsz:  562/ 489/47; 10541/9178 tok/s;    212 sec;
[2024-03-12 10:09:18,325 INFO] Step 8800/11200; acc: 81.8; ppl:   1.9; xent: 0.6; lr: 1.00000; sents:    2373; bsz:  582/ 507/47; 7875/6861 tok/s;    216 sec;
[2024-03-12 10:09:21,853 INFO] valid stats calculation
                           took: 3.5282745361328125 s.
[2024-03-12 10:09:21,854 INFO] Train perplexity: 23.4601
[2024-03-12 10:09:21,854 INFO] Train accuracy: 49.3283
[2024-03-12 10:09:21,854 INFO] Sentences processed: 121521
[2024-03-12 10:09:21,854 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:09:21,854 INFO] Validation perplexity: 3183.02
[2024-03-12 10:09:21,854 INFO] Validation accuracy: 27.6775
[2024-03-12 10:09:21,855 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_8800.pt
[2024-03-12 10:09:25,595 INFO] Step 8850/11200; acc: 82.5; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2275; bsz:  547/ 475/46; 3762/3265 tok/s;    223 sec;
[2024-03-12 10:09:28,835 INFO] Step 8900/11200; acc: 83.0; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2375; bsz:  580/ 505/48; 8957/7796 tok/s;    226 sec;
[2024-03-12 10:09:31,307 INFO] Step 8950/11200; acc: 83.3; ppl:   1.8; xent: 0.6; lr: 1.00000; sents:    2381; bsz:  566/ 491/48; 11449/9933 tok/s;    229 sec;
[2024-03-12 10:09:34,873 INFO] Step 9000/11200; acc: 84.3; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2376; bsz:  578/ 498/48; 8108/6989 tok/s;    232 sec;
[2024-03-12 10:09:38,312 INFO] valid stats calculation
                           took: 3.438887119293213 s.
[2024-03-12 10:09:38,312 INFO] Train perplexity: 19.5198
[2024-03-12 10:09:38,312 INFO] Train accuracy: 51.7457
[2024-03-12 10:09:38,312 INFO] Sentences processed: 130928
[2024-03-12 10:09:38,312 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:09:38,312 INFO] Validation perplexity: 3033.01
[2024-03-12 10:09:38,312 INFO] Validation accuracy: 27.8379
[2024-03-12 10:09:38,314 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_9000.pt
[2024-03-12 10:09:42,073 INFO] Step 9050/11200; acc: 84.9; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2275; bsz:  562/ 485/46; 3904/3370 tok/s;    240 sec;
[2024-03-12 10:09:45,204 INFO] Step 9100/11200; acc: 84.5; ppl:   1.7; xent: 0.5; lr: 1.00000; sents:    2371; bsz:  566/ 491/47; 9031/7838 tok/s;    243 sec;
[2024-03-12 10:09:47,769 INFO] Step 9150/11200; acc: 85.6; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2268; bsz:  583/ 504/45; 11370/9838 tok/s;    245 sec;
[2024-03-12 10:09:51,242 INFO] Step 9200/11200; acc: 86.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2366; bsz:  564/ 490/47; 8125/7061 tok/s;    249 sec;
[2024-03-12 10:09:54,723 INFO] valid stats calculation
                           took: 3.4802558422088623 s.
[2024-03-12 10:09:54,723 INFO] Train perplexity: 16.5586
[2024-03-12 10:09:54,723 INFO] Train accuracy: 53.9803
[2024-03-12 10:09:54,723 INFO] Sentences processed: 140208
[2024-03-12 10:09:54,723 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:09:54,723 INFO] Validation perplexity: 3457.6
[2024-03-12 10:09:54,723 INFO] Validation accuracy: 28.1187
[2024-03-12 10:09:54,725 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_9200.pt
[2024-03-12 10:09:58,324 INFO] Step 9250/11200; acc: 86.4; ppl:   1.6; xent: 0.5; lr: 1.00000; sents:    2362; bsz:  562/ 488/47; 3970/3446 tok/s;    256 sec;
[2024-03-12 10:10:01,651 INFO] Step 9300/11200; acc: 86.7; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2369; bsz:  580/ 500/47; 8720/7514 tok/s;    259 sec;
[2024-03-12 10:10:04,091 INFO] Step 9350/11200; acc: 86.9; ppl:   1.6; xent: 0.4; lr: 1.00000; sents:    2267; bsz:  561/ 484/45; 11490/9915 tok/s;    262 sec;
[2024-03-12 10:10:07,308 INFO] Step 9400/11200; acc: 87.3; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2270; bsz:  559/ 485/45; 8691/7539 tok/s;    265 sec;
[2024-03-12 10:10:10,712 INFO] valid stats calculation
                           took: 3.4031143188476562 s.
[2024-03-12 10:10:10,712 INFO] Train perplexity: 14.3074
[2024-03-12 10:10:10,712 INFO] Train accuracy: 56.0155
[2024-03-12 10:10:10,712 INFO] Sentences processed: 149476
[2024-03-12 10:10:10,712 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:10:10,712 INFO] Validation perplexity: 5455.72
[2024-03-12 10:10:10,713 INFO] Validation accuracy: 28.1588
[2024-03-12 10:10:10,714 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_9400.pt
[2024-03-12 10:10:14,469 INFO] Step 9450/11200; acc: 87.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2371; bsz:  566/ 493/47; 3951/3442 tok/s;    272 sec;
[2024-03-12 10:10:18,153 INFO] Step 9500/11200; acc: 87.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2375; bsz:  582/ 503/48; 7900/6834 tok/s;    276 sec;
[2024-03-12 10:10:20,632 INFO] Step 9550/11200; acc: 88.1; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2382; bsz:  589/ 510/48; 11878/10296 tok/s;    278 sec;
[2024-03-12 10:10:23,192 INFO] Step 9600/11200; acc: 89.4; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2275; bsz:  542/ 473/46; 10590/9233 tok/s;    281 sec;
[2024-03-12 10:10:26,763 INFO] valid stats calculation
                           took: 3.570312023162842 s.
[2024-03-12 10:10:26,763 INFO] Train perplexity: 12.5243
[2024-03-12 10:10:26,763 INFO] Train accuracy: 57.913
[2024-03-12 10:10:26,763 INFO] Sentences processed: 158879
[2024-03-12 10:10:26,763 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:10:26,764 INFO] Validation perplexity: 4605.34
[2024-03-12 10:10:26,764 INFO] Validation accuracy: 28.6402
[2024-03-12 10:10:26,765 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_9600.pt
[2024-03-12 10:10:29,319 INFO] Step 9650/11200; acc: 88.6; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2381; bsz:  592/ 515/48; 4834/4201 tok/s;    287 sec;
[2024-03-12 10:10:32,875 INFO] Step 9700/11200; acc: 88.8; ppl:   1.5; xent: 0.4; lr: 1.00000; sents:    2368; bsz:  585/ 506/47; 8231/7122 tok/s;    290 sec;
[2024-03-12 10:10:36,347 INFO] Step 9750/11200; acc: 90.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2246; bsz:  529/ 460/45; 7624/6631 tok/s;    294 sec;
[2024-03-12 10:10:40,026 INFO] Step 9800/11200; acc: 89.4; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2368; bsz:  587/ 509/47; 7980/6911 tok/s;    297 sec;
[2024-03-12 10:10:43,377 INFO] valid stats calculation
                           took: 3.350799322128296 s.
[2024-03-12 10:10:43,378 INFO] Train perplexity: 11.0982
[2024-03-12 10:10:43,378 INFO] Train accuracy: 59.6621
[2024-03-12 10:10:43,378 INFO] Sentences processed: 168242
[2024-03-12 10:10:43,378 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:10:43,378 INFO] Validation perplexity: 6222.13
[2024-03-12 10:10:43,378 INFO] Validation accuracy: 28.2391
[2024-03-12 10:10:43,379 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_9800.pt
[2024-03-12 10:10:45,963 INFO] Step 9850/11200; acc: 89.5; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2363; bsz:  576/ 498/47; 4856/4193 tok/s;    303 sec;
[2024-03-12 10:10:49,243 INFO] Step 9900/11200; acc: 89.6; ppl:   1.4; xent: 0.4; lr: 1.00000; sents:    2251; bsz:  535/ 467/45; 8161/7113 tok/s;    307 sec;
[2024-03-12 10:10:52,855 INFO] Step 9950/11200; acc: 89.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  582/ 505/47; 8063/6994 tok/s;    310 sec;
[2024-03-12 10:10:56,466 INFO] Step 10000/11200; acc: 90.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  587/ 513/48; 8126/7106 tok/s;    314 sec;
[2024-03-12 10:10:59,868 INFO] valid stats calculation
                           took: 3.4008984565734863 s.
[2024-03-12 10:10:59,868 INFO] Train perplexity: 9.9534
[2024-03-12 10:10:59,868 INFO] Train accuracy: 61.2543
[2024-03-12 10:10:59,868 INFO] Sentences processed: 177605
[2024-03-12 10:10:59,868 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:10:59,868 INFO] Validation perplexity: 7007.32
[2024-03-12 10:10:59,868 INFO] Validation accuracy: 28.7204
[2024-03-12 10:10:59,870 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_10000.pt
[2024-03-12 10:11:02,610 INFO] Step 10050/11200; acc: 90.8; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2272; bsz:  556/ 482/45; 4523/3924 tok/s;    320 sec;
[2024-03-12 10:11:05,569 INFO] Step 10100/11200; acc: 90.9; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2381; bsz:  565/ 490/48; 9544/8276 tok/s;    323 sec;
[2024-03-12 10:11:09,166 INFO] Step 10150/11200; acc: 91.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2376; bsz:  564/ 492/48; 7838/6836 tok/s;    327 sec;
[2024-03-12 10:11:12,824 INFO] Step 10200/11200; acc: 91.0; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  585/ 512/48; 7997/6993 tok/s;    330 sec;
[2024-03-12 10:11:16,287 INFO] valid stats calculation
                           took: 3.462733745574951 s.
[2024-03-12 10:11:16,288 INFO] Train perplexity: 9.01131
[2024-03-12 10:11:16,288 INFO] Train accuracy: 62.7382
[2024-03-12 10:11:16,288 INFO] Sentences processed: 187009
[2024-03-12 10:11:16,288 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:11:16,288 INFO] Validation perplexity: 10161.8
[2024-03-12 10:11:16,288 INFO] Validation accuracy: 28.0385
[2024-03-12 10:11:16,289 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_10200.pt
[2024-03-12 10:11:19,066 INFO] Step 10250/11200; acc: 91.2; ppl:   1.4; xent: 0.3; lr: 1.00000; sents:    2275; bsz:  569/ 494/46; 4562/3957 tok/s;    337 sec;
[2024-03-12 10:11:21,881 INFO] Step 10300/11200; acc: 91.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  563/ 489/47; 9994/8684 tok/s;    339 sec;
[2024-03-12 10:11:25,516 INFO] Step 10350/11200; acc: 92.0; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  576/ 496/47; 7916/6820 tok/s;    343 sec;
[2024-03-12 10:11:29,080 INFO] Step 10400/11200; acc: 91.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2260; bsz:  554/ 481/45; 7766/6742 tok/s;    347 sec;
[2024-03-12 10:11:32,510 INFO] valid stats calculation
                           took: 3.429480791091919 s.
[2024-03-12 10:11:32,511 INFO] Train perplexity: 8.23322
[2024-03-12 10:11:32,511 INFO] Train accuracy: 64.0987
[2024-03-12 10:11:32,511 INFO] Sentences processed: 196278
[2024-03-12 10:11:32,511 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:11:32,511 INFO] Validation perplexity: 11432.7
[2024-03-12 10:11:32,511 INFO] Validation accuracy: 27.7577
[2024-03-12 10:11:32,512 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_10400.pt
[2024-03-12 10:11:35,577 INFO] Step 10450/11200; acc: 91.9; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2367; bsz:  563/ 492/47; 4337/3787 tok/s;    353 sec;
[2024-03-12 10:11:38,118 INFO] Step 10500/11200; acc: 91.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2268; bsz:  561/ 484/45; 11036/9534 tok/s;    356 sec;
[2024-03-12 10:11:41,743 INFO] Step 10550/11200; acc: 91.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2373; bsz:  581/ 507/47; 8015/6989 tok/s;    359 sec;
[2024-03-12 10:11:45,425 INFO] Step 10600/11200; acc: 91.8; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2372; bsz:  585/ 503/47; 7939/6836 tok/s;    363 sec;
[2024-03-12 10:11:48,878 INFO] valid stats calculation
                           took: 3.451963186264038 s.
[2024-03-12 10:11:48,878 INFO] Train perplexity: 7.57366
[2024-03-12 10:11:48,878 INFO] Train accuracy: 65.366
[2024-03-12 10:11:48,878 INFO] Sentences processed: 205658
[2024-03-12 10:11:48,878 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:11:48,878 INFO] Validation perplexity: 11306.8
[2024-03-12 10:11:48,878 INFO] Validation accuracy: 26.5544
[2024-03-12 10:11:48,880 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_10600.pt
[2024-03-12 10:11:51,985 INFO] Step 10650/11200; acc: 92.6; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2375; bsz:  561/ 487/48; 4277/3714 tok/s;    369 sec;
[2024-03-12 10:11:54,436 INFO] Step 10700/11200; acc: 92.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2281; bsz:  559/ 484/46; 11395/9870 tok/s;    372 sec;
[2024-03-12 10:11:58,020 INFO] Step 10750/11200; acc: 92.4; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2276; bsz:  565/ 488/46; 7885/6817 tok/s;    375 sec;
[2024-03-12 10:12:01,690 INFO] Step 10800/11200; acc: 92.5; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2377; bsz:  567/ 492/48; 7731/6703 tok/s;    379 sec;
[2024-03-12 10:12:05,143 INFO] valid stats calculation
                           took: 3.453066825866699 s.
[2024-03-12 10:12:05,144 INFO] Train perplexity: 7.02012
[2024-03-12 10:12:05,144 INFO] Train accuracy: 66.5302
[2024-03-12 10:12:05,144 INFO] Sentences processed: 214967
[2024-03-12 10:12:05,144 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:12:05,144 INFO] Validation perplexity: 13631.7
[2024-03-12 10:12:05,144 INFO] Validation accuracy: 28.6402
[2024-03-12 10:12:05,145 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_10800.pt
[2024-03-12 10:12:08,564 INFO] Step 10850/11200; acc: 92.3; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2371; bsz:  586/ 508/47; 4260/3694 tok/s;    386 sec;
[2024-03-12 10:12:11,036 INFO] Step 10900/11200; acc: 92.7; ppl:   1.3; xent: 0.3; lr: 1.00000; sents:    2260; bsz:  558/ 482/45; 11278/9738 tok/s;    389 sec;
[2024-03-12 10:12:14,369 INFO] Step 10950/11200; acc: 93.1; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2472; bsz:  584/ 507/49; 8768/7608 tok/s;    392 sec;
[2024-03-12 10:12:17,988 INFO] Step 11000/11200; acc: 92.8; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2262; bsz:  560/ 483/45; 7739/6674 tok/s;    395 sec;
[2024-03-12 10:12:21,408 INFO] valid stats calculation
                           took: 3.4191436767578125 s.
[2024-03-12 10:12:21,408 INFO] Train perplexity: 6.53842
[2024-03-12 10:12:21,408 INFO] Train accuracy: 67.6252
[2024-03-12 10:12:21,408 INFO] Sentences processed: 224332
[2024-03-12 10:12:21,408 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:12:21,408 INFO] Validation perplexity: 14556.8
[2024-03-12 10:12:21,408 INFO] Validation accuracy: 27.5973
[2024-03-12 10:12:21,409 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_11000.pt
[2024-03-12 10:12:24,982 INFO] Step 11050/11200; acc: 92.8; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2367; bsz:  566/ 494/47; 4046/3534 tok/s;    402 sec;
[2024-03-12 10:12:27,431 INFO] Step 11100/11200; acc: 93.0; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2369; bsz:  583/ 504/47; 11903/10302 tok/s;    405 sec;
[2024-03-12 10:12:30,852 INFO] Step 11150/11200; acc: 93.4; ppl:   1.2; xent: 0.2; lr: 1.00000; sents:    2270; bsz:  557/ 483/45; 8145/7064 tok/s;    408 sec;
[2024-03-12 10:12:34,540 INFO] Step 11200/11200; acc: 93.3; ppl:   1.3; xent: 0.2; lr: 1.00000; sents:    2257; bsz:  556/ 481/45; 7541/6522 tok/s;    412 sec;
[2024-03-12 10:12:38,038 INFO] valid stats calculation
                           took: 3.496259927749634 s.
[2024-03-12 10:12:38,038 INFO] Train perplexity: 6.12459
[2024-03-12 10:12:38,038 INFO] Train accuracy: 68.6393
[2024-03-12 10:12:38,038 INFO] Sentences processed: 233595
[2024-03-12 10:12:38,038 INFO] Average bsz:  569/ 494/47
[2024-03-12 10:12:38,038 INFO] Validation perplexity: 16438.4
[2024-03-12 10:12:38,038 INFO] Validation accuracy: 27.0758
[2024-03-12 10:12:38,039 INFO] Saving checkpoint tg-ft-enc/tg-ft-enc_6200_02_step_11200.pt
